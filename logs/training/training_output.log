Could not register with unified registry
WARNING:root:Could not import TSNormalizer from utils.normalization
WARNING:root:Wavelet components not available: attempted relative import beyond top-level package
INFO:__main__:Starting PRODUCTION Celestial Enhanced PGAT training run
INFO:__main__:Heavy-duty overnight configuration enabled
INFO:__main__:================================================================================
INFO:__main__:Memory diagnostics enabled; detailed logs stored at checkpoints\celestial_enhanced_pgat_production_overnight\memory_diagnostics.log
INFO:__main__:Configuration summary | model=Celestial_Enhanced_PGAT seq_len=250 pred_len=10 d_model=130 n_heads=8 e_layers=4 d_layers=2 train_epochs=50
INFO:__main__:Optimization summary | batch_size=16 learning_rate=0.001 patience=999 target=log_Open,log_High,log_Low,log_Close target_wave_indices=[0, 1, 2, 3] c_out=4 wave_aggregation=True
INFO:__main__:Using device: cpu (CPU fallback)
INFO:__main__:Reproducibility seed configured to 2024
INFO:__main__:Loading production data modules
INFO:__main__:Loaded train data module | samples=6750 batches=421 batch_size=16 drop_last=True shuffle=True pin_memory=False prefetch_factor=n/a persistent_workers=False
INFO:__main__:Loaded val data module | samples=41 batches=3 batch_size=16 drop_last=False shuffle=False pin_memory=False prefetch_factor=n/a persistent_workers=False
INFO:__main__:Loaded test data module | samples=41 batches=3 batch_size=16 drop_last=False shuffle=False pin_memory=False prefetch_factor=n/a persistent_workers=False
INFO:__main__:Data loader sizes | train=421 val=3 test=3
INFO:__main__:Preparing scaling utilities for loss computation
INFO:__main__:Main scaler detected with 118 features
INFO:__main__:Target scaler detected with 4 features
INFO:__main__:Using target indices for OHLC: [0, 1, 2, 3]
INFO:__main__:Initializing production Celestial Enhanced PGAT model
WARNING:models.Celestial_Enhanced_PGAT.Model:d_model=130 is not compatible with graph/attention dimensions; required multiple=104 (nodes=13 heads=8). Adjusted to 208.
INFO:__main__:Model initialized successfully
INFO:__main__:Parameter statistics | total=12,310,208 trainable=12,310,208 approx_size_mb=47.0
INFO:__main__:Standard precision training
INFO:__main__:Gradient accumulation configured | steps=2 effective_batch_size=32
INFO:__main__:Learning rate schedule preview | warmup_epochs=5 base_lr=0.001000 min_lr=0.000001 remaining_epochs=45
INFO:__main__:Sample learning rates: E1:0.000200, E5:0.001000, E6:0.001000, E26:0.000587, E50:0.000002
INFO:__main__:Using MSE Loss for deterministic predictions
INFO:__main__:Early stopping patience configured to 999 (effectively disabled)
INFO:__main__:Checkpoints will be saved to checkpoints\celestial_enhanced_pgat_production_overnight
INFO:__main__:Inspecting data file at ./data\prepared_financial_data.csv for target resolution
INFO:__main__:Feature summary | total_columns=119 feature_columns=118
INFO:__main__:Estimated CSV row count: 7109
INFO:__main__:Auto-set enc_in/dec_in to 118 based on feature count
INFO:__main__:Resolved target indices: [0, 1, 2, 3]
INFO:__main__:Resolved target names: ['log_Open', 'log_High', 'log_Low', 'log_Close']
INFO:__main__:Starting production training loop
INFO:__main__:Configured for 50 training epochs
INFO:__main__:Epoch 1/50 - production training
