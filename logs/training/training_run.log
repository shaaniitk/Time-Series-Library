2025-10-26 09:41:11,463 INFO __main__: Starting PRODUCTION Celestial Enhanced PGAT training run
2025-10-26 09:41:11,463 INFO __main__: Heavy-duty overnight configuration enabled
2025-10-26 09:41:11,463 INFO __main__: üîç DIAGNOSTIC MODE ENABLED - Writing to training_diagnostic.log
2025-10-26 09:41:11,463 INFO __main__: ================================================================================
2025-10-26 09:41:11,463 ERROR __main__: PRODUCTION training failed with error: [Errno 13] Permission denied: '/home/kalki/Documents/workspace/Time-Series-Library/checkpoints/celestial_enhanced_pgat_production_recovery/memory_diagnostics.log'
Traceback (most recent call last):
  File "/home/kalki/Documents/workspace/Time-Series-Library/scripts/train/train_celestial_production.py", line 2472, in main
    success = train_celestial_pgat_production(config_path=cli_args.config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalki/Documents/workspace/Time-Series-Library/scripts/train/train_celestial_production.py", line 1919, in train_celestial_pgat_production
    memory_handler = logging.FileHandler(memory_log_file, encoding="utf-8")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1181, in __init__
    StreamHandler.__init__(self, self._open())
                                 ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1213, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/kalki/Documents/workspace/Time-Series-Library/checkpoints/celestial_enhanced_pgat_production_recovery/memory_diagnostics.log'
2025-10-26 09:41:48,962 INFO __main__: Starting PRODUCTION Celestial Enhanced PGAT training run
2025-10-26 09:41:48,963 INFO __main__: Heavy-duty overnight configuration enabled
2025-10-26 09:41:48,963 INFO __main__: üîç DIAGNOSTIC MODE ENABLED - Writing to training_diagnostic.log
2025-10-26 09:41:48,963 INFO __main__: ================================================================================
2025-10-26 09:41:48,963 INFO __main__: Memory diagnostics enabled; detailed logs stored at checkpoints/celestial_enhanced_pgat_production_recovery_kalki/memory_diagnostics.log
2025-10-26 09:41:48,963 INFO __main__: Configuration summary | model=Celestial_Enhanced_PGAT seq_len=250 pred_len=10 d_model=416 n_heads=8 e_layers=8 d_layers=4 train_epochs=3
2025-10-26 09:41:48,963 INFO __main__: Optimization summary | batch_size=12 learning_rate=0.003 patience=999 target=log_Open,log_High,log_Low,log_Close target_wave_indices=[0, 1, 2, 3] c_out=4 wave_aggregation=True
2025-10-26 09:41:48,963 INFO __main__: Using device: cpu (CPU fallback)
2025-10-26 09:41:48,964 INFO __main__: Reproducibility seed configured to 2024
2025-10-26 09:41:48,964 INFO __main__: Loading production data modules
2025-10-26 09:41:49,029 INFO __main__: Loaded train data module | samples=6250 batches=520 batch_size=12 drop_last=True shuffle=True pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 09:41:49,090 INFO __main__: Loaded val data module | samples=291 batches=25 batch_size=12 drop_last=False shuffle=False pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 09:41:49,149 INFO __main__: Loaded test data module | samples=291 batches=25 batch_size=12 drop_last=False shuffle=False pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 09:41:49,149 INFO __main__: Data loader sizes | train=520 val=25 test=25
2025-10-26 09:41:49,149 INFO __main__: Preparing scaling utilities for loss computation
2025-10-26 09:41:49,149 INFO __main__: Main scaler detected with 118 features
2025-10-26 09:41:49,149 INFO __main__: Target scaler detected with 4 features
2025-10-26 09:41:49,149 INFO __main__: Using target indices for OHLC: [0, 1, 2, 3]
2025-10-26 09:41:49,150 INFO __main__: Initializing production Celestial Enhanced PGAT model
2025-10-26 09:41:49,165 INFO models.Celestial_Enhanced_PGAT.Model: Celestial projection preserves: 416D ‚Üí 416D (1.0x)
2025-10-26 09:41:49,190 INFO models.Celestial_Enhanced_PGAT.Model: üöÄ Initializing Petri Net Combiner with message passing (edge_feature_dim=6, num_steps=2)
2025-10-26 09:41:49,201 INFO models.Celestial_Enhanced_PGAT.Model: ‚úÖ Petri Net Combiner initialized - memory efficient with ZERO information loss!
2025-10-26 09:41:49,205 INFO models.Celestial_Enhanced_PGAT.Model: Celestial fusion gate initialized to 0.5 (balanced) for stable warmup
2025-10-26 09:41:49,296 INFO models.Celestial_Enhanced_PGAT.Model: üöÄ Using EdgeConditionedGraphAttention - ZERO information loss from edge features!
2025-10-26 09:41:49,345 INFO models.Celestial_Enhanced_PGAT.Model: üéØ Target Autocorrelation Module enabled with 2 layers
2025-10-26 09:41:49,347 INFO models.Celestial_Enhanced_PGAT.Model: üìÖ Calendar Effects Module enabled with 104D embeddings
2025-10-26 09:41:49,480 INFO __main__: Model initialized successfully
2025-10-26 09:41:49,482 INFO __main__: Parameter statistics | total=57,324,017 trainable=57,324,017 approx_size_mb=218.7
2025-10-26 09:41:49,483 INFO __main__: Standard precision training
2025-10-26 09:41:49,483 INFO __main__: Gradient accumulation configured | steps=3 effective_batch_size=36
2025-10-26 09:41:49,483 INFO __main__: Learning rate schedule preview | warmup_epochs=3 base_lr=0.003000 min_lr=0.000010 remaining_epochs=0
2025-10-26 09:41:49,484 INFO __main__: Sample learning rates: E1:0.001000, E3:0.003000, E2:0.002000, E3:0.003000
2025-10-26 09:41:49,484 INFO __main__: Using MSE Loss for deterministic predictions
2025-10-26 09:41:49,484 INFO __main__: Early stopping patience configured to 999 (effectively disabled)
2025-10-26 09:41:49,484 INFO __main__: Checkpoints will be saved to checkpoints/celestial_enhanced_pgat_production_recovery_kalki
2025-10-26 09:41:49,484 INFO __main__: Inspecting data file at ./data/prepared_financial_data.csv for target resolution
2025-10-26 09:41:49,486 INFO __main__: Feature summary | total_columns=119 feature_columns=118
2025-10-26 09:41:49,493 INFO __main__: Estimated CSV row count: 7109
2025-10-26 09:41:49,493 INFO __main__: Auto-set enc_in/dec_in to 118 based on feature count
2025-10-26 09:41:49,493 INFO __main__: Resolved target indices: [0, 1, 2, 3]
2025-10-26 09:41:49,493 INFO __main__: Resolved target names: ['log_Open', 'log_High', 'log_Low', 'log_Close']
2025-10-26 09:41:49,493 INFO __main__: Starting production training loop
2025-10-26 09:41:49,493 INFO __main__: Configured for 3 training epochs
2025-10-26 09:41:49,493 INFO __main__: Warmup phase | epoch=1/3 lr=0.00100000
2025-10-26 09:41:49,494 INFO __main__: Epoch 1/3 - production training
2025-10-26 09:41:49,576 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:41:49,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=0.80GB
2025-10-26 09:41:50,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=1.05GB
2025-10-26 09:41:50,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=1.09GB
2025-10-26 09:41:50,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=1.11GB
2025-10-26 09:41:50,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=1.12GB
2025-10-26 09:41:51,130 INFO models.Celestial_Enhanced_PGAT.Model: [CELESTIAL FUSION] Gate stats | mean=0.503708 std=0.081184 min=0.192106 max=0.832568 | celestial_features_std=0.999973 enc_out_std=0.609490 fused_output_std=0.217364 influence_norm=123.8598
2025-10-26 09:41:51,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=3.86GB
2025-10-26 09:41:51,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=3.86GB
2025-10-26 09:41:51,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=3.86GB
2025-10-26 09:41:51,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=3.86GB
2025-10-26 09:41:52,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=3.86GB
2025-10-26 09:41:52,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=3.86GB
2025-10-26 09:41:52,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=3.87GB
2025-10-26 09:41:54,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=17.66GB Delta_CPU=+13.79GB
2025-10-26 09:41:54,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=17.66GB
2025-10-26 09:42:02,197 INFO __main__: Batch 0/520 | loss=1.060983 elapsed=12.7s
2025-10-26 09:42:02,197 DEBUG __main__: Production train - first batch scaling check
2025-10-26 09:42:02,197 DEBUG __main__: Raw batch_y OHLC stats | mean=0.001508 std=0.012547
2025-10-26 09:42:02,197 DEBUG __main__: Scaled targets stats | mean=0.072997 std=0.866500
2025-10-26 09:42:02,197 DEBUG __main__: Model outputs stats | mean=0.103204 std=0.574869
2025-10-26 09:42:02,197 DEBUG __main__: Scaling consistency verified for production training
2025-10-26 09:42:02,199 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:42:02,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=17.26GB
2025-10-26 09:42:02,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=17.26GB
2025-10-26 09:42:02,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 09:42:03,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=17.26GB
2025-10-26 09:42:03,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 09:42:03,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 09:42:04,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=17.26GB
2025-10-26 09:42:04,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=17.26GB
2025-10-26 09:42:04,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 09:42:04,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 09:42:04,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 09:42:04,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=17.26GB
2025-10-26 09:42:06,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=19.33GB Delta_CPU=+2.08GB
2025-10-26 09:42:07,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=19.33GB
2025-10-26 09:42:14,641 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:42:14,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=18.54GB
2025-10-26 09:42:15,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=18.54GB
2025-10-26 09:42:15,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=18.54GB
2025-10-26 09:42:15,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=18.54GB
2025-10-26 09:42:15,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=18.54GB
2025-10-26 09:42:16,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=18.54GB
2025-10-26 09:42:16,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=18.54GB
2025-10-26 09:42:16,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=18.54GB
2025-10-26 09:42:16,916 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=18.54GB
2025-10-26 09:42:17,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=18.54GB
2025-10-26 09:42:17,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=18.54GB
2025-10-26 09:42:17,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=18.54GB
2025-10-26 09:42:19,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=22.97GB Delta_CPU=+4.43GB
2025-10-26 09:42:19,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=22.97GB
2025-10-26 09:42:26,896 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:42:27,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=21.36GB
2025-10-26 09:42:27,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=21.36GB
2025-10-26 09:42:27,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=21.36GB
2025-10-26 09:42:27,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=21.36GB
2025-10-26 09:42:28,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=21.36GB
2025-10-26 09:42:28,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=21.36GB
2025-10-26 09:42:28,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=21.36GB
2025-10-26 09:42:28,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=21.36GB
2025-10-26 09:42:29,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=21.36GB
2025-10-26 09:42:29,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=21.36GB
2025-10-26 09:42:29,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=21.36GB
2025-10-26 09:42:29,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=21.36GB
2025-10-26 09:42:31,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=21.55GB Delta_CPU=+0.18GB
2025-10-26 09:42:31,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=21.55GB
2025-10-26 09:42:39,179 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:42:39,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=21.48GB
2025-10-26 09:42:39,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=21.48GB
2025-10-26 09:42:39,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=21.48GB
2025-10-26 09:42:40,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=21.48GB
2025-10-26 09:42:40,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=21.48GB
2025-10-26 09:42:40,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=21.48GB
2025-10-26 09:42:41,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=21.48GB
2025-10-26 09:42:41,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=21.48GB
2025-10-26 09:42:41,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=21.48GB
2025-10-26 09:42:41,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=21.48GB
2025-10-26 09:42:41,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=21.48GB
2025-10-26 09:42:41,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=21.48GB
2025-10-26 09:42:43,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.72GB Delta_CPU=+2.24GB
2025-10-26 09:42:43,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.72GB
2025-10-26 09:42:51,050 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:42:51,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=22.47GB
2025-10-26 09:42:51,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=22.47GB
2025-10-26 09:42:51,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=22.47GB
2025-10-26 09:42:52,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=22.47GB
2025-10-26 09:42:52,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=22.47GB
2025-10-26 09:42:52,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=22.47GB
2025-10-26 09:42:52,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=22.47GB
2025-10-26 09:42:53,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=22.47GB
2025-10-26 09:42:53,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=22.47GB
2025-10-26 09:42:53,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=22.47GB
2025-10-26 09:42:53,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=22.47GB
2025-10-26 09:42:53,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=22.47GB
2025-10-26 09:42:55,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.32GB Delta_CPU=+0.86GB
2025-10-26 09:42:55,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.32GB
2025-10-26 09:43:03,065 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:43:03,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=22.53GB
2025-10-26 09:43:03,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=22.53GB
2025-10-26 09:43:03,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=22.53GB
2025-10-26 09:43:04,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=22.53GB
2025-10-26 09:43:04,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=22.53GB
2025-10-26 09:43:04,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=22.53GB
2025-10-26 09:43:04,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=22.53GB
2025-10-26 09:43:05,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=22.53GB
2025-10-26 09:43:05,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=22.53GB
2025-10-26 09:43:05,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=22.53GB
2025-10-26 09:43:05,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=22.53GB
2025-10-26 09:43:05,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=22.53GB
2025-10-26 09:43:07,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.38GB Delta_CPU=+0.85GB
2025-10-26 09:43:07,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.38GB
2025-10-26 09:43:15,123 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:43:15,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=23.08GB
2025-10-26 09:43:15,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=23.08GB
2025-10-26 09:43:15,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:16,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=23.08GB
2025-10-26 09:43:16,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:16,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:16,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=23.08GB
2025-10-26 09:43:17,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=23.08GB
2025-10-26 09:43:17,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:17,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:17,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:17,806 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=23.08GB
2025-10-26 09:43:19,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.43GB Delta_CPU=+0.35GB
2025-10-26 09:43:19,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.43GB
2025-10-26 09:43:27,156 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:43:27,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=23.43GB
2025-10-26 09:43:27,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=23.43GB
2025-10-26 09:43:27,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=23.43GB
2025-10-26 09:43:28,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=23.43GB
2025-10-26 09:43:28,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=23.43GB
2025-10-26 09:43:28,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=23.43GB
2025-10-26 09:43:29,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=23.43GB
2025-10-26 09:43:29,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=23.43GB
2025-10-26 09:43:29,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=23.43GB
2025-10-26 09:43:29,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=23.43GB
2025-10-26 09:43:29,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=23.43GB
2025-10-26 09:43:29,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=23.43GB
2025-10-26 09:43:31,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.42GB Delta_CPU=-0.01GB
2025-10-26 09:43:31,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.42GB
2025-10-26 09:43:39,321 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:43:39,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=23.08GB
2025-10-26 09:43:39,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=23.08GB
2025-10-26 09:43:40,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:40,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=23.08GB
2025-10-26 09:43:40,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:41,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=23.08GB
2025-10-26 09:43:41,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=23.08GB
2025-10-26 09:43:41,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=23.08GB
2025-10-26 09:43:41,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:41,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:42,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=23.08GB
2025-10-26 09:43:42,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=23.08GB
2025-10-26 09:43:43,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.13GB Delta_CPU=+1.06GB
2025-10-26 09:43:44,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.13GB
2025-10-26 09:43:51,447 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:43:51,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.13GB
2025-10-26 09:43:51,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.13GB
2025-10-26 09:43:52,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.13GB
2025-10-26 09:43:52,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.13GB
2025-10-26 09:43:52,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.13GB
2025-10-26 09:43:53,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.13GB
2025-10-26 09:43:53,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.13GB
2025-10-26 09:43:53,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.13GB
2025-10-26 09:43:53,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.13GB
2025-10-26 09:43:53,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.13GB
2025-10-26 09:43:54,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.13GB
2025-10-26 09:43:54,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.13GB
2025-10-26 09:43:55,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.55GB Delta_CPU=+0.41GB
2025-10-26 09:43:56,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.55GB
2025-10-26 09:44:03,635 INFO __main__: Batch 10/520 | loss=15.060561 elapsed=134.1s
2025-10-26 09:44:03,641 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:44:03,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.55GB
2025-10-26 09:44:04,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.55GB
2025-10-26 09:44:04,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 09:44:04,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.55GB
2025-10-26 09:44:04,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 09:44:05,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 09:44:05,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.55GB
2025-10-26 09:44:05,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.55GB
2025-10-26 09:44:05,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 09:44:06,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 09:44:06,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 09:44:06,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.55GB
2025-10-26 09:44:08,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.51GB Delta_CPU=-0.04GB
2025-10-26 09:44:08,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.51GB
2025-10-26 09:44:15,467 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:44:15,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.17GB
2025-10-26 09:44:16,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.17GB
2025-10-26 09:44:16,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.17GB
2025-10-26 09:44:16,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.17GB
2025-10-26 09:44:16,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.17GB
2025-10-26 09:44:17,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.17GB
2025-10-26 09:44:17,292 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.17GB
2025-10-26 09:44:17,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.17GB
2025-10-26 09:44:17,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.17GB
2025-10-26 09:44:17,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.17GB
2025-10-26 09:44:18,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.17GB
2025-10-26 09:44:18,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.17GB
2025-10-26 09:44:19,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.62GB Delta_CPU=+0.45GB
2025-10-26 09:44:20,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.62GB
2025-10-26 09:44:27,405 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:44:27,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.62GB
2025-10-26 09:44:27,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.62GB
2025-10-26 09:44:28,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:44:28,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.62GB
2025-10-26 09:44:28,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:44:29,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:44:29,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.62GB
2025-10-26 09:44:29,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.62GB
2025-10-26 09:44:29,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:44:29,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:44:30,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:44:30,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.62GB
2025-10-26 09:44:31,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.59GB Delta_CPU=-0.04GB
2025-10-26 09:44:32,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.59GB
2025-10-26 09:44:39,595 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:44:39,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.59GB
2025-10-26 09:44:40,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.59GB
2025-10-26 09:44:40,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 09:44:40,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.59GB
2025-10-26 09:44:40,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 09:44:41,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 09:44:41,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.59GB
2025-10-26 09:44:41,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.59GB
2025-10-26 09:44:41,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 09:44:42,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 09:44:42,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 09:44:42,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.59GB
2025-10-26 09:44:44,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.61GB Delta_CPU=+0.03GB
2025-10-26 09:44:44,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.61GB
2025-10-26 09:44:51,627 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:44:51,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.61GB
2025-10-26 09:44:52,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.61GB
2025-10-26 09:44:52,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 09:44:52,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.61GB
2025-10-26 09:44:52,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 09:44:53,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 09:44:53,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.61GB
2025-10-26 09:44:53,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.61GB
2025-10-26 09:44:53,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 09:44:54,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 09:44:54,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 09:44:54,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.61GB
2025-10-26 09:44:56,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.57GB Delta_CPU=-0.05GB
2025-10-26 09:44:56,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.57GB
2025-10-26 09:45:03,576 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:45:03,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.36GB
2025-10-26 09:45:04,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.36GB
2025-10-26 09:45:04,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:04,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.36GB
2025-10-26 09:45:04,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:05,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:05,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.36GB
2025-10-26 09:45:05,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.36GB
2025-10-26 09:45:05,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:06,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:06,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:06,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.36GB
2025-10-26 09:45:08,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.36GB Delta_CPU=-0.00GB
2025-10-26 09:45:08,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.36GB
2025-10-26 09:45:15,700 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:45:15,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.36GB
2025-10-26 09:45:16,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.36GB
2025-10-26 09:45:16,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:16,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.36GB
2025-10-26 09:45:16,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:17,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.36GB
2025-10-26 09:45:17,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.36GB
2025-10-26 09:45:17,775 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.36GB
2025-10-26 09:45:17,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:18,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:18,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.36GB
2025-10-26 09:45:18,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.36GB
2025-10-26 09:45:20,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.14GB Delta_CPU=+0.79GB
2025-10-26 09:45:20,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.14GB
2025-10-26 09:45:27,895 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:45:28,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.35GB
2025-10-26 09:45:28,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.35GB
2025-10-26 09:45:28,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 09:45:28,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.35GB
2025-10-26 09:45:29,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 09:45:29,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 09:45:29,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.35GB
2025-10-26 09:45:29,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.35GB
2025-10-26 09:45:30,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 09:45:30,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 09:45:30,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 09:45:30,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.35GB
2025-10-26 09:45:32,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.34GB Delta_CPU=-0.01GB
2025-10-26 09:45:32,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.34GB
2025-10-26 09:45:39,852 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:45:40,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.34GB
2025-10-26 09:45:40,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.34GB
2025-10-26 09:45:40,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.34GB
2025-10-26 09:45:40,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.34GB
2025-10-26 09:45:41,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.34GB
2025-10-26 09:45:41,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.34GB
2025-10-26 09:45:41,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.34GB
2025-10-26 09:45:41,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.34GB
2025-10-26 09:45:42,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.34GB
2025-10-26 09:45:42,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.34GB
2025-10-26 09:45:42,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.34GB
2025-10-26 09:45:42,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.34GB
2025-10-26 09:45:44,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.31GB Delta_CPU=+0.97GB
2025-10-26 09:45:44,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.31GB
2025-10-26 09:45:52,135 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:45:52,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.31GB
2025-10-26 09:45:52,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.31GB
2025-10-26 09:45:52,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:45:53,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.31GB
2025-10-26 09:45:53,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:45:53,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:45:53,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.31GB
2025-10-26 09:45:54,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.31GB
2025-10-26 09:45:54,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:45:54,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:45:54,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:45:54,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.31GB
2025-10-26 09:45:56,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=-0.01GB
2025-10-26 09:45:56,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 09:46:04,097 INFO __main__: Batch 20/520 | loss=4.451699 elapsed=254.6s
2025-10-26 09:46:04,099 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:46:04,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.30GB
2025-10-26 09:46:04,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.30GB
2025-10-26 09:46:04,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 09:46:05,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.30GB
2025-10-26 09:46:05,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 09:46:05,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 09:46:05,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.30GB
2025-10-26 09:46:06,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.30GB
2025-10-26 09:46:06,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 09:46:06,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 09:46:06,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 09:46:06,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.30GB
2025-10-26 09:46:08,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=-0.04GB
2025-10-26 09:46:08,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 09:46:16,314 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:46:16,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 09:46:16,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 09:46:17,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 09:46:17,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 09:46:17,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 09:46:17,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 09:46:18,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 09:46:18,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 09:46:18,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 09:46:18,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 09:46:18,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 09:46:18,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 09:46:20,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=-0.01GB
2025-10-26 09:46:20,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 09:46:28,331 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:46:28,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 09:46:28,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 09:46:29,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 09:46:29,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 09:46:29,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 09:46:29,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 09:46:30,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 09:46:30,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 09:46:30,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 09:46:30,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 09:46:30,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 09:46:30,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 09:46:32,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.33GB
2025-10-26 09:46:32,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 09:46:40,133 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:46:40,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.44GB
2025-10-26 09:46:40,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.44GB
2025-10-26 09:46:40,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 09:46:41,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.44GB
2025-10-26 09:46:41,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 09:46:41,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 09:46:41,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.44GB
2025-10-26 09:46:42,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.44GB
2025-10-26 09:46:42,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 09:46:42,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 09:46:42,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 09:46:42,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.44GB
2025-10-26 09:46:44,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.65GB Delta_CPU=+0.21GB
2025-10-26 09:46:44,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.65GB
2025-10-26 09:46:52,382 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:46:52,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 09:46:52,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 09:46:53,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 09:46:53,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 09:46:53,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 09:46:54,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 09:46:54,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 09:46:54,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 09:46:54,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 09:46:54,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 09:46:55,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 09:46:55,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 09:46:56,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.75GB Delta_CPU=+0.03GB
2025-10-26 09:46:57,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.75GB
2025-10-26 09:47:04,256 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:47:04,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 09:47:04,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 09:47:05,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:47:05,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 09:47:05,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:47:05,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:47:06,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 09:47:06,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 09:47:06,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:47:06,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:47:06,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:47:06,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 09:47:08,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=+0.79GB
2025-10-26 09:47:08,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 09:47:16,067 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:47:16,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.50GB
2025-10-26 09:47:16,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.50GB
2025-10-26 09:47:16,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:47:17,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.50GB
2025-10-26 09:47:17,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:47:17,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:47:17,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.50GB
2025-10-26 09:47:18,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.50GB
2025-10-26 09:47:18,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:47:18,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:47:18,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:47:18,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.50GB
2025-10-26 09:47:20,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.53GB Delta_CPU=+0.03GB
2025-10-26 09:47:20,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.53GB
2025-10-26 09:47:28,339 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:47:28,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.53GB
2025-10-26 09:47:28,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.53GB
2025-10-26 09:47:29,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 09:47:29,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.53GB
2025-10-26 09:47:29,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 09:47:30,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 09:47:30,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.53GB
2025-10-26 09:47:30,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.53GB
2025-10-26 09:47:30,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 09:47:30,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 09:47:31,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 09:47:31,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.53GB
2025-10-26 09:47:33,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.49GB Delta_CPU=-0.05GB
2025-10-26 09:47:33,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.49GB
2025-10-26 09:47:40,777 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:47:40,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 09:47:41,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 09:47:41,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:47:41,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 09:47:41,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:47:42,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:47:42,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 09:47:42,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 09:47:43,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:47:43,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:47:43,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:47:43,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 09:47:45,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.31GB Delta_CPU=+0.82GB
2025-10-26 09:47:45,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.31GB
2025-10-26 09:47:53,020 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:47:53,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.51GB
2025-10-26 09:47:53,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.51GB
2025-10-26 09:47:53,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:47:53,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.51GB
2025-10-26 09:47:54,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:47:54,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:47:54,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.51GB
2025-10-26 09:47:55,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.51GB
2025-10-26 09:47:55,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:47:55,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:47:55,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:47:55,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.51GB
2025-10-26 09:47:57,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.48GB Delta_CPU=+0.98GB
2025-10-26 09:47:57,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.48GB
2025-10-26 09:48:05,187 INFO __main__: Batch 30/520 | loss=1.731660 elapsed=375.7s
2025-10-26 09:48:05,192 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:48:05,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.37GB
2025-10-26 09:48:05,755 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.37GB
2025-10-26 09:48:05,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.37GB
2025-10-26 09:48:06,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.37GB
2025-10-26 09:48:06,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.37GB
2025-10-26 09:48:06,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.37GB
2025-10-26 09:48:07,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.37GB
2025-10-26 09:48:07,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.37GB
2025-10-26 09:48:07,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.37GB
2025-10-26 09:48:07,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.37GB
2025-10-26 09:48:07,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.37GB
2025-10-26 09:48:07,921 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.37GB
2025-10-26 09:48:09,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.64GB Delta_CPU=+0.27GB
2025-10-26 09:48:09,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.64GB
2025-10-26 09:48:17,436 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:48:17,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 09:48:17,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 09:48:18,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 09:48:18,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 09:48:18,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 09:48:19,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 09:48:19,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 09:48:19,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 09:48:19,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 09:48:19,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 09:48:20,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 09:48:20,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 09:48:21,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.63GB Delta_CPU=-0.01GB
2025-10-26 09:48:22,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.63GB
2025-10-26 09:48:29,268 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:48:29,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 09:48:29,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 09:48:29,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:30,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 09:48:30,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:30,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:31,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 09:48:31,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 09:48:31,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:31,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:31,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:31,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 09:48:33,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=+0.79GB
2025-10-26 09:48:33,847 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 09:48:41,229 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:48:41,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 09:48:41,775 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 09:48:41,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:42,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 09:48:42,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:42,875 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 09:48:43,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 09:48:43,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 09:48:43,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:43,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:43,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 09:48:43,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 09:48:45,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=+0.79GB
2025-10-26 09:48:45,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 09:48:53,145 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:48:53,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.62GB
2025-10-26 09:48:53,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.62GB
2025-10-26 09:48:53,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:48:54,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.62GB
2025-10-26 09:48:54,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:48:54,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 09:48:55,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.62GB
2025-10-26 09:48:55,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.62GB
2025-10-26 09:48:55,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:48:55,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:48:55,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 09:48:55,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.62GB
2025-10-26 09:48:57,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.48GB Delta_CPU=+0.86GB
2025-10-26 09:48:57,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.48GB
2025-10-26 09:49:04,921 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:49:05,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.48GB
2025-10-26 09:49:05,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.48GB
2025-10-26 09:49:05,670 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 09:49:05,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.48GB
2025-10-26 09:49:06,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 09:49:06,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 09:49:06,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.48GB
2025-10-26 09:49:06,957 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.48GB
2025-10-26 09:49:07,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 09:49:07,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 09:49:07,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 09:49:07,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.48GB
2025-10-26 09:49:09,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=+0.00GB
2025-10-26 09:49:09,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 09:49:16,914 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:49:17,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.42GB
2025-10-26 09:49:17,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.42GB
2025-10-26 09:49:17,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:49:17,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.42GB
2025-10-26 09:49:18,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:49:18,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:49:18,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.42GB
2025-10-26 09:49:18,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.42GB
2025-10-26 09:49:19,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:49:19,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:49:19,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:49:19,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.42GB
2025-10-26 09:49:21,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.27GB Delta_CPU=+0.84GB
2025-10-26 09:49:21,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.27GB
2025-10-26 09:49:28,764 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:49:28,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.47GB
2025-10-26 09:49:29,287 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.47GB
2025-10-26 09:49:29,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 09:49:29,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.47GB
2025-10-26 09:49:29,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 09:49:30,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 09:49:30,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.47GB
2025-10-26 09:49:30,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.47GB
2025-10-26 09:49:31,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 09:49:31,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 09:49:31,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 09:49:31,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.47GB
2025-10-26 09:49:33,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=-0.05GB
2025-10-26 09:49:33,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 09:49:40,885 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:49:41,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 09:49:41,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 09:49:41,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 09:49:41,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 09:49:42,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 09:49:42,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 09:49:42,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 09:49:42,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 09:49:43,179 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 09:49:43,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 09:49:43,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 09:49:43,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 09:49:45,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.32GB Delta_CPU=+0.03GB
2025-10-26 09:49:45,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.32GB
2025-10-26 09:49:53,007 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:49:53,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 09:49:53,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 09:49:53,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 09:49:53,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 09:49:54,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 09:49:54,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 09:49:54,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 09:49:55,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 09:49:55,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 09:49:55,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 09:49:55,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 09:49:55,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 09:49:57,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.91GB Delta_CPU=+0.83GB
2025-10-26 09:49:57,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.91GB
2025-10-26 09:50:04,926 INFO __main__: Batch 40/520 | loss=1.796029 elapsed=495.4s
2025-10-26 09:50:04,929 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:50:05,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 09:50:05,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 09:50:05,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:50:05,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 09:50:06,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:50:06,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:50:06,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 09:50:06,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 09:50:07,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:50:07,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:50:07,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:50:07,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 09:50:09,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.90GB Delta_CPU=+0.79GB
2025-10-26 09:50:09,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.90GB
2025-10-26 09:50:16,736 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:50:16,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.10GB
2025-10-26 09:50:17,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.10GB
2025-10-26 09:50:17,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 09:50:17,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.10GB
2025-10-26 09:50:17,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 09:50:18,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 09:50:18,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.10GB
2025-10-26 09:50:18,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.10GB
2025-10-26 09:50:18,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 09:50:19,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 09:50:19,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 09:50:19,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.10GB
2025-10-26 09:50:21,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=-0.01GB
2025-10-26 09:50:21,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 09:50:28,834 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:50:29,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 09:50:29,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 09:50:29,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:29,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 09:50:29,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:30,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:30,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 09:50:30,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 09:50:31,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:31,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:31,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:31,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 09:50:33,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.66GB Delta_CPU=+0.00GB
2025-10-26 09:50:33,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.66GB
2025-10-26 09:50:40,759 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:50:40,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 09:50:41,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 09:50:41,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:41,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 09:50:41,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:42,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 09:50:42,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 09:50:42,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 09:50:43,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:43,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:43,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 09:50:43,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 09:50:45,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=+0.83GB
2025-10-26 09:50:45,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 09:50:52,853 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:50:53,062 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.69GB
2025-10-26 09:50:53,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.69GB
2025-10-26 09:50:53,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 09:50:53,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.69GB
2025-10-26 09:50:54,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 09:50:54,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 09:50:54,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.69GB
2025-10-26 09:50:54,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.69GB
2025-10-26 09:50:55,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 09:50:55,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 09:50:55,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 09:50:55,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.69GB
2025-10-26 09:50:57,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.66GB Delta_CPU=-0.03GB
2025-10-26 09:50:57,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.66GB
2025-10-26 09:51:04,993 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:51:05,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:51:05,543 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:51:05,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:05,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:51:06,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:06,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:06,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:51:07,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:51:07,277 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:07,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:07,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:07,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:51:09,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=+0.00GB
2025-10-26 09:51:09,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 09:51:17,006 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:51:17,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:51:17,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:51:17,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:17,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:51:18,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:18,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:18,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:51:19,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:51:19,292 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:19,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:19,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:19,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:51:21,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.50GB Delta_CPU=+0.03GB
2025-10-26 09:51:21,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.50GB
2025-10-26 09:51:29,021 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:51:29,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.50GB
2025-10-26 09:51:29,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.50GB
2025-10-26 09:51:29,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:51:29,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.50GB
2025-10-26 09:51:30,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:51:30,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:51:30,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.50GB
2025-10-26 09:51:31,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.50GB
2025-10-26 09:51:31,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:51:31,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:51:31,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:51:31,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.50GB
2025-10-26 09:51:33,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=-0.03GB
2025-10-26 09:51:33,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 09:51:41,093 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:51:41,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:51:41,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:51:41,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:42,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:51:42,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:42,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:42,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:51:43,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:51:43,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:43,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:43,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:43,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:51:45,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=+0.00GB
2025-10-26 09:51:45,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 09:51:52,957 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:51:53,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:51:53,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:51:53,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:53,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:51:54,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:54,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:51:54,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:51:55,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:51:55,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:55,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:55,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:51:55,670 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:51:57,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.83GB Delta_CPU=+0.36GB
2025-10-26 09:51:57,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.83GB
2025-10-26 09:52:05,055 INFO __main__: Batch 50/520 | loss=1.245314 elapsed=615.6s
2025-10-26 09:52:05,057 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:52:05,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 09:52:05,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 09:52:05,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 09:52:06,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 09:52:06,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 09:52:06,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 09:52:06,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 09:52:07,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 09:52:07,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 09:52:07,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 09:52:07,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 09:52:07,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 09:52:09,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.82GB Delta_CPU=-0.01GB
2025-10-26 09:52:09,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.82GB
2025-10-26 09:52:16,865 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:52:17,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 09:52:17,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 09:52:17,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 09:52:17,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 09:52:18,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 09:52:18,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 09:52:18,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 09:52:18,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 09:52:19,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 09:52:19,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 09:52:19,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 09:52:19,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 09:52:21,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.81GB Delta_CPU=-0.01GB
2025-10-26 09:52:21,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.81GB
2025-10-26 09:52:28,745 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:52:28,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.57GB
2025-10-26 09:52:29,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.57GB
2025-10-26 09:52:29,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 09:52:29,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.57GB
2025-10-26 09:52:29,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 09:52:30,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 09:52:30,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.57GB
2025-10-26 09:52:30,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.57GB
2025-10-26 09:52:30,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 09:52:31,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 09:52:31,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 09:52:31,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.57GB
2025-10-26 09:52:33,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.57GB Delta_CPU=+0.00GB
2025-10-26 09:52:33,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.57GB
2025-10-26 09:52:40,730 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:52:40,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:52:41,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:52:41,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:52:41,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:52:41,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:52:42,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:52:42,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:52:42,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:52:42,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:52:43,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:52:43,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:52:43,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:52:45,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.79GB
2025-10-26 09:52:45,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 09:52:52,775 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:52:52,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 09:52:53,312 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 09:52:53,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:52:53,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 09:52:53,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:52:54,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:52:54,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 09:52:54,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 09:52:55,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:52:55,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:52:55,473 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:52:55,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 09:52:57,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.66GB Delta_CPU=+0.41GB
2025-10-26 09:52:57,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.66GB
2025-10-26 09:53:04,891 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:53:05,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.66GB
2025-10-26 09:53:05,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.66GB
2025-10-26 09:53:05,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 09:53:05,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.66GB
2025-10-26 09:53:06,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 09:53:06,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 09:53:06,734 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.66GB
2025-10-26 09:53:06,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.66GB
2025-10-26 09:53:07,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 09:53:07,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 09:53:07,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 09:53:07,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.66GB
2025-10-26 09:53:09,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.42GB Delta_CPU=+0.76GB
2025-10-26 09:53:09,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.42GB
2025-10-26 09:53:17,115 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:53:17,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.63GB
2025-10-26 09:53:17,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.63GB
2025-10-26 09:53:17,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 09:53:18,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.63GB
2025-10-26 09:53:18,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 09:53:18,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 09:53:18,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.63GB
2025-10-26 09:53:19,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.63GB
2025-10-26 09:53:19,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 09:53:19,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 09:53:19,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 09:53:19,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.63GB
2025-10-26 09:53:21,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.44GB Delta_CPU=+0.82GB
2025-10-26 09:53:21,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.44GB
2025-10-26 09:53:28,970 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:53:29,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.64GB
2025-10-26 09:53:29,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.64GB
2025-10-26 09:53:29,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 09:53:29,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.64GB
2025-10-26 09:53:30,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 09:53:30,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 09:53:30,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.64GB
2025-10-26 09:53:31,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.64GB
2025-10-26 09:53:31,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 09:53:31,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 09:53:31,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 09:53:31,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.64GB
2025-10-26 09:53:33,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.60GB Delta_CPU=-0.05GB
2025-10-26 09:53:33,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.60GB
2025-10-26 09:53:40,994 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:53:41,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.50GB
2025-10-26 09:53:41,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.50GB
2025-10-26 09:53:41,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 09:53:41,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.50GB
2025-10-26 09:53:42,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 09:53:42,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 09:53:42,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.50GB
2025-10-26 09:53:43,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.50GB
2025-10-26 09:53:43,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 09:53:43,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 09:53:43,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 09:53:43,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.50GB
2025-10-26 09:53:45,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.48GB Delta_CPU=-0.02GB
2025-10-26 09:53:45,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.48GB
2025-10-26 09:53:52,926 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:53:53,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.38GB
2025-10-26 09:53:53,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.38GB
2025-10-26 09:53:53,654 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:53:53,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.38GB
2025-10-26 09:53:54,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:53:54,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:53:54,734 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.38GB
2025-10-26 09:53:54,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.38GB
2025-10-26 09:53:55,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:53:55,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:53:55,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:53:55,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.38GB
2025-10-26 09:53:57,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.17GB Delta_CPU=+0.80GB
2025-10-26 09:53:57,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.17GB
2025-10-26 09:54:04,991 INFO __main__: Batch 60/520 | loss=1.065513 elapsed=735.5s
2025-10-26 09:54:04,995 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:54:05,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.38GB
2025-10-26 09:54:05,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.38GB
2025-10-26 09:54:05,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:54:05,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.38GB
2025-10-26 09:54:06,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:54:06,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:54:06,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.38GB
2025-10-26 09:54:07,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.38GB
2025-10-26 09:54:07,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:54:07,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:54:07,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:54:07,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.38GB
2025-10-26 09:54:09,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.17GB Delta_CPU=+0.79GB
2025-10-26 09:54:09,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.17GB
2025-10-26 09:54:17,224 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:54:17,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.37GB
2025-10-26 09:54:17,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.37GB
2025-10-26 09:54:17,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 09:54:18,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.37GB
2025-10-26 09:54:18,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 09:54:18,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 09:54:19,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.37GB
2025-10-26 09:54:19,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.37GB
2025-10-26 09:54:19,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 09:54:19,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 09:54:19,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 09:54:19,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.37GB
2025-10-26 09:54:21,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.36GB Delta_CPU=-0.01GB
2025-10-26 09:54:21,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.36GB
2025-10-26 09:54:29,465 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:54:29,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.36GB
2025-10-26 09:54:30,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.36GB
2025-10-26 09:54:30,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:54:30,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.36GB
2025-10-26 09:54:30,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:54:31,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:54:31,287 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.36GB
2025-10-26 09:54:31,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.36GB
2025-10-26 09:54:31,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:54:31,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:54:32,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:54:32,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.36GB
2025-10-26 09:54:33,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.36GB Delta_CPU=-0.01GB
2025-10-26 09:54:34,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.36GB
2025-10-26 09:54:41,552 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:54:41,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 09:54:42,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 09:54:42,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:54:42,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 09:54:42,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:54:43,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 09:54:43,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 09:54:43,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 09:54:43,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:54:44,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:54:44,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 09:54:44,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 09:54:45,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=-0.00GB
2025-10-26 09:54:46,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 09:54:53,848 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:54:54,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.45GB
2025-10-26 09:54:54,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.45GB
2025-10-26 09:54:54,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:54:54,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.45GB
2025-10-26 09:54:55,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:54:55,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:54:55,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.45GB
2025-10-26 09:54:55,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.45GB
2025-10-26 09:54:56,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:54:56,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:54:56,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:54:56,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.45GB
2025-10-26 09:54:58,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=+0.86GB
2025-10-26 09:54:58,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 09:55:05,791 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:55:05,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.51GB
2025-10-26 09:55:06,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.51GB
2025-10-26 09:55:06,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:55:06,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.51GB
2025-10-26 09:55:06,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:55:07,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 09:55:07,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.51GB
2025-10-26 09:55:07,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.51GB
2025-10-26 09:55:08,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:55:08,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:55:08,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 09:55:08,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.51GB
2025-10-26 09:55:10,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.50GB Delta_CPU=-0.01GB
2025-10-26 09:55:10,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.50GB
2025-10-26 09:55:18,001 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:55:18,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.50GB
2025-10-26 09:55:18,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.50GB
2025-10-26 09:55:18,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:55:18,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.50GB
2025-10-26 09:55:19,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:55:19,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 09:55:19,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.50GB
2025-10-26 09:55:20,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.50GB
2025-10-26 09:55:20,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:55:20,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:55:20,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 09:55:20,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.50GB
2025-10-26 09:55:22,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=-0.03GB
2025-10-26 09:55:22,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 09:55:30,215 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:55:30,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 09:55:30,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 09:55:30,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:55:31,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 09:55:31,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:55:31,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:55:32,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 09:55:32,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 09:55:32,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:55:32,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:55:32,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:55:32,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 09:55:34,734 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.48GB Delta_CPU=+0.01GB
2025-10-26 09:55:34,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.48GB
2025-10-26 09:55:42,622 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:55:42,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 09:55:43,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 09:55:43,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 09:55:43,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 09:55:43,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 09:55:44,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 09:55:44,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 09:55:44,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 09:55:44,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 09:55:45,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 09:55:45,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 09:55:45,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 09:55:46,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=-0.01GB
2025-10-26 09:55:47,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 09:55:54,649 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:55:54,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 09:55:55,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 09:55:55,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:55:55,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 09:55:55,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:55:56,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 09:55:56,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 09:55:56,734 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 09:55:56,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:55:57,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:55:57,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 09:55:57,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 09:55:59,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.79GB
2025-10-26 09:55:59,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 09:56:06,825 INFO __main__: Batch 70/520 | loss=1.694058 elapsed=857.3s
2025-10-26 09:56:06,828 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:56:07,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 09:56:07,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 09:56:07,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:56:07,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 09:56:08,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:56:08,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 09:56:08,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 09:56:08,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 09:56:09,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:56:09,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:56:09,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 09:56:09,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 09:56:11,264 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.22GB Delta_CPU=+0.76GB
2025-10-26 09:56:11,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.22GB
2025-10-26 09:56:18,954 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:56:19,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.42GB
2025-10-26 09:56:19,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.42GB
2025-10-26 09:56:19,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.42GB
2025-10-26 09:56:19,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.42GB
2025-10-26 09:56:20,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.42GB
2025-10-26 09:56:20,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.42GB
2025-10-26 09:56:20,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.42GB
2025-10-26 09:56:20,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.42GB
2025-10-26 09:56:21,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.42GB
2025-10-26 09:56:21,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.42GB
2025-10-26 09:56:21,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.42GB
2025-10-26 09:56:21,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.42GB
2025-10-26 09:56:23,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.45GB Delta_CPU=+0.02GB
2025-10-26 09:56:23,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.45GB
2025-10-26 09:56:30,754 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:56:30,957 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.45GB
2025-10-26 09:56:31,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.45GB
2025-10-26 09:56:31,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:56:31,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.45GB
2025-10-26 09:56:31,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:56:32,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.45GB
2025-10-26 09:56:32,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.45GB
2025-10-26 09:56:32,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.45GB
2025-10-26 09:56:33,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:56:33,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:56:33,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.45GB
2025-10-26 09:56:33,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.45GB
2025-10-26 09:56:35,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.21GB Delta_CPU=+0.76GB
2025-10-26 09:56:35,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.21GB
2025-10-26 09:56:42,798 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:56:43,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 09:56:43,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 09:56:43,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:43,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 09:56:43,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:44,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:44,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 09:56:44,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 09:56:45,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:45,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:45,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:45,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 09:56:47,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.41GB Delta_CPU=-0.01GB
2025-10-26 09:56:47,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.41GB
2025-10-26 09:56:54,851 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:56:55,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 09:56:55,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 09:56:55,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:55,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 09:56:56,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:56,497 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 09:56:56,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 09:56:56,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 09:56:57,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:57,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:57,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 09:56:57,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 09:56:59,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.40GB Delta_CPU=-0.00GB
2025-10-26 09:56:59,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.40GB
2025-10-26 09:57:06,846 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:57:07,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.40GB
2025-10-26 09:57:07,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.40GB
2025-10-26 09:57:07,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.40GB
2025-10-26 09:57:07,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.40GB
2025-10-26 09:57:08,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.40GB
2025-10-26 09:57:08,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.40GB
2025-10-26 09:57:08,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.40GB
2025-10-26 09:57:08,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.40GB
2025-10-26 09:57:09,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.40GB
2025-10-26 09:57:09,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.40GB
2025-10-26 09:57:09,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.40GB
2025-10-26 09:57:09,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.40GB
2025-10-26 09:57:11,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=+0.69GB
2025-10-26 09:57:11,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 09:57:19,124 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:57:19,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.89GB
2025-10-26 09:57:19,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.89GB
2025-10-26 09:57:19,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 09:57:20,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.89GB
2025-10-26 09:57:20,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 09:57:20,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 09:57:20,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.89GB
2025-10-26 09:57:21,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.89GB
2025-10-26 09:57:21,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 09:57:21,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 09:57:21,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 09:57:21,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.89GB
2025-10-26 09:57:23,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.80GB
2025-10-26 09:57:23,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 09:57:31,155 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:57:31,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 09:57:31,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 09:57:31,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:57:32,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 09:57:32,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:57:32,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 09:57:33,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 09:57:33,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 09:57:33,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:57:33,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:57:33,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 09:57:33,847 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 09:57:35,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.29GB Delta_CPU=+0.80GB
2025-10-26 09:57:35,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.29GB
2025-10-26 09:57:43,332 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:57:43,539 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.29GB
2025-10-26 09:57:43,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.29GB
2025-10-26 09:57:44,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.29GB
2025-10-26 09:57:44,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.29GB
2025-10-26 09:57:44,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.29GB
2025-10-26 09:57:44,981 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.29GB
2025-10-26 09:57:45,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.29GB
2025-10-26 09:57:45,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.29GB
2025-10-26 09:57:45,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.29GB
2025-10-26 09:57:45,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.29GB
2025-10-26 09:57:46,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.29GB
2025-10-26 09:57:46,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.29GB
2025-10-26 09:57:47,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.32GB Delta_CPU=+0.03GB
2025-10-26 09:57:48,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.32GB
2025-10-26 09:57:55,515 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:57:55,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.32GB
2025-10-26 09:57:56,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.32GB
2025-10-26 09:57:56,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.32GB
2025-10-26 09:57:56,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.32GB
2025-10-26 09:57:56,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.32GB
2025-10-26 09:57:57,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.32GB
2025-10-26 09:57:57,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.32GB
2025-10-26 09:57:57,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.32GB
2025-10-26 09:57:57,777 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.32GB
2025-10-26 09:57:57,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.32GB
2025-10-26 09:57:58,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.32GB
2025-10-26 09:57:58,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.32GB
2025-10-26 09:57:59,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=+0.48GB
2025-10-26 09:58:00,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 09:58:07,426 INFO __main__: Batch 80/520 | loss=0.715936 elapsed=977.9s
2025-10-26 09:58:07,428 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:58:07,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.58GB
2025-10-26 09:58:07,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.58GB
2025-10-26 09:58:08,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 09:58:08,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.58GB
2025-10-26 09:58:08,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 09:58:09,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 09:58:09,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.58GB
2025-10-26 09:58:09,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.58GB
2025-10-26 09:58:09,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 09:58:09,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 09:58:10,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 09:58:10,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.58GB
2025-10-26 09:58:11,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.39GB Delta_CPU=+0.82GB
2025-10-26 09:58:12,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.39GB
2025-10-26 09:58:19,163 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:58:19,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 09:58:19,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 09:58:19,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 09:58:20,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 09:58:20,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 09:58:20,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 09:58:20,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 09:58:21,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 09:58:21,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 09:58:21,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 09:58:21,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 09:58:21,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 09:58:23,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+0.33GB
2025-10-26 09:58:23,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 09:58:31,112 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:58:31,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.36GB
2025-10-26 09:58:31,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.36GB
2025-10-26 09:58:31,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:32,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.36GB
2025-10-26 09:58:32,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:32,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:32,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.36GB
2025-10-26 09:58:33,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.36GB
2025-10-26 09:58:33,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:33,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:33,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:33,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.36GB
2025-10-26 09:58:35,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.36GB Delta_CPU=+0.00GB
2025-10-26 09:58:35,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.36GB
2025-10-26 09:58:43,147 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:58:43,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.27GB
2025-10-26 09:58:43,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.27GB
2025-10-26 09:58:43,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 09:58:44,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.27GB
2025-10-26 09:58:44,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 09:58:44,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 09:58:44,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.27GB
2025-10-26 09:58:45,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.27GB
2025-10-26 09:58:45,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 09:58:45,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 09:58:45,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 09:58:45,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.27GB
2025-10-26 09:58:47,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.66GB Delta_CPU=+0.39GB
2025-10-26 09:58:47,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.66GB
2025-10-26 09:58:54,979 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:58:55,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.36GB
2025-10-26 09:58:55,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.36GB
2025-10-26 09:58:55,735 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:55,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.36GB
2025-10-26 09:58:56,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:56,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 09:58:56,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.36GB
2025-10-26 09:58:57,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.36GB
2025-10-26 09:58:57,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:57,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:57,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 09:58:57,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.36GB
2025-10-26 09:58:59,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=+0.06GB
2025-10-26 09:58:59,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 09:59:07,087 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:59:07,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.42GB
2025-10-26 09:59:07,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.42GB
2025-10-26 09:59:07,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:59:08,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.42GB
2025-10-26 09:59:08,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:59:08,740 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 09:59:08,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.42GB
2025-10-26 09:59:09,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.42GB
2025-10-26 09:59:09,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:59:09,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:59:09,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 09:59:09,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.42GB
2025-10-26 09:59:11,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.60GB Delta_CPU=+0.17GB
2025-10-26 09:59:11,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.60GB
2025-10-26 09:59:19,026 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:59:19,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.38GB
2025-10-26 09:59:19,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.38GB
2025-10-26 09:59:19,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:59:20,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.38GB
2025-10-26 09:59:20,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:59:20,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 09:59:20,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.38GB
2025-10-26 09:59:21,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.38GB
2025-10-26 09:59:21,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:59:21,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:59:21,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 09:59:21,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.38GB
2025-10-26 09:59:23,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.41GB Delta_CPU=+0.03GB
2025-10-26 09:59:23,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.41GB
2025-10-26 09:59:31,219 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:59:31,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.31GB
2025-10-26 09:59:31,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.31GB
2025-10-26 09:59:31,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:59:32,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.31GB
2025-10-26 09:59:32,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:59:32,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 09:59:33,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.31GB
2025-10-26 09:59:33,264 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.31GB
2025-10-26 09:59:33,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:59:33,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:59:33,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 09:59:33,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.31GB
2025-10-26 09:59:35,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=+0.03GB
2025-10-26 09:59:35,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 09:59:43,240 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:59:43,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 09:59:43,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 09:59:43,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 09:59:44,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 09:59:44,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 09:59:44,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 09:59:45,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 09:59:45,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 09:59:45,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 09:59:45,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 09:59:45,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 09:59:45,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 09:59:47,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=+0.02GB
2025-10-26 09:59:47,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 09:59:55,235 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 09:59:55,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 09:59:55,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 09:59:56,000 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:59:56,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 09:59:56,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:59:56,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 09:59:57,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 09:59:57,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 09:59:57,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:59:57,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:59:57,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 09:59:57,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 09:59:59,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.90GB Delta_CPU=+0.79GB
2025-10-26 09:59:59,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.90GB
2025-10-26 10:00:07,352 INFO __main__: Batch 90/520 | loss=1.463024 elapsed=1097.9s
2025-10-26 10:00:07,355 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:00:07,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.10GB
2025-10-26 10:00:07,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.10GB
2025-10-26 10:00:08,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 10:00:08,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.10GB
2025-10-26 10:00:08,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 10:00:09,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 10:00:09,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.10GB
2025-10-26 10:00:09,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.10GB
2025-10-26 10:00:09,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 10:00:09,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 10:00:10,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 10:00:10,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.10GB
2025-10-26 10:00:11,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=+0.03GB
2025-10-26 10:00:11,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 10:00:19,344 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:00:19,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.13GB
2025-10-26 10:00:19,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.13GB
2025-10-26 10:00:20,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 10:00:20,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.13GB
2025-10-26 10:00:20,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 10:00:20,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 10:00:21,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.13GB
2025-10-26 10:00:21,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.13GB
2025-10-26 10:00:21,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 10:00:21,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 10:00:22,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 10:00:22,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.13GB
2025-10-26 10:00:23,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=-0.05GB
2025-10-26 10:00:23,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 10:00:31,429 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:00:31,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 10:00:31,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 10:00:32,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:00:32,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 10:00:32,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:00:33,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:00:33,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 10:00:33,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 10:00:33,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:00:33,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:00:34,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:00:34,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 10:00:35,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=+0.24GB
2025-10-26 10:00:36,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 10:00:43,286 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:00:43,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.33GB
2025-10-26 10:00:43,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.33GB
2025-10-26 10:00:44,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:00:44,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.33GB
2025-10-26 10:00:44,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:00:44,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:00:45,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.33GB
2025-10-26 10:00:45,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.33GB
2025-10-26 10:00:45,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:00:45,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:00:45,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:00:46,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.33GB
2025-10-26 10:00:47,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.36GB
2025-10-26 10:00:47,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 10:00:55,308 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:00:55,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:00:55,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:00:56,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:00:56,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:00:56,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:00:56,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:00:57,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:00:57,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:00:57,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:00:57,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:00:57,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:00:57,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:00:59,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.64GB Delta_CPU=-0.04GB
2025-10-26 10:00:59,923 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.64GB
2025-10-26 10:01:07,213 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:01:07,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.64GB
2025-10-26 10:01:07,755 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.64GB
2025-10-26 10:01:07,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 10:01:08,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.64GB
2025-10-26 10:01:08,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 10:01:08,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 10:01:09,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.64GB
2025-10-26 10:01:09,254 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.64GB
2025-10-26 10:01:09,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 10:01:09,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 10:01:09,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 10:01:09,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.64GB
2025-10-26 10:01:11,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.47GB Delta_CPU=+0.83GB
2025-10-26 10:01:11,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.47GB
2025-10-26 10:01:18,983 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:01:19,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:01:19,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:01:19,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:01:19,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:01:20,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:01:20,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:01:20,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:01:21,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:01:21,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:01:21,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:01:21,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:01:21,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:01:23,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.43GB Delta_CPU=+0.75GB
2025-10-26 10:01:23,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.43GB
2025-10-26 10:01:31,024 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:01:31,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.63GB
2025-10-26 10:01:31,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.63GB
2025-10-26 10:01:31,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 10:01:31,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.63GB
2025-10-26 10:01:32,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 10:01:32,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 10:01:32,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.63GB
2025-10-26 10:01:33,062 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.63GB
2025-10-26 10:01:33,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 10:01:33,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 10:01:33,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 10:01:33,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.63GB
2025-10-26 10:01:35,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.61GB Delta_CPU=-0.01GB
2025-10-26 10:01:35,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.61GB
2025-10-26 10:01:42,905 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:01:43,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.61GB
2025-10-26 10:01:43,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.61GB
2025-10-26 10:01:43,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 10:01:43,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.61GB
2025-10-26 10:01:44,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 10:01:44,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 10:01:44,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.61GB
2025-10-26 10:01:44,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.61GB
2025-10-26 10:01:45,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 10:01:45,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 10:01:45,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 10:01:45,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.61GB
2025-10-26 10:01:47,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.60GB Delta_CPU=-0.02GB
2025-10-26 10:01:47,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.60GB
2025-10-26 10:01:54,795 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:01:54,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.60GB
2025-10-26 10:01:55,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.60GB
2025-10-26 10:01:55,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 10:01:55,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.60GB
2025-10-26 10:01:55,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 10:01:56,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 10:01:56,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.60GB
2025-10-26 10:01:56,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.60GB
2025-10-26 10:01:57,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 10:01:57,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 10:01:57,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 10:01:57,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.60GB
2025-10-26 10:01:59,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.39GB Delta_CPU=+0.79GB
2025-10-26 10:01:59,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.39GB
2025-10-26 10:02:06,647 INFO __main__: Batch 100/520 | loss=2.086077 elapsed=1217.2s
2025-10-26 10:02:06,651 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:02:06,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 10:02:07,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 10:02:07,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:07,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 10:02:07,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:08,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:08,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 10:02:08,710 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 10:02:08,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:09,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:09,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:09,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 10:02:11,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.09GB Delta_CPU=+0.80GB
2025-10-26 10:02:11,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.09GB
2025-10-26 10:02:18,723 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:02:18,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 10:02:19,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 10:02:19,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:19,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 10:02:19,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:20,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:02:20,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 10:02:20,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 10:02:20,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:21,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:21,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:02:21,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 10:02:23,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=-0.02GB
2025-10-26 10:02:23,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:02:31,339 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:02:31,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.28GB
2025-10-26 10:02:31,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.28GB
2025-10-26 10:02:32,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 10:02:32,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.28GB
2025-10-26 10:02:32,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 10:02:33,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 10:02:33,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.28GB
2025-10-26 10:02:33,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.28GB
2025-10-26 10:02:33,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 10:02:33,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 10:02:34,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 10:02:34,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.28GB
2025-10-26 10:02:35,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=+0.02GB
2025-10-26 10:02:36,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 10:02:43,446 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:02:43,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.30GB
2025-10-26 10:02:43,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.30GB
2025-10-26 10:02:44,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:02:44,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.30GB
2025-10-26 10:02:44,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:02:45,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:02:45,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.30GB
2025-10-26 10:02:45,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.30GB
2025-10-26 10:02:45,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:02:45,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:02:46,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:02:46,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.30GB
2025-10-26 10:02:47,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.06GB Delta_CPU=+0.76GB
2025-10-26 10:02:48,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.06GB
2025-10-26 10:02:55,419 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:02:55,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 10:02:55,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 10:02:56,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:02:56,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 10:02:56,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:02:57,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:02:57,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 10:02:57,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 10:02:57,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:02:57,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:02:58,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:02:58,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 10:02:59,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.04GB Delta_CPU=+0.78GB
2025-10-26 10:03:00,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.04GB
2025-10-26 10:03:07,555 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:03:07,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 10:03:08,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 10:03:08,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:03:08,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 10:03:08,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:03:09,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:03:09,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 10:03:09,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 10:03:09,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:03:10,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:03:10,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:03:10,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 10:03:11,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.01GB Delta_CPU=+0.76GB
2025-10-26 10:03:12,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.01GB
2025-10-26 10:03:19,605 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:03:19,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.21GB
2025-10-26 10:03:20,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.21GB
2025-10-26 10:03:20,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:20,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.21GB
2025-10-26 10:03:20,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:21,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:21,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.21GB
2025-10-26 10:03:21,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.21GB
2025-10-26 10:03:21,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:22,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:22,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:22,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.21GB
2025-10-26 10:03:24,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.00GB Delta_CPU=+0.80GB
2025-10-26 10:03:24,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.00GB
2025-10-26 10:03:31,814 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:03:32,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.21GB
2025-10-26 10:03:32,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.21GB
2025-10-26 10:03:32,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:32,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.21GB
2025-10-26 10:03:32,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:33,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:03:33,642 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.21GB
2025-10-26 10:03:33,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.21GB
2025-10-26 10:03:34,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:34,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:34,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:03:34,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.21GB
2025-10-26 10:03:36,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.84GB
2025-10-26 10:03:36,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 10:03:43,900 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:03:44,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 10:03:44,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 10:03:44,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:03:44,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 10:03:45,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:03:45,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:03:45,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 10:03:45,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 10:03:46,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:03:46,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:03:46,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:03:46,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 10:03:48,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.99GB Delta_CPU=+0.74GB
2025-10-26 10:03:48,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.99GB
2025-10-26 10:03:56,095 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:03:56,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 10:03:56,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 10:03:56,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:03:57,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 10:03:57,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:03:57,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:03:57,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 10:03:58,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 10:03:58,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:03:58,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:03:58,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:03:58,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 10:04:00,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.02GB Delta_CPU=+0.82GB
2025-10-26 10:04:00,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.02GB
2025-10-26 10:04:08,180 INFO __main__: Batch 110/520 | loss=0.670433 elapsed=1338.7s
2025-10-26 10:04:08,182 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:04:08,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 10:04:08,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 10:04:08,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 10:04:09,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 10:04:09,350 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 10:04:09,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 10:04:10,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 10:04:10,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 10:04:10,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 10:04:10,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 10:04:10,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 10:04:10,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 10:04:12,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.99GB Delta_CPU=+0.77GB
2025-10-26 10:04:12,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.99GB
2025-10-26 10:04:19,984 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:04:20,179 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.19GB
2025-10-26 10:04:20,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.19GB
2025-10-26 10:04:20,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 10:04:20,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.19GB
2025-10-26 10:04:21,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 10:04:21,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 10:04:21,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.19GB
2025-10-26 10:04:22,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.19GB
2025-10-26 10:04:22,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 10:04:22,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 10:04:22,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 10:04:22,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.19GB
2025-10-26 10:04:24,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.98GB Delta_CPU=+0.79GB
2025-10-26 10:04:24,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.98GB
2025-10-26 10:04:31,947 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:04:32,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.18GB
2025-10-26 10:04:32,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.18GB
2025-10-26 10:04:32,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:32,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.18GB
2025-10-26 10:04:33,132 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:33,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:33,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.18GB
2025-10-26 10:04:34,000 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.18GB
2025-10-26 10:04:34,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:34,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:34,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:34,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.18GB
2025-10-26 10:04:36,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.98GB Delta_CPU=+0.79GB
2025-10-26 10:04:36,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.98GB
2025-10-26 10:04:44,171 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:04:44,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.18GB
2025-10-26 10:04:44,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.18GB
2025-10-26 10:04:44,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:45,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.18GB
2025-10-26 10:04:45,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:45,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 10:04:46,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.18GB
2025-10-26 10:04:46,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.18GB
2025-10-26 10:04:46,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:46,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:46,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 10:04:46,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.18GB
2025-10-26 10:04:48,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.99GB Delta_CPU=+0.80GB
2025-10-26 10:04:48,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.99GB
2025-10-26 10:04:56,287 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:04:56,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.95GB
2025-10-26 10:04:56,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.95GB
2025-10-26 10:04:57,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:04:57,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.95GB
2025-10-26 10:04:57,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:04:57,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:04:58,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.95GB
2025-10-26 10:04:58,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.95GB
2025-10-26 10:04:58,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:04:58,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:04:59,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:04:59,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.95GB
2025-10-26 10:05:00,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.75GB Delta_CPU=+0.80GB
2025-10-26 10:05:00,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.75GB
2025-10-26 10:05:08,553 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:05:08,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.95GB
2025-10-26 10:05:09,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.95GB
2025-10-26 10:05:09,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:05:09,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.95GB
2025-10-26 10:05:09,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:05:10,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:05:10,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.95GB
2025-10-26 10:05:10,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.95GB
2025-10-26 10:05:10,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:05:10,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:05:11,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:05:11,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.95GB
2025-10-26 10:05:12,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.74GB Delta_CPU=+0.79GB
2025-10-26 10:05:13,133 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.74GB
2025-10-26 10:05:20,712 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:05:20,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 10:05:21,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 10:05:21,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:05:21,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 10:05:21,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:05:22,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:05:22,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 10:05:22,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 10:05:22,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:05:23,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:05:23,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:05:23,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 10:05:25,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.48GB Delta_CPU=+0.82GB
2025-10-26 10:05:25,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.48GB
2025-10-26 10:05:32,561 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:05:32,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.68GB
2025-10-26 10:05:33,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.68GB
2025-10-26 10:05:33,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 10:05:33,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.68GB
2025-10-26 10:05:33,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 10:05:34,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 10:05:34,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.68GB
2025-10-26 10:05:34,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.68GB
2025-10-26 10:05:34,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 10:05:35,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 10:05:35,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 10:05:35,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.68GB
2025-10-26 10:05:36,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.76GB
2025-10-26 10:05:37,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 10:05:44,497 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:05:44,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.55GB
2025-10-26 10:05:45,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.55GB
2025-10-26 10:05:45,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:05:45,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.55GB
2025-10-26 10:05:45,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:05:46,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:05:46,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.55GB
2025-10-26 10:05:46,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.55GB
2025-10-26 10:05:46,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:05:46,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:05:47,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:05:47,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.55GB
2025-10-26 10:05:48,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.32GB Delta_CPU=+0.77GB
2025-10-26 10:05:49,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.32GB
2025-10-26 10:05:56,654 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:05:56,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.43GB
2025-10-26 10:05:57,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.43GB
2025-10-26 10:05:57,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.43GB
2025-10-26 10:05:57,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.43GB
2025-10-26 10:05:57,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.43GB
2025-10-26 10:05:58,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.43GB
2025-10-26 10:05:58,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.43GB
2025-10-26 10:05:58,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.43GB
2025-10-26 10:05:58,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.43GB
2025-10-26 10:05:59,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.43GB
2025-10-26 10:05:59,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.43GB
2025-10-26 10:05:59,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.43GB
2025-10-26 10:06:01,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.22GB Delta_CPU=+0.79GB
2025-10-26 10:06:01,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.22GB
2025-10-26 10:06:08,628 INFO __main__: Batch 120/520 | loss=0.963675 elapsed=1459.1s
2025-10-26 10:06:08,633 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:06:08,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.22GB
2025-10-26 10:06:09,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.22GB
2025-10-26 10:06:09,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:09,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.22GB
2025-10-26 10:06:09,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:10,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:10,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.22GB
2025-10-26 10:06:10,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.22GB
2025-10-26 10:06:10,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:11,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:11,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:11,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.22GB
2025-10-26 10:06:13,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.02GB Delta_CPU=+0.79GB
2025-10-26 10:06:13,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.02GB
2025-10-26 10:06:20,678 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:06:20,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.22GB
2025-10-26 10:06:21,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.22GB
2025-10-26 10:06:21,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:21,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.22GB
2025-10-26 10:06:21,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:22,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.22GB
2025-10-26 10:06:22,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.22GB
2025-10-26 10:06:22,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.22GB
2025-10-26 10:06:22,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:23,163 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:23,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.22GB
2025-10-26 10:06:23,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.22GB
2025-10-26 10:06:25,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.05GB Delta_CPU=+0.83GB
2025-10-26 10:06:25,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.05GB
2025-10-26 10:06:32,849 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:06:33,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.25GB
2025-10-26 10:06:33,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.25GB
2025-10-26 10:06:33,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:06:33,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.25GB
2025-10-26 10:06:34,030 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:06:34,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:06:34,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.25GB
2025-10-26 10:06:34,903 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.25GB
2025-10-26 10:06:35,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:06:35,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:06:35,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:06:35,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.25GB
2025-10-26 10:06:37,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.03GB Delta_CPU=+0.78GB
2025-10-26 10:06:37,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.03GB
2025-10-26 10:06:44,789 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:06:44,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.24GB
2025-10-26 10:06:45,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.24GB
2025-10-26 10:06:45,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.24GB
2025-10-26 10:06:45,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.24GB
2025-10-26 10:06:45,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.24GB
2025-10-26 10:06:46,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.24GB
2025-10-26 10:06:46,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.24GB
2025-10-26 10:06:46,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.24GB
2025-10-26 10:06:47,030 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.24GB
2025-10-26 10:06:47,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.24GB
2025-10-26 10:06:47,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.24GB
2025-10-26 10:06:47,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.24GB
2025-10-26 10:06:49,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=+1.21GB
2025-10-26 10:06:49,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 10:06:56,808 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:06:57,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 10:06:57,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 10:06:57,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:06:57,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 10:06:57,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:06:58,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:06:58,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 10:06:58,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 10:06:59,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:06:59,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:06:59,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:06:59,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 10:07:01,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.79GB
2025-10-26 10:07:01,431 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 10:07:08,830 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:07:09,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 10:07:09,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 10:07:09,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 10:07:09,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 10:07:10,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 10:07:10,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 10:07:10,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 10:07:10,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 10:07:11,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 10:07:11,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 10:07:11,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 10:07:11,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 10:07:13,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.40GB Delta_CPU=+0.76GB
2025-10-26 10:07:13,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.40GB
2025-10-26 10:07:20,845 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:07:21,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.60GB
2025-10-26 10:07:21,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.60GB
2025-10-26 10:07:21,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:07:21,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.60GB
2025-10-26 10:07:22,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:07:22,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:07:22,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.60GB
2025-10-26 10:07:22,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.60GB
2025-10-26 10:07:23,030 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:07:23,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:07:23,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:07:23,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.60GB
2025-10-26 10:07:25,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=+0.82GB
2025-10-26 10:07:25,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 10:07:32,826 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:07:33,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 10:07:33,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 10:07:33,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 10:07:33,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 10:07:34,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 10:07:34,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 10:07:34,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 10:07:34,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 10:07:35,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 10:07:35,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 10:07:35,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 10:07:35,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 10:07:37,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.66GB Delta_CPU=+1.03GB
2025-10-26 10:07:37,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.66GB
2025-10-26 10:07:44,890 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:07:45,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 10:07:45,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 10:07:45,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:07:45,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 10:07:46,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:07:46,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:07:46,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 10:07:46,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 10:07:47,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:07:47,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:07:47,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:07:47,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 10:07:49,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.76GB
2025-10-26 10:07:49,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 10:07:56,881 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:07:57,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 10:07:57,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 10:07:57,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:07:57,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 10:07:58,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:07:58,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:07:58,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 10:07:58,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 10:07:59,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:07:59,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:07:59,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:07:59,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 10:08:01,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.61GB Delta_CPU=+0.78GB
2025-10-26 10:08:01,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.61GB
2025-10-26 10:08:09,143 INFO __main__: Batch 130/520 | loss=1.255628 elapsed=1579.6s
2025-10-26 10:08:09,146 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:08:09,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.81GB
2025-10-26 10:08:09,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.81GB
2025-10-26 10:08:09,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 10:08:10,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.81GB
2025-10-26 10:08:10,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 10:08:10,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 10:08:11,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.81GB
2025-10-26 10:08:11,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.81GB
2025-10-26 10:08:11,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 10:08:11,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 10:08:11,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 10:08:11,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.81GB
2025-10-26 10:08:13,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.62GB Delta_CPU=+0.80GB
2025-10-26 10:08:13,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.62GB
2025-10-26 10:08:21,195 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:08:21,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 10:08:21,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 10:08:21,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:22,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 10:08:22,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:22,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:23,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 10:08:23,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 10:08:23,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:23,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:23,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:23,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 10:08:25,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.82GB Delta_CPU=-0.00GB
2025-10-26 10:08:25,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.82GB
2025-10-26 10:08:33,345 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:08:33,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 10:08:33,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 10:08:34,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:34,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 10:08:34,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:35,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:08:35,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 10:08:35,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 10:08:35,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:35,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:36,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:08:36,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 10:08:37,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.75GB
2025-10-26 10:08:38,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 10:08:45,493 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:08:45,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.58GB
2025-10-26 10:08:46,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.58GB
2025-10-26 10:08:46,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:46,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.58GB
2025-10-26 10:08:46,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:47,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:47,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.58GB
2025-10-26 10:08:47,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.58GB
2025-10-26 10:08:47,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:08:48,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:08:48,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:08:48,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.58GB
2025-10-26 10:08:49,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.38GB Delta_CPU=+0.80GB
2025-10-26 10:08:50,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.38GB
2025-10-26 10:08:57,530 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:08:57,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.58GB
2025-10-26 10:08:58,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.58GB
2025-10-26 10:08:58,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:58,497 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.58GB
2025-10-26 10:08:58,710 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:59,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.58GB
2025-10-26 10:08:59,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.58GB
2025-10-26 10:08:59,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.58GB
2025-10-26 10:08:59,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:09:00,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:09:00,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.58GB
2025-10-26 10:09:00,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.58GB
2025-10-26 10:09:02,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.61GB Delta_CPU=+0.03GB
2025-10-26 10:09:02,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.61GB
2025-10-26 10:09:09,753 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:09:09,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.61GB
2025-10-26 10:09:10,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.61GB
2025-10-26 10:09:10,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 10:09:10,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.61GB
2025-10-26 10:09:10,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 10:09:11,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 10:09:11,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.61GB
2025-10-26 10:09:11,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.61GB
2025-10-26 10:09:12,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 10:09:12,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 10:09:12,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 10:09:12,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.61GB
2025-10-26 10:09:14,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.66GB Delta_CPU=+0.05GB
2025-10-26 10:09:14,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.66GB
2025-10-26 10:09:21,784 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:09:21,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 10:09:22,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 10:09:22,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:09:22,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 10:09:22,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:09:23,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:09:23,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 10:09:23,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 10:09:24,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:09:24,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:09:24,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:09:24,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 10:09:26,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=+0.79GB
2025-10-26 10:09:26,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 10:09:33,646 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:09:33,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 10:09:34,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 10:09:34,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:09:34,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 10:09:34,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:09:35,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:09:35,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 10:09:35,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 10:09:35,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:09:36,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:09:36,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:09:36,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 10:09:38,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.39GB Delta_CPU=+0.74GB
2025-10-26 10:09:38,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.39GB
2025-10-26 10:09:45,569 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:09:45,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.59GB
2025-10-26 10:09:46,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.59GB
2025-10-26 10:09:46,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 10:09:46,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.59GB
2025-10-26 10:09:46,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 10:09:47,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 10:09:47,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.59GB
2025-10-26 10:09:47,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.59GB
2025-10-26 10:09:47,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 10:09:48,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 10:09:48,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 10:09:48,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.59GB
2025-10-26 10:09:50,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.39GB Delta_CPU=+0.79GB
2025-10-26 10:09:50,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.39GB
2025-10-26 10:09:57,601 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:09:57,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 10:09:58,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 10:09:58,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:09:58,551 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 10:09:58,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:09:59,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:09:59,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 10:09:59,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 10:09:59,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:00,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:00,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:00,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 10:10:02,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.80GB
2025-10-26 10:10:02,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:10:09,643 INFO __main__: Batch 140/520 | loss=0.708000 elapsed=1700.2s
2025-10-26 10:10:09,645 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:10:09,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 10:10:10,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 10:10:10,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:10:10,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 10:10:10,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:10:11,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:10:11,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 10:10:11,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 10:10:11,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:12,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:12,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:10:12,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 10:10:14,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=+0.82GB
2025-10-26 10:10:14,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 10:10:21,599 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:10:21,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.51GB
2025-10-26 10:10:22,133 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.51GB
2025-10-26 10:10:22,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 10:10:22,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.51GB
2025-10-26 10:10:22,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 10:10:23,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 10:10:23,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.51GB
2025-10-26 10:10:23,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.51GB
2025-10-26 10:10:23,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 10:10:24,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 10:10:24,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 10:10:24,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.51GB
2025-10-26 10:10:26,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.29GB Delta_CPU=+0.78GB
2025-10-26 10:10:26,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.29GB
2025-10-26 10:10:33,759 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:10:33,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.50GB
2025-10-26 10:10:34,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.50GB
2025-10-26 10:10:34,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 10:10:34,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.50GB
2025-10-26 10:10:34,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 10:10:35,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.50GB
2025-10-26 10:10:35,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.50GB
2025-10-26 10:10:35,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.50GB
2025-10-26 10:10:36,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 10:10:36,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 10:10:36,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.50GB
2025-10-26 10:10:36,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.50GB
2025-10-26 10:10:38,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.76GB
2025-10-26 10:10:38,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 10:10:45,849 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:10:46,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:10:46,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:10:46,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:10:46,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:10:47,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:10:47,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:10:47,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:10:47,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:10:48,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:10:48,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:10:48,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:10:48,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:10:50,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.80GB
2025-10-26 10:10:50,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 10:10:58,160 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:10:58,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:10:58,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:10:58,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:10:59,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:10:59,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:10:59,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:00,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:11:00,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:11:00,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:00,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:00,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:00,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:11:02,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.80GB
2025-10-26 10:11:02,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 10:11:10,406 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:11:10,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:11:10,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:11:11,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:11,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:11:11,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:12,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:12,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:11:12,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:11:12,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:12,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:13,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:13,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:11:14,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.80GB
2025-10-26 10:11:15,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 10:11:22,490 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:11:22,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:11:23,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:11:23,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:23,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:11:23,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:24,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:24,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:11:24,551 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:11:24,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:24,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:25,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:25,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:11:26,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.82GB
2025-10-26 10:11:27,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:11:34,509 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:11:34,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:11:35,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:11:35,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:11:35,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:11:35,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:11:36,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:11:36,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:11:36,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:11:36,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:11:37,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:11:37,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:11:37,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:11:39,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.77GB
2025-10-26 10:11:39,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:11:46,880 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:11:47,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:11:47,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:11:47,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:47,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:11:48,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:48,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:11:48,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:11:48,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:11:49,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:49,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:49,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:11:49,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:11:51,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.83GB
2025-10-26 10:11:51,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:11:59,246 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:11:59,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:11:59,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:12:00,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:00,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:12:00,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:00,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:01,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:12:01,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:12:01,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:01,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:01,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:01,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:12:03,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.80GB
2025-10-26 10:12:03,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:12:11,377 INFO __main__: Batch 150/520 | loss=0.917410 elapsed=1821.9s
2025-10-26 10:12:11,380 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:12:11,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:12:11,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:12:12,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:12,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:12:12,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:12,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:13,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:12:13,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:12:13,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:13,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:14,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:14,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:12:15,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.77GB
2025-10-26 10:12:15,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:12:23,448 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:12:23,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:12:23,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:12:24,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:24,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:12:24,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:25,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:25,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:12:25,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:12:25,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:25,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:26,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:26,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:12:27,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:12:28,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:12:35,490 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:12:35,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:12:36,032 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:12:36,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:36,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:12:36,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:37,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:12:37,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:12:37,539 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:12:37,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:37,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:38,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:12:38,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:12:39,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.83GB
2025-10-26 10:12:40,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:12:47,771 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:12:47,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:12:48,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:12:48,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:48,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:12:48,936 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:49,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:12:49,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:12:49,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:12:50,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:50,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:50,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:12:50,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:12:52,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=+1.07GB
2025-10-26 10:12:52,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 10:12:59,813 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:13:00,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:13:00,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:13:00,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:00,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:13:00,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:01,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:01,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:13:01,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:13:02,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:02,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:02,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:02,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:13:04,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:13:04,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:13:11,907 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:13:12,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:13:12,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:13:12,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:12,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:13:13,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:13,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:13,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:13:13,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:13:14,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:14,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:14,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:14,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:13:16,312 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:13:16,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:13:23,842 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:13:24,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:13:24,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:13:24,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:24,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:13:25,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:25,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:13:25,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:13:25,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:13:26,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:26,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:26,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:13:26,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:13:28,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.83GB
2025-10-26 10:13:28,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:13:35,940 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:13:36,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:13:36,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:13:36,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:13:36,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:13:37,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:13:37,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:13:37,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:13:38,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:13:38,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:13:38,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:13:38,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:13:38,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:13:40,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.71GB Delta_CPU=+1.22GB
2025-10-26 10:13:40,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.71GB
2025-10-26 10:13:48,112 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:13:48,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.91GB
2025-10-26 10:13:48,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.91GB
2025-10-26 10:13:48,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 10:13:49,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.91GB
2025-10-26 10:13:49,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 10:13:49,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 10:13:49,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.91GB
2025-10-26 10:13:50,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.91GB
2025-10-26 10:13:50,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 10:13:50,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 10:13:50,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 10:13:50,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.91GB
2025-10-26 10:13:52,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.67GB Delta_CPU=+0.76GB
2025-10-26 10:13:52,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.67GB
2025-10-26 10:14:00,421 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:14:00,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 10:14:00,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 10:14:01,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:14:01,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 10:14:01,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:14:02,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 10:14:02,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 10:14:02,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 10:14:02,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:14:02,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:14:03,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 10:14:03,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 10:14:04,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.67GB Delta_CPU=+0.79GB
2025-10-26 10:14:05,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.67GB
2025-10-26 10:14:12,499 INFO __main__: Batch 160/520 | loss=0.556126 elapsed=1943.0s
2025-10-26 10:14:12,503 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:14:12,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.75GB
2025-10-26 10:14:13,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.75GB
2025-10-26 10:14:13,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:14:13,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.75GB
2025-10-26 10:14:13,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:14:14,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:14:14,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.75GB
2025-10-26 10:14:14,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.75GB
2025-10-26 10:14:14,735 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:14:14,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:14:15,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:14:15,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.75GB
2025-10-26 10:14:16,892 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.55GB Delta_CPU=+0.80GB
2025-10-26 10:14:17,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.55GB
2025-10-26 10:14:24,497 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:14:24,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:14:25,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:14:25,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:25,473 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:14:25,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:26,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:26,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:14:26,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:14:26,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:26,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:27,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:27,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:14:28,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:14:29,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:14:36,378 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:14:36,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:14:36,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:14:37,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:37,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:14:37,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:38,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:14:38,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:14:38,487 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:14:38,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:38,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:39,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:14:39,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:14:40,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+1.04GB
2025-10-26 10:14:41,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 10:14:48,294 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:14:48,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:14:48,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:14:49,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:14:49,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:14:49,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:14:49,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:14:50,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:14:50,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:14:50,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:14:50,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:14:51,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:14:51,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:14:52,735 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=+0.76GB
2025-10-26 10:14:52,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 10:15:00,306 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:15:00,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 10:15:00,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 10:15:01,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:01,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 10:15:01,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:01,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:02,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 10:15:02,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 10:15:02,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:02,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:03,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:03,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 10:15:04,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=+0.92GB
2025-10-26 10:15:04,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 10:15:12,437 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:15:12,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 10:15:12,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 10:15:13,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:13,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 10:15:13,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:14,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 10:15:14,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 10:15:14,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 10:15:14,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:14,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:15,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 10:15:15,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 10:15:16,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=+0.80GB
2025-10-26 10:15:17,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 10:15:24,415 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:15:24,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.55GB
2025-10-26 10:15:24,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.55GB
2025-10-26 10:15:25,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:25,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.55GB
2025-10-26 10:15:25,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:26,030 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:26,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.55GB
2025-10-26 10:15:26,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.55GB
2025-10-26 10:15:26,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:26,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:27,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:27,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.55GB
2025-10-26 10:15:28,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.35GB Delta_CPU=+0.80GB
2025-10-26 10:15:29,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.35GB
2025-10-26 10:15:36,459 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:15:36,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.55GB
2025-10-26 10:15:37,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.55GB
2025-10-26 10:15:37,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:37,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.55GB
2025-10-26 10:15:37,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:38,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:15:38,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.55GB
2025-10-26 10:15:38,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.55GB
2025-10-26 10:15:38,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:38,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:39,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:15:39,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.55GB
2025-10-26 10:15:40,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.55GB Delta_CPU=+0.00GB
2025-10-26 10:15:41,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.55GB
2025-10-26 10:15:48,570 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:15:48,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:15:49,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:15:49,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:15:49,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:15:49,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:15:50,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:15:50,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:15:50,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:15:50,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:15:51,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:15:51,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:15:51,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:15:53,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.52GB Delta_CPU=+0.06GB
2025-10-26 10:15:53,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.52GB
2025-10-26 10:16:00,557 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:16:00,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.52GB
2025-10-26 10:16:01,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.52GB
2025-10-26 10:16:01,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.52GB
2025-10-26 10:16:01,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.52GB
2025-10-26 10:16:01,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.52GB
2025-10-26 10:16:02,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.52GB
2025-10-26 10:16:02,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.52GB
2025-10-26 10:16:02,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.52GB
2025-10-26 10:16:02,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.52GB
2025-10-26 10:16:03,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.52GB
2025-10-26 10:16:03,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.52GB
2025-10-26 10:16:03,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.52GB
2025-10-26 10:16:04,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.76GB
2025-10-26 10:16:05,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 10:16:12,880 INFO __main__: Batch 170/520 | loss=1.825796 elapsed=2063.4s
2025-10-26 10:16:12,883 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:16:13,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 10:16:13,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 10:16:13,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:16:13,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 10:16:14,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:16:14,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:16:14,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 10:16:14,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 10:16:15,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:16:15,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:16:15,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:16:15,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 10:16:17,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.27GB Delta_CPU=+0.79GB
2025-10-26 10:16:17,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.27GB
2025-10-26 10:16:24,810 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:16:25,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 10:16:25,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 10:16:25,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:16:25,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 10:16:26,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:16:26,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:16:26,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 10:16:26,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 10:16:27,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:16:27,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:16:27,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:16:27,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 10:16:29,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=-0.01GB
2025-10-26 10:16:29,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:16:36,991 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:16:37,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:16:37,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:16:37,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:37,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:16:38,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:38,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:38,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:16:39,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:16:39,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:39,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:39,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:39,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:16:41,487 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+0.00GB
2025-10-26 10:16:41,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:16:49,330 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:16:49,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:16:49,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:16:50,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:50,254 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:16:50,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:50,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:16:51,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:16:51,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:16:51,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:51,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:51,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:16:51,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:16:53,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:16:53,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:17:01,324 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:17:01,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:17:01,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:17:02,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:02,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:17:02,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:02,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:03,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:17:03,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:17:03,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:03,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:03,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:03,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:17:05,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:17:05,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:17:13,287 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:17:13,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:17:13,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:17:14,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:14,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:17:14,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:14,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:15,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:17:15,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:17:15,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:15,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:16,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:16,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:17:17,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:17:17,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:17:25,794 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:17:26,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:17:26,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:17:26,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:26,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:17:27,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:27,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:27,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:17:28,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:17:28,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:28,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:28,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:28,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:17:30,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:17:30,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:17:38,433 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:17:38,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:17:38,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:17:39,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:39,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:17:39,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:40,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:40,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:17:40,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:17:40,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:40,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:41,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:41,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:17:42,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:17:43,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:17:50,571 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:17:50,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:17:51,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:17:51,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:51,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:17:51,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:52,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:17:52,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:17:52,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:17:52,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:53,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:53,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:17:53,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:17:54,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.59GB Delta_CPU=+1.13GB
2025-10-26 10:17:55,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.59GB
2025-10-26 10:18:02,581 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:18:02,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 10:18:03,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 10:18:03,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:18:03,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 10:18:03,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:18:04,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 10:18:04,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 10:18:04,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 10:18:04,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:18:05,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:18:05,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 10:18:05,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 10:18:06,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=+0.80GB
2025-10-26 10:18:07,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 10:18:14,596 INFO __main__: Batch 180/520 | loss=0.758628 elapsed=2185.1s
2025-10-26 10:18:14,599 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:18:14,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:18:15,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:18:15,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:15,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:18:15,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:16,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:16,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:18:16,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:18:16,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:17,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:17,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:17,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:18:18,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:18:19,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:18:26,750 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:18:26,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:18:27,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:18:27,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:27,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:18:27,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:28,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:28,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:18:28,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:18:29,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:29,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:29,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:29,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:18:31,254 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.49GB Delta_CPU=+0.03GB
2025-10-26 10:18:31,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.49GB
2025-10-26 10:18:38,996 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:18:39,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.49GB
2025-10-26 10:18:39,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.49GB
2025-10-26 10:18:39,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:18:39,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.49GB
2025-10-26 10:18:40,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:18:40,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.49GB
2025-10-26 10:18:40,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.49GB
2025-10-26 10:18:40,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.49GB
2025-10-26 10:18:41,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:18:41,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:18:41,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.49GB
2025-10-26 10:18:41,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.49GB
2025-10-26 10:18:43,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=-0.03GB
2025-10-26 10:18:43,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:18:50,938 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:18:51,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:18:51,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:18:51,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:51,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:18:52,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:52,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:18:52,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:18:52,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:18:53,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:53,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:53,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:18:53,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:18:55,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=+0.80GB
2025-10-26 10:18:55,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 10:19:03,067 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:19:03,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:19:03,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:19:03,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:04,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:19:04,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:04,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:04,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:19:05,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:19:05,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:05,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:05,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:05,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:19:07,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+0.00GB
2025-10-26 10:19:07,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:19:15,576 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:19:15,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:19:16,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:19:16,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:16,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:19:16,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:17,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:17,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:19:17,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:19:17,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:18,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:18,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:18,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:19:20,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+0.00GB
2025-10-26 10:19:20,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:19:27,518 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:19:27,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:19:28,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:19:28,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:28,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:19:28,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:29,153 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:29,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:19:29,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:19:29,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:29,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:30,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:30,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:19:32,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+0.00GB
2025-10-26 10:19:32,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:19:39,653 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:19:39,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:19:40,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:19:40,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:40,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:19:40,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:41,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:19:41,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:19:41,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:19:41,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:42,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:42,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:19:42,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:19:44,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.85GB Delta_CPU=+0.39GB
2025-10-26 10:19:44,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.85GB
2025-10-26 10:19:51,796 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:19:52,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.85GB
2025-10-26 10:19:52,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.85GB
2025-10-26 10:19:52,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 10:19:52,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.85GB
2025-10-26 10:19:53,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 10:19:53,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 10:19:53,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.85GB
2025-10-26 10:19:53,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.85GB
2025-10-26 10:19:54,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 10:19:54,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 10:19:54,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 10:19:54,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.85GB
2025-10-26 10:19:56,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=-0.05GB
2025-10-26 10:19:56,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 10:20:04,032 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:20:04,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:20:04,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:20:04,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:05,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:20:05,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:05,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:05,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:20:06,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:20:06,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:06,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:06,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:06,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:20:08,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.78GB Delta_CPU=-0.02GB
2025-10-26 10:20:08,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.78GB
2025-10-26 10:20:16,023 INFO __main__: Batch 190/520 | loss=1.617125 elapsed=2306.5s
2025-10-26 10:20:16,026 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:20:16,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 10:20:16,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 10:20:16,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:20:16,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 10:20:17,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:20:17,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:20:17,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 10:20:18,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 10:20:18,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:20:18,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:20:18,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:20:18,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 10:20:20,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=+0.02GB
2025-10-26 10:20:20,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 10:20:28,236 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:20:28,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:20:28,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:20:28,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:29,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:20:29,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:29,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:20:30,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:20:30,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:20:30,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:30,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:30,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:20:30,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:20:32,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=-0.04GB
2025-10-26 10:20:32,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 10:20:40,105 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:20:40,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 10:20:40,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 10:20:40,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:20:41,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 10:20:41,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:20:41,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:20:42,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 10:20:42,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 10:20:42,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:20:42,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:20:42,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:20:42,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 10:20:44,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.55GB Delta_CPU=+0.79GB
2025-10-26 10:20:44,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.55GB
2025-10-26 10:20:52,471 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:20:52,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.75GB
2025-10-26 10:20:53,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.75GB
2025-10-26 10:20:53,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:20:53,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.75GB
2025-10-26 10:20:53,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:20:54,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 10:20:54,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.75GB
2025-10-26 10:20:54,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.75GB
2025-10-26 10:20:54,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:20:54,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:20:55,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 10:20:55,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.75GB
2025-10-26 10:20:56,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=+0.83GB
2025-10-26 10:20:57,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 10:21:04,385 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:21:04,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 10:21:04,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 10:21:05,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:05,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 10:21:05,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:06,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:06,264 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 10:21:06,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 10:21:06,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:06,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:07,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:07,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 10:21:08,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.79GB
2025-10-26 10:21:09,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 10:21:16,724 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:21:16,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 10:21:17,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 10:21:17,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:17,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 10:21:18,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:18,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 10:21:18,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 10:21:18,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 10:21:19,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:19,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:19,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 10:21:19,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 10:21:21,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.73GB Delta_CPU=+0.96GB
2025-10-26 10:21:21,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.73GB
2025-10-26 10:21:29,125 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:21:29,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.93GB
2025-10-26 10:21:29,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.93GB
2025-10-26 10:21:29,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:21:30,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.93GB
2025-10-26 10:21:30,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:21:30,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:21:30,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.93GB
2025-10-26 10:21:31,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.93GB
2025-10-26 10:21:31,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:21:31,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:21:31,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:21:31,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.93GB
2025-10-26 10:21:33,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.75GB
2025-10-26 10:21:33,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 10:27:02,504 INFO __main__: Starting PRODUCTION Celestial Enhanced PGAT training run
2025-10-26 10:27:02,504 INFO __main__: Heavy-duty overnight configuration enabled
2025-10-26 10:27:02,504 INFO __main__: üîç DIAGNOSTIC MODE ENABLED - Writing to training_diagnostic.log
2025-10-26 10:27:02,504 INFO __main__: ================================================================================
2025-10-26 10:27:02,504 INFO __main__: Memory diagnostics enabled; detailed logs stored at checkpoints/celestial_enhanced_pgat_production_recovery_kalki/memory_diagnostics.log
2025-10-26 10:27:02,505 INFO __main__: Configuration summary | model=Celestial_Enhanced_PGAT seq_len=250 pred_len=10 d_model=416 n_heads=8 e_layers=8 d_layers=4 train_epochs=3
2025-10-26 10:27:02,505 INFO __main__: Optimization summary | batch_size=12 learning_rate=0.003 patience=999 target=log_Open,log_High,log_Low,log_Close target_wave_indices=[0, 1, 2, 3] c_out=4 wave_aggregation=True
2025-10-26 10:27:02,505 INFO __main__: Using device: cpu (CPU fallback)
2025-10-26 10:27:02,505 INFO __main__: Reproducibility seed configured to 2024
2025-10-26 10:27:02,505 INFO __main__: Loading production data modules
2025-10-26 10:27:02,570 INFO __main__: Loaded train data module | samples=6250 batches=520 batch_size=12 drop_last=True shuffle=True pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 10:27:02,630 INFO __main__: Loaded val data module | samples=291 batches=25 batch_size=12 drop_last=False shuffle=False pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 10:27:02,689 INFO __main__: Loaded test data module | samples=291 batches=25 batch_size=12 drop_last=False shuffle=False pin_memory=False prefetch_factor=2 persistent_workers=True
2025-10-26 10:27:02,689 INFO __main__: Data loader sizes | train=520 val=25 test=25
2025-10-26 10:27:02,689 INFO __main__: Preparing scaling utilities for loss computation
2025-10-26 10:27:02,689 INFO __main__: Main scaler detected with 118 features
2025-10-26 10:27:02,689 INFO __main__: Target scaler detected with 4 features
2025-10-26 10:27:02,689 INFO __main__: Using target indices for OHLC: [0, 1, 2, 3]
2025-10-26 10:27:02,689 INFO __main__: Initializing production Celestial Enhanced PGAT model
2025-10-26 10:27:02,705 INFO models.Celestial_Enhanced_PGAT.Model: Celestial projection preserves: 416D ‚Üí 416D (1.0x)
2025-10-26 10:27:02,726 INFO models.Celestial_Enhanced_PGAT.Model: üöÄ Initializing Petri Net Combiner with message passing (edge_feature_dim=6, num_steps=2)
2025-10-26 10:27:02,737 INFO models.Celestial_Enhanced_PGAT.Model: ‚úÖ Petri Net Combiner initialized - memory efficient with ZERO information loss!
2025-10-26 10:27:02,741 INFO models.Celestial_Enhanced_PGAT.Model: Celestial fusion gate initialized to 0.5 (balanced) for stable warmup
2025-10-26 10:27:02,830 INFO models.Celestial_Enhanced_PGAT.Model: üöÄ Using EdgeConditionedGraphAttention - ZERO information loss from edge features!
2025-10-26 10:27:02,880 INFO models.Celestial_Enhanced_PGAT.Model: üéØ Target Autocorrelation Module enabled with 2 layers
2025-10-26 10:27:02,881 INFO models.Celestial_Enhanced_PGAT.Model: üìÖ Calendar Effects Module enabled with 104D embeddings
2025-10-26 10:27:03,019 INFO __main__: Model initialized successfully
2025-10-26 10:27:03,021 INFO __main__: Parameter statistics | total=57,324,017 trainable=57,324,017 approx_size_mb=218.7
2025-10-26 10:27:03,023 INFO __main__: Standard precision training
2025-10-26 10:27:03,023 INFO __main__: Gradient accumulation configured | steps=3 effective_batch_size=36
2025-10-26 10:27:03,023 INFO __main__: Learning rate schedule preview | warmup_epochs=3 base_lr=0.003000 min_lr=0.000010 remaining_epochs=0
2025-10-26 10:27:03,023 INFO __main__: Sample learning rates: E1:0.001000, E3:0.003000, E2:0.002000, E3:0.003000
2025-10-26 10:27:03,023 INFO __main__: Using MSE Loss for deterministic predictions
2025-10-26 10:27:03,023 INFO __main__: Early stopping patience configured to 999 (effectively disabled)
2025-10-26 10:27:03,023 INFO __main__: Checkpoints will be saved to checkpoints/celestial_enhanced_pgat_production_recovery_kalki
2025-10-26 10:27:03,023 INFO __main__: Inspecting data file at ./data/prepared_financial_data.csv for target resolution
2025-10-26 10:27:03,025 INFO __main__: Feature summary | total_columns=119 feature_columns=118
2025-10-26 10:27:03,032 INFO __main__: Estimated CSV row count: 7109
2025-10-26 10:27:03,032 INFO __main__: Auto-set enc_in/dec_in to 118 based on feature count
2025-10-26 10:27:03,032 INFO __main__: Resolved target indices: [0, 1, 2, 3]
2025-10-26 10:27:03,032 INFO __main__: Resolved target names: ['log_Open', 'log_High', 'log_Low', 'log_Close']
2025-10-26 10:27:03,032 INFO __main__: Starting production training loop
2025-10-26 10:27:03,032 INFO __main__: Configured for 3 training epochs
2025-10-26 10:27:03,032 INFO __main__: Warmup phase | epoch=1/3 lr=0.00100000
2025-10-26 10:27:03,033 INFO __main__: Epoch 1/3 - production training
2025-10-26 10:27:03,108 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:27:03,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=0.80GB
2025-10-26 10:27:03,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=1.05GB
2025-10-26 10:27:03,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=1.09GB
2025-10-26 10:27:04,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=1.11GB
2025-10-26 10:27:04,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=1.13GB
2025-10-26 10:27:04,626 INFO models.Celestial_Enhanced_PGAT.Model: [CELESTIAL FUSION] Gate stats | mean=0.503708 std=0.081184 min=0.192106 max=0.832568 | celestial_features_std=0.999973 enc_out_std=0.609490 fused_output_std=0.217364 influence_norm=123.8598
2025-10-26 10:27:04,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=3.87GB
2025-10-26 10:27:05,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=3.87GB
2025-10-26 10:27:05,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=3.87GB
2025-10-26 10:27:05,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=3.87GB
2025-10-26 10:27:05,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=3.87GB
2025-10-26 10:27:05,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=3.87GB
2025-10-26 10:27:05,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=3.87GB
2025-10-26 10:27:07,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=17.67GB Delta_CPU=+13.79GB
2025-10-26 10:27:08,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=17.67GB
2025-10-26 10:27:15,444 INFO __main__: Batch 0/520 | loss=1.060983 elapsed=12.4s
2025-10-26 10:27:15,444 DEBUG __main__: Production train - first batch scaling check
2025-10-26 10:27:15,445 DEBUG __main__: Raw batch_y OHLC stats | mean=0.001508 std=0.012547
2025-10-26 10:27:15,445 DEBUG __main__: Scaled targets stats | mean=0.072997 std=0.866500
2025-10-26 10:27:15,445 DEBUG __main__: Model outputs stats | mean=0.103204 std=0.574869
2025-10-26 10:27:15,445 DEBUG __main__: Scaling consistency verified for production training
2025-10-26 10:27:15,448 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:27:15,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=17.26GB
2025-10-26 10:27:15,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=17.26GB
2025-10-26 10:27:16,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 10:27:16,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=17.26GB
2025-10-26 10:27:16,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 10:27:17,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=17.26GB
2025-10-26 10:27:17,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=17.26GB
2025-10-26 10:27:17,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=17.26GB
2025-10-26 10:27:17,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 10:27:17,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 10:27:18,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=17.26GB
2025-10-26 10:27:18,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=17.26GB
2025-10-26 10:27:19,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=21.77GB Delta_CPU=+4.51GB
2025-10-26 10:27:20,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=21.77GB
2025-10-26 10:27:27,650 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:27:27,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=20.97GB
2025-10-26 10:27:28,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=20.97GB
2025-10-26 10:27:28,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=20.97GB
2025-10-26 10:27:28,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=20.97GB
2025-10-26 10:27:28,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=20.97GB
2025-10-26 10:27:29,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=20.97GB
2025-10-26 10:27:29,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=20.97GB
2025-10-26 10:27:29,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=20.97GB
2025-10-26 10:27:29,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=20.97GB
2025-10-26 10:27:30,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=20.97GB
2025-10-26 10:27:30,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=20.97GB
2025-10-26 10:27:30,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=20.97GB
2025-10-26 10:27:32,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.43GB Delta_CPU=+2.45GB
2025-10-26 10:27:32,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.43GB
2025-10-26 10:27:39,466 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:27:39,670 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=23.00GB
2025-10-26 10:27:40,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=23.00GB
2025-10-26 10:27:40,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=23.00GB
2025-10-26 10:27:40,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=23.00GB
2025-10-26 10:27:40,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=23.00GB
2025-10-26 10:27:41,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=23.00GB
2025-10-26 10:27:41,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=23.00GB
2025-10-26 10:27:41,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=23.00GB
2025-10-26 10:27:41,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=23.00GB
2025-10-26 10:27:41,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=23.00GB
2025-10-26 10:27:42,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=23.00GB
2025-10-26 10:27:42,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=23.00GB
2025-10-26 10:27:43,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.03GB Delta_CPU=+0.03GB
2025-10-26 10:27:44,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.03GB
2025-10-26 10:27:51,517 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:27:51,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=21.03GB
2025-10-26 10:27:52,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=21.03GB
2025-10-26 10:27:52,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=21.03GB
2025-10-26 10:27:52,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=21.03GB
2025-10-26 10:27:52,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=21.03GB
2025-10-26 10:27:53,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=21.03GB
2025-10-26 10:27:53,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=21.03GB
2025-10-26 10:27:53,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=21.03GB
2025-10-26 10:27:53,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=21.03GB
2025-10-26 10:27:54,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=21.03GB
2025-10-26 10:27:54,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=21.03GB
2025-10-26 10:27:54,215 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=21.03GB
2025-10-26 10:27:56,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=21.15GB Delta_CPU=+0.12GB
2025-10-26 10:27:56,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=21.15GB
2025-10-26 10:28:03,454 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:28:03,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=21.15GB
2025-10-26 10:28:03,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=21.15GB
2025-10-26 10:28:04,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=21.15GB
2025-10-26 10:28:04,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=21.15GB
2025-10-26 10:28:04,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=21.15GB
2025-10-26 10:28:05,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=21.15GB
2025-10-26 10:28:05,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=21.15GB
2025-10-26 10:28:05,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=21.15GB
2025-10-26 10:28:05,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=21.15GB
2025-10-26 10:28:05,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=21.15GB
2025-10-26 10:28:06,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=21.15GB
2025-10-26 10:28:06,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=21.15GB
2025-10-26 10:28:07,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=23.93GB Delta_CPU=+2.78GB
2025-10-26 10:28:08,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=23.93GB
2025-10-26 10:28:15,434 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:28:15,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=23.13GB
2025-10-26 10:28:15,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=23.13GB
2025-10-26 10:28:16,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=23.13GB
2025-10-26 10:28:16,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=23.13GB
2025-10-26 10:28:16,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=23.13GB
2025-10-26 10:28:17,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=23.13GB
2025-10-26 10:28:17,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=23.13GB
2025-10-26 10:28:17,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=23.13GB
2025-10-26 10:28:17,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=23.13GB
2025-10-26 10:28:17,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=23.13GB
2025-10-26 10:28:18,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=23.13GB
2025-10-26 10:28:18,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=23.13GB
2025-10-26 10:28:19,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+1.32GB
2025-10-26 10:28:20,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 10:28:27,427 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:28:27,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 10:28:27,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 10:28:28,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:28:28,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 10:28:28,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:28:29,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 10:28:29,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 10:28:29,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 10:28:29,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:28:29,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:28:30,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 10:28:30,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 10:28:31,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.41GB Delta_CPU=-0.05GB
2025-10-26 10:28:32,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.41GB
2025-10-26 10:28:39,259 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:28:39,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 10:28:39,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 10:28:39,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:28:40,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 10:28:40,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:28:40,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:28:41,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 10:28:41,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 10:28:41,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:28:41,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:28:41,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:28:41,892 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 10:28:43,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.44GB Delta_CPU=+0.03GB
2025-10-26 10:28:43,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.44GB
2025-10-26 10:28:51,060 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:28:51,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.44GB
2025-10-26 10:28:51,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.44GB
2025-10-26 10:28:51,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:28:52,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.44GB
2025-10-26 10:28:52,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:28:52,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:28:52,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.44GB
2025-10-26 10:28:53,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.44GB
2025-10-26 10:28:53,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:28:53,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:28:53,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:28:53,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.44GB
2025-10-26 10:28:55,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.10GB Delta_CPU=+0.66GB
2025-10-26 10:28:55,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.10GB
2025-10-26 10:29:03,113 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:29:03,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.89GB
2025-10-26 10:29:03,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.89GB
2025-10-26 10:29:03,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 10:29:04,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.89GB
2025-10-26 10:29:04,278 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 10:29:04,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 10:29:04,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.89GB
2025-10-26 10:29:05,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.89GB
2025-10-26 10:29:05,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 10:29:05,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 10:29:05,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 10:29:05,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.89GB
2025-10-26 10:29:07,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.93GB Delta_CPU=+0.03GB
2025-10-26 10:29:07,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.93GB
2025-10-26 10:29:15,053 INFO __main__: Batch 10/520 | loss=15.060561 elapsed=132.0s
2025-10-26 10:29:15,057 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:29:15,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.60GB
2025-10-26 10:29:15,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.60GB
2025-10-26 10:29:15,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:29:16,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.60GB
2025-10-26 10:29:16,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:29:16,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:29:16,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.60GB
2025-10-26 10:29:17,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.60GB
2025-10-26 10:29:17,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:29:17,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:29:17,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:29:17,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.60GB
2025-10-26 10:29:19,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.57GB Delta_CPU=-0.02GB
2025-10-26 10:29:19,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.57GB
2025-10-26 10:29:27,275 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:29:27,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 10:29:27,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 10:29:28,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:29:28,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 10:29:28,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:29:28,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 10:29:29,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 10:29:29,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 10:29:29,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:29:29,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:29:29,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 10:29:29,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 10:29:31,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=-0.00GB
2025-10-26 10:29:31,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 10:29:39,156 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:29:39,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.47GB
2025-10-26 10:29:39,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.47GB
2025-10-26 10:29:39,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:29:40,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.47GB
2025-10-26 10:29:40,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:29:40,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.47GB
2025-10-26 10:29:41,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.47GB
2025-10-26 10:29:41,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.47GB
2025-10-26 10:29:41,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:29:41,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:29:41,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.47GB
2025-10-26 10:29:41,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.47GB
2025-10-26 10:29:43,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.47GB Delta_CPU=-0.00GB
2025-10-26 10:29:43,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.47GB
2025-10-26 10:29:51,237 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:29:51,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.25GB
2025-10-26 10:29:51,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.25GB
2025-10-26 10:29:51,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:29:52,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.25GB
2025-10-26 10:29:52,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:29:52,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.25GB
2025-10-26 10:29:53,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.25GB
2025-10-26 10:29:53,254 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.25GB
2025-10-26 10:29:53,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:29:53,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:29:53,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.25GB
2025-10-26 10:29:53,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.25GB
2025-10-26 10:29:55,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.28GB Delta_CPU=+0.03GB
2025-10-26 10:29:55,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.28GB
2025-10-26 10:30:03,304 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:30:03,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.28GB
2025-10-26 10:30:03,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.28GB
2025-10-26 10:30:04,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.28GB
2025-10-26 10:30:04,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.28GB
2025-10-26 10:30:04,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.28GB
2025-10-26 10:30:04,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.28GB
2025-10-26 10:30:05,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.28GB
2025-10-26 10:30:05,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.28GB
2025-10-26 10:30:05,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.28GB
2025-10-26 10:30:05,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.28GB
2025-10-26 10:30:05,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.28GB
2025-10-26 10:30:05,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.28GB
2025-10-26 10:30:07,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.16GB Delta_CPU=+0.87GB
2025-10-26 10:30:07,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.16GB
2025-10-26 10:30:15,103 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:30:15,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 10:30:15,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 10:30:15,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:30:16,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 10:30:16,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:30:16,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:30:16,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 10:30:17,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 10:30:17,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:30:17,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:30:17,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:30:17,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 10:30:19,518 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.97GB Delta_CPU=+0.03GB
2025-10-26 10:30:19,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.97GB
2025-10-26 10:30:27,336 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:30:27,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.54GB
2025-10-26 10:30:27,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.54GB
2025-10-26 10:30:28,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.54GB
2025-10-26 10:30:28,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.54GB
2025-10-26 10:30:28,497 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.54GB
2025-10-26 10:30:28,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.54GB
2025-10-26 10:30:29,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.54GB
2025-10-26 10:30:29,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.54GB
2025-10-26 10:30:29,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.54GB
2025-10-26 10:30:29,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.54GB
2025-10-26 10:30:29,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.54GB
2025-10-26 10:30:29,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.54GB
2025-10-26 10:30:31,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=+0.83GB
2025-10-26 10:30:31,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 10:30:39,462 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:30:39,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.57GB
2025-10-26 10:30:39,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.57GB
2025-10-26 10:30:40,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 10:30:40,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.57GB
2025-10-26 10:30:40,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 10:30:41,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 10:30:41,287 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.57GB
2025-10-26 10:30:41,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.57GB
2025-10-26 10:30:41,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 10:30:41,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 10:30:42,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 10:30:42,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.57GB
2025-10-26 10:30:43,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.35GB Delta_CPU=+0.78GB
2025-10-26 10:30:44,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.35GB
2025-10-26 10:30:51,539 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:30:51,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.55GB
2025-10-26 10:30:52,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.55GB
2025-10-26 10:30:52,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:30:52,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.55GB
2025-10-26 10:30:52,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:30:53,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.55GB
2025-10-26 10:30:53,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.55GB
2025-10-26 10:30:53,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.55GB
2025-10-26 10:30:53,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:30:53,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:30:54,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.55GB
2025-10-26 10:30:54,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.55GB
2025-10-26 10:30:55,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.31GB Delta_CPU=+0.76GB
2025-10-26 10:30:56,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.31GB
2025-10-26 10:31:03,362 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:31:03,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 10:31:03,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 10:31:04,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:04,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 10:31:04,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:04,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:05,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 10:31:05,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 10:31:05,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:05,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:06,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:06,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 10:31:07,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+1.12GB
2025-10-26 10:31:07,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 10:31:15,631 INFO __main__: Batch 20/520 | loss=4.451699 elapsed=252.6s
2025-10-26 10:31:15,634 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:31:15,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.60GB
2025-10-26 10:31:16,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.60GB
2025-10-26 10:31:16,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:31:16,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.60GB
2025-10-26 10:31:16,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:31:17,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.60GB
2025-10-26 10:31:17,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.60GB
2025-10-26 10:31:17,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.60GB
2025-10-26 10:31:17,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:31:18,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:31:18,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.60GB
2025-10-26 10:31:18,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.60GB
2025-10-26 10:31:20,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.60GB Delta_CPU=+0.00GB
2025-10-26 10:31:20,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.60GB
2025-10-26 10:31:27,653 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:31:27,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 10:31:28,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 10:31:28,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:28,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 10:31:28,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:29,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:29,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 10:31:29,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 10:31:29,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:30,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:30,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:30,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 10:31:32,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.44GB Delta_CPU=+0.03GB
2025-10-26 10:31:32,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.44GB
2025-10-26 10:31:39,507 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:31:39,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.44GB
2025-10-26 10:31:40,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.44GB
2025-10-26 10:31:40,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:31:40,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.44GB
2025-10-26 10:31:40,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:31:41,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 10:31:41,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.44GB
2025-10-26 10:31:41,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.44GB
2025-10-26 10:31:41,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:31:41,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:31:42,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 10:31:42,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.44GB
2025-10-26 10:31:43,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=+0.77GB
2025-10-26 10:31:44,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 10:31:51,323 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:31:51,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 10:31:51,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 10:31:52,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:52,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 10:31:52,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:52,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 10:31:53,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 10:31:53,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 10:31:53,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:53,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:53,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 10:31:53,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 10:31:55,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=+0.80GB
2025-10-26 10:31:56,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 10:32:03,629 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:32:03,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.27GB
2025-10-26 10:32:04,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.27GB
2025-10-26 10:32:04,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:04,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.27GB
2025-10-26 10:32:04,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:05,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:05,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.27GB
2025-10-26 10:32:05,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.27GB
2025-10-26 10:32:05,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:05,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:06,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:06,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.27GB
2025-10-26 10:32:07,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.27GB Delta_CPU=+0.00GB
2025-10-26 10:32:08,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.27GB
2025-10-26 10:32:15,544 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:32:15,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.27GB
2025-10-26 10:32:16,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.27GB
2025-10-26 10:32:16,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:16,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.27GB
2025-10-26 10:32:16,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:17,132 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.27GB
2025-10-26 10:32:17,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.27GB
2025-10-26 10:32:17,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.27GB
2025-10-26 10:32:17,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:17,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:18,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.27GB
2025-10-26 10:32:18,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.27GB
2025-10-26 10:32:19,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.05GB Delta_CPU=+0.78GB
2025-10-26 10:32:20,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.05GB
2025-10-26 10:32:27,596 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:32:27,806 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 10:32:28,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 10:32:28,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 10:32:28,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 10:32:28,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 10:32:29,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 10:32:29,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 10:32:29,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 10:32:30,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 10:32:30,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 10:32:30,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 10:32:30,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 10:32:32,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.40GB Delta_CPU=+0.35GB
2025-10-26 10:32:32,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.40GB
2025-10-26 10:32:40,051 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:32:40,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 10:32:40,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 10:32:40,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:32:40,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 10:32:41,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:32:41,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:32:41,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 10:32:41,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 10:32:42,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:32:42,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:32:42,543 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:32:42,546 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 10:32:44,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=+0.00GB
2025-10-26 10:32:44,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 10:32:52,048 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:32:52,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 10:32:52,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 10:32:52,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:32:52,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 10:32:53,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:32:53,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:32:53,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 10:32:54,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 10:32:54,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:32:54,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:32:54,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:32:54,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 10:32:56,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.78GB
2025-10-26 10:32:56,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 10:33:03,890 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:33:04,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 10:33:04,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 10:33:04,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:04,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 10:33:05,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:05,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:05,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 10:33:05,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 10:33:06,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:06,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:06,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:06,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 10:33:08,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.79GB
2025-10-26 10:33:08,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 10:33:15,697 INFO __main__: Batch 30/520 | loss=1.731660 elapsed=372.7s
2025-10-26 10:33:15,700 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:33:15,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 10:33:16,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 10:33:16,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:16,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 10:33:16,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:17,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 10:33:17,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 10:33:17,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 10:33:17,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:18,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:18,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 10:33:18,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 10:33:19,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.68GB
2025-10-26 10:33:20,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 10:33:27,227 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:33:27,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.69GB
2025-10-26 10:33:27,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.69GB
2025-10-26 10:33:27,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:28,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.69GB
2025-10-26 10:33:28,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:28,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:28,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.69GB
2025-10-26 10:33:29,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.69GB
2025-10-26 10:33:29,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:29,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:29,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:29,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.69GB
2025-10-26 10:33:31,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.72GB Delta_CPU=+0.03GB
2025-10-26 10:33:31,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.72GB
2025-10-26 10:33:39,203 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:33:39,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.72GB
2025-10-26 10:33:39,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.72GB
2025-10-26 10:33:39,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:33:40,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.72GB
2025-10-26 10:33:40,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:33:40,816 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:33:41,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.72GB
2025-10-26 10:33:41,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.72GB
2025-10-26 10:33:41,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:33:41,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:33:41,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:33:41,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.72GB
2025-10-26 10:33:43,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.06GB
2025-10-26 10:33:43,642 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 10:33:50,885 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:33:51,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.69GB
2025-10-26 10:33:51,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.69GB
2025-10-26 10:33:51,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:51,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.69GB
2025-10-26 10:33:52,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:52,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 10:33:52,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.69GB
2025-10-26 10:33:52,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.69GB
2025-10-26 10:33:53,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:53,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:53,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 10:33:53,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.69GB
2025-10-26 10:33:55,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.70GB Delta_CPU=+0.01GB
2025-10-26 10:33:55,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.70GB
2025-10-26 10:34:02,465 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:34:02,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.70GB
2025-10-26 10:34:02,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.70GB
2025-10-26 10:34:03,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.70GB
2025-10-26 10:34:03,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.70GB
2025-10-26 10:34:03,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.70GB
2025-10-26 10:34:04,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.70GB
2025-10-26 10:34:04,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.70GB
2025-10-26 10:34:04,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.70GB
2025-10-26 10:34:04,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.70GB
2025-10-26 10:34:04,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.70GB
2025-10-26 10:34:04,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.70GB
2025-10-26 10:34:04,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.70GB
2025-10-26 10:34:06,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.33GB
2025-10-26 10:34:06,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 10:34:14,290 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:34:14,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.91GB
2025-10-26 10:34:14,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.91GB
2025-10-26 10:34:15,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:15,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.91GB
2025-10-26 10:34:15,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:15,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:16,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.91GB
2025-10-26 10:34:16,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.91GB
2025-10-26 10:34:16,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:16,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:16,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:16,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.91GB
2025-10-26 10:34:18,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.91GB Delta_CPU=+0.00GB
2025-10-26 10:34:18,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.91GB
2025-10-26 10:34:26,151 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:34:26,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.91GB
2025-10-26 10:34:26,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.91GB
2025-10-26 10:34:26,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:27,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.91GB
2025-10-26 10:34:27,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:27,755 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.91GB
2025-10-26 10:34:27,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.91GB
2025-10-26 10:34:28,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.91GB
2025-10-26 10:34:28,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:28,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:28,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.91GB
2025-10-26 10:34:28,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.91GB
2025-10-26 10:34:30,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.69GB Delta_CPU=+0.78GB
2025-10-26 10:34:30,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.69GB
2025-10-26 10:34:38,036 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:34:38,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.89GB
2025-10-26 10:34:38,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.89GB
2025-10-26 10:34:38,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:39,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.89GB
2025-10-26 10:34:39,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:39,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:39,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.89GB
2025-10-26 10:34:40,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.89GB
2025-10-26 10:34:40,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:40,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:40,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:40,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.89GB
2025-10-26 10:34:42,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.69GB Delta_CPU=+0.80GB
2025-10-26 10:34:42,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.69GB
2025-10-26 10:34:49,913 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:34:50,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.89GB
2025-10-26 10:34:50,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.89GB
2025-10-26 10:34:50,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:50,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.89GB
2025-10-26 10:34:51,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:51,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 10:34:51,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.89GB
2025-10-26 10:34:51,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.89GB
2025-10-26 10:34:52,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:52,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:52,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 10:34:52,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.89GB
2025-10-26 10:34:54,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=-0.01GB
2025-10-26 10:34:54,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 10:35:01,476 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:35:01,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.88GB
2025-10-26 10:35:02,032 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.88GB
2025-10-26 10:35:02,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.88GB
2025-10-26 10:35:02,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.88GB
2025-10-26 10:35:02,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.88GB
2025-10-26 10:35:03,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.88GB
2025-10-26 10:35:03,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.88GB
2025-10-26 10:35:03,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.88GB
2025-10-26 10:35:03,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.88GB
2025-10-26 10:35:03,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.88GB
2025-10-26 10:35:04,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.88GB
2025-10-26 10:35:04,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.88GB
2025-10-26 10:35:05,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=-0.05GB
2025-10-26 10:35:05,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 10:35:13,315 INFO __main__: Batch 40/520 | loss=1.796029 elapsed=490.3s
2025-10-26 10:35:13,319 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:35:13,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.72GB
2025-10-26 10:35:13,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.72GB
2025-10-26 10:35:14,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:35:14,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.72GB
2025-10-26 10:35:14,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:35:14,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.72GB
2025-10-26 10:35:15,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.72GB
2025-10-26 10:35:15,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.72GB
2025-10-26 10:35:15,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:35:15,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:35:15,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.72GB
2025-10-26 10:35:15,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.72GB
2025-10-26 10:35:17,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.33GB
2025-10-26 10:35:17,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 10:35:24,848 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:35:25,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.92GB
2025-10-26 10:35:25,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.92GB
2025-10-26 10:35:25,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 10:35:25,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.92GB
2025-10-26 10:35:25,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 10:35:26,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 10:35:26,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.92GB
2025-10-26 10:35:26,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.92GB
2025-10-26 10:35:27,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 10:35:27,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 10:35:27,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 10:35:27,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.92GB
2025-10-26 10:35:29,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.92GB Delta_CPU=+0.00GB
2025-10-26 10:35:29,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.92GB
2025-10-26 10:35:36,614 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:35:36,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.82GB
2025-10-26 10:35:37,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.82GB
2025-10-26 10:35:37,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.82GB
2025-10-26 10:35:37,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.82GB
2025-10-26 10:35:37,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.82GB
2025-10-26 10:35:38,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.82GB
2025-10-26 10:35:38,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.82GB
2025-10-26 10:35:38,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.82GB
2025-10-26 10:35:38,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.82GB
2025-10-26 10:35:39,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.82GB
2025-10-26 10:35:39,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.82GB
2025-10-26 10:35:39,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.82GB
2025-10-26 10:35:40,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.85GB Delta_CPU=+0.03GB
2025-10-26 10:35:41,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.85GB
2025-10-26 10:35:48,406 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:35:48,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.85GB
2025-10-26 10:35:48,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.85GB
2025-10-26 10:35:49,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:35:49,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.85GB
2025-10-26 10:35:49,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:35:49,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:35:50,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.85GB
2025-10-26 10:35:50,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.85GB
2025-10-26 10:35:50,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:35:50,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:35:50,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:35:50,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.85GB
2025-10-26 10:35:52,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.61GB Delta_CPU=+0.76GB
2025-10-26 10:35:52,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.61GB
2025-10-26 10:36:00,147 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:00,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.81GB
2025-10-26 10:36:00,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.81GB
2025-10-26 10:36:00,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:36:01,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.81GB
2025-10-26 10:36:01,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:36:01,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:36:01,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.81GB
2025-10-26 10:36:02,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.81GB
2025-10-26 10:36:02,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:36:02,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:36:02,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:36:02,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.81GB
2025-10-26 10:36:04,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.66GB Delta_CPU=+0.84GB
2025-10-26 10:36:04,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.66GB
2025-10-26 10:36:11,888 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:12,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.86GB
2025-10-26 10:36:12,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.86GB
2025-10-26 10:36:12,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 10:36:12,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.86GB
2025-10-26 10:36:13,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 10:36:13,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 10:36:13,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.86GB
2025-10-26 10:36:13,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.86GB
2025-10-26 10:36:14,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 10:36:14,215 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 10:36:14,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 10:36:14,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.86GB
2025-10-26 10:36:16,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.65GB Delta_CPU=+0.79GB
2025-10-26 10:36:16,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.65GB
2025-10-26 10:36:23,552 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:23,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.85GB
2025-10-26 10:36:24,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.85GB
2025-10-26 10:36:24,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:36:24,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.85GB
2025-10-26 10:36:24,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:36:25,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.85GB
2025-10-26 10:36:25,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.85GB
2025-10-26 10:36:25,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.85GB
2025-10-26 10:36:25,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:36:25,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:36:26,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.85GB
2025-10-26 10:36:26,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.85GB
2025-10-26 10:36:27,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.64GB Delta_CPU=+0.79GB
2025-10-26 10:36:27,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.64GB
2025-10-26 10:36:35,413 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:35,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.84GB
2025-10-26 10:36:35,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.84GB
2025-10-26 10:36:36,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:36:36,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.84GB
2025-10-26 10:36:36,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:36:37,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:36:37,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.84GB
2025-10-26 10:36:37,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.84GB
2025-10-26 10:36:37,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:36:37,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:36:37,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:36:37,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.84GB
2025-10-26 10:36:39,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=-0.05GB
2025-10-26 10:36:39,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 10:36:47,354 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:47,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.80GB
2025-10-26 10:36:47,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.80GB
2025-10-26 10:36:48,062 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 10:36:48,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.80GB
2025-10-26 10:36:48,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 10:36:48,916 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 10:36:49,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.80GB
2025-10-26 10:36:49,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.80GB
2025-10-26 10:36:49,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 10:36:49,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 10:36:49,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 10:36:49,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.80GB
2025-10-26 10:36:51,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.64GB Delta_CPU=+0.84GB
2025-10-26 10:36:51,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.64GB
2025-10-26 10:36:58,971 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:36:59,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.84GB
2025-10-26 10:36:59,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.84GB
2025-10-26 10:36:59,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:36:59,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.84GB
2025-10-26 10:37:00,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:37:00,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:37:00,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.84GB
2025-10-26 10:37:00,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.84GB
2025-10-26 10:37:01,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:01,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:01,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:01,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.84GB
2025-10-26 10:37:03,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.64GB Delta_CPU=+0.80GB
2025-10-26 10:37:03,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.64GB
2025-10-26 10:37:10,796 INFO __main__: Batch 50/520 | loss=1.245314 elapsed=607.8s
2025-10-26 10:37:10,798 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:37:10,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.84GB
2025-10-26 10:37:11,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.84GB
2025-10-26 10:37:11,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:37:11,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.84GB
2025-10-26 10:37:11,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:37:12,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 10:37:12,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.84GB
2025-10-26 10:37:12,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.84GB
2025-10-26 10:37:12,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:13,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:13,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 10:37:13,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.84GB
2025-10-26 10:37:14,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.60GB Delta_CPU=+0.76GB
2025-10-26 10:37:15,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.60GB
2025-10-26 10:37:22,450 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:37:22,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:37:22,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:37:23,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:23,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:37:23,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:24,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:24,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:37:24,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:37:24,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:37:24,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:37:24,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:37:25,000 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:37:26,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.52GB Delta_CPU=+0.84GB
2025-10-26 10:37:26,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.52GB
2025-10-26 10:37:34,133 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:37:34,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.73GB
2025-10-26 10:37:34,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.73GB
2025-10-26 10:37:34,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.73GB
2025-10-26 10:37:35,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.73GB
2025-10-26 10:37:35,278 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.73GB
2025-10-26 10:37:35,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.73GB
2025-10-26 10:37:35,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.73GB
2025-10-26 10:37:36,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.73GB
2025-10-26 10:37:36,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.73GB
2025-10-26 10:37:36,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.73GB
2025-10-26 10:37:36,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.73GB
2025-10-26 10:37:36,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.73GB
2025-10-26 10:37:38,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=27.11GB Delta_CPU=+1.38GB
2025-10-26 10:37:38,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=27.11GB
2025-10-26 10:37:45,951 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:37:46,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.98GB
2025-10-26 10:37:46,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.98GB
2025-10-26 10:37:46,659 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.98GB
2025-10-26 10:37:46,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.98GB
2025-10-26 10:37:47,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.98GB
2025-10-26 10:37:47,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.98GB
2025-10-26 10:37:47,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.98GB
2025-10-26 10:37:47,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.98GB
2025-10-26 10:37:48,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.98GB
2025-10-26 10:37:48,277 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.98GB
2025-10-26 10:37:48,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.98GB
2025-10-26 10:37:48,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.98GB
2025-10-26 10:37:50,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.02GB Delta_CPU=+0.04GB
2025-10-26 10:37:50,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.02GB
2025-10-26 10:37:57,876 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:37:58,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:37:58,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:37:58,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:58,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:37:59,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:59,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:37:59,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:37:59,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:38:00,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:00,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:00,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:00,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:38:02,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.00GB
2025-10-26 10:38:02,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 10:38:09,671 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:38:09,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:38:10,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:38:10,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:10,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:38:10,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:11,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:11,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:38:11,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:38:11,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:12,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:12,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:12,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:38:13,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.48GB Delta_CPU=+0.80GB
2025-10-26 10:38:14,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.48GB
2025-10-26 10:38:21,673 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:38:21,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:38:22,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:38:22,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:22,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:38:22,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:23,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:23,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:38:23,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:38:23,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:23,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:24,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:24,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:38:25,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.48GB Delta_CPU=+0.80GB
2025-10-26 10:38:26,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.48GB
2025-10-26 10:38:33,197 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:38:33,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:38:33,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:38:33,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:34,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:38:34,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:34,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:34,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:38:35,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:38:35,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:35,546 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:35,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:35,740 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:38:37,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.00GB
2025-10-26 10:38:37,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 10:38:44,830 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:38:45,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 10:38:45,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 10:38:45,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:45,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 10:38:45,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:46,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 10:38:46,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 10:38:46,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 10:38:47,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:47,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:47,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 10:38:47,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 10:38:49,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=-0.00GB
2025-10-26 10:38:49,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 10:38:56,806 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:38:56,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:38:57,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:38:57,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:38:57,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:38:57,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:38:58,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:38:58,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:38:58,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:38:58,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:38:59,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:38:59,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:38:59,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:39:00,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.31GB Delta_CPU=+0.82GB
2025-10-26 10:39:01,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.31GB
2025-10-26 10:39:08,442 INFO __main__: Batch 60/520 | loss=1.065513 elapsed=725.4s
2025-10-26 10:39:08,445 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:39:08,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 10:39:08,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 10:39:09,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:39:09,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 10:39:09,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:39:10,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:39:10,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 10:39:10,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 10:39:10,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:39:10,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:39:10,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:39:10,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 10:39:12,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.01GB
2025-10-26 10:39:12,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 10:39:20,378 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:39:20,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.52GB
2025-10-26 10:39:20,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.52GB
2025-10-26 10:39:21,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:21,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.52GB
2025-10-26 10:39:21,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:21,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:22,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.52GB
2025-10-26 10:39:22,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.52GB
2025-10-26 10:39:22,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:22,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:22,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:22,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.52GB
2025-10-26 10:39:24,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.31GB Delta_CPU=+0.80GB
2025-10-26 10:39:24,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.31GB
2025-10-26 10:39:32,201 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:39:32,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.52GB
2025-10-26 10:39:32,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.52GB
2025-10-26 10:39:32,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:33,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.52GB
2025-10-26 10:39:33,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:33,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:33,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.52GB
2025-10-26 10:39:34,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.52GB
2025-10-26 10:39:34,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:34,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:34,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:34,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.52GB
2025-10-26 10:39:36,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.31GB Delta_CPU=+0.80GB
2025-10-26 10:39:36,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.31GB
2025-10-26 10:39:43,849 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:39:44,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.52GB
2025-10-26 10:39:44,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.52GB
2025-10-26 10:39:44,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:44,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.52GB
2025-10-26 10:39:45,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:45,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:39:45,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.52GB
2025-10-26 10:39:45,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.52GB
2025-10-26 10:39:46,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:46,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:46,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:39:46,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.52GB
2025-10-26 10:39:48,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.53GB Delta_CPU=+0.01GB
2025-10-26 10:39:48,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.53GB
2025-10-26 10:39:55,612 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:39:55,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.53GB
2025-10-26 10:39:56,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.53GB
2025-10-26 10:39:56,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:39:56,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.53GB
2025-10-26 10:39:56,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:39:57,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:39:57,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.53GB
2025-10-26 10:39:57,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.53GB
2025-10-26 10:39:57,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:39:57,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:39:58,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:39:58,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.53GB
2025-10-26 10:39:59,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.28GB Delta_CPU=+0.75GB
2025-10-26 10:39:59,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.28GB
2025-10-26 10:40:07,141 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:40:07,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:40:07,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:40:07,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:08,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:40:08,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:08,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:08,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:40:09,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:40:09,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:09,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:09,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:09,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:40:11,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=+0.00GB
2025-10-26 10:40:11,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 10:40:18,953 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:40:19,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:40:19,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:40:19,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:19,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:40:20,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:20,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:20,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:40:20,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:40:21,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:21,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:21,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:21,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:40:23,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=+0.00GB
2025-10-26 10:40:23,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 10:40:30,560 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:40:30,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:40:31,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:40:31,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:31,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:40:31,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:32,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:40:32,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:40:32,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:40:32,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:32,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:33,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:40:33,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:40:34,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.33GB Delta_CPU=+0.84GB
2025-10-26 10:40:35,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.33GB
2025-10-26 10:40:42,355 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:40:42,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.53GB
2025-10-26 10:40:42,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.53GB
2025-10-26 10:40:43,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:40:43,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.53GB
2025-10-26 10:40:43,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:40:43,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 10:40:44,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.53GB
2025-10-26 10:40:44,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.53GB
2025-10-26 10:40:44,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:40:44,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:40:44,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 10:40:44,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.53GB
2025-10-26 10:40:46,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.31GB Delta_CPU=+0.77GB
2025-10-26 10:40:46,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.31GB
2025-10-26 10:40:54,146 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:40:54,350 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 10:40:54,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 10:40:54,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:40:55,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 10:40:55,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:40:55,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 10:40:55,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 10:40:56,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 10:40:56,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:40:56,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:40:56,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 10:40:56,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 10:40:58,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.28GB Delta_CPU=+0.77GB
2025-10-26 10:40:58,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.28GB
2025-10-26 10:41:05,923 INFO __main__: Batch 70/520 | loss=1.694058 elapsed=842.9s
2025-10-26 10:41:05,926 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:41:06,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:41:06,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:41:06,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:06,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:41:07,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:07,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:07,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:41:07,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:41:08,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:08,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:08,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:08,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:41:10,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.28GB Delta_CPU=+0.80GB
2025-10-26 10:41:10,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.28GB
2025-10-26 10:41:17,751 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:41:17,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 10:41:18,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 10:41:18,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:18,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 10:41:18,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:19,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 10:41:19,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 10:41:19,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 10:41:19,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:20,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:20,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 10:41:20,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 10:41:21,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.27GB Delta_CPU=+0.79GB
2025-10-26 10:41:22,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.27GB
2025-10-26 10:41:29,380 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:41:29,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.48GB
2025-10-26 10:41:29,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.48GB
2025-10-26 10:41:30,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 10:41:30,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.48GB
2025-10-26 10:41:30,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 10:41:30,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.48GB
2025-10-26 10:41:31,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.48GB
2025-10-26 10:41:31,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.48GB
2025-10-26 10:41:31,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 10:41:31,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 10:41:31,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.48GB
2025-10-26 10:41:31,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.48GB
2025-10-26 10:41:33,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.32GB Delta_CPU=+0.84GB
2025-10-26 10:41:33,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.32GB
2025-10-26 10:41:41,040 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:41:41,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.52GB
2025-10-26 10:41:41,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.52GB
2025-10-26 10:41:41,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:41:41,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.52GB
2025-10-26 10:41:42,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:41:42,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.52GB
2025-10-26 10:41:42,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.52GB
2025-10-26 10:41:43,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.52GB
2025-10-26 10:41:43,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:41:43,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:41:43,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.52GB
2025-10-26 10:41:43,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.52GB
2025-10-26 10:41:45,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=-0.02GB
2025-10-26 10:41:45,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 10:41:52,939 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:41:53,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.50GB
2025-10-26 10:41:53,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.50GB
2025-10-26 10:41:53,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:41:53,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.50GB
2025-10-26 10:41:54,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:41:54,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:41:54,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.50GB
2025-10-26 10:41:54,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.50GB
2025-10-26 10:41:55,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:41:55,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:41:55,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:41:55,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.50GB
2025-10-26 10:41:57,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.29GB Delta_CPU=+0.79GB
2025-10-26 10:41:57,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.29GB
2025-10-26 10:42:04,711 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:42:04,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.50GB
2025-10-26 10:42:05,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.50GB
2025-10-26 10:42:05,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:05,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.50GB
2025-10-26 10:42:05,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:06,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:06,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.50GB
2025-10-26 10:42:06,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.50GB
2025-10-26 10:42:06,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:07,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:07,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:07,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.50GB
2025-10-26 10:42:08,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=-0.03GB
2025-10-26 10:42:09,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 10:42:16,499 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:42:16,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.46GB
2025-10-26 10:42:17,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.46GB
2025-10-26 10:42:17,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:17,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.46GB
2025-10-26 10:42:17,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:18,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:18,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.46GB
2025-10-26 10:42:18,442 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.46GB
2025-10-26 10:42:18,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:18,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:19,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:19,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.46GB
2025-10-26 10:42:20,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.26GB Delta_CPU=+0.79GB
2025-10-26 10:42:20,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.26GB
2025-10-26 10:42:28,171 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:42:28,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.46GB
2025-10-26 10:42:28,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.46GB
2025-10-26 10:42:28,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:29,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.46GB
2025-10-26 10:42:29,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:29,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 10:42:29,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.46GB
2025-10-26 10:42:30,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.46GB
2025-10-26 10:42:30,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:30,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:30,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 10:42:30,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.46GB
2025-10-26 10:42:32,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.30GB Delta_CPU=+0.84GB
2025-10-26 10:42:32,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.30GB
2025-10-26 10:42:39,930 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:42:40,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.50GB
2025-10-26 10:42:40,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.50GB
2025-10-26 10:42:40,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:40,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.50GB
2025-10-26 10:42:41,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:41,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 10:42:41,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.50GB
2025-10-26 10:42:41,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.50GB
2025-10-26 10:42:42,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:42,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:42,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 10:42:42,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.50GB
2025-10-26 10:42:44,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=-0.05GB
2025-10-26 10:42:44,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 10:42:51,874 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:42:52,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.45GB
2025-10-26 10:42:52,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.45GB
2025-10-26 10:42:52,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.45GB
2025-10-26 10:42:52,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.45GB
2025-10-26 10:42:53,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.45GB
2025-10-26 10:42:53,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.45GB
2025-10-26 10:42:53,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.45GB
2025-10-26 10:42:53,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.45GB
2025-10-26 10:42:54,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.45GB
2025-10-26 10:42:54,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.45GB
2025-10-26 10:42:54,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.45GB
2025-10-26 10:42:54,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.45GB
2025-10-26 10:42:56,115 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.23GB Delta_CPU=+0.78GB
2025-10-26 10:42:56,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.23GB
2025-10-26 10:43:03,679 INFO __main__: Batch 80/520 | loss=0.715936 elapsed=960.6s
2025-10-26 10:43:03,682 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:43:03,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.43GB
2025-10-26 10:43:04,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.43GB
2025-10-26 10:43:04,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 10:43:04,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.43GB
2025-10-26 10:43:04,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 10:43:05,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 10:43:05,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.43GB
2025-10-26 10:43:05,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.43GB
2025-10-26 10:43:05,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 10:43:06,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 10:43:06,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 10:43:06,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.43GB
2025-10-26 10:43:07,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.25GB Delta_CPU=+0.82GB
2025-10-26 10:43:08,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.25GB
2025-10-26 10:43:15,196 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:43:15,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.32GB
2025-10-26 10:43:15,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.32GB
2025-10-26 10:43:15,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:43:16,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.32GB
2025-10-26 10:43:16,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:43:16,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:43:16,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.32GB
2025-10-26 10:43:17,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.32GB
2025-10-26 10:43:17,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:43:17,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:43:17,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:43:17,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.32GB
2025-10-26 10:43:19,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.11GB Delta_CPU=+0.80GB
2025-10-26 10:43:19,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.11GB
2025-10-26 10:43:27,016 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:43:27,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 10:43:27,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 10:43:27,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:43:27,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 10:43:28,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:43:28,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:43:28,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 10:43:29,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 10:43:29,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:43:29,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:43:29,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:43:29,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 10:43:31,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.65GB Delta_CPU=+0.83GB
2025-10-26 10:43:31,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.65GB
2025-10-26 10:43:38,893 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:43:39,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:43:39,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:43:39,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:39,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:43:40,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:40,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:40,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:43:40,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:43:41,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:41,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:41,518 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:41,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:43:43,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.73GB Delta_CPU=+0.00GB
2025-10-26 10:43:43,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.73GB
2025-10-26 10:43:50,860 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:43:51,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:43:51,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:43:51,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:51,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:43:51,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:52,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:43:52,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:43:52,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:43:53,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:53,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:53,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:43:53,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:43:55,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.73GB Delta_CPU=+0.00GB
2025-10-26 10:43:55,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.73GB
2025-10-26 10:44:02,804 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:44:03,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:44:03,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:44:03,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:03,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:44:04,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:04,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:04,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:44:04,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:44:05,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:05,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:05,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:05,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:44:07,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.91GB
2025-10-26 10:44:07,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 10:44:14,917 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:44:15,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.32GB
2025-10-26 10:44:15,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.32GB
2025-10-26 10:44:15,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:44:15,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.32GB
2025-10-26 10:44:16,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:44:16,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.32GB
2025-10-26 10:44:16,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.32GB
2025-10-26 10:44:16,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.32GB
2025-10-26 10:44:17,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:44:17,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:44:17,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.32GB
2025-10-26 10:44:17,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.32GB
2025-10-26 10:44:19,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.11GB Delta_CPU=+0.80GB
2025-10-26 10:44:19,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.11GB
2025-10-26 10:44:26,592 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:44:26,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:44:27,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:44:27,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:27,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:44:27,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:28,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:28,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:44:28,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:44:28,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:28,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:29,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:29,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:44:30,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.80GB
2025-10-26 10:44:31,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 10:44:38,302 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:44:38,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:44:38,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:44:39,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:39,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:44:39,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:39,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:44:40,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:44:40,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:44:40,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:40,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:40,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:44:40,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:44:42,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=+0.03GB
2025-10-26 10:44:42,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 10:44:50,204 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:44:50,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 10:44:50,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 10:44:50,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:44:51,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 10:44:51,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:44:51,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:44:51,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 10:44:52,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 10:44:52,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:44:52,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:44:52,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:44:52,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 10:44:54,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+1.27GB
2025-10-26 10:44:54,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 10:45:01,818 INFO __main__: Batch 90/520 | loss=1.463024 elapsed=1078.8s
2025-10-26 10:45:01,822 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:45:02,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.71GB
2025-10-26 10:45:02,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.71GB
2025-10-26 10:45:02,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 10:45:02,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.71GB
2025-10-26 10:45:02,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 10:45:03,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 10:45:03,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.71GB
2025-10-26 10:45:03,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.71GB
2025-10-26 10:45:03,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 10:45:04,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 10:45:04,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 10:45:04,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.71GB
2025-10-26 10:45:05,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.71GB Delta_CPU=+0.00GB
2025-10-26 10:45:06,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.71GB
2025-10-26 10:45:13,557 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:45:13,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:45:14,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:45:14,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:45:14,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:45:14,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:45:15,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:45:15,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:45:15,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:45:15,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:45:15,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:45:16,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:45:16,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:45:17,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.09GB Delta_CPU=+1.36GB
2025-10-26 10:45:17,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.09GB
2025-10-26 10:45:25,324 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:45:25,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=26.02GB
2025-10-26 10:45:25,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=26.02GB
2025-10-26 10:45:26,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:26,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=26.02GB
2025-10-26 10:45:26,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:26,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:27,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=26.02GB
2025-10-26 10:45:27,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=26.02GB
2025-10-26 10:45:27,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:27,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:27,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:27,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=26.02GB
2025-10-26 10:45:29,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.02GB Delta_CPU=+0.00GB
2025-10-26 10:45:29,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.02GB
2025-10-26 10:45:37,003 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:45:37,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=26.02GB
2025-10-26 10:45:37,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=26.02GB
2025-10-26 10:45:37,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:37,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=26.02GB
2025-10-26 10:45:38,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:38,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=26.02GB
2025-10-26 10:45:38,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=26.02GB
2025-10-26 10:45:38,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=26.02GB
2025-10-26 10:45:39,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:39,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:39,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=26.02GB
2025-10-26 10:45:39,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=26.02GB
2025-10-26 10:45:41,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.04GB Delta_CPU=+0.03GB
2025-10-26 10:45:41,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.04GB
2025-10-26 10:45:48,892 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:45:49,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.81GB
2025-10-26 10:45:49,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.81GB
2025-10-26 10:45:49,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:45:49,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.81GB
2025-10-26 10:45:50,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:45:50,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 10:45:50,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.81GB
2025-10-26 10:45:50,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.81GB
2025-10-26 10:45:51,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:45:51,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:45:51,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 10:45:51,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.81GB
2025-10-26 10:45:53,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.60GB Delta_CPU=+0.80GB
2025-10-26 10:45:53,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.60GB
2025-10-26 10:46:00,815 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:46:01,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 10:46:01,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 10:46:01,543 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:01,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 10:46:01,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:02,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:02,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 10:46:02,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 10:46:03,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:03,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:03,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:03,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 10:46:05,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.98GB
2025-10-26 10:46:05,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 10:46:12,670 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:46:12,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.82GB
2025-10-26 10:46:13,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.82GB
2025-10-26 10:46:13,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:13,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.82GB
2025-10-26 10:46:13,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:14,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.82GB
2025-10-26 10:46:14,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.82GB
2025-10-26 10:46:14,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.82GB
2025-10-26 10:46:14,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:15,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:15,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.82GB
2025-10-26 10:46:15,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.82GB
2025-10-26 10:46:16,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.95GB Delta_CPU=+0.12GB
2025-10-26 10:46:17,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.95GB
2025-10-26 10:46:24,481 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:46:24,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.95GB
2025-10-26 10:46:24,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.95GB
2025-10-26 10:46:25,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:46:25,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.95GB
2025-10-26 10:46:25,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:46:26,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.95GB
2025-10-26 10:46:26,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.95GB
2025-10-26 10:46:26,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.95GB
2025-10-26 10:46:26,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:46:26,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:46:27,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.95GB
2025-10-26 10:46:27,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.95GB
2025-10-26 10:46:28,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.97GB Delta_CPU=+0.02GB
2025-10-26 10:46:29,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.97GB
2025-10-26 10:46:36,487 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:46:36,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 10:46:37,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 10:46:37,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:46:37,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 10:46:37,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:46:38,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:46:38,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 10:46:38,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 10:46:38,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:46:38,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:46:39,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:46:39,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 10:46:40,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.94GB Delta_CPU=-0.03GB
2025-10-26 10:46:40,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.94GB
2025-10-26 10:46:48,380 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:46:48,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 10:46:48,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 10:46:49,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:46:49,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 10:46:49,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:46:49,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:46:50,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 10:46:50,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 10:46:50,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:46:50,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:46:50,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:46:50,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 10:46:52,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.05GB Delta_CPU=+0.12GB
2025-10-26 10:46:52,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.05GB
2025-10-26 10:47:00,422 INFO __main__: Batch 100/520 | loss=2.086077 elapsed=1197.4s
2025-10-26 10:47:00,425 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:47:00,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:47:00,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:47:01,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:47:01,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:47:01,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:47:02,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:47:02,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:47:02,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:47:02,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:47:02,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:47:03,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:47:03,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:47:04,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=+0.03GB
2025-10-26 10:47:05,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 10:47:12,645 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:47:12,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 10:47:13,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 10:47:13,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:47:13,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 10:47:13,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:47:14,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:47:14,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 10:47:14,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 10:47:14,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:47:15,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:47:15,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:47:15,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 10:47:16,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.97GB Delta_CPU=+0.21GB
2025-10-26 10:47:17,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.97GB
2025-10-26 10:47:24,730 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:47:24,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 10:47:25,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 10:47:25,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:47:25,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 10:47:26,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:47:26,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:47:26,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 10:47:26,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 10:47:27,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:47:27,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:47:27,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:47:27,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 10:47:29,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=27.16GB Delta_CPU=+2.19GB
2025-10-26 10:47:29,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=27.16GB
2025-10-26 10:47:37,187 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:47:37,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=26.01GB
2025-10-26 10:47:37,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=26.01GB
2025-10-26 10:47:37,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=26.01GB
2025-10-26 10:47:38,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=26.01GB
2025-10-26 10:47:38,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=26.01GB
2025-10-26 10:47:38,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=26.01GB
2025-10-26 10:47:38,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=26.01GB
2025-10-26 10:47:39,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=26.01GB
2025-10-26 10:47:39,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=26.01GB
2025-10-26 10:47:39,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=26.01GB
2025-10-26 10:47:39,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=26.01GB
2025-10-26 10:47:39,777 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=26.01GB
2025-10-26 10:47:41,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.85GB Delta_CPU=+0.84GB
2025-10-26 10:47:41,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.85GB
2025-10-26 10:47:49,289 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:47:49,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.93GB
2025-10-26 10:47:49,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.93GB
2025-10-26 10:47:50,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:47:50,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.93GB
2025-10-26 10:47:50,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:47:50,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 10:47:51,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.93GB
2025-10-26 10:47:51,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.93GB
2025-10-26 10:47:51,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:47:51,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:47:51,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 10:47:51,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.93GB
2025-10-26 10:47:53,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.32GB Delta_CPU=+0.39GB
2025-10-26 10:47:53,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.32GB
2025-10-26 10:48:01,012 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:48:01,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 10:48:01,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 10:48:01,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:48:01,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 10:48:02,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:48:02,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:48:02,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 10:48:03,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 10:48:03,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:48:03,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:48:03,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:48:03,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 10:48:05,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=-0.01GB
2025-10-26 10:48:05,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 10:48:12,630 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:48:12,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 10:48:13,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 10:48:13,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:13,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 10:48:13,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:14,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:14,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 10:48:14,623 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 10:48:14,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:15,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:15,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:15,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 10:48:16,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=-0.00GB
2025-10-26 10:48:17,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 10:48:24,530 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:48:24,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 10:48:25,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 10:48:25,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:25,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 10:48:25,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:26,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:48:26,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 10:48:26,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 10:48:26,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:26,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:27,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:48:27,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 10:48:28,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=+0.11GB
2025-10-26 10:48:29,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 10:48:36,427 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:48:36,620 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 10:48:36,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 10:48:37,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:37,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 10:48:37,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:38,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:38,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 10:48:38,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 10:48:38,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:38,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:38,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:38,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 10:48:40,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.11GB Delta_CPU=-0.00GB
2025-10-26 10:48:40,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.11GB
2025-10-26 10:48:48,155 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:48:48,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 10:48:48,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 10:48:48,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:49,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 10:48:49,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:49,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 10:48:49,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 10:48:50,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 10:48:50,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:50,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:50,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 10:48:50,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 10:48:52,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.12GB Delta_CPU=+0.02GB
2025-10-26 10:48:52,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.12GB
2025-10-26 10:48:59,850 INFO __main__: Batch 110/520 | loss=0.670433 elapsed=1316.8s
2025-10-26 10:48:59,852 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:00,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 10:49:00,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 10:49:00,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 10:49:00,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 10:49:01,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 10:49:01,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 10:49:01,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 10:49:01,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 10:49:02,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 10:49:02,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 10:49:02,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 10:49:02,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 10:49:04,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=-0.04GB
2025-10-26 10:49:04,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 10:49:11,729 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:11,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 10:49:12,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 10:49:12,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:49:12,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 10:49:12,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:49:13,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 10:49:13,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 10:49:13,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 10:49:13,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:49:14,032 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:49:14,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 10:49:14,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 10:49:15,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.11GB Delta_CPU=+0.02GB
2025-10-26 10:49:16,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.11GB
2025-10-26 10:49:23,403 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:23,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 10:49:23,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 10:49:24,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:24,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 10:49:24,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:25,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:25,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 10:49:25,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 10:49:25,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:25,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:25,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:25,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 10:49:27,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.83GB
2025-10-26 10:49:27,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 10:49:35,215 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:35,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 10:49:35,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 10:49:35,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:49:36,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 10:49:36,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:49:36,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:49:37,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 10:49:37,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 10:49:37,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:49:37,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:49:37,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:49:37,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 10:49:39,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.77GB
2025-10-26 10:49:39,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 10:49:46,915 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:47,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 10:49:47,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 10:49:47,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:47,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 10:49:48,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:48,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 10:49:48,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 10:49:48,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 10:49:49,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:49,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:49,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 10:49:49,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 10:49:51,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.83GB
2025-10-26 10:49:51,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 10:49:58,687 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:49:58,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 10:49:59,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 10:49:59,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:49:59,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 10:49:59,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:50:00,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:50:00,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 10:50:00,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 10:50:00,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:01,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:01,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:01,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 10:50:02,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.80GB
2025-10-26 10:50:03,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 10:50:10,668 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:50:10,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 10:50:11,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 10:50:11,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:50:11,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 10:50:11,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:50:12,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 10:50:12,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 10:50:12,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 10:50:12,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:13,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:13,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 10:50:13,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 10:50:14,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+0.79GB
2025-10-26 10:50:15,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 10:50:22,457 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:50:22,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.99GB
2025-10-26 10:50:22,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.99GB
2025-10-26 10:50:23,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:23,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.99GB
2025-10-26 10:50:23,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:24,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:24,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.99GB
2025-10-26 10:50:24,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.99GB
2025-10-26 10:50:24,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:24,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:24,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:24,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.99GB
2025-10-26 10:50:26,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.76GB
2025-10-26 10:50:26,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 10:50:34,283 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:50:34,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 10:50:34,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 10:50:35,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 10:50:35,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 10:50:35,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 10:50:35,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 10:50:36,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 10:50:36,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 10:50:36,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 10:50:36,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 10:50:36,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 10:50:36,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 10:50:38,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.82GB
2025-10-26 10:50:38,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 10:50:46,142 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:50:46,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.99GB
2025-10-26 10:50:46,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.99GB
2025-10-26 10:50:46,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:47,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.99GB
2025-10-26 10:50:47,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:47,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 10:50:47,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.99GB
2025-10-26 10:50:48,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.99GB
2025-10-26 10:50:48,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:48,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:48,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 10:50:48,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.99GB
2025-10-26 10:50:50,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.75GB Delta_CPU=+0.76GB
2025-10-26 10:50:50,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.75GB
2025-10-26 10:50:58,127 INFO __main__: Batch 120/520 | loss=0.963675 elapsed=1435.1s
2025-10-26 10:50:58,131 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:50:58,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:50:58,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:50:58,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:50:59,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:50:59,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:50:59,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:50:59,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:51:00,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:51:00,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:00,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:00,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:00,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:51:02,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+0.80GB
2025-10-26 10:51:02,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 10:51:09,791 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:51:09,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:51:10,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:51:10,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:10,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:51:10,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:11,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:11,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:51:11,777 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:51:11,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:12,163 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:12,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:12,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:51:14,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=+0.86GB
2025-10-26 10:51:14,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 10:51:21,646 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:51:21,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 10:51:22,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 10:51:22,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:51:22,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 10:51:22,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:51:23,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:51:23,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 10:51:23,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 10:51:23,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:51:23,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:51:24,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:51:24,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 10:51:25,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.76GB
2025-10-26 10:51:26,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 10:51:33,265 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:51:33,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 10:51:33,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 10:51:33,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 10:51:34,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 10:51:34,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 10:51:34,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 10:51:35,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 10:51:35,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 10:51:35,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 10:51:35,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 10:51:35,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 10:51:35,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 10:51:37,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+0.77GB
2025-10-26 10:51:37,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 10:51:45,046 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:51:45,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:51:45,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:51:45,777 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:45,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:51:46,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:46,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:51:46,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:51:47,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:51:47,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:47,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:47,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:51:47,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:51:49,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.74GB Delta_CPU=+1.04GB
2025-10-26 10:51:49,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.74GB
2025-10-26 10:51:56,834 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:51:57,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 10:51:57,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 10:51:57,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:51:57,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 10:51:57,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:51:58,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 10:51:58,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 10:51:58,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 10:51:59,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:51:59,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:51:59,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 10:51:59,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 10:52:01,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.70GB Delta_CPU=+0.76GB
2025-10-26 10:52:01,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.70GB
2025-10-26 10:52:08,544 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:52:08,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:52:09,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:52:09,264 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:09,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:52:09,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:10,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:10,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:52:10,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:52:10,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:10,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:11,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:11,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:52:12,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.83GB Delta_CPU=+1.13GB
2025-10-26 10:52:13,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.83GB
2025-10-26 10:52:20,330 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:52:20,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:52:20,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:52:21,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:21,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:52:21,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:21,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:22,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:52:22,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:52:22,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:22,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:22,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:22,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:52:24,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.59GB Delta_CPU=+0.80GB
2025-10-26 10:52:24,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.59GB
2025-10-26 10:52:32,277 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:52:32,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:52:32,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:52:33,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:33,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:52:33,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:33,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:52:34,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:52:34,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:52:34,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:34,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:34,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:52:34,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:52:36,518 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.62GB Delta_CPU=+0.83GB
2025-10-26 10:52:36,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.62GB
2025-10-26 10:52:43,957 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:52:44,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:52:44,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:52:44,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:44,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:52:45,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:45,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:52:45,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:52:45,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:52:46,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:46,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:46,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:52:46,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:52:48,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+1.09GB
2025-10-26 10:52:48,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 10:52:55,788 INFO __main__: Batch 130/520 | loss=1.255628 elapsed=1552.8s
2025-10-26 10:52:55,791 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:52:55,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.79GB
2025-10-26 10:52:56,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.79GB
2025-10-26 10:52:56,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:52:56,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.79GB
2025-10-26 10:52:56,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:52:57,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:52:57,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.79GB
2025-10-26 10:52:57,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.79GB
2025-10-26 10:52:57,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:52:58,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:52:58,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:52:58,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.79GB
2025-10-26 10:53:00,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+0.00GB
2025-10-26 10:53:00,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 10:53:07,528 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:53:07,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.79GB
2025-10-26 10:53:08,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.79GB
2025-10-26 10:53:08,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:53:08,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.79GB
2025-10-26 10:53:08,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:53:09,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.79GB
2025-10-26 10:53:09,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.79GB
2025-10-26 10:53:09,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.79GB
2025-10-26 10:53:09,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:53:09,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:53:10,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.79GB
2025-10-26 10:53:10,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.79GB
2025-10-26 10:53:11,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.77GB Delta_CPU=-0.02GB
2025-10-26 10:53:12,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.77GB
2025-10-26 10:53:19,311 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:53:19,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.58GB
2025-10-26 10:53:19,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.58GB
2025-10-26 10:53:20,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 10:53:20,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.58GB
2025-10-26 10:53:20,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 10:53:20,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 10:53:21,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.58GB
2025-10-26 10:53:21,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.58GB
2025-10-26 10:53:21,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 10:53:21,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 10:53:21,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 10:53:21,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.58GB
2025-10-26 10:53:23,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=+0.00GB
2025-10-26 10:53:23,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 10:53:31,145 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:53:31,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:53:31,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:53:31,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:32,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:53:32,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:32,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:32,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:53:33,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:53:33,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:33,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:33,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:33,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:53:35,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.70GB Delta_CPU=+0.00GB
2025-10-26 10:53:35,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.70GB
2025-10-26 10:53:43,220 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:53:43,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:53:43,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:53:43,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:44,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:53:44,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:44,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:45,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:53:45,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:53:45,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:45,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:45,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:45,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:53:47,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.70GB Delta_CPU=+0.00GB
2025-10-26 10:53:47,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.70GB
2025-10-26 10:53:55,069 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:53:55,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:53:55,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:53:55,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:55,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:53:56,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:56,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:53:56,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:53:57,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:53:57,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:57,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:57,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:53:57,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:53:59,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=+0.39GB
2025-10-26 10:53:59,551 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 10:54:06,840 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:54:07,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.03GB
2025-10-26 10:54:07,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.03GB
2025-10-26 10:54:07,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 10:54:07,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.03GB
2025-10-26 10:54:07,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 10:54:08,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 10:54:08,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.03GB
2025-10-26 10:54:08,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.03GB
2025-10-26 10:54:09,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 10:54:09,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 10:54:09,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 10:54:09,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.03GB
2025-10-26 10:54:11,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.53GB Delta_CPU=+0.50GB
2025-10-26 10:54:11,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.53GB
2025-10-26 10:54:18,665 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:54:18,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.31GB
2025-10-26 10:54:19,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.31GB
2025-10-26 10:54:19,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 10:54:19,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.31GB
2025-10-26 10:54:19,791 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 10:54:20,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 10:54:20,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.31GB
2025-10-26 10:54:20,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.31GB
2025-10-26 10:54:20,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 10:54:20,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 10:54:21,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 10:54:21,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.31GB
2025-10-26 10:54:22,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=+0.03GB
2025-10-26 10:54:23,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 10:54:30,384 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:54:30,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.21GB
2025-10-26 10:54:30,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.21GB
2025-10-26 10:54:31,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:54:31,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.21GB
2025-10-26 10:54:31,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:54:31,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 10:54:32,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.21GB
2025-10-26 10:54:32,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.21GB
2025-10-26 10:54:32,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:54:32,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:54:32,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 10:54:32,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.21GB
2025-10-26 10:54:34,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.01GB Delta_CPU=+0.80GB
2025-10-26 10:54:34,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.01GB
2025-10-26 10:54:42,149 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:54:42,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:54:42,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:54:42,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:43,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:54:43,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:43,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:43,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:54:44,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:54:44,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:44,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:44,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:44,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:54:46,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.59GB Delta_CPU=+0.80GB
2025-10-26 10:54:46,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.59GB
2025-10-26 10:54:54,027 INFO __main__: Batch 140/520 | loss=0.708000 elapsed=1671.0s
2025-10-26 10:54:54,029 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:54:54,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:54:54,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:54:54,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:54,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:54:55,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:55,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:54:55,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:54:55,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:54:56,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:56,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:56,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:54:56,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:54:58,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.62GB Delta_CPU=+0.83GB
2025-10-26 10:54:58,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.62GB
2025-10-26 10:55:05,644 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:55:05,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:55:06,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:55:06,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:06,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:55:06,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:07,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:07,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:55:07,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:55:07,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:08,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:08,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:08,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:55:09,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.70GB Delta_CPU=+0.00GB
2025-10-26 10:55:10,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.70GB
2025-10-26 10:55:17,615 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:55:17,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:55:18,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:55:18,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:18,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:55:18,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:19,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:55:19,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:55:19,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:55:19,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:19,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:20,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:55:20,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:55:21,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.73GB Delta_CPU=+0.03GB
2025-10-26 10:55:22,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.73GB
2025-10-26 10:55:29,441 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:55:29,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 10:55:29,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 10:55:30,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:55:30,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 10:55:30,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:55:31,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 10:55:31,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 10:55:31,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 10:55:31,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:55:31,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:55:31,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 10:55:31,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 10:55:33,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=+0.57GB
2025-10-26 10:55:33,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 10:55:41,024 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:55:41,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.30GB
2025-10-26 10:55:41,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.30GB
2025-10-26 10:55:41,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:55:41,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.30GB
2025-10-26 10:55:42,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:55:42,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 10:55:42,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.30GB
2025-10-26 10:55:42,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.30GB
2025-10-26 10:55:43,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:55:43,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:55:43,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 10:55:43,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.30GB
2025-10-26 10:55:45,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=-0.04GB
2025-10-26 10:55:45,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 10:55:52,706 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:55:52,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 10:55:53,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 10:55:53,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:55:53,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 10:55:53,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:55:54,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:55:54,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 10:55:54,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 10:55:54,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:55:55,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:55:55,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:55:55,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 10:55:56,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.09GB Delta_CPU=+0.83GB
2025-10-26 10:55:57,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.09GB
2025-10-26 10:56:04,374 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:56:04,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 10:56:04,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 10:56:05,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:56:05,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 10:56:05,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:56:05,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 10:56:06,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 10:56:06,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 10:56:06,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:56:06,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:56:06,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 10:56:06,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 10:56:08,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.04GB Delta_CPU=+0.75GB
2025-10-26 10:56:09,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.04GB
2025-10-26 10:56:16,235 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:56:16,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 10:56:16,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 10:56:16,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:17,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 10:56:17,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:17,816 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:18,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 10:56:18,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 10:56:18,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:18,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:18,755 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:18,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 10:56:20,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=-0.00GB
2025-10-26 10:56:20,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 10:56:28,305 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:56:28,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 10:56:28,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 10:56:29,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:29,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 10:56:29,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:29,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 10:56:30,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 10:56:30,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 10:56:30,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:30,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:30,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 10:56:30,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 10:56:32,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.06GB Delta_CPU=+0.82GB
2025-10-26 10:56:32,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.06GB
2025-10-26 10:56:40,337 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:56:40,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 10:56:40,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 10:56:41,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:56:41,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 10:56:41,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:56:41,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 10:56:42,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 10:56:42,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 10:56:42,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:56:42,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:56:42,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 10:56:42,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 10:56:44,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.78GB
2025-10-26 10:56:44,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 10:56:52,208 INFO __main__: Batch 150/520 | loss=0.917410 elapsed=1789.2s
2025-10-26 10:56:52,212 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:56:52,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 10:56:52,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 10:56:52,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:56:53,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 10:56:53,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:56:53,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 10:56:54,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 10:56:54,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 10:56:54,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:56:54,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:56:54,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 10:56:54,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 10:56:56,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.06GB Delta_CPU=+0.81GB
2025-10-26 10:56:56,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.06GB
2025-10-26 10:57:03,921 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:57:04,115 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 10:57:04,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 10:57:04,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:57:04,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 10:57:05,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:57:05,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 10:57:05,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 10:57:05,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 10:57:06,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:57:06,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:57:06,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 10:57:06,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 10:57:08,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.83GB
2025-10-26 10:57:08,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 10:57:15,741 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:57:15,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 10:57:16,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 10:57:16,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:57:16,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 10:57:16,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:57:17,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 10:57:17,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 10:57:17,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 10:57:17,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:57:18,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:57:18,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 10:57:18,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 10:57:19,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.99GB Delta_CPU=+0.76GB
2025-10-26 10:57:20,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.99GB
2025-10-26 10:57:27,746 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:57:27,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:57:28,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:57:28,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:57:28,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:57:28,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:57:29,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:57:29,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:57:29,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:57:29,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:57:30,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:57:30,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:57:30,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:57:31,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.83GB Delta_CPU=+0.03GB
2025-10-26 10:57:32,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.83GB
2025-10-26 10:57:39,756 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:57:39,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 10:57:40,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 10:57:40,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:40,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 10:57:40,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:41,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:41,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 10:57:41,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 10:57:41,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:42,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:42,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:42,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 10:57:43,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.62GB Delta_CPU=+0.80GB
2025-10-26 10:57:44,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.62GB
2025-10-26 10:57:51,689 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:57:51,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 10:57:52,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 10:57:52,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:52,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 10:57:52,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:53,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:57:53,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 10:57:53,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 10:57:53,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:54,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:54,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:57:54,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 10:57:56,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=-0.03GB
2025-10-26 10:57:56,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 10:58:03,496 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:58:03,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:58:04,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:58:04,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:04,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:58:04,642 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:05,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:05,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:58:05,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:58:05,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:05,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:06,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:06,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:58:07,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.83GB Delta_CPU=+0.03GB
2025-10-26 10:58:08,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.83GB
2025-10-26 10:58:15,108 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:58:15,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 10:58:15,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 10:58:15,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:58:16,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 10:58:16,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:58:16,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 10:58:16,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 10:58:17,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 10:58:17,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:58:17,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:58:17,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 10:58:17,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 10:58:19,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.59GB Delta_CPU=+0.77GB
2025-10-26 10:58:19,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.59GB
2025-10-26 10:58:27,051 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:58:27,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:58:27,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:58:27,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:27,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:58:28,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:28,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:28,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:58:28,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:58:29,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:29,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:29,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:29,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:58:31,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.59GB Delta_CPU=+0.80GB
2025-10-26 10:58:31,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.59GB
2025-10-26 10:58:38,356 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:58:38,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:58:38,892 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:58:39,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:39,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:58:39,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:39,957 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:40,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:58:40,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:58:40,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:40,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:40,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:40,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:58:42,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=+0.00GB
2025-10-26 10:58:42,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 10:58:50,144 INFO __main__: Batch 160/520 | loss=0.556126 elapsed=1907.1s
2025-10-26 10:58:50,148 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:58:50,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 10:58:50,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 10:58:50,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:51,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 10:58:51,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:51,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 10:58:51,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 10:58:52,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 10:58:52,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:52,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:52,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 10:58:52,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 10:58:54,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=+0.00GB
2025-10-26 10:58:54,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 10:59:02,242 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:59:02,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 10:59:02,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 10:59:02,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:59:03,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 10:59:03,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:59:03,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 10:59:04,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 10:59:04,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 10:59:04,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:59:04,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:59:04,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 10:59:04,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 10:59:06,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=+0.06GB
2025-10-26 10:59:06,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 10:59:14,147 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:59:14,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 10:59:14,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 10:59:14,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:59:15,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 10:59:15,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:59:15,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 10:59:15,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 10:59:16,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 10:59:16,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:59:16,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:59:16,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 10:59:16,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 10:59:18,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.41GB Delta_CPU=+0.65GB
2025-10-26 10:59:18,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.41GB
2025-10-26 10:59:26,018 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:59:26,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.35GB
2025-10-26 10:59:26,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.35GB
2025-10-26 10:59:26,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.35GB
2025-10-26 10:59:26,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.35GB
2025-10-26 10:59:27,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.35GB
2025-10-26 10:59:27,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.35GB
2025-10-26 10:59:27,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.35GB
2025-10-26 10:59:28,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.35GB
2025-10-26 10:59:28,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.35GB
2025-10-26 10:59:28,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.35GB
2025-10-26 10:59:28,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.35GB
2025-10-26 10:59:28,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.35GB
2025-10-26 10:59:30,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.36GB Delta_CPU=+0.02GB
2025-10-26 10:59:30,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.36GB
2025-10-26 10:59:37,882 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:59:38,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.36GB
2025-10-26 10:59:38,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.36GB
2025-10-26 10:59:38,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 10:59:38,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.36GB
2025-10-26 10:59:39,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 10:59:39,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 10:59:39,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.36GB
2025-10-26 10:59:39,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.36GB
2025-10-26 10:59:40,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 10:59:40,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 10:59:40,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 10:59:40,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.36GB
2025-10-26 10:59:42,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=-0.03GB
2025-10-26 10:59:42,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 10:59:49,775 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 10:59:49,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.33GB
2025-10-26 10:59:50,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.33GB
2025-10-26 10:59:50,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:59:50,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.33GB
2025-10-26 10:59:50,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:59:51,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 10:59:51,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.33GB
2025-10-26 10:59:51,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.33GB
2025-10-26 10:59:51,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:59:52,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:59:52,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 10:59:52,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.33GB
2025-10-26 10:59:54,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.19GB
2025-10-26 10:59:54,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 11:00:01,616 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:00:01,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 11:00:02,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 11:00:02,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:00:02,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 11:00:02,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:00:03,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:00:03,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 11:00:03,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 11:00:03,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:00:03,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:00:04,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:00:04,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 11:00:05,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.51GB
2025-10-26 11:00:06,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:00:13,533 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:00:13,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.63GB
2025-10-26 11:00:14,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.63GB
2025-10-26 11:00:14,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 11:00:14,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.63GB
2025-10-26 11:00:14,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 11:00:15,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 11:00:15,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.63GB
2025-10-26 11:00:15,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.63GB
2025-10-26 11:00:15,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 11:00:15,916 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 11:00:16,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 11:00:16,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.63GB
2025-10-26 11:00:17,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=-0.04GB
2025-10-26 11:00:18,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 11:00:25,375 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:00:25,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.14GB
2025-10-26 11:00:25,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.14GB
2025-10-26 11:00:26,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:00:26,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.14GB
2025-10-26 11:00:26,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:00:26,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:00:27,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.14GB
2025-10-26 11:00:27,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.14GB
2025-10-26 11:00:27,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:00:27,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:00:27,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:00:27,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.14GB
2025-10-26 11:00:29,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.17GB Delta_CPU=+0.03GB
2025-10-26 11:00:29,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.17GB
2025-10-26 11:00:37,159 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:00:37,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:00:37,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:00:37,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:00:38,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:00:38,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:00:38,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:00:38,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:00:39,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:00:39,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:00:39,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:00:39,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:00:39,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:00:41,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+0.51GB
2025-10-26 11:00:41,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 11:00:48,997 INFO __main__: Batch 170/520 | loss=1.825796 elapsed=2026.0s
2025-10-26 11:00:49,000 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:00:49,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.68GB
2025-10-26 11:00:49,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.68GB
2025-10-26 11:00:49,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 11:00:49,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.68GB
2025-10-26 11:00:50,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 11:00:50,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.68GB
2025-10-26 11:00:50,816 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.68GB
2025-10-26 11:00:51,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.68GB
2025-10-26 11:00:51,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 11:00:51,431 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 11:00:51,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.68GB
2025-10-26 11:00:51,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.68GB
2025-10-26 11:00:53,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=-0.05GB
2025-10-26 11:00:53,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:01:00,965 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:01,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.33GB
2025-10-26 11:01:01,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.33GB
2025-10-26 11:01:01,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:01,903 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.33GB
2025-10-26 11:01:02,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:02,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:02,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.33GB
2025-10-26 11:01:02,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.33GB
2025-10-26 11:01:03,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:03,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:03,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:03,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.33GB
2025-10-26 11:01:05,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=+0.00GB
2025-10-26 11:01:05,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 11:01:12,826 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:13,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.33GB
2025-10-26 11:01:13,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.33GB
2025-10-26 11:01:13,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:13,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.33GB
2025-10-26 11:01:13,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:14,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:01:14,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.33GB
2025-10-26 11:01:14,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.33GB
2025-10-26 11:01:14,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:15,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:15,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:01:15,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.33GB
2025-10-26 11:01:17,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.45GB
2025-10-26 11:01:17,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 11:01:24,573 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:24,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.78GB
2025-10-26 11:01:25,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.78GB
2025-10-26 11:01:25,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.78GB
2025-10-26 11:01:25,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.78GB
2025-10-26 11:01:25,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.78GB
2025-10-26 11:01:26,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.78GB
2025-10-26 11:01:26,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.78GB
2025-10-26 11:01:26,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.78GB
2025-10-26 11:01:26,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.78GB
2025-10-26 11:01:26,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.78GB
2025-10-26 11:01:27,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.78GB
2025-10-26 11:01:27,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.78GB
2025-10-26 11:01:28,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.77GB Delta_CPU=-0.01GB
2025-10-26 11:01:28,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.77GB
2025-10-26 11:01:36,104 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:36,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.77GB
2025-10-26 11:01:36,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.77GB
2025-10-26 11:01:36,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.77GB
2025-10-26 11:01:37,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.77GB
2025-10-26 11:01:37,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.77GB
2025-10-26 11:01:37,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.77GB
2025-10-26 11:01:37,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.77GB
2025-10-26 11:01:38,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.77GB
2025-10-26 11:01:38,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.77GB
2025-10-26 11:01:38,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.77GB
2025-10-26 11:01:38,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.77GB
2025-10-26 11:01:38,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.77GB
2025-10-26 11:01:40,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.53GB Delta_CPU=+0.76GB
2025-10-26 11:01:40,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.53GB
2025-10-26 11:01:47,918 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:48,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.74GB
2025-10-26 11:01:48,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.74GB
2025-10-26 11:01:48,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.74GB
2025-10-26 11:01:48,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.74GB
2025-10-26 11:01:49,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.74GB
2025-10-26 11:01:49,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.74GB
2025-10-26 11:01:49,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.74GB
2025-10-26 11:01:49,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.74GB
2025-10-26 11:01:50,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.74GB
2025-10-26 11:01:50,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.74GB
2025-10-26 11:01:50,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.74GB
2025-10-26 11:01:50,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.74GB
2025-10-26 11:01:52,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.75GB Delta_CPU=+0.02GB
2025-10-26 11:01:52,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.75GB
2025-10-26 11:01:59,732 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:01:59,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 11:02:00,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 11:02:00,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:02:00,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 11:02:00,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:02:01,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:02:01,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 11:02:01,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 11:02:01,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:02:02,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:02:02,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:02:02,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 11:02:03,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.06GB Delta_CPU=+0.84GB
2025-10-26 11:02:04,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.06GB
2025-10-26 11:02:11,510 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:02:11,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 11:02:12,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 11:02:12,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:12,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 11:02:12,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:13,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:13,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 11:02:13,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 11:02:13,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:13,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:14,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:14,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 11:02:15,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.12GB Delta_CPU=-0.00GB
2025-10-26 11:02:16,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.12GB
2025-10-26 11:02:23,468 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:02:23,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 11:02:24,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 11:02:24,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:24,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 11:02:24,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:25,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:02:25,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 11:02:25,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 11:02:25,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:26,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:26,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:02:26,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 11:02:28,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.11GB Delta_CPU=-0.01GB
2025-10-26 11:02:28,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.11GB
2025-10-26 11:02:36,201 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:02:36,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.11GB
2025-10-26 11:02:36,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.11GB
2025-10-26 11:02:36,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:02:37,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.11GB
2025-10-26 11:02:37,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:02:37,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.11GB
2025-10-26 11:02:38,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.11GB
2025-10-26 11:02:38,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.11GB
2025-10-26 11:02:38,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:02:38,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:02:38,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.11GB
2025-10-26 11:02:38,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.11GB
2025-10-26 11:02:40,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.89GB Delta_CPU=+0.79GB
2025-10-26 11:02:40,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.89GB
2025-10-26 11:02:48,152 INFO __main__: Batch 180/520 | loss=0.758628 elapsed=2145.1s
2025-10-26 11:02:48,155 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:02:48,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.10GB
2025-10-26 11:02:48,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.10GB
2025-10-26 11:02:48,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:02:49,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.10GB
2025-10-26 11:02:49,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:02:49,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:02:49,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.10GB
2025-10-26 11:02:50,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.10GB
2025-10-26 11:02:50,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:02:50,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:02:50,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:02:50,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.10GB
2025-10-26 11:02:52,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.89GB Delta_CPU=+0.79GB
2025-10-26 11:02:52,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.89GB
2025-10-26 11:02:59,918 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:00,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:03:00,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:03:00,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:03:00,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:03:01,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:03:01,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:03:01,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:03:01,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:03:02,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:03:02,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:03:02,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:03:02,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:03:04,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.79GB
2025-10-26 11:03:04,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:03:12,022 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:12,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 11:03:12,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 11:03:12,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:12,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 11:03:13,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:13,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:13,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 11:03:13,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 11:03:14,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:14,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:14,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:14,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 11:03:16,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.85GB Delta_CPU=+0.77GB
2025-10-26 11:03:16,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.85GB
2025-10-26 11:03:23,725 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:23,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 11:03:24,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 11:03:24,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:03:24,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 11:03:24,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:03:25,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:03:25,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 11:03:25,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 11:03:25,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:03:26,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:03:26,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:03:26,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 11:03:28,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.82GB
2025-10-26 11:03:28,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:03:35,477 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:35,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 11:03:36,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 11:03:36,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:36,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 11:03:36,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:37,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:03:37,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 11:03:37,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 11:03:37,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:37,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:38,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:03:38,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 11:03:39,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.87GB Delta_CPU=+0.79GB
2025-10-26 11:03:39,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.87GB
2025-10-26 11:03:47,216 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:47,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.07GB
2025-10-26 11:03:47,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.07GB
2025-10-26 11:03:47,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:03:48,163 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.07GB
2025-10-26 11:03:48,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:03:48,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:03:49,035 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.07GB
2025-10-26 11:03:49,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.07GB
2025-10-26 11:03:49,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:03:49,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:03:49,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:03:49,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.07GB
2025-10-26 11:03:51,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.21GB
2025-10-26 11:03:51,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 11:03:59,157 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:03:59,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.28GB
2025-10-26 11:03:59,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.28GB
2025-10-26 11:03:59,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:04:00,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.28GB
2025-10-26 11:04:00,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:04:00,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:04:00,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.28GB
2025-10-26 11:04:01,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.28GB
2025-10-26 11:04:01,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:04:01,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:04:01,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:04:01,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.28GB
2025-10-26 11:04:03,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=-0.04GB
2025-10-26 11:04:03,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 11:04:10,891 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:04:11,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 11:04:11,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 11:04:11,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:11,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 11:04:12,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:12,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:12,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 11:04:12,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 11:04:13,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:13,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:13,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:13,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 11:04:15,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=-0.01GB
2025-10-26 11:04:15,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 11:04:22,823 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:04:23,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 11:04:23,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 11:04:23,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:23,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 11:04:23,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:24,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:04:24,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 11:04:24,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 11:04:25,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:25,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:25,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:04:25,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 11:04:27,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.21GB
2025-10-26 11:04:27,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:04:34,631 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:04:34,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.13GB
2025-10-26 11:04:35,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.13GB
2025-10-26 11:04:35,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:35,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.13GB
2025-10-26 11:04:35,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:36,239 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:36,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.13GB
2025-10-26 11:04:36,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.13GB
2025-10-26 11:04:36,847 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:37,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:37,239 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:37,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.13GB
2025-10-26 11:04:38,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.93GB Delta_CPU=+0.80GB
2025-10-26 11:04:39,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.93GB
2025-10-26 11:04:46,507 INFO __main__: Batch 190/520 | loss=1.617125 elapsed=2263.5s
2025-10-26 11:04:46,510 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:04:46,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.13GB
2025-10-26 11:04:47,032 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.13GB
2025-10-26 11:04:47,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:47,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.13GB
2025-10-26 11:04:47,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:48,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:04:48,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.13GB
2025-10-26 11:04:48,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.13GB
2025-10-26 11:04:48,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:48,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:49,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:04:49,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.13GB
2025-10-26 11:04:50,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.92GB Delta_CPU=+0.79GB
2025-10-26 11:04:50,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.92GB
2025-10-26 11:04:58,340 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:04:58,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 11:04:58,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 11:04:59,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:04:59,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 11:04:59,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:04:59,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:05:00,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 11:05:00,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 11:05:00,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:05:00,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:05:00,923 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:05:00,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 11:05:02,659 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=+0.10GB
2025-10-26 11:05:02,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 11:05:10,203 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:05:10,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.10GB
2025-10-26 11:05:10,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.10GB
2025-10-26 11:05:10,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:05:11,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.10GB
2025-10-26 11:05:11,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:05:11,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.10GB
2025-10-26 11:05:12,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.10GB
2025-10-26 11:05:12,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.10GB
2025-10-26 11:05:12,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:05:12,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:05:12,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.10GB
2025-10-26 11:05:12,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.10GB
2025-10-26 11:05:14,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.08GB Delta_CPU=-0.02GB
2025-10-26 11:05:14,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.08GB
2025-10-26 11:05:22,579 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:05:22,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.89GB
2025-10-26 11:05:23,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.89GB
2025-10-26 11:05:23,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:05:23,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.89GB
2025-10-26 11:05:23,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:05:24,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:05:24,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.89GB
2025-10-26 11:05:24,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.89GB
2025-10-26 11:05:24,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:05:24,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:05:25,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:05:25,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.89GB
2025-10-26 11:05:26,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.89GB Delta_CPU=+0.00GB
2025-10-26 11:05:27,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.89GB
2025-10-26 11:05:34,380 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:05:34,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.79GB
2025-10-26 11:05:34,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.79GB
2025-10-26 11:05:35,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:35,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.79GB
2025-10-26 11:05:35,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:35,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:36,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.79GB
2025-10-26 11:05:36,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.79GB
2025-10-26 11:05:36,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:36,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:36,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:36,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.79GB
2025-10-26 11:05:38,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.79GB Delta_CPU=-0.00GB
2025-10-26 11:05:38,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.79GB
2025-10-26 11:05:46,142 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:05:46,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.79GB
2025-10-26 11:05:46,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.79GB
2025-10-26 11:05:46,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:47,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.79GB
2025-10-26 11:05:47,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:47,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:05:47,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.79GB
2025-10-26 11:05:48,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.79GB
2025-10-26 11:05:48,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:48,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:48,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:05:48,704 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.79GB
2025-10-26 11:05:50,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.78GB
2025-10-26 11:05:50,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:05:57,929 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:05:58,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:05:58,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:05:58,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:05:58,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:05:59,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:05:59,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:05:59,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:05:59,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:06:00,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:00,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:00,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:00,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:06:02,215 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=-0.02GB
2025-10-26 11:06:02,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 11:06:09,767 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:06:09,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 11:06:10,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 11:06:10,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:06:10,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 11:06:10,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:06:11,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:06:11,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 11:06:11,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 11:06:11,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:06:12,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:06:12,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:06:12,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 11:06:14,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.77GB Delta_CPU=+0.02GB
2025-10-26 11:06:14,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.77GB
2025-10-26 11:06:21,535 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:06:21,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:06:22,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:06:22,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:22,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:06:22,704 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:23,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:23,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:06:23,539 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:06:23,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:23,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:24,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:24,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:06:25,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.80GB
2025-10-26 11:06:26,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:06:33,339 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:06:33,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:06:33,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:06:34,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:34,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:06:34,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:34,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:35,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:06:35,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:06:35,487 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:35,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:35,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:35,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:06:37,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.74GB Delta_CPU=-0.03GB
2025-10-26 11:06:37,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.74GB
2025-10-26 11:06:45,364 INFO __main__: Batch 200/520 | loss=0.868279 elapsed=2382.3s
2025-10-26 11:06:45,366 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:06:45,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:06:45,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:06:46,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:06:46,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:06:46,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:06:46,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:06:47,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:06:47,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:06:47,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:06:47,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:06:47,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:06:47,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:06:49,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.77GB Delta_CPU=+0.03GB
2025-10-26 11:06:49,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.77GB
2025-10-26 11:06:57,271 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:06:57,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:06:57,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:06:57,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:58,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:06:58,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:58,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:06:59,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:06:59,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:06:59,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:59,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:59,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:06:59,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:07:01,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=+0.42GB
2025-10-26 11:07:01,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 11:07:09,183 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:07:09,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 11:07:09,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 11:07:09,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:07:10,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 11:07:10,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:07:10,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:07:10,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 11:07:11,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 11:07:11,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:07:11,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:07:11,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:07:11,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 11:07:13,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.96GB Delta_CPU=+0.76GB
2025-10-26 11:07:13,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.96GB
2025-10-26 11:07:21,147 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:07:21,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.16GB
2025-10-26 11:07:21,667 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.16GB
2025-10-26 11:07:21,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:07:22,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.16GB
2025-10-26 11:07:22,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:07:22,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:07:22,921 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.16GB
2025-10-26 11:07:23,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.16GB
2025-10-26 11:07:23,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:07:23,487 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:07:23,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:07:23,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.16GB
2025-10-26 11:07:25,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.95GB Delta_CPU=+0.79GB
2025-10-26 11:07:25,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.95GB
2025-10-26 11:07:32,869 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:07:33,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:07:33,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:07:33,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:07:33,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:07:33,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:07:34,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:07:34,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:07:34,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:07:34,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:07:35,182 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:07:35,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:07:35,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:07:37,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.83GB Delta_CPU=+0.80GB
2025-10-26 11:07:37,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.83GB
2025-10-26 11:07:44,748 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:07:44,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:07:45,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:07:45,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:07:45,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:07:45,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:07:46,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:07:46,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:07:46,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:07:46,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:07:47,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:07:47,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:07:47,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:07:49,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.83GB
2025-10-26 11:07:49,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:07:56,612 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:07:56,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:07:57,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:07:57,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:07:57,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:07:57,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:07:58,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:07:58,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:07:58,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:07:58,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:07:58,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:07:59,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:07:59,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:08:00,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.74GB Delta_CPU=-0.03GB
2025-10-26 11:08:01,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.74GB
2025-10-26 11:08:08,317 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:08:08,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:08:08,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:08:09,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:09,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:08:09,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:09,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:10,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:08:10,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:08:10,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:10,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:10,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:10,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:08:12,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.74GB Delta_CPU=+0.00GB
2025-10-26 11:08:13,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.74GB
2025-10-26 11:08:20,366 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:08:20,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:08:20,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:08:21,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:21,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:08:21,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:22,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:22,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:08:22,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:08:22,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:22,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:23,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:23,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:08:24,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.74GB Delta_CPU=-0.00GB
2025-10-26 11:08:24,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.74GB
2025-10-26 11:08:32,536 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:08:32,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:08:33,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:08:33,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:33,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:08:33,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:34,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:08:34,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:08:34,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:08:34,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:34,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:35,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:08:35,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:08:36,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.77GB Delta_CPU=+0.03GB
2025-10-26 11:08:37,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.77GB
2025-10-26 11:08:44,721 INFO __main__: Batch 210/520 | loss=0.892127 elapsed=2501.7s
2025-10-26 11:08:44,724 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:08:44,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:08:45,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:08:45,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:45,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:08:45,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:46,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:46,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:08:46,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:08:46,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:47,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:47,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:47,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:08:49,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.77GB Delta_CPU=+0.00GB
2025-10-26 11:08:49,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.77GB
2025-10-26 11:08:56,669 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:08:56,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:08:57,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:08:57,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:57,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:08:57,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:58,239 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:08:58,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:08:58,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:08:58,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:58,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:59,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:08:59,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:09:00,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.74GB Delta_CPU=-0.03GB
2025-10-26 11:09:01,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.74GB
2025-10-26 11:09:08,581 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:09:08,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:09:09,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:09:09,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:09:09,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:09:09,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:09:10,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:09:10,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:09:10,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:09:10,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:09:10,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:09:11,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:09:11,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:09:12,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.38GB Delta_CPU=+0.63GB
2025-10-26 11:09:13,035 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.38GB
2025-10-26 11:09:20,299 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:09:20,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.38GB
2025-10-26 11:09:20,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.38GB
2025-10-26 11:09:21,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:09:21,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.38GB
2025-10-26 11:09:21,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:09:21,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:09:22,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.38GB
2025-10-26 11:09:22,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.38GB
2025-10-26 11:09:22,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:09:22,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:09:22,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:09:22,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.38GB
2025-10-26 11:09:24,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.67GB Delta_CPU=+0.30GB
2025-10-26 11:09:24,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.67GB
2025-10-26 11:09:32,295 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:09:32,503 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.54GB
2025-10-26 11:09:32,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.54GB
2025-10-26 11:09:33,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 11:09:33,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.54GB
2025-10-26 11:09:33,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 11:09:33,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 11:09:34,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.54GB
2025-10-26 11:09:34,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.54GB
2025-10-26 11:09:34,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 11:09:34,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 11:09:34,916 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 11:09:34,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.54GB
2025-10-26 11:09:36,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.00GB
2025-10-26 11:09:36,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 11:09:44,365 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:09:44,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:09:44,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:09:45,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:45,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:09:45,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:46,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:46,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:09:46,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:09:46,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:46,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:47,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:47,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:09:48,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=+0.00GB
2025-10-26 11:09:48,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 11:09:56,303 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:09:56,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:09:56,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:09:57,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:57,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:09:57,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:57,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:09:58,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:09:58,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:09:58,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:58,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:58,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:09:58,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:10:00,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.67GB Delta_CPU=+0.33GB
2025-10-26 11:10:00,775 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.67GB
2025-10-26 11:10:08,161 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:10:08,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.67GB
2025-10-26 11:10:08,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.67GB
2025-10-26 11:10:08,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.67GB
2025-10-26 11:10:09,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.67GB
2025-10-26 11:10:09,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.67GB
2025-10-26 11:10:09,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.67GB
2025-10-26 11:10:09,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.67GB
2025-10-26 11:10:10,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.67GB
2025-10-26 11:10:10,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.67GB
2025-10-26 11:10:10,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.67GB
2025-10-26 11:10:10,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.67GB
2025-10-26 11:10:10,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.67GB
2025-10-26 11:10:12,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.64GB Delta_CPU=-0.04GB
2025-10-26 11:10:12,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.64GB
2025-10-26 11:10:20,047 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:10:20,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:10:20,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:10:20,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:20,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:10:21,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:21,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:21,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:10:22,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:10:22,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:22,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:22,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:22,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:10:24,264 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=+0.03GB
2025-10-26 11:10:24,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 11:10:31,912 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:10:32,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.37GB
2025-10-26 11:10:32,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.37GB
2025-10-26 11:10:32,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:10:32,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.37GB
2025-10-26 11:10:33,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:10:33,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:10:33,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.37GB
2025-10-26 11:10:33,903 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.37GB
2025-10-26 11:10:34,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:10:34,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:10:34,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:10:34,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.37GB
2025-10-26 11:10:36,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=-0.03GB
2025-10-26 11:10:36,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 11:10:43,697 INFO __main__: Batch 220/520 | loss=0.636569 elapsed=2620.7s
2025-10-26 11:10:43,701 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:10:43,891 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:10:44,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:10:44,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:44,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:10:44,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:45,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:45,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:10:45,654 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:10:45,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:46,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:46,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:46,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:10:47,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=+0.00GB
2025-10-26 11:10:48,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 11:10:55,573 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:10:55,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:10:56,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:10:56,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:56,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:10:56,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:57,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:10:57,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:10:57,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:10:57,740 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:57,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:58,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:10:58,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:10:59,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=+0.03GB
2025-10-26 11:11:00,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 11:11:07,421 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:11:07,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.37GB
2025-10-26 11:11:07,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.37GB
2025-10-26 11:11:08,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:08,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.37GB
2025-10-26 11:11:08,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:09,000 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:09,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.37GB
2025-10-26 11:11:09,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.37GB
2025-10-26 11:11:09,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:09,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:09,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:09,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.37GB
2025-10-26 11:11:11,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=+0.00GB
2025-10-26 11:11:11,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 11:11:19,431 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:11:19,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.37GB
2025-10-26 11:11:19,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.37GB
2025-10-26 11:11:20,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:20,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.37GB
2025-10-26 11:11:20,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:21,032 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.37GB
2025-10-26 11:11:21,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.37GB
2025-10-26 11:11:21,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.37GB
2025-10-26 11:11:21,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:21,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:21,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.37GB
2025-10-26 11:11:21,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.37GB
2025-10-26 11:11:23,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=-0.00GB
2025-10-26 11:11:23,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 11:11:31,110 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:11:31,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.73GB
2025-10-26 11:11:31,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.73GB
2025-10-26 11:11:31,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 11:11:32,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.73GB
2025-10-26 11:11:32,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 11:11:32,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.73GB
2025-10-26 11:11:32,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.73GB
2025-10-26 11:11:33,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.73GB
2025-10-26 11:11:33,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 11:11:33,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 11:11:33,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.73GB
2025-10-26 11:11:33,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.73GB
2025-10-26 11:11:35,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.75GB Delta_CPU=+0.02GB
2025-10-26 11:11:35,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.75GB
2025-10-26 11:11:43,017 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:11:43,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.75GB
2025-10-26 11:11:43,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.75GB
2025-10-26 11:11:43,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 11:11:43,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.75GB
2025-10-26 11:11:44,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 11:11:44,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.75GB
2025-10-26 11:11:44,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.75GB
2025-10-26 11:11:45,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.75GB
2025-10-26 11:11:45,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 11:11:45,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 11:11:45,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.75GB
2025-10-26 11:11:45,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.75GB
2025-10-26 11:11:47,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.92GB Delta_CPU=+0.17GB
2025-10-26 11:11:47,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.92GB
2025-10-26 11:11:54,793 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:11:54,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.92GB
2025-10-26 11:11:55,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.92GB
2025-10-26 11:11:55,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:11:55,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.92GB
2025-10-26 11:11:55,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:11:56,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:11:56,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.92GB
2025-10-26 11:11:56,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.92GB
2025-10-26 11:11:56,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:11:57,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:11:57,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:11:57,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.92GB
2025-10-26 11:11:59,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.91GB Delta_CPU=-0.01GB
2025-10-26 11:11:59,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.91GB
2025-10-26 11:12:06,570 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:12:06,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.81GB
2025-10-26 11:12:07,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.81GB
2025-10-26 11:12:07,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:12:07,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.81GB
2025-10-26 11:12:07,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:12:08,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:12:08,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.81GB
2025-10-26 11:12:08,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.81GB
2025-10-26 11:12:08,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:12:08,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:12:09,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:12:09,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.81GB
2025-10-26 11:12:10,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=+0.33GB
2025-10-26 11:12:11,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 11:12:18,453 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:12:18,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 11:12:18,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 11:12:19,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:12:19,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 11:12:19,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:12:20,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:12:20,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 11:12:20,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 11:12:20,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:12:20,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:12:20,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:12:20,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 11:12:22,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.04GB Delta_CPU=+0.04GB
2025-10-26 11:12:22,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.04GB
2025-10-26 11:12:30,190 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:12:30,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.90GB
2025-10-26 11:12:30,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.90GB
2025-10-26 11:12:30,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.90GB
2025-10-26 11:12:31,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.90GB
2025-10-26 11:12:31,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.90GB
2025-10-26 11:12:31,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.90GB
2025-10-26 11:12:31,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.90GB
2025-10-26 11:12:32,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.90GB
2025-10-26 11:12:32,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.90GB
2025-10-26 11:12:32,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.90GB
2025-10-26 11:12:32,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.90GB
2025-10-26 11:12:32,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.90GB
2025-10-26 11:12:34,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.88GB Delta_CPU=-0.01GB
2025-10-26 11:12:34,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.88GB
2025-10-26 11:12:42,054 INFO __main__: Batch 230/520 | loss=1.513929 elapsed=2739.0s
2025-10-26 11:12:42,056 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:12:42,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.79GB
2025-10-26 11:12:42,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.79GB
2025-10-26 11:12:42,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:12:42,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.79GB
2025-10-26 11:12:43,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:12:43,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:12:43,841 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.79GB
2025-10-26 11:12:44,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.79GB
2025-10-26 11:12:44,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:12:44,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:12:44,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:12:44,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.79GB
2025-10-26 11:12:46,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=+0.45GB
2025-10-26 11:12:46,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 11:12:53,804 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:12:54,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.24GB
2025-10-26 11:12:54,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.24GB
2025-10-26 11:12:54,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:12:54,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.24GB
2025-10-26 11:12:54,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:12:55,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.24GB
2025-10-26 11:12:55,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.24GB
2025-10-26 11:12:55,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.24GB
2025-10-26 11:12:55,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:12:56,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:12:56,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.24GB
2025-10-26 11:12:56,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.24GB
2025-10-26 11:12:58,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=-0.04GB
2025-10-26 11:12:58,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 11:13:05,654 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:13:05,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 11:13:06,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 11:13:06,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:13:06,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 11:13:06,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:13:07,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:13:07,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 11:13:07,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 11:13:07,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:13:07,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:13:08,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:13:08,138 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 11:13:09,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=+0.03GB
2025-10-26 11:13:10,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 11:13:17,353 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:13:17,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 11:13:17,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 11:13:18,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:13:18,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 11:13:18,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:13:18,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:13:19,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 11:13:19,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 11:13:19,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:13:19,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:13:19,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:13:19,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 11:13:21,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.00GB Delta_CPU=+0.78GB
2025-10-26 11:13:21,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.00GB
2025-10-26 11:13:29,059 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:13:29,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 11:13:29,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 11:13:29,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:29,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 11:13:30,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:30,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:30,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 11:13:31,030 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 11:13:31,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:31,398 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:31,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:31,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 11:13:33,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.78GB Delta_CPU=+0.00GB
2025-10-26 11:13:33,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.78GB
2025-10-26 11:13:41,008 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:13:41,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 11:13:41,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 11:13:41,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:41,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 11:13:42,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:42,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:13:42,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 11:13:43,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 11:13:43,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:43,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:43,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:13:43,559 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 11:13:45,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=+0.79GB
2025-10-26 11:13:45,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 11:13:53,046 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:13:53,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.56GB
2025-10-26 11:13:53,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.56GB
2025-10-26 11:13:53,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:13:54,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.56GB
2025-10-26 11:13:54,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:13:54,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:13:54,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.56GB
2025-10-26 11:13:55,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.56GB
2025-10-26 11:13:55,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:13:55,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:13:55,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:13:55,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.56GB
2025-10-26 11:13:57,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.31GB Delta_CPU=+0.74GB
2025-10-26 11:13:57,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.31GB
2025-10-26 11:14:04,829 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:14:05,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 11:14:05,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 11:14:05,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:05,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 11:14:05,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:06,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:06,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 11:14:06,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 11:14:07,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:07,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:07,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:07,431 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 11:14:09,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.30GB Delta_CPU=+0.79GB
2025-10-26 11:14:09,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.30GB
2025-10-26 11:14:16,828 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:14:17,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 11:14:17,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 11:14:17,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:17,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 11:14:18,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:18,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 11:14:18,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 11:14:18,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 11:14:19,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:19,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:19,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 11:14:19,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 11:14:21,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=+0.01GB
2025-10-26 11:14:21,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 11:14:28,509 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:14:28,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 11:14:29,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 11:14:29,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:29,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 11:14:29,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:30,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:30,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 11:14:30,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 11:14:30,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:30,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:31,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:31,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 11:14:32,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.78GB Delta_CPU=+0.00GB
2025-10-26 11:14:33,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.78GB
2025-10-26 11:14:40,411 INFO __main__: Batch 240/520 | loss=1.393623 elapsed=2857.4s
2025-10-26 11:14:40,419 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:14:40,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.78GB
2025-10-26 11:14:40,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.78GB
2025-10-26 11:14:41,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:41,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.78GB
2025-10-26 11:14:41,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:42,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.78GB
2025-10-26 11:14:42,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.78GB
2025-10-26 11:14:42,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.78GB
2025-10-26 11:14:42,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:42,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:43,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.78GB
2025-10-26 11:14:43,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.78GB
2025-10-26 11:14:44,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=+0.45GB
2025-10-26 11:14:44,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 11:14:52,044 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:14:52,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 11:14:52,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 11:14:52,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:14:52,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 11:14:53,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:14:53,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:14:53,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 11:14:53,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 11:14:54,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:14:54,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:14:54,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:14:54,543 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 11:14:56,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.19GB Delta_CPU=-0.04GB
2025-10-26 11:14:56,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.19GB
2025-10-26 11:15:03,845 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:15:04,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 11:15:04,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 11:15:04,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:15:04,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 11:15:05,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:15:05,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:15:05,659 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 11:15:05,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 11:15:06,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:15:06,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:15:06,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:15:06,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 11:15:08,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.97GB Delta_CPU=-0.00GB
2025-10-26 11:15:08,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.97GB
2025-10-26 11:15:15,626 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:15:15,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.86GB
2025-10-26 11:15:16,161 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.86GB
2025-10-26 11:15:16,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:16,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.86GB
2025-10-26 11:15:16,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:17,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:17,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.86GB
2025-10-26 11:15:17,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.86GB
2025-10-26 11:15:17,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:17,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:18,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:18,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.86GB
2025-10-26 11:15:19,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.65GB Delta_CPU=+0.79GB
2025-10-26 11:15:20,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.65GB
2025-10-26 11:15:27,409 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:15:27,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.86GB
2025-10-26 11:15:27,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.86GB
2025-10-26 11:15:28,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:28,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.86GB
2025-10-26 11:15:28,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:29,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:15:29,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.86GB
2025-10-26 11:15:29,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.86GB
2025-10-26 11:15:29,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:29,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:29,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:15:29,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.86GB
2025-10-26 11:15:31,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.85GB Delta_CPU=-0.00GB
2025-10-26 11:15:31,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.85GB
2025-10-26 11:15:39,438 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:15:39,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.85GB
2025-10-26 11:15:39,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.85GB
2025-10-26 11:15:40,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:15:40,350 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.85GB
2025-10-26 11:15:40,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:15:41,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:15:41,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.85GB
2025-10-26 11:15:41,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.85GB
2025-10-26 11:15:41,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:15:41,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:15:41,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:15:41,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.85GB
2025-10-26 11:15:43,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.64GB Delta_CPU=+0.79GB
2025-10-26 11:15:43,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.64GB
2025-10-26 11:15:51,297 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:15:51,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:15:51,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:15:52,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:15:52,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:15:52,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:15:52,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:15:53,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:15:53,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:15:53,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:15:53,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:15:53,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:15:53,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:15:55,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.87GB Delta_CPU=+0.02GB
2025-10-26 11:15:55,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.87GB
2025-10-26 11:16:03,110 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:16:03,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:16:03,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:16:03,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:16:04,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:16:04,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:16:04,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:16:04,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:16:05,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:16:05,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:16:05,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:16:05,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:16:05,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:16:07,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.81GB Delta_CPU=+0.94GB
2025-10-26 11:16:07,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.81GB
2025-10-26 11:16:15,190 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:16:15,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.02GB
2025-10-26 11:16:15,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.02GB
2025-10-26 11:16:15,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:16:16,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.02GB
2025-10-26 11:16:16,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:16:16,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:16:16,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.02GB
2025-10-26 11:16:17,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.02GB
2025-10-26 11:16:17,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:16:17,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:16:17,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:16:17,696 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.02GB
2025-10-26 11:16:19,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.07GB Delta_CPU=+0.05GB
2025-10-26 11:16:19,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.07GB
2025-10-26 11:16:26,908 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:16:27,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.98GB
2025-10-26 11:16:27,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.98GB
2025-10-26 11:16:27,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:16:27,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.98GB
2025-10-26 11:16:28,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:16:28,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:16:28,654 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.98GB
2025-10-26 11:16:28,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.98GB
2025-10-26 11:16:29,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:16:29,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:16:29,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:16:29,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.98GB
2025-10-26 11:16:31,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.00GB Delta_CPU=+0.03GB
2025-10-26 11:16:31,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.00GB
2025-10-26 11:16:38,644 INFO __main__: Batch 250/520 | loss=0.380987 elapsed=2975.6s
2025-10-26 11:16:38,647 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:16:38,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.93GB
2025-10-26 11:16:39,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.93GB
2025-10-26 11:16:39,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:16:39,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.93GB
2025-10-26 11:16:39,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:16:40,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:16:40,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.93GB
2025-10-26 11:16:40,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.93GB
2025-10-26 11:16:40,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:16:41,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:16:41,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:16:41,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.93GB
2025-10-26 11:16:43,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.96GB Delta_CPU=+0.03GB
2025-10-26 11:16:43,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.96GB
2025-10-26 11:16:50,548 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:16:50,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 11:16:51,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 11:16:51,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:16:51,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 11:16:51,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:16:52,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:16:52,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 11:16:52,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 11:16:52,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:16:52,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:16:53,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:16:53,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 11:16:54,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.93GB Delta_CPU=-0.04GB
2025-10-26 11:16:55,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.93GB
2025-10-26 11:17:02,451 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:17:02,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.93GB
2025-10-26 11:17:02,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.93GB
2025-10-26 11:17:03,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:17:03,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.93GB
2025-10-26 11:17:03,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:17:04,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.93GB
2025-10-26 11:17:04,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.93GB
2025-10-26 11:17:04,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.93GB
2025-10-26 11:17:04,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:17:04,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:17:05,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.93GB
2025-10-26 11:17:05,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.93GB
2025-10-26 11:17:06,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.96GB Delta_CPU=+0.03GB
2025-10-26 11:17:06,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.96GB
2025-10-26 11:17:14,351 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:17:14,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 11:17:14,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 11:17:15,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:17:15,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 11:17:15,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:17:16,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:17:16,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 11:17:16,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 11:17:16,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:17:16,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:17:17,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:17:17,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 11:17:18,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.89GB Delta_CPU=+0.94GB
2025-10-26 11:17:19,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.89GB
2025-10-26 11:17:26,408 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:17:26,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.89GB
2025-10-26 11:17:27,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.89GB
2025-10-26 11:17:27,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 11:17:27,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.89GB
2025-10-26 11:17:27,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 11:17:28,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.89GB
2025-10-26 11:17:28,431 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.89GB
2025-10-26 11:17:28,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.89GB
2025-10-26 11:17:28,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 11:17:29,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 11:17:29,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.89GB
2025-10-26 11:17:29,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.89GB
2025-10-26 11:17:31,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.72GB Delta_CPU=+0.83GB
2025-10-26 11:17:31,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.72GB
2025-10-26 11:17:38,854 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:17:39,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.92GB
2025-10-26 11:17:39,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.92GB
2025-10-26 11:17:39,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 11:17:39,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.92GB
2025-10-26 11:17:39,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 11:17:40,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.92GB
2025-10-26 11:17:40,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.92GB
2025-10-26 11:17:40,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.92GB
2025-10-26 11:17:41,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 11:17:41,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 11:17:41,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.92GB
2025-10-26 11:17:41,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.92GB
2025-10-26 11:17:43,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.86GB Delta_CPU=-0.06GB
2025-10-26 11:17:43,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.86GB
2025-10-26 11:17:50,764 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:17:50,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.86GB
2025-10-26 11:17:51,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.86GB
2025-10-26 11:17:51,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 11:17:51,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.86GB
2025-10-26 11:17:51,891 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 11:17:52,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.86GB
2025-10-26 11:17:52,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.86GB
2025-10-26 11:17:52,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.86GB
2025-10-26 11:17:52,921 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 11:17:53,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 11:17:53,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.86GB
2025-10-26 11:17:53,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.86GB
2025-10-26 11:17:55,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.89GB Delta_CPU=+0.03GB
2025-10-26 11:17:55,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.89GB
2025-10-26 11:18:02,655 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:18:02,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.81GB
2025-10-26 11:18:03,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.81GB
2025-10-26 11:18:03,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 11:18:03,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.81GB
2025-10-26 11:18:03,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 11:18:04,251 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.81GB
2025-10-26 11:18:04,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.81GB
2025-10-26 11:18:04,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.81GB
2025-10-26 11:18:04,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 11:18:05,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 11:18:05,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.81GB
2025-10-26 11:18:05,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.81GB
2025-10-26 11:18:06,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.81GB Delta_CPU=+0.00GB
2025-10-26 11:18:07,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.81GB
2025-10-26 11:18:14,469 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:18:14,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.71GB
2025-10-26 11:18:14,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.71GB
2025-10-26 11:18:15,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 11:18:15,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.71GB
2025-10-26 11:18:15,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 11:18:16,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.71GB
2025-10-26 11:18:16,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.71GB
2025-10-26 11:18:16,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.71GB
2025-10-26 11:18:16,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 11:18:16,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 11:18:16,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.71GB
2025-10-26 11:18:16,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.71GB
2025-10-26 11:18:18,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.74GB Delta_CPU=+0.03GB
2025-10-26 11:18:18,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.74GB
2025-10-26 11:18:26,363 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:18:26,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 11:18:26,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 11:18:27,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:27,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 11:18:27,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:27,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:28,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 11:18:28,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 11:18:28,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:28,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:28,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:28,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 11:18:30,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.12GB Delta_CPU=-0.00GB
2025-10-26 11:18:30,811 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.12GB
2025-10-26 11:18:38,264 INFO __main__: Batch 260/520 | loss=0.869200 elapsed=3095.2s
2025-10-26 11:18:38,266 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:18:38,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.12GB
2025-10-26 11:18:38,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.12GB
2025-10-26 11:18:38,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:39,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.12GB
2025-10-26 11:18:39,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:39,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.12GB
2025-10-26 11:18:40,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.12GB
2025-10-26 11:18:40,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.12GB
2025-10-26 11:18:40,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:40,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:40,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.12GB
2025-10-26 11:18:40,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.12GB
2025-10-26 11:18:42,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.94GB Delta_CPU=+0.82GB
2025-10-26 11:18:42,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.94GB
2025-10-26 11:18:49,953 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:18:50,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.14GB
2025-10-26 11:18:50,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.14GB
2025-10-26 11:18:50,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:18:50,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.14GB
2025-10-26 11:18:51,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:18:51,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:18:51,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.14GB
2025-10-26 11:18:51,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.14GB
2025-10-26 11:18:52,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:18:52,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:18:52,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:18:52,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.14GB
2025-10-26 11:18:54,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=-0.01GB
2025-10-26 11:18:54,408 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 11:19:01,675 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:19:01,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.13GB
2025-10-26 11:19:02,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.13GB
2025-10-26 11:19:02,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:19:02,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.13GB
2025-10-26 11:19:02,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:19:03,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.13GB
2025-10-26 11:19:03,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.13GB
2025-10-26 11:19:03,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.13GB
2025-10-26 11:19:03,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:19:04,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:19:04,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.13GB
2025-10-26 11:19:04,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.13GB
2025-10-26 11:19:05,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.75GB
2025-10-26 11:19:06,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:19:13,504 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:19:13,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:19:14,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:19:14,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:14,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:19:14,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:15,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:15,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:19:15,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:19:15,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:15,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:16,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:16,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:19:17,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.80GB
2025-10-26 11:19:17,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:19:24,934 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:19:25,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:19:25,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:19:25,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:25,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:19:26,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:26,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:19:26,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:19:26,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:19:27,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:27,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:27,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:19:27,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:19:29,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.06GB Delta_CPU=-0.02GB
2025-10-26 11:19:29,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.06GB
2025-10-26 11:19:36,839 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:19:37,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.06GB
2025-10-26 11:19:37,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.06GB
2025-10-26 11:19:37,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:19:37,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.06GB
2025-10-26 11:19:37,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:19:38,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:19:38,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.06GB
2025-10-26 11:19:38,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.06GB
2025-10-26 11:19:38,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:19:39,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:19:39,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:19:39,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.06GB
2025-10-26 11:19:41,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.05GB Delta_CPU=-0.02GB
2025-10-26 11:19:41,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.05GB
2025-10-26 11:19:48,578 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:19:48,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 11:19:49,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 11:19:49,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:19:49,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 11:19:49,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:19:50,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:19:50,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 11:19:50,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 11:19:50,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:19:50,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:19:51,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:19:51,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 11:19:52,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.04GB Delta_CPU=-0.01GB
2025-10-26 11:19:53,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.04GB
2025-10-26 11:20:00,756 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:20:00,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 11:20:01,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 11:20:01,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:20:01,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 11:20:01,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:20:02,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:20:02,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 11:20:02,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 11:20:02,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:20:03,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:20:03,333 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:20:03,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 11:20:05,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.83GB
2025-10-26 11:20:05,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 11:20:12,572 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:20:12,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 11:20:13,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 11:20:13,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:20:13,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 11:20:13,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:20:14,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:20:14,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 11:20:14,539 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 11:20:14,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:20:14,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:20:15,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:20:15,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 11:20:16,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=+0.12GB
2025-10-26 11:20:17,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 11:20:24,561 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:20:24,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:20:25,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:20:25,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:20:25,497 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:20:25,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:20:26,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:20:26,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:20:26,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:20:26,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:20:26,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:20:27,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:20:27,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:20:28,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.21GB Delta_CPU=+0.13GB
2025-10-26 11:20:29,000 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.21GB
2025-10-26 11:20:36,446 INFO __main__: Batch 270/520 | loss=0.590637 elapsed=3213.4s
2025-10-26 11:20:36,449 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:20:36,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.21GB
2025-10-26 11:20:36,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.21GB
2025-10-26 11:20:37,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:20:37,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.21GB
2025-10-26 11:20:37,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:20:38,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:20:38,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.21GB
2025-10-26 11:20:38,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.21GB
2025-10-26 11:20:38,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:20:38,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:20:39,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:20:39,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.21GB
2025-10-26 11:20:40,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.17GB Delta_CPU=-0.04GB
2025-10-26 11:20:40,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.17GB
2025-10-26 11:20:48,421 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:20:48,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:20:48,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:20:49,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:20:49,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:20:49,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:20:49,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:20:50,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:20:50,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:20:50,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:20:50,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:20:50,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:20:50,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:20:52,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.16GB Delta_CPU=-0.01GB
2025-10-26 11:20:52,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.16GB
2025-10-26 11:21:00,276 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:00,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.16GB
2025-10-26 11:21:00,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.16GB
2025-10-26 11:21:00,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:21:01,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.16GB
2025-10-26 11:21:01,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:21:01,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:21:02,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.16GB
2025-10-26 11:21:02,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.16GB
2025-10-26 11:21:02,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:21:02,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:21:02,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:21:02,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.16GB
2025-10-26 11:21:04,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.19GB Delta_CPU=+0.03GB
2025-10-26 11:21:04,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.19GB
2025-10-26 11:21:12,352 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:12,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.19GB
2025-10-26 11:21:12,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.19GB
2025-10-26 11:21:13,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:21:13,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.19GB
2025-10-26 11:21:13,481 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:21:13,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:21:14,133 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.19GB
2025-10-26 11:21:14,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.19GB
2025-10-26 11:21:14,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:21:14,670 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:21:14,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:21:14,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.19GB
2025-10-26 11:21:16,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=+0.14GB
2025-10-26 11:21:16,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 11:21:24,025 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:24,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 11:21:24,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 11:21:24,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:21:24,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 11:21:25,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:21:25,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:21:25,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 11:21:26,007 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 11:21:26,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:21:26,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:21:26,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:21:26,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 11:21:28,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.09GB Delta_CPU=+0.83GB
2025-10-26 11:21:28,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.09GB
2025-10-26 11:21:36,033 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:36,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 11:21:36,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 11:21:36,755 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:21:36,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 11:21:37,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:21:37,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:21:37,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 11:21:38,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 11:21:38,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:21:38,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:21:38,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:21:38,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 11:21:40,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=-0.01GB
2025-10-26 11:21:40,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 11:21:47,936 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:48,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.28GB
2025-10-26 11:21:48,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.28GB
2025-10-26 11:21:48,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:21:48,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.28GB
2025-10-26 11:21:49,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:21:49,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:21:49,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.28GB
2025-10-26 11:21:49,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.28GB
2025-10-26 11:21:50,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:21:50,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:21:50,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:21:50,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.28GB
2025-10-26 11:21:52,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.37GB Delta_CPU=+0.09GB
2025-10-26 11:21:52,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.37GB
2025-10-26 11:21:59,615 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:21:59,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 11:22:00,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 11:22:00,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:00,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 11:22:00,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:01,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:01,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 11:22:01,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 11:22:01,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:01,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:02,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:02,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 11:22:03,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=+0.33GB
2025-10-26 11:22:04,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 11:22:11,444 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:22:11,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.44GB
2025-10-26 11:22:11,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.44GB
2025-10-26 11:22:12,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 11:22:12,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.44GB
2025-10-26 11:22:12,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 11:22:13,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 11:22:13,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.44GB
2025-10-26 11:22:13,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.44GB
2025-10-26 11:22:13,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 11:22:13,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 11:22:13,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 11:22:13,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.44GB
2025-10-26 11:22:15,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.00GB
2025-10-26 11:22:15,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:22:23,374 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:22:23,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 11:22:23,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 11:22:24,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:24,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 11:22:24,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:24,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:22:25,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 11:22:25,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 11:22:25,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:25,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:25,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:22:25,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 11:22:27,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.03GB
2025-10-26 11:22:27,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 11:22:34,962 INFO __main__: Batch 280/520 | loss=0.423415 elapsed=3331.9s
2025-10-26 11:22:34,965 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:22:35,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.28GB
2025-10-26 11:22:35,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.28GB
2025-10-26 11:22:35,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:22:35,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.28GB
2025-10-26 11:22:36,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:22:36,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:22:36,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.28GB
2025-10-26 11:22:36,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.28GB
2025-10-26 11:22:37,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:22:37,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:22:37,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:22:37,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.28GB
2025-10-26 11:22:39,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=-0.02GB
2025-10-26 11:22:39,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 11:22:46,813 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:22:47,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:22:47,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:22:47,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:22:47,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:22:47,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:22:48,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:22:48,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:22:48,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:22:49,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:22:49,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:22:49,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:22:49,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:22:51,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.80GB
2025-10-26 11:22:51,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 11:22:58,781 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:22:58,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:22:59,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:22:59,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:22:59,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:22:59,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:00,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:00,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:23:00,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:23:00,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:01,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:01,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:01,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:23:03,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.80GB
2025-10-26 11:23:03,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:23:10,662 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:23:10,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:23:11,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:23:11,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:11,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:23:11,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:12,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:12,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:23:12,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:23:12,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:12,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:13,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:13,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:23:14,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.80GB
2025-10-26 11:23:15,133 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:23:22,563 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:23:22,757 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:23:23,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:23:23,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:23,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:23:23,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:24,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:24,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:23:24,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:23:24,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:24,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:25,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:25,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:23:26,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.64GB Delta_CPU=+0.00GB
2025-10-26 11:23:27,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.64GB
2025-10-26 11:23:34,712 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:23:34,903 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:23:35,239 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:23:35,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:35,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:23:35,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:36,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:23:36,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:23:36,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:23:36,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:37,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:37,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:23:37,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:23:38,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.17GB Delta_CPU=+0.53GB
2025-10-26 11:23:39,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.17GB
2025-10-26 11:23:46,465 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:23:46,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:23:46,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:23:47,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:23:47,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:23:47,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:23:48,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:23:48,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:23:48,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:23:48,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:23:48,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:23:49,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:23:49,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:23:50,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=-0.04GB
2025-10-26 11:23:50,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 11:23:58,191 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:23:58,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 11:23:58,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 11:23:58,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:23:59,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 11:23:59,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:23:59,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:23:59,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 11:24:00,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 11:24:00,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:24:00,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:24:00,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:24:00,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 11:24:02,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.94GB Delta_CPU=+0.00GB
2025-10-26 11:24:02,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.94GB
2025-10-26 11:24:10,172 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:24:10,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:24:10,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:24:10,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:11,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:24:11,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:11,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:11,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:24:12,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:24:12,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:12,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:12,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:12,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:24:14,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.89GB
2025-10-26 11:24:14,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:24:21,864 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:24:22,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:24:22,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:24:22,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:22,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:24:23,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:23,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:23,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:24:23,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:24:24,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:24,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:24,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:24:24,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:24:26,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.80GB
2025-10-26 11:24:26,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 11:24:33,793 INFO __main__: Batch 290/520 | loss=0.710823 elapsed=3450.8s
2025-10-26 11:24:33,796 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:24:33,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:24:34,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:24:34,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:24:34,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:24:34,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:24:35,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:24:35,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:24:35,791 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:24:35,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:24:36,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:24:36,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:24:36,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:24:38,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=+0.79GB
2025-10-26 11:24:38,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 11:24:45,812 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:24:46,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 11:24:46,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 11:24:46,551 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:24:46,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 11:24:46,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:24:47,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:24:47,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 11:24:47,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 11:24:47,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:24:48,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:24:48,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:24:48,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 11:24:50,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.80GB
2025-10-26 11:24:50,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 11:24:57,893 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:24:58,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:24:58,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:24:58,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:58,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:24:59,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:59,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:24:59,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:24:59,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:25:00,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:25:00,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:25:00,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:25:00,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:25:02,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.77GB Delta_CPU=+0.03GB
2025-10-26 11:25:02,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.77GB
2025-10-26 11:25:10,041 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:25:10,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:25:10,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:25:10,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:25:10,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:25:11,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:25:11,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:25:11,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:25:12,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:25:12,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:25:12,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:25:12,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:25:12,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:25:14,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.21GB Delta_CPU=+0.57GB
2025-10-26 11:25:14,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.21GB
2025-10-26 11:25:21,881 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:25:22,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.21GB
2025-10-26 11:25:22,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.21GB
2025-10-26 11:25:22,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:25:22,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.21GB
2025-10-26 11:25:23,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:25:23,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.21GB
2025-10-26 11:25:23,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.21GB
2025-10-26 11:25:23,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.21GB
2025-10-26 11:25:24,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:25:24,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:25:24,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.21GB
2025-10-26 11:25:24,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.21GB
2025-10-26 11:25:26,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.97GB Delta_CPU=+0.75GB
2025-10-26 11:25:26,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.97GB
2025-10-26 11:25:33,745 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:25:33,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:25:34,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:25:34,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:25:34,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:25:34,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:25:35,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:25:35,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:25:35,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:25:35,941 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:25:36,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:25:36,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:25:36,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:25:37,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.09GB Delta_CPU=+0.92GB
2025-10-26 11:25:38,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.09GB
2025-10-26 11:25:45,338 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:25:45,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.19GB
2025-10-26 11:25:45,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.19GB
2025-10-26 11:25:46,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:25:46,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.19GB
2025-10-26 11:25:46,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:25:46,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 11:25:47,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.19GB
2025-10-26 11:25:47,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.19GB
2025-10-26 11:25:47,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:25:47,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:25:47,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 11:25:47,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.19GB
2025-10-26 11:25:49,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=+0.32GB
2025-10-26 11:25:49,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 11:25:57,172 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:25:57,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.18GB
2025-10-26 11:25:57,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.18GB
2025-10-26 11:25:57,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:25:58,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.18GB
2025-10-26 11:25:58,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:25:58,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:25:58,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.18GB
2025-10-26 11:25:59,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.18GB
2025-10-26 11:25:59,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:25:59,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:25:59,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:25:59,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.18GB
2025-10-26 11:26:01,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.18GB Delta_CPU=+0.00GB
2025-10-26 11:26:01,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.18GB
2025-10-26 11:26:09,055 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:26:09,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.18GB
2025-10-26 11:26:09,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.18GB
2025-10-26 11:26:09,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:26:10,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.18GB
2025-10-26 11:26:10,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:26:10,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:26:10,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.18GB
2025-10-26 11:26:11,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.18GB
2025-10-26 11:26:11,277 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:26:11,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:26:11,659 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:26:11,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.18GB
2025-10-26 11:26:13,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.66GB
2025-10-26 11:26:13,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:26:21,090 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:26:21,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.84GB
2025-10-26 11:26:21,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.84GB
2025-10-26 11:26:21,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:22,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.84GB
2025-10-26 11:26:22,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:22,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:22,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.84GB
2025-10-26 11:26:23,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.84GB
2025-10-26 11:26:23,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:23,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:23,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:23,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.84GB
2025-10-26 11:26:25,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.64GB Delta_CPU=+0.80GB
2025-10-26 11:26:25,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.64GB
2025-10-26 11:26:32,891 INFO __main__: Batch 300/520 | loss=1.143653 elapsed=3569.9s
2025-10-26 11:26:32,894 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:26:33,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.84GB
2025-10-26 11:26:33,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.84GB
2025-10-26 11:26:33,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:33,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.84GB
2025-10-26 11:26:34,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:34,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.84GB
2025-10-26 11:26:34,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.84GB
2025-10-26 11:26:34,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.84GB
2025-10-26 11:26:35,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:35,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:35,403 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.84GB
2025-10-26 11:26:35,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.84GB
2025-10-26 11:26:37,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.59GB Delta_CPU=+0.75GB
2025-10-26 11:26:37,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.59GB
2025-10-26 11:26:44,566 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:26:44,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.80GB
2025-10-26 11:26:45,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.80GB
2025-10-26 11:26:45,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 11:26:45,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.80GB
2025-10-26 11:26:45,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 11:26:46,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.80GB
2025-10-26 11:26:46,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.80GB
2025-10-26 11:26:46,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.80GB
2025-10-26 11:26:46,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 11:26:46,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 11:26:47,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.80GB
2025-10-26 11:26:47,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.80GB
2025-10-26 11:26:48,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.58GB Delta_CPU=+0.78GB
2025-10-26 11:26:48,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.58GB
2025-10-26 11:26:56,383 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:26:56,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.36GB
2025-10-26 11:26:56,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.36GB
2025-10-26 11:26:57,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 11:26:57,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.36GB
2025-10-26 11:26:57,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 11:26:57,976 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.36GB
2025-10-26 11:26:58,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.36GB
2025-10-26 11:26:58,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.36GB
2025-10-26 11:26:58,546 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 11:26:58,740 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 11:26:58,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.36GB
2025-10-26 11:26:58,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.36GB
2025-10-26 11:27:00,630 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.18GB Delta_CPU=+0.82GB
2025-10-26 11:27:00,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.18GB
2025-10-26 11:27:08,178 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:27:08,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.38GB
2025-10-26 11:27:08,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.38GB
2025-10-26 11:27:08,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:27:09,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.38GB
2025-10-26 11:27:09,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:27:09,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.38GB
2025-10-26 11:27:09,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.38GB
2025-10-26 11:27:10,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.38GB
2025-10-26 11:27:10,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:27:10,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:27:10,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.38GB
2025-10-26 11:27:10,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.38GB
2025-10-26 11:27:12,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.20GB Delta_CPU=+0.81GB
2025-10-26 11:27:12,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.20GB
2025-10-26 11:27:19,913 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:27:20,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 11:27:20,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 11:27:20,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:20,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 11:27:21,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:21,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:21,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 11:27:21,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 11:27:22,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:22,278 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:22,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:22,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 11:27:24,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.80GB
2025-10-26 11:27:24,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 11:27:32,025 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:27:32,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 11:27:32,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 11:27:32,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:32,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 11:27:33,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:33,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:27:33,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 11:27:34,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 11:27:34,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:34,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:34,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:27:34,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 11:27:36,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.79GB
2025-10-26 11:27:36,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 11:27:43,783 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:27:43,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 11:27:44,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 11:27:44,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:27:44,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 11:27:44,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:27:45,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:27:45,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 11:27:45,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 11:27:45,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:27:46,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:27:46,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:27:46,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 11:27:48,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.08GB Delta_CPU=+0.82GB
2025-10-26 11:27:48,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.08GB
2025-10-26 11:27:55,853 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:27:56,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.28GB
2025-10-26 11:27:56,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.28GB
2025-10-26 11:27:56,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:27:56,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.28GB
2025-10-26 11:27:57,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:27:57,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.28GB
2025-10-26 11:27:57,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.28GB
2025-10-26 11:27:57,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.28GB
2025-10-26 11:27:58,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:27:58,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:27:58,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.28GB
2025-10-26 11:27:58,420 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.28GB
2025-10-26 11:28:00,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.04GB Delta_CPU=+0.77GB
2025-10-26 11:28:00,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.04GB
2025-10-26 11:28:07,567 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:28:07,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 11:28:08,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 11:28:08,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:28:08,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 11:28:08,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:28:09,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 11:28:09,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 11:28:09,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 11:28:09,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:28:09,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:28:10,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 11:28:10,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 11:28:11,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.78GB
2025-10-26 11:28:12,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 11:28:19,521 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:28:19,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 11:28:20,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 11:28:20,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:28:20,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 11:28:20,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:28:21,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 11:28:21,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 11:28:21,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 11:28:21,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:28:21,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:28:22,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 11:28:22,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 11:28:23,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.02GB Delta_CPU=+0.78GB
2025-10-26 11:28:24,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.02GB
2025-10-26 11:28:31,389 INFO __main__: Batch 310/520 | loss=1.212520 elapsed=3688.4s
2025-10-26 11:28:31,392 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:28:31,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 11:28:31,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 11:28:32,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:28:32,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 11:28:32,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:28:32,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:28:33,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 11:28:33,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 11:28:33,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:28:33,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:28:33,923 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:28:33,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 11:28:35,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.98GB Delta_CPU=+0.76GB
2025-10-26 11:28:35,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.98GB
2025-10-26 11:28:42,908 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:28:43,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.18GB
2025-10-26 11:28:43,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.18GB
2025-10-26 11:28:43,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:28:43,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.18GB
2025-10-26 11:28:44,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:28:44,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.18GB
2025-10-26 11:28:44,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.18GB
2025-10-26 11:28:44,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.18GB
2025-10-26 11:28:45,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:28:45,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:28:45,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.18GB
2025-10-26 11:28:45,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.18GB
2025-10-26 11:28:47,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.97GB Delta_CPU=+0.79GB
2025-10-26 11:28:47,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.97GB
2025-10-26 11:28:54,808 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:28:55,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:28:55,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:28:55,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:28:55,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:28:55,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:28:56,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:28:56,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:28:56,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:28:56,957 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:28:57,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:28:57,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:28:57,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:28:59,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.00GB Delta_CPU=+0.82GB
2025-10-26 11:28:59,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.00GB
2025-10-26 11:29:06,464 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:29:06,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.20GB
2025-10-26 11:29:06,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.20GB
2025-10-26 11:29:07,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:29:07,399 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.20GB
2025-10-26 11:29:07,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:29:08,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.20GB
2025-10-26 11:29:08,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.20GB
2025-10-26 11:29:08,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.20GB
2025-10-26 11:29:08,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:29:08,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:29:08,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.20GB
2025-10-26 11:29:08,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.20GB
2025-10-26 11:29:10,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.17GB Delta_CPU=-0.03GB
2025-10-26 11:29:10,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.17GB
2025-10-26 11:29:18,288 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:29:18,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:29:18,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:29:19,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:29:19,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:29:19,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:29:19,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:29:20,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:29:20,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:29:20,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:29:20,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:29:21,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:29:21,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:29:22,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.16GB Delta_CPU=-0.00GB
2025-10-26 11:29:23,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.16GB
2025-10-26 11:29:30,480 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:29:30,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.16GB
2025-10-26 11:29:30,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.16GB
2025-10-26 11:29:31,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:31,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.16GB
2025-10-26 11:29:31,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:32,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:32,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.16GB
2025-10-26 11:29:32,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.16GB
2025-10-26 11:29:32,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:32,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:32,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:32,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.16GB
2025-10-26 11:29:34,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.16GB Delta_CPU=-0.01GB
2025-10-26 11:29:34,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.16GB
2025-10-26 11:29:42,374 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:29:42,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.16GB
2025-10-26 11:29:42,891 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.16GB
2025-10-26 11:29:43,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:43,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.16GB
2025-10-26 11:29:43,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:43,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:29:44,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.16GB
2025-10-26 11:29:44,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.16GB
2025-10-26 11:29:44,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:44,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:44,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:29:44,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.16GB
2025-10-26 11:29:46,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.15GB Delta_CPU=-0.01GB
2025-10-26 11:29:46,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.15GB
2025-10-26 11:29:54,142 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:29:54,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.15GB
2025-10-26 11:29:54,682 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.15GB
2025-10-26 11:29:54,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:29:55,080 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.15GB
2025-10-26 11:29:55,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:29:55,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:29:55,917 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.15GB
2025-10-26 11:29:56,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.15GB
2025-10-26 11:29:56,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:29:56,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:29:56,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:29:56,669 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.15GB
2025-10-26 11:29:58,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.14GB Delta_CPU=-0.01GB
2025-10-26 11:29:58,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.14GB
2025-10-26 11:30:06,042 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:30:06,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.14GB
2025-10-26 11:30:06,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.14GB
2025-10-26 11:30:06,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:30:06,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.14GB
2025-10-26 11:30:07,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:30:07,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.14GB
2025-10-26 11:30:07,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.14GB
2025-10-26 11:30:07,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.14GB
2025-10-26 11:30:08,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:30:08,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:30:08,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.14GB
2025-10-26 11:30:08,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.14GB
2025-10-26 11:30:10,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.97GB Delta_CPU=+0.82GB
2025-10-26 11:30:10,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.97GB
2025-10-26 11:30:17,839 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:30:18,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.17GB
2025-10-26 11:30:18,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.17GB
2025-10-26 11:30:18,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:30:18,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.17GB
2025-10-26 11:30:18,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:30:19,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.17GB
2025-10-26 11:30:19,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.17GB
2025-10-26 11:30:19,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.17GB
2025-10-26 11:30:19,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:30:20,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:30:20,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.17GB
2025-10-26 11:30:20,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.17GB
2025-10-26 11:30:22,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.96GB Delta_CPU=+0.79GB
2025-10-26 11:30:22,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.96GB
2025-10-26 11:30:29,791 INFO __main__: Batch 320/520 | loss=0.776721 elapsed=3806.8s
2025-10-26 11:30:29,793 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:30:29,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.16GB
2025-10-26 11:30:30,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.16GB
2025-10-26 11:30:30,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:30:30,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.16GB
2025-10-26 11:30:30,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:30:31,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.16GB
2025-10-26 11:30:31,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.16GB
2025-10-26 11:30:31,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.16GB
2025-10-26 11:30:31,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:30:32,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:30:32,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.16GB
2025-10-26 11:30:32,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.16GB
2025-10-26 11:30:34,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.91GB Delta_CPU=+0.75GB
2025-10-26 11:30:34,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.91GB
2025-10-26 11:30:41,632 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:30:41,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:30:42,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:30:42,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:30:42,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:30:42,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:30:43,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:30:43,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:30:43,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:30:43,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:30:44,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:30:44,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:30:44,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:30:45,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.83GB
2025-10-26 11:30:46,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:30:53,392 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:30:53,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:30:53,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:30:54,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:30:54,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:30:54,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:30:54,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:30:55,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:30:55,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:30:55,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:30:55,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:30:55,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:30:55,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:30:57,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.80GB
2025-10-26 11:30:57,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:31:05,052 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:31:05,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:31:05,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:31:05,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:05,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:31:06,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:06,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:06,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:31:07,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:31:07,229 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:07,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:07,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:07,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:31:09,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.01GB Delta_CPU=-0.03GB
2025-10-26 11:31:09,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.01GB
2025-10-26 11:31:16,919 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:31:17,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:31:17,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:31:17,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:17,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:31:18,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:18,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:18,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:31:18,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:31:19,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:19,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:19,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:19,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:31:21,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.01GB Delta_CPU=+0.00GB
2025-10-26 11:31:21,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.01GB
2025-10-26 11:31:28,824 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:31:29,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:31:29,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:31:29,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:29,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:31:29,951 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:30,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:30,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:31:30,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:31:30,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:31,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:31,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:31,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:31:33,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.81GB Delta_CPU=+0.80GB
2025-10-26 11:31:33,247 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.81GB
2025-10-26 11:31:40,861 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:31:41,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:31:41,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:31:41,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:41,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:31:42,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:42,502 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:31:42,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:31:42,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:31:43,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:43,287 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:43,478 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:31:43,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:31:45,187 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.83GB
2025-10-26 11:31:45,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:31:52,569 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:31:52,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:31:53,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:31:53,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:53,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:31:53,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:54,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:31:54,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:31:54,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:31:54,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:54,924 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:55,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:31:55,115 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:31:56,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.01GB Delta_CPU=-0.03GB
2025-10-26 11:31:57,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.01GB
2025-10-26 11:32:04,540 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:32:04,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:32:05,075 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:32:05,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:05,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:32:05,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:06,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:06,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:32:06,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:32:06,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:06,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:07,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:07,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:32:08,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.01GB Delta_CPU=+0.00GB
2025-10-26 11:32:09,066 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.01GB
2025-10-26 11:32:16,383 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:32:16,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:32:16,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:32:17,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:17,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:32:17,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:17,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:32:18,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:32:18,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:32:18,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:18,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:18,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:32:18,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:32:20,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.06GB Delta_CPU=+0.04GB
2025-10-26 11:32:20,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.06GB
2025-10-26 11:32:28,700 INFO __main__: Batch 330/520 | loss=0.686137 elapsed=3925.7s
2025-10-26 11:32:28,705 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:32:28,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.06GB
2025-10-26 11:32:29,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.06GB
2025-10-26 11:32:29,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:32:29,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.06GB
2025-10-26 11:32:29,982 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:32:30,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:32:30,705 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.06GB
2025-10-26 11:32:30,921 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.06GB
2025-10-26 11:32:31,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:32:31,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:32:31,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:32:31,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.06GB
2025-10-26 11:32:33,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.04GB Delta_CPU=-0.02GB
2025-10-26 11:32:33,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.04GB
2025-10-26 11:32:41,194 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:32:41,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:32:41,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:32:41,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:32:42,163 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:32:42,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:32:42,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:32:43,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:32:43,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:32:43,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:32:43,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:32:43,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:32:43,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:32:45,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.76GB
2025-10-26 11:32:45,710 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 11:32:52,977 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:32:53,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 11:32:53,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 11:32:53,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:32:53,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 11:32:54,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:32:54,543 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:32:54,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 11:32:54,936 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 11:32:55,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:32:55,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:32:55,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:32:55,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 11:32:57,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+0.79GB
2025-10-26 11:32:57,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 11:33:04,694 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:33:04,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.00GB
2025-10-26 11:33:05,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.00GB
2025-10-26 11:33:05,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:33:05,623 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.00GB
2025-10-26 11:33:05,826 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:33:06,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.00GB
2025-10-26 11:33:06,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.00GB
2025-10-26 11:33:06,654 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.00GB
2025-10-26 11:33:06,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:33:07,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:33:07,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.00GB
2025-10-26 11:33:07,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.00GB
2025-10-26 11:33:08,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+0.79GB
2025-10-26 11:33:09,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 11:33:16,332 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:33:16,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.99GB
2025-10-26 11:33:16,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.99GB
2025-10-26 11:33:17,078 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:33:17,287 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.99GB
2025-10-26 11:33:17,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:33:17,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:33:18,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.99GB
2025-10-26 11:33:18,350 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.99GB
2025-10-26 11:33:18,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:33:18,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:33:18,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:33:18,939 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.99GB
2025-10-26 11:33:20,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.79GB
2025-10-26 11:33:20,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 11:33:28,284 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:33:28,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.98GB
2025-10-26 11:33:28,806 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.98GB
2025-10-26 11:33:29,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:33:29,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.98GB
2025-10-26 11:33:29,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:33:29,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:33:30,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.98GB
2025-10-26 11:33:30,223 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.98GB
2025-10-26 11:33:30,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:33:30,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:33:30,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:33:30,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.98GB
2025-10-26 11:33:32,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.77GB Delta_CPU=+0.79GB
2025-10-26 11:33:32,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.77GB
2025-10-26 11:33:40,083 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:33:40,279 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 11:33:40,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 11:33:40,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:33:41,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 11:33:41,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:33:41,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:33:41,918 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 11:33:42,125 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 11:33:42,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:33:42,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:33:42,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:33:42,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 11:33:44,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.75GB Delta_CPU=+0.78GB
2025-10-26 11:33:44,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.75GB
2025-10-26 11:33:51,997 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:33:52,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 11:33:52,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 11:33:52,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:33:52,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 11:33:53,132 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:33:53,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:33:53,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 11:33:53,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 11:33:54,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:33:54,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:33:54,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:33:54,516 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 11:33:56,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.77GB Delta_CPU=+0.81GB
2025-10-26 11:33:56,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.77GB
2025-10-26 11:34:03,879 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:34:04,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:34:04,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:34:04,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:04,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:34:04,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:05,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:05,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:34:05,816 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:34:05,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:06,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:06,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:06,377 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:34:08,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.80GB
2025-10-26 11:34:08,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 11:34:15,596 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:34:15,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:34:16,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:34:16,322 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:16,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:34:16,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:17,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:34:17,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:34:17,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:34:17,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:17,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:18,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:34:18,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:34:19,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.83GB
2025-10-26 11:34:20,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:34:27,415 INFO __main__: Batch 340/520 | loss=2.562441 elapsed=4044.4s
2025-10-26 11:34:27,419 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:34:27,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:34:27,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:34:28,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:28,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:34:28,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:29,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:29,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:34:29,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:34:29,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:29,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:29,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:29,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:34:31,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.80GB
2025-10-26 11:34:31,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:34:39,461 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:34:39,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.77GB
2025-10-26 11:34:39,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.77GB
2025-10-26 11:34:40,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:40,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.77GB
2025-10-26 11:34:40,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:41,020 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.77GB
2025-10-26 11:34:41,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.77GB
2025-10-26 11:34:41,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.77GB
2025-10-26 11:34:41,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:41,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:42,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.77GB
2025-10-26 11:34:42,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.77GB
2025-10-26 11:34:43,716 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.55GB Delta_CPU=+0.78GB
2025-10-26 11:34:43,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.55GB
2025-10-26 11:34:51,200 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:34:51,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:34:51,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:34:51,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:34:52,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:34:52,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:34:52,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:34:52,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:34:53,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:34:53,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:34:53,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:34:53,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:34:53,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:34:55,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+1.04GB
2025-10-26 11:34:55,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 11:35:02,950 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:35:03,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.88GB
2025-10-26 11:35:03,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.88GB
2025-10-26 11:35:03,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:35:03,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.88GB
2025-10-26 11:35:04,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:35:04,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:35:04,700 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.88GB
2025-10-26 11:35:04,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.88GB
2025-10-26 11:35:05,054 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:35:05,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:35:05,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:35:05,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.88GB
2025-10-26 11:35:07,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.88GB Delta_CPU=-0.01GB
2025-10-26 11:35:07,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.88GB
2025-10-26 11:35:14,995 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:35:15,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:35:15,511 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:35:15,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:15,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:35:16,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:16,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:16,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:35:16,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:35:17,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:17,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:17,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:17,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:35:19,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=+0.39GB
2025-10-26 11:35:19,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 11:35:26,690 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:35:26,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.94GB
2025-10-26 11:35:27,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.94GB
2025-10-26 11:35:27,435 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:35:27,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.94GB
2025-10-26 11:35:27,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:35:28,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.94GB
2025-10-26 11:35:28,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.94GB
2025-10-26 11:35:28,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.94GB
2025-10-26 11:35:28,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:35:29,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:35:29,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.94GB
2025-10-26 11:35:29,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.94GB
2025-10-26 11:35:31,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.73GB Delta_CPU=+0.80GB
2025-10-26 11:35:31,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.73GB
2025-10-26 11:35:39,066 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:35:39,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:35:39,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:35:39,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:39,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:35:40,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:40,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:35:40,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:35:41,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:35:41,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:41,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:41,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:35:41,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:35:43,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.83GB
2025-10-26 11:35:43,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:35:50,523 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:35:50,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:35:51,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:35:51,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:35:51,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:35:51,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:35:52,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:35:52,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:35:52,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:35:52,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:35:52,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:35:53,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:35:53,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:35:54,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.67GB Delta_CPU=+0.03GB
2025-10-26 11:35:55,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.67GB
2025-10-26 11:36:02,374 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:36:02,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:36:02,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:36:03,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:03,293 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:36:03,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:03,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:04,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:36:04,312 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:36:04,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:04,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:04,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:04,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:36:06,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.67GB Delta_CPU=+0.00GB
2025-10-26 11:36:06,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.67GB
2025-10-26 11:36:14,043 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:36:14,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:36:14,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:36:14,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:14,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:36:15,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:15,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:15,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:36:15,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:36:16,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:16,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:16,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:16,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:36:18,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.77GB
2025-10-26 11:36:18,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:36:25,914 INFO __main__: Batch 350/520 | loss=1.046408 elapsed=4162.9s
2025-10-26 11:36:25,916 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:36:26,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:36:26,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:36:26,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:36:26,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:36:27,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:36:27,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:36:27,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:36:27,892 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:36:28,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:36:28,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:36:28,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:36:28,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:36:30,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.83GB
2025-10-26 11:36:30,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:36:37,664 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:36:37,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:36:38,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:36:38,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:38,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:36:38,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:39,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:36:39,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:36:39,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:36:39,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:39,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:40,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:36:40,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:36:41,936 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=+0.79GB
2025-10-26 11:36:42,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 11:36:49,565 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:36:49,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.46GB
2025-10-26 11:36:50,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.46GB
2025-10-26 11:36:50,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 11:36:50,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.46GB
2025-10-26 11:36:50,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 11:36:51,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.46GB
2025-10-26 11:36:51,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.46GB
2025-10-26 11:36:51,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.46GB
2025-10-26 11:36:51,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 11:36:51,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 11:36:52,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.46GB
2025-10-26 11:36:52,120 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.46GB
2025-10-26 11:36:53,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=-0.03GB
2025-10-26 11:36:54,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 11:37:01,822 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:37:02,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.74GB
2025-10-26 11:37:02,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.74GB
2025-10-26 11:37:02,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:37:02,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.74GB
2025-10-26 11:37:02,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:37:03,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.74GB
2025-10-26 11:37:03,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.74GB
2025-10-26 11:37:03,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.74GB
2025-10-26 11:37:04,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:37:04,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:37:04,389 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.74GB
2025-10-26 11:37:04,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.74GB
2025-10-26 11:37:06,133 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.80GB
2025-10-26 11:37:06,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 11:37:13,676 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:37:13,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:37:14,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:37:14,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:37:14,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:37:14,806 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:37:15,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:37:15,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:37:15,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:37:15,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:37:16,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:37:16,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:37:16,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:37:17,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=+0.92GB
2025-10-26 11:37:18,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 11:37:25,446 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:37:25,640 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 11:37:25,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 11:37:26,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:37:26,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 11:37:26,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:37:27,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:37:27,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 11:37:27,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 11:37:27,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:37:27,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:37:27,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:37:27,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 11:37:29,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=+0.75GB
2025-10-26 11:37:29,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 11:37:37,389 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:37:37,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.71GB
2025-10-26 11:37:37,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.71GB
2025-10-26 11:37:38,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:38,312 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.71GB
2025-10-26 11:37:38,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:38,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:39,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.71GB
2025-10-26 11:37:39,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.71GB
2025-10-26 11:37:39,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:39,698 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:39,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:39,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.71GB
2025-10-26 11:37:41,642 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=+0.79GB
2025-10-26 11:37:41,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 11:37:49,253 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:37:49,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.71GB
2025-10-26 11:37:49,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.71GB
2025-10-26 11:37:49,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:50,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.71GB
2025-10-26 11:37:50,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:50,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:37:51,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.71GB
2025-10-26 11:37:51,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.71GB
2025-10-26 11:37:51,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:51,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:51,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:37:51,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.71GB
2025-10-26 11:37:53,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.71GB Delta_CPU=-0.00GB
2025-10-26 11:37:53,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.71GB
2025-10-26 11:38:00,947 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:38:01,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.71GB
2025-10-26 11:38:01,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.71GB
2025-10-26 11:38:01,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:38:01,875 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.71GB
2025-10-26 11:38:02,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:38:02,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.71GB
2025-10-26 11:38:02,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.71GB
2025-10-26 11:38:02,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.71GB
2025-10-26 11:38:03,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:38:03,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:38:03,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.71GB
2025-10-26 11:38:03,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.71GB
2025-10-26 11:38:05,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.91GB Delta_CPU=+0.20GB
2025-10-26 11:38:05,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.91GB
2025-10-26 11:38:12,932 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:38:13,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.91GB
2025-10-26 11:38:13,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.91GB
2025-10-26 11:38:13,650 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:38:13,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.91GB
2025-10-26 11:38:14,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:38:14,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:38:14,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.91GB
2025-10-26 11:38:14,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.91GB
2025-10-26 11:38:15,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:38:15,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:38:15,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:38:15,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.91GB
2025-10-26 11:38:17,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=+0.54GB
2025-10-26 11:38:17,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 11:38:24,463 INFO __main__: Batch 360/520 | loss=0.572822 elapsed=4281.4s
2025-10-26 11:38:24,467 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:38:24,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 11:38:24,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 11:38:25,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:38:25,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 11:38:25,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:38:26,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 11:38:26,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 11:38:26,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 11:38:26,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:38:26,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:38:27,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 11:38:27,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 11:38:28,805 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.26GB Delta_CPU=+0.00GB
2025-10-26 11:38:29,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.26GB
2025-10-26 11:38:36,449 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:38:36,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 11:38:36,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 11:38:37,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:38:37,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 11:38:37,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:38:38,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:38:38,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 11:38:38,424 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 11:38:38,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:38:38,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:38:39,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:38:39,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 11:38:40,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.79GB
2025-10-26 11:38:40,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 11:38:48,544 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:38:48,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:38:49,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:38:49,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:38:49,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:38:49,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:38:50,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:38:50,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:38:50,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:38:50,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:38:50,875 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:38:51,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:38:51,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:38:52,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.84GB Delta_CPU=+0.00GB
2025-10-26 11:38:53,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.84GB
2025-10-26 11:39:00,219 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:00,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:39:00,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:39:00,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:39:01,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:39:01,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:39:01,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:39:02,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:39:02,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:39:02,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:39:02,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:39:02,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:39:02,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:39:04,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.87GB Delta_CPU=+0.03GB
2025-10-26 11:39:04,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.87GB
2025-10-26 11:39:12,015 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:12,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:39:12,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:39:12,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:39:12,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:39:13,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:39:13,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:39:13,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:39:14,014 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:39:14,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:39:14,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:39:14,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:39:14,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:39:16,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.62GB Delta_CPU=+0.76GB
2025-10-26 11:39:16,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.62GB
2025-10-26 11:39:23,731 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:23,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.56GB
2025-10-26 11:39:24,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.56GB
2025-10-26 11:39:24,468 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:24,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.56GB
2025-10-26 11:39:24,878 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:25,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:25,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.56GB
2025-10-26 11:39:25,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.56GB
2025-10-26 11:39:25,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:26,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:26,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:26,278 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.56GB
2025-10-26 11:39:27,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=+0.00GB
2025-10-26 11:39:28,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 11:39:35,401 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:35,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.56GB
2025-10-26 11:39:35,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.56GB
2025-10-26 11:39:36,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:36,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.56GB
2025-10-26 11:39:36,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:37,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 11:39:37,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.56GB
2025-10-26 11:39:37,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.56GB
2025-10-26 11:39:37,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:37,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:37,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 11:39:37,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.56GB
2025-10-26 11:39:39,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.40GB Delta_CPU=+0.84GB
2025-10-26 11:39:39,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.40GB
2025-10-26 11:39:47,115 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:47,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.60GB
2025-10-26 11:39:47,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.60GB
2025-10-26 11:39:47,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 11:39:48,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.60GB
2025-10-26 11:39:48,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 11:39:48,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 11:39:48,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.60GB
2025-10-26 11:39:49,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.60GB
2025-10-26 11:39:49,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 11:39:49,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 11:39:49,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 11:39:49,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.60GB
2025-10-26 11:39:51,332 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.35GB Delta_CPU=+0.75GB
2025-10-26 11:39:51,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.35GB
2025-10-26 11:39:59,055 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:39:59,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:39:59,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:39:59,766 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:39:59,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:40:00,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:00,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:00,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:40:01,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:40:01,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:01,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:01,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:01,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:40:03,364 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.87GB Delta_CPU=+0.03GB
2025-10-26 11:40:03,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.87GB
2025-10-26 11:40:11,008 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:40:11,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:40:11,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:40:11,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:11,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:40:12,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:12,623 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:12,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:40:13,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:40:13,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:13,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:13,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:13,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:40:15,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.87GB Delta_CPU=+0.00GB
2025-10-26 11:40:15,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.87GB
2025-10-26 11:40:22,712 INFO __main__: Batch 370/520 | loss=0.994885 elapsed=4399.7s
2025-10-26 11:40:22,717 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:40:22,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:40:23,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:40:23,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:23,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:40:23,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:24,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:40:24,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:40:24,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:40:24,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:25,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:25,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:40:25,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:40:27,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.77GB
2025-10-26 11:40:27,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:40:34,684 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:40:34,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:40:35,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:40:35,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:35,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:40:35,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:36,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:36,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:40:36,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:40:36,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:37,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:37,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:37,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:40:38,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.80GB
2025-10-26 11:40:39,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:40:46,359 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:40:46,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.84GB
2025-10-26 11:40:46,882 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.84GB
2025-10-26 11:40:47,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:47,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.84GB
2025-10-26 11:40:47,488 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:47,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.84GB
2025-10-26 11:40:48,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.84GB
2025-10-26 11:40:48,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.84GB
2025-10-26 11:40:48,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:48,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:48,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.84GB
2025-10-26 11:40:48,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.84GB
2025-10-26 11:40:50,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.84GB Delta_CPU=+0.00GB
2025-10-26 11:40:50,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.84GB
2025-10-26 11:40:58,191 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:40:58,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:40:58,706 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:40:58,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:40:59,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:40:59,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:40:59,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:40:59,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:41:00,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:41:00,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:41:00,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:41:00,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:41:00,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:41:02,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.67GB Delta_CPU=+0.03GB
2025-10-26 11:41:02,775 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.67GB
2025-10-26 11:41:10,265 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:41:10,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:41:10,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:41:10,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:11,207 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:41:11,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:11,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:12,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:41:12,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:41:12,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:12,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:12,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:12,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:41:14,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+0.83GB
2025-10-26 11:41:14,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 11:41:22,300 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:41:22,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 11:41:22,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 11:41:23,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:41:23,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 11:41:23,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:41:23,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:41:24,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 11:41:24,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 11:41:24,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:41:24,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:41:24,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:41:24,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 11:41:26,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.77GB
2025-10-26 11:41:26,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:41:34,178 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:41:34,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:41:34,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:41:34,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:35,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:41:35,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:35,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:41:35,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:41:36,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:41:36,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:36,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:36,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:41:36,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:41:38,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.09GB Delta_CPU=+0.42GB
2025-10-26 11:41:38,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.09GB
2025-10-26 11:41:46,475 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:41:46,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:41:46,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:41:47,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:41:47,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:41:47,605 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:41:48,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:41:48,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:41:48,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:41:48,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:41:48,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:41:48,990 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:41:48,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:41:50,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.06GB Delta_CPU=-0.04GB
2025-10-26 11:41:50,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.06GB
2025-10-26 11:41:58,242 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:41:58,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.06GB
2025-10-26 11:41:58,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.06GB
2025-10-26 11:41:58,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:41:59,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.06GB
2025-10-26 11:41:59,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:41:59,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.06GB
2025-10-26 11:42:00,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.06GB
2025-10-26 11:42:00,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.06GB
2025-10-26 11:42:00,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:42:00,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:42:00,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.06GB
2025-10-26 11:42:00,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.06GB
2025-10-26 11:42:02,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.79GB
2025-10-26 11:42:02,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:42:10,163 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:42:10,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 11:42:10,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 11:42:10,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:42:11,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 11:42:11,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:42:11,735 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:42:11,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 11:42:12,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 11:42:12,297 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:42:12,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:42:12,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:42:12,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 11:42:14,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.79GB
2025-10-26 11:42:14,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 11:42:22,037 INFO __main__: Batch 380/520 | loss=0.661038 elapsed=4519.0s
2025-10-26 11:42:22,039 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:42:22,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:42:22,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:42:22,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:22,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:42:23,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:23,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:23,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:42:24,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:42:24,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:24,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:24,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:24,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:42:26,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.64GB Delta_CPU=+0.00GB
2025-10-26 11:42:26,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.64GB
2025-10-26 11:42:33,804 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:42:33,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:42:34,324 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:42:34,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:34,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:42:34,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:35,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:35,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:42:35,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:42:35,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:36,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:36,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:36,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:42:38,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.83GB
2025-10-26 11:42:38,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:42:45,823 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:42:46,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:42:46,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:42:46,534 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:42:46,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:42:46,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:42:47,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:42:47,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:42:47,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:42:47,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:42:48,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:42:48,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:42:48,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:42:50,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.77GB
2025-10-26 11:42:50,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 11:42:57,642 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:42:57,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:42:58,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:42:58,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:58,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:42:58,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:59,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:42:59,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:42:59,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:42:59,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:42:59,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:43:00,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:43:00,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:43:01,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=+0.79GB
2025-10-26 11:43:02,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 11:43:09,453 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:43:09,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.53GB
2025-10-26 11:43:09,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.53GB
2025-10-26 11:43:10,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 11:43:10,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.53GB
2025-10-26 11:43:10,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 11:43:11,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.53GB
2025-10-26 11:43:11,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.53GB
2025-10-26 11:43:11,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.53GB
2025-10-26 11:43:11,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 11:43:11,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 11:43:11,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.53GB
2025-10-26 11:43:11,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.53GB
2025-10-26 11:43:13,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.35GB Delta_CPU=+0.83GB
2025-10-26 11:43:13,961 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.35GB
2025-10-26 11:43:21,550 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:43:21,744 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.56GB
2025-10-26 11:43:22,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.56GB
2025-10-26 11:43:22,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:43:22,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.56GB
2025-10-26 11:43:22,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:43:23,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:43:23,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.56GB
2025-10-26 11:43:23,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.56GB
2025-10-26 11:43:23,734 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:43:23,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:43:24,121 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:43:24,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.56GB
2025-10-26 11:43:25,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=+0.78GB
2025-10-26 11:43:26,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 11:43:33,416 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:43:33,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.30GB
2025-10-26 11:43:33,935 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.30GB
2025-10-26 11:43:34,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.30GB
2025-10-26 11:43:34,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.30GB
2025-10-26 11:43:34,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.30GB
2025-10-26 11:43:34,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.30GB
2025-10-26 11:43:35,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.30GB
2025-10-26 11:43:35,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.30GB
2025-10-26 11:43:35,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.30GB
2025-10-26 11:43:35,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.30GB
2025-10-26 11:43:35,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.30GB
2025-10-26 11:43:35,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.30GB
2025-10-26 11:43:37,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.13GB Delta_CPU=+0.83GB
2025-10-26 11:43:37,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.13GB
2025-10-26 11:43:45,375 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:43:45,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.21GB
2025-10-26 11:43:45,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.21GB
2025-10-26 11:43:46,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.21GB
2025-10-26 11:43:46,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.21GB
2025-10-26 11:43:46,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.21GB
2025-10-26 11:43:46,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.21GB
2025-10-26 11:43:47,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.21GB
2025-10-26 11:43:47,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.21GB
2025-10-26 11:43:47,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.21GB
2025-10-26 11:43:47,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.21GB
2025-10-26 11:43:47,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.21GB
2025-10-26 11:43:47,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.21GB
2025-10-26 11:43:49,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=+1.25GB
2025-10-26 11:43:49,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 11:43:57,278 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:43:57,473 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 11:43:57,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 11:43:57,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:43:58,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 11:43:58,397 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:43:58,859 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:43:59,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 11:43:59,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 11:43:59,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:43:59,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:43:59,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:43:59,868 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 11:44:01,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=+0.76GB
2025-10-26 11:44:01,850 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 11:44:09,209 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:44:09,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.62GB
2025-10-26 11:44:09,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.62GB
2025-10-26 11:44:09,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:44:10,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.62GB
2025-10-26 11:44:10,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:44:10,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:44:10,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.62GB
2025-10-26 11:44:11,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.62GB
2025-10-26 11:44:11,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:44:11,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:44:11,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:44:11,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.62GB
2025-10-26 11:44:13,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.41GB Delta_CPU=+0.79GB
2025-10-26 11:44:13,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.41GB
2025-10-26 11:44:20,945 INFO __main__: Batch 390/520 | loss=0.800875 elapsed=4637.9s
2025-10-26 11:44:20,949 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:44:21,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.61GB
2025-10-26 11:44:21,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.61GB
2025-10-26 11:44:21,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 11:44:21,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.61GB
2025-10-26 11:44:22,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 11:44:22,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.61GB
2025-10-26 11:44:22,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.61GB
2025-10-26 11:44:22,921 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.61GB
2025-10-26 11:44:23,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 11:44:23,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 11:44:23,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.61GB
2025-10-26 11:44:23,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.61GB
2025-10-26 11:44:25,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.68GB Delta_CPU=+1.07GB
2025-10-26 11:44:25,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.68GB
2025-10-26 11:44:33,043 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:44:33,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.88GB
2025-10-26 11:44:33,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.88GB
2025-10-26 11:44:33,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:44:34,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.88GB
2025-10-26 11:44:34,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:44:34,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.88GB
2025-10-26 11:44:34,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.88GB
2025-10-26 11:44:35,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.88GB
2025-10-26 11:44:35,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:44:35,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:44:35,665 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.88GB
2025-10-26 11:44:35,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.88GB
2025-10-26 11:44:37,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.82GB Delta_CPU=+0.94GB
2025-10-26 11:44:37,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.82GB
2025-10-26 11:44:45,093 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:44:45,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.02GB
2025-10-26 11:44:45,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.02GB
2025-10-26 11:44:45,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:44:46,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.02GB
2025-10-26 11:44:46,220 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:44:46,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:44:46,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.02GB
2025-10-26 11:44:47,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.02GB
2025-10-26 11:44:47,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:44:47,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:44:47,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:44:47,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.02GB
2025-10-26 11:44:49,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.76GB
2025-10-26 11:44:49,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 11:44:56,714 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:44:56,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.99GB
2025-10-26 11:44:57,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.99GB
2025-10-26 11:44:57,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:44:57,652 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.99GB
2025-10-26 11:44:57,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:44:58,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:44:58,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.99GB
2025-10-26 11:44:58,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.99GB
2025-10-26 11:44:58,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:44:59,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:44:59,281 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:44:59,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.99GB
2025-10-26 11:45:01,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.98GB Delta_CPU=-0.00GB
2025-10-26 11:45:01,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.98GB
2025-10-26 11:45:08,954 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:45:09,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.98GB
2025-10-26 11:45:09,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.98GB
2025-10-26 11:45:09,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:45:09,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.98GB
2025-10-26 11:45:10,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:45:10,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:45:10,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.98GB
2025-10-26 11:45:10,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.98GB
2025-10-26 11:45:11,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:45:11,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:45:11,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:45:11,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.98GB
2025-10-26 11:45:13,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.22GB Delta_CPU=+0.23GB
2025-10-26 11:45:13,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.22GB
2025-10-26 11:45:20,980 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:45:21,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 11:45:21,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 11:45:21,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:45:21,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 11:45:22,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:45:22,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 11:45:22,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 11:45:22,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 11:45:23,115 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:45:23,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:45:23,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 11:45:23,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 11:45:25,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.20GB Delta_CPU=-0.02GB
2025-10-26 11:45:25,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.20GB
2025-10-26 11:45:32,728 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:45:32,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.07GB
2025-10-26 11:45:33,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.07GB
2025-10-26 11:45:33,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:33,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.07GB
2025-10-26 11:45:33,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:34,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:34,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.07GB
2025-10-26 11:45:34,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.07GB
2025-10-26 11:45:34,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:35,083 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:35,270 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:35,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.07GB
2025-10-26 11:45:37,042 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.07GB Delta_CPU=-0.01GB
2025-10-26 11:45:37,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.07GB
2025-10-26 11:45:44,641 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:45:44,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.07GB
2025-10-26 11:45:45,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.07GB
2025-10-26 11:45:45,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:45,583 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.07GB
2025-10-26 11:45:45,790 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:46,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:45:46,442 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.07GB
2025-10-26 11:45:46,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.07GB
2025-10-26 11:45:46,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:47,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:47,195 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:45:47,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.07GB
2025-10-26 11:45:48,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.82GB
2025-10-26 11:45:49,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:45:56,548 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:45:56,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 11:45:57,079 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 11:45:57,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:45:57,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 11:45:57,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:45:58,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 11:45:58,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 11:45:58,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 11:45:58,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:45:58,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:45:59,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 11:45:59,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 11:46:00,821 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.79GB
2025-10-26 11:46:01,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 11:46:08,256 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:46:08,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 11:46:08,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 11:46:08,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:46:09,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 11:46:09,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:46:09,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 11:46:10,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 11:46:10,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 11:46:10,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:46:10,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:46:10,791 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 11:46:10,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 11:46:12,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.07GB Delta_CPU=-0.01GB
2025-10-26 11:46:12,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.07GB
2025-10-26 11:46:20,355 INFO __main__: Batch 400/520 | loss=0.646222 elapsed=4757.3s
2025-10-26 11:46:20,362 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:46:20,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.07GB
2025-10-26 11:46:20,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.07GB
2025-10-26 11:46:21,082 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:46:21,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.07GB
2025-10-26 11:46:21,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:46:21,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.07GB
2025-10-26 11:46:22,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.07GB
2025-10-26 11:46:22,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.07GB
2025-10-26 11:46:22,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:46:22,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:46:22,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.07GB
2025-10-26 11:46:22,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.07GB
2025-10-26 11:46:24,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.96GB
2025-10-26 11:46:24,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 11:46:32,111 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:46:32,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 11:46:32,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 11:46:32,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:46:33,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 11:46:33,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:46:33,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:46:33,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 11:46:34,074 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 11:46:34,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:46:34,439 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:46:34,619 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:46:34,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 11:46:36,394 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.04GB Delta_CPU=-0.01GB
2025-10-26 11:46:36,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.04GB
2025-10-26 11:46:44,220 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:46:44,414 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 11:46:44,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 11:46:44,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:46:45,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 11:46:45,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:46:45,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 11:46:46,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 11:46:46,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 11:46:46,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:46:46,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:46:46,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 11:46:46,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 11:46:48,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.03GB Delta_CPU=-0.01GB
2025-10-26 11:46:48,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.03GB
2025-10-26 11:46:56,184 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:46:56,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.03GB
2025-10-26 11:46:56,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.03GB
2025-10-26 11:46:56,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:46:57,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.03GB
2025-10-26 11:46:57,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:46:57,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:46:57,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.03GB
2025-10-26 11:46:58,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.03GB
2025-10-26 11:46:58,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:46:58,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:46:58,735 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:46:58,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.03GB
2025-10-26 11:47:00,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.03GB Delta_CPU=-0.00GB
2025-10-26 11:47:00,723 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.03GB
2025-10-26 11:47:08,549 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:47:08,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.03GB
2025-10-26 11:47:09,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.03GB
2025-10-26 11:47:09,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:09,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.03GB
2025-10-26 11:47:09,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:10,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:10,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.03GB
2025-10-26 11:47:10,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.03GB
2025-10-26 11:47:10,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:10,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:11,153 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:11,157 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.03GB
2025-10-26 11:47:13,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.05GB Delta_CPU=+0.02GB
2025-10-26 11:47:13,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.05GB
2025-10-26 11:47:20,897 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:47:21,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.05GB
2025-10-26 11:47:21,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.05GB
2025-10-26 11:47:21,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:47:21,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.05GB
2025-10-26 11:47:22,038 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:47:22,485 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.05GB
2025-10-26 11:47:22,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.05GB
2025-10-26 11:47:22,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.05GB
2025-10-26 11:47:23,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:47:23,319 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:47:23,537 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.05GB
2025-10-26 11:47:23,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.05GB
2025-10-26 11:47:25,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.01GB Delta_CPU=-0.04GB
2025-10-26 11:47:25,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.01GB
2025-10-26 11:47:33,421 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:47:33,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:47:33,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:47:34,215 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:47:34,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:47:34,661 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:47:35,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:47:35,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:47:35,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:47:35,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:47:35,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:47:36,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:47:36,213 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:47:38,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.83GB Delta_CPU=+0.82GB
2025-10-26 11:47:38,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.83GB
2025-10-26 11:47:46,187 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:47:46,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.03GB
2025-10-26 11:47:46,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.03GB
2025-10-26 11:47:46,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:47,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.03GB
2025-10-26 11:47:47,305 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:47,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:47:47,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.03GB
2025-10-26 11:47:48,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.03GB
2025-10-26 11:47:48,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:48,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:48,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:47:48,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.03GB
2025-10-26 11:47:50,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.79GB Delta_CPU=+0.76GB
2025-10-26 11:47:50,784 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.79GB
2025-10-26 11:47:58,265 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:47:58,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.99GB
2025-10-26 11:47:58,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.99GB
2025-10-26 11:47:59,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:47:59,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.99GB
2025-10-26 11:47:59,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:47:59,853 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.99GB
2025-10-26 11:48:00,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.99GB
2025-10-26 11:48:00,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.99GB
2025-10-26 11:48:00,442 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:48:00,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:48:00,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.99GB
2025-10-26 11:48:00,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.99GB
2025-10-26 11:48:02,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.78GB Delta_CPU=+0.79GB
2025-10-26 11:48:02,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.78GB
2025-10-26 11:48:10,741 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:48:10,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.98GB
2025-10-26 11:48:11,282 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.98GB
2025-10-26 11:48:11,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:48:11,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.98GB
2025-10-26 11:48:11,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:48:12,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.98GB
2025-10-26 11:48:12,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.98GB
2025-10-26 11:48:12,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.98GB
2025-10-26 11:48:12,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:48:13,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:48:13,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.98GB
2025-10-26 11:48:13,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.98GB
2025-10-26 11:48:15,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.80GB Delta_CPU=+0.82GB
2025-10-26 11:48:15,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.80GB
2025-10-26 11:48:23,161 INFO __main__: Batch 410/520 | loss=0.480292 elapsed=4880.1s
2025-10-26 11:48:23,163 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:48:23,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:48:23,701 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:48:23,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:48:24,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:48:24,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:48:24,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:48:25,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:48:25,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:48:25,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:48:25,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:48:25,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:48:25,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:48:27,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.82GB Delta_CPU=+0.82GB
2025-10-26 11:48:27,816 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.82GB
2025-10-26 11:48:35,646 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:48:35,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 11:48:36,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 11:48:36,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:36,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 11:48:36,801 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:37,240 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:37,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 11:48:37,642 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 11:48:37,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:38,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:38,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:38,230 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 11:48:40,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.76GB Delta_CPU=+0.80GB
2025-10-26 11:48:40,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.76GB
2025-10-26 11:48:48,051 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:48:48,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.96GB
2025-10-26 11:48:48,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.96GB
2025-10-26 11:48:48,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:48,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.96GB
2025-10-26 11:48:49,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:49,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.96GB
2025-10-26 11:48:49,831 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.96GB
2025-10-26 11:48:50,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.96GB
2025-10-26 11:48:50,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:50,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:50,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.96GB
2025-10-26 11:48:50,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.96GB
2025-10-26 11:48:52,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.33GB Delta_CPU=+1.37GB
2025-10-26 11:48:52,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.33GB
2025-10-26 11:49:00,287 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:49:00,491 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.53GB
2025-10-26 11:49:00,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.53GB
2025-10-26 11:49:01,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 11:49:01,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.53GB
2025-10-26 11:49:01,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 11:49:01,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 11:49:02,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.53GB
2025-10-26 11:49:02,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.53GB
2025-10-26 11:49:02,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 11:49:02,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 11:49:02,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 11:49:02,847 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.53GB
2025-10-26 11:49:04,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.37GB Delta_CPU=+0.84GB
2025-10-26 11:49:04,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.37GB
2025-10-26 11:49:12,567 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:49:12,762 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.03GB
2025-10-26 11:49:13,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.03GB
2025-10-26 11:49:13,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:49:13,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.03GB
2025-10-26 11:49:13,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:49:14,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.03GB
2025-10-26 11:49:14,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.03GB
2025-10-26 11:49:14,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.03GB
2025-10-26 11:49:14,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:49:14,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:49:15,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.03GB
2025-10-26 11:49:15,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.03GB
2025-10-26 11:49:17,135 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.24GB Delta_CPU=+0.22GB
2025-10-26 11:49:17,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.24GB
2025-10-26 11:49:24,751 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:49:24,942 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.02GB
2025-10-26 11:49:25,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.02GB
2025-10-26 11:49:25,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:49:25,677 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.02GB
2025-10-26 11:49:25,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:49:26,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 11:49:26,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.02GB
2025-10-26 11:49:26,718 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.02GB
2025-10-26 11:49:26,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:49:27,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:49:27,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 11:49:27,275 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.02GB
2025-10-26 11:49:29,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.81GB Delta_CPU=+0.79GB
2025-10-26 11:49:29,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.81GB
2025-10-26 11:49:36,897 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:49:37,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.01GB
2025-10-26 11:49:37,426 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.01GB
2025-10-26 11:49:37,620 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:49:37,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.01GB
2025-10-26 11:49:38,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:49:38,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.01GB
2025-10-26 11:49:38,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.01GB
2025-10-26 11:49:38,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.01GB
2025-10-26 11:49:39,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:49:39,207 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:49:39,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.01GB
2025-10-26 11:49:39,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.01GB
2025-10-26 11:49:41,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.83GB Delta_CPU=+0.82GB
2025-10-26 11:49:41,450 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.83GB
2025-10-26 11:49:48,970 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:49:49,160 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.89GB
2025-10-26 11:49:49,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.89GB
2025-10-26 11:49:49,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:49:49,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.89GB
2025-10-26 11:49:50,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:49:50,634 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.89GB
2025-10-26 11:49:50,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.89GB
2025-10-26 11:49:51,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.89GB
2025-10-26 11:49:51,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:49:51,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:49:51,717 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.89GB
2025-10-26 11:49:51,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.89GB
2025-10-26 11:49:53,624 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.69GB Delta_CPU=+0.80GB
2025-10-26 11:49:53,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.69GB
2025-10-26 11:50:01,667 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:50:01,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.70GB
2025-10-26 11:50:02,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.70GB
2025-10-26 11:50:02,411 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:50:02,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.70GB
2025-10-26 11:50:02,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:50:03,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.70GB
2025-10-26 11:50:03,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.70GB
2025-10-26 11:50:03,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.70GB
2025-10-26 11:50:03,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:50:04,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:50:04,215 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.70GB
2025-10-26 11:50:04,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.70GB
2025-10-26 11:50:06,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.82GB
2025-10-26 11:50:06,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 11:50:13,736 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:50:13,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 11:50:14,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 11:50:14,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:50:14,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 11:50:14,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:50:15,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:50:15,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 11:50:15,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 11:50:15,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:50:16,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:50:16,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:50:16,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 11:50:18,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=+0.77GB
2025-10-26 11:50:18,348 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 11:50:25,894 INFO __main__: Batch 420/520 | loss=1.352002 elapsed=5002.9s
2025-10-26 11:50:25,898 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:50:26,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.69GB
2025-10-26 11:50:26,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.69GB
2025-10-26 11:50:26,612 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 11:50:26,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.69GB
2025-10-26 11:50:27,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 11:50:27,482 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 11:50:27,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.69GB
2025-10-26 11:50:27,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.69GB
2025-10-26 11:50:28,081 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 11:50:28,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 11:50:28,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 11:50:28,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.69GB
2025-10-26 11:50:30,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.48GB Delta_CPU=+0.79GB
2025-10-26 11:50:30,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.48GB
2025-10-26 11:50:37,948 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:50:38,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.68GB
2025-10-26 11:50:38,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.68GB
2025-10-26 11:50:38,679 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:50:38,886 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.68GB
2025-10-26 11:50:39,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:50:39,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:50:39,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.68GB
2025-10-26 11:50:39,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.68GB
2025-10-26 11:50:40,091 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:50:40,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:50:40,457 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:50:40,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.68GB
2025-10-26 11:50:42,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.65GB Delta_CPU=-0.04GB
2025-10-26 11:50:42,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.65GB
2025-10-26 11:50:50,209 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:50:50,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 11:50:50,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 11:50:50,936 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:50:51,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 11:50:51,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:50:51,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:50:51,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 11:50:52,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 11:50:52,329 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:50:52,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:50:52,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:50:52,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 11:50:54,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.64GB Delta_CPU=-0.01GB
2025-10-26 11:50:54,800 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.64GB
2025-10-26 11:51:02,210 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:51:02,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:51:02,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:51:02,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:03,154 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:51:03,354 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:03,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:04,051 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:51:04,266 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:51:04,479 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:04,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:04,907 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:04,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:51:06,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.97GB Delta_CPU=+0.33GB
2025-10-26 11:51:07,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.97GB
2025-10-26 11:51:14,374 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:51:14,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.97GB
2025-10-26 11:51:14,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.97GB
2025-10-26 11:51:15,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:51:15,309 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.97GB
2025-10-26 11:51:15,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:51:15,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.97GB
2025-10-26 11:51:16,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.97GB
2025-10-26 11:51:16,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.97GB
2025-10-26 11:51:16,548 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:51:16,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:51:16,928 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.97GB
2025-10-26 11:51:16,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.97GB
2025-10-26 11:51:18,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.93GB Delta_CPU=-0.04GB
2025-10-26 11:51:19,087 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.93GB
2025-10-26 11:51:26,478 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:51:26,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 11:51:26,997 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 11:51:27,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 11:51:27,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 11:51:27,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 11:51:28,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 11:51:28,253 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 11:51:28,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 11:51:28,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 11:51:28,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 11:51:28,984 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 11:51:28,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 11:51:30,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.66GB Delta_CPU=+0.03GB
2025-10-26 11:51:31,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.66GB
2025-10-26 11:51:38,689 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:51:38,883 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.66GB
2025-10-26 11:51:39,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.66GB
2025-10-26 11:51:39,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:51:39,614 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.66GB
2025-10-26 11:51:39,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:51:40,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.66GB
2025-10-26 11:51:40,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.66GB
2025-10-26 11:51:40,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.66GB
2025-10-26 11:51:40,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:51:40,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:51:41,178 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.66GB
2025-10-26 11:51:41,181 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.66GB
2025-10-26 11:51:43,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.75GB Delta_CPU=+0.09GB
2025-10-26 11:51:43,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.75GB
2025-10-26 11:51:50,716 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:51:50,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.64GB
2025-10-26 11:51:51,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.64GB
2025-10-26 11:51:51,449 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:51,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.64GB
2025-10-26 11:51:51,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:52,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.64GB
2025-10-26 11:51:52,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.64GB
2025-10-26 11:51:52,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.64GB
2025-10-26 11:51:52,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:53,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:53,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.64GB
2025-10-26 11:51:53,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.64GB
2025-10-26 11:51:55,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.62GB Delta_CPU=-0.02GB
2025-10-26 11:51:55,539 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.62GB
2025-10-26 11:52:03,168 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:52:03,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.62GB
2025-10-26 11:52:03,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.62GB
2025-10-26 11:52:03,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:52:04,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.62GB
2025-10-26 11:52:04,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:52:04,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.62GB
2025-10-26 11:52:05,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.62GB
2025-10-26 11:52:05,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.62GB
2025-10-26 11:52:05,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:52:05,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:52:05,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.62GB
2025-10-26 11:52:05,884 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.62GB
2025-10-26 11:52:07,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.61GB Delta_CPU=-0.01GB
2025-10-26 11:52:08,048 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.61GB
2025-10-26 11:52:15,503 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:52:15,691 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.44GB
2025-10-26 11:52:16,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.44GB
2025-10-26 11:52:16,260 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 11:52:16,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.44GB
2025-10-26 11:52:16,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 11:52:17,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.44GB
2025-10-26 11:52:17,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.44GB
2025-10-26 11:52:17,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.44GB
2025-10-26 11:52:17,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 11:52:17,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 11:52:18,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.44GB
2025-10-26 11:52:18,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.44GB
2025-10-26 11:52:20,226 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.44GB Delta_CPU=+0.00GB
2025-10-26 11:52:20,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.44GB
2025-10-26 11:52:28,024 INFO __main__: Batch 430/520 | loss=0.941161 elapsed=5125.0s
2025-10-26 11:52:28,029 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:52:28,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.35GB
2025-10-26 11:52:28,540 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.35GB
2025-10-26 11:52:28,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 11:52:28,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.35GB
2025-10-26 11:52:29,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 11:52:29,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.35GB
2025-10-26 11:52:29,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.35GB
2025-10-26 11:52:29,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.35GB
2025-10-26 11:52:30,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 11:52:30,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 11:52:30,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.35GB
2025-10-26 11:52:30,523 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.35GB
2025-10-26 11:52:32,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.80GB Delta_CPU=+0.45GB
2025-10-26 11:52:32,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.80GB
2025-10-26 11:52:40,305 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:52:40,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 11:52:40,823 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 11:52:41,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:52:41,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 11:52:41,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:52:41,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:52:42,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 11:52:42,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 11:52:42,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:52:42,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:52:42,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:52:42,847 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 11:52:44,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.76GB Delta_CPU=-0.04GB
2025-10-26 11:52:44,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.76GB
2025-10-26 11:52:52,626 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:52:52,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.76GB
2025-10-26 11:52:53,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.76GB
2025-10-26 11:52:53,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:52:53,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.76GB
2025-10-26 11:52:53,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:52:54,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.76GB
2025-10-26 11:52:54,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.76GB
2025-10-26 11:52:54,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.76GB
2025-10-26 11:52:54,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:52:54,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:52:55,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.76GB
2025-10-26 11:52:55,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.76GB
2025-10-26 11:52:56,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.28GB Delta_CPU=+0.53GB
2025-10-26 11:52:57,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.28GB
2025-10-26 11:53:04,479 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:53:04,687 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.15GB
2025-10-26 11:53:05,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.15GB
2025-10-26 11:53:05,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:53:05,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.15GB
2025-10-26 11:53:05,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:53:06,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.15GB
2025-10-26 11:53:06,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.15GB
2025-10-26 11:53:06,505 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.15GB
2025-10-26 11:53:06,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:53:06,908 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:53:07,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.15GB
2025-10-26 11:53:07,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.15GB
2025-10-26 11:53:08,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.15GB Delta_CPU=+0.00GB
2025-10-26 11:53:09,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.15GB
2025-10-26 11:53:16,681 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:53:16,874 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.85GB
2025-10-26 11:53:17,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.85GB
2025-10-26 11:53:17,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:17,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.85GB
2025-10-26 11:53:17,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:18,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:18,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.85GB
2025-10-26 11:53:18,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.85GB
2025-10-26 11:53:18,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:19,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:19,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:19,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.85GB
2025-10-26 11:53:21,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.65GB Delta_CPU=+0.80GB
2025-10-26 11:53:21,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.65GB
2025-10-26 11:53:28,512 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:53:28,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.85GB
2025-10-26 11:53:29,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.85GB
2025-10-26 11:53:29,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:29,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.85GB
2025-10-26 11:53:29,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:30,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:53:30,295 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.85GB
2025-10-26 11:53:30,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.85GB
2025-10-26 11:53:30,655 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:30,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:31,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:53:31,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.85GB
2025-10-26 11:53:32,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.84GB Delta_CPU=-0.01GB
2025-10-26 11:53:33,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.84GB
2025-10-26 11:53:40,656 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:53:40,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.57GB
2025-10-26 11:53:41,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.57GB
2025-10-26 11:53:41,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 11:53:41,585 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.57GB
2025-10-26 11:53:41,789 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 11:53:42,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.57GB
2025-10-26 11:53:42,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.57GB
2025-10-26 11:53:42,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.57GB
2025-10-26 11:53:42,807 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 11:53:42,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 11:53:43,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.57GB
2025-10-26 11:53:43,179 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.57GB
2025-10-26 11:53:45,107 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.92GB Delta_CPU=+0.36GB
2025-10-26 11:53:45,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.92GB
2025-10-26 11:53:52,819 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:53:53,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.92GB
2025-10-26 11:53:53,360 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.92GB
2025-10-26 11:53:53,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:53:53,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.92GB
2025-10-26 11:53:53,994 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:53:54,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.92GB
2025-10-26 11:53:54,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.92GB
2025-10-26 11:53:54,861 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.92GB
2025-10-26 11:53:55,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:53:55,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:53:55,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.92GB
2025-10-26 11:53:55,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.92GB
2025-10-26 11:53:57,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.91GB Delta_CPU=-0.01GB
2025-10-26 11:53:57,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.91GB
2025-10-26 11:54:05,148 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:54:05,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.91GB
2025-10-26 11:54:05,685 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.91GB
2025-10-26 11:54:05,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:54:06,103 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.91GB
2025-10-26 11:54:06,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:54:06,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:54:06,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.91GB
2025-10-26 11:54:07,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.91GB
2025-10-26 11:54:07,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:54:07,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:54:07,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:54:07,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.91GB
2025-10-26 11:54:09,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.87GB Delta_CPU=-0.04GB
2025-10-26 11:54:09,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.87GB
2025-10-26 11:54:17,170 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:54:17,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:54:17,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:54:17,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:54:18,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:54:18,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:54:18,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:54:18,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:54:19,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:54:19,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:54:19,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:54:19,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:54:19,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:54:21,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.86GB Delta_CPU=-0.01GB
2025-10-26 11:54:21,852 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.86GB
2025-10-26 11:54:29,408 INFO __main__: Batch 440/520 | loss=0.405113 elapsed=5246.4s
2025-10-26 11:54:29,411 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:54:29,601 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.86GB
2025-10-26 11:54:29,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.86GB
2025-10-26 11:54:30,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:54:30,356 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.86GB
2025-10-26 11:54:30,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:54:31,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.86GB
2025-10-26 11:54:31,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.86GB
2025-10-26 11:54:31,522 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.86GB
2025-10-26 11:54:31,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:54:31,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:54:32,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.86GB
2025-10-26 11:54:32,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.86GB
2025-10-26 11:54:34,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.85GB Delta_CPU=-0.01GB
2025-10-26 11:54:34,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.85GB
2025-10-26 11:54:41,838 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:54:42,052 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.85GB
2025-10-26 11:54:42,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.85GB
2025-10-26 11:54:42,620 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:54:42,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.85GB
2025-10-26 11:54:43,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:54:43,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.85GB
2025-10-26 11:54:43,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.85GB
2025-10-26 11:54:43,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.85GB
2025-10-26 11:54:44,151 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:54:44,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:54:44,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.85GB
2025-10-26 11:54:44,544 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.85GB
2025-10-26 11:54:46,423 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.84GB Delta_CPU=-0.01GB
2025-10-26 11:54:46,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.84GB
2025-10-26 11:54:54,429 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:54:54,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 11:54:54,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 11:54:55,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:54:55,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 11:54:55,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:54:56,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:54:56,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 11:54:56,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 11:54:56,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:54:56,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:54:56,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:54:56,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 11:54:58,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.39GB Delta_CPU=+0.66GB
2025-10-26 11:54:59,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.39GB
2025-10-26 11:55:06,706 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:55:06,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.39GB
2025-10-26 11:55:07,252 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.39GB
2025-10-26 11:55:07,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.39GB
2025-10-26 11:55:07,684 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.39GB
2025-10-26 11:55:07,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.39GB
2025-10-26 11:55:08,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.39GB
2025-10-26 11:55:08,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.39GB
2025-10-26 11:55:08,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.39GB
2025-10-26 11:55:08,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.39GB
2025-10-26 11:55:09,101 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.39GB
2025-10-26 11:55:09,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.39GB
2025-10-26 11:55:09,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.39GB
2025-10-26 11:55:11,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.34GB Delta_CPU=-0.05GB
2025-10-26 11:55:11,344 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.34GB
2025-10-26 11:55:19,207 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:55:19,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.34GB
2025-10-26 11:55:19,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.34GB
2025-10-26 11:55:19,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:55:20,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.34GB
2025-10-26 11:55:20,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:55:20,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.34GB
2025-10-26 11:55:21,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.34GB
2025-10-26 11:55:21,261 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.34GB
2025-10-26 11:55:21,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:55:21,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:55:21,916 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.34GB
2025-10-26 11:55:21,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.34GB
2025-10-26 11:55:23,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.33GB Delta_CPU=-0.01GB
2025-10-26 11:55:24,069 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.33GB
2025-10-26 11:55:31,539 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:55:31,748 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.33GB
2025-10-26 11:55:32,097 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.33GB
2025-10-26 11:55:32,316 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:55:32,542 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.33GB
2025-10-26 11:55:32,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:55:33,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.33GB
2025-10-26 11:55:33,475 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.33GB
2025-10-26 11:55:33,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.33GB
2025-10-26 11:55:33,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:55:34,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:55:34,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.33GB
2025-10-26 11:55:34,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.33GB
2025-10-26 11:55:36,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.13GB Delta_CPU=+0.81GB
2025-10-26 11:55:36,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.13GB
2025-10-26 11:55:44,261 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:55:44,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.91GB
2025-10-26 11:55:44,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.91GB
2025-10-26 11:55:45,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:55:45,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.91GB
2025-10-26 11:55:45,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:55:45,944 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 11:55:46,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.91GB
2025-10-26 11:55:46,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.91GB
2025-10-26 11:55:46,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:55:46,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:55:47,033 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 11:55:47,037 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.91GB
2025-10-26 11:55:48,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.91GB Delta_CPU=-0.00GB
2025-10-26 11:55:49,197 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.91GB
2025-10-26 11:55:56,839 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:55:57,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.80GB
2025-10-26 11:55:57,405 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.80GB
2025-10-26 11:55:57,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:55:57,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.80GB
2025-10-26 11:55:58,047 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:55:58,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.80GB
2025-10-26 11:55:58,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.80GB
2025-10-26 11:55:58,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.80GB
2025-10-26 11:55:59,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:55:59,355 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:55:59,567 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.80GB
2025-10-26 11:55:59,571 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.80GB
2025-10-26 11:56:01,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.82GB
2025-10-26 11:56:01,666 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:56:09,299 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:56:09,499 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 11:56:09,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 11:56:10,044 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:10,248 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 11:56:10,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:10,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:11,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 11:56:11,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 11:56:11,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:11,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:11,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:11,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 11:56:13,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.80GB
2025-10-26 11:56:14,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:56:21,769 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:56:21,962 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 11:56:22,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 11:56:22,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:22,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 11:56:22,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:23,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 11:56:23,573 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 11:56:23,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 11:56:23,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:24,153 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:24,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 11:56:24,361 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 11:56:26,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.79GB Delta_CPU=-0.04GB
2025-10-26 11:56:26,508 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.79GB
2025-10-26 11:56:34,116 INFO __main__: Batch 450/520 | loss=0.586394 elapsed=5371.1s
2025-10-26 11:56:34,119 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:56:34,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.79GB
2025-10-26 11:56:34,690 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.79GB
2025-10-26 11:56:34,910 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:56:35,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.79GB
2025-10-26 11:56:35,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:56:35,820 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.79GB
2025-10-26 11:56:36,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.79GB
2025-10-26 11:56:36,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.79GB
2025-10-26 11:56:36,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:56:36,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:56:36,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.79GB
2025-10-26 11:56:36,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.79GB
2025-10-26 11:56:38,844 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.81GB Delta_CPU=+0.02GB
2025-10-26 11:56:39,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.81GB
2025-10-26 11:56:46,794 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:56:46,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.81GB
2025-10-26 11:56:47,310 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.81GB
2025-10-26 11:56:47,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:56:47,715 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.81GB
2025-10-26 11:56:47,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:56:48,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.81GB
2025-10-26 11:56:48,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.81GB
2025-10-26 11:56:48,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.81GB
2025-10-26 11:56:48,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:56:49,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:56:49,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.81GB
2025-10-26 11:56:49,318 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.81GB
2025-10-26 11:56:51,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.76GB
2025-10-26 11:56:51,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:56:59,057 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:56:59,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.56GB
2025-10-26 11:56:59,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.56GB
2025-10-26 11:56:59,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:00,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.56GB
2025-10-26 11:57:00,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:00,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:01,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.56GB
2025-10-26 11:57:01,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.56GB
2025-10-26 11:57:01,454 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:01,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:01,891 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:01,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.56GB
2025-10-26 11:57:03,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+1.01GB
2025-10-26 11:57:03,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 11:57:11,535 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:57:11,725 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.56GB
2025-10-26 11:57:12,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.56GB
2025-10-26 11:57:12,244 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:12,443 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.56GB
2025-10-26 11:57:12,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:13,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.56GB
2025-10-26 11:57:13,285 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.56GB
2025-10-26 11:57:13,471 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.56GB
2025-10-26 11:57:13,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:13,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:14,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.56GB
2025-10-26 11:57:14,026 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.56GB
2025-10-26 11:57:15,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.56GB Delta_CPU=+0.00GB
2025-10-26 11:57:16,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.56GB
2025-10-26 11:57:23,587 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:57:23,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 11:57:24,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 11:57:24,312 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 11:57:24,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 11:57:24,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 11:57:25,166 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 11:57:25,357 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 11:57:25,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 11:57:25,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 11:57:25,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 11:57:26,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 11:57:26,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 11:57:27,993 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.31GB Delta_CPU=+0.84GB
2025-10-26 11:57:28,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.31GB
2025-10-26 11:57:35,647 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:57:35,849 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.31GB
2025-10-26 11:57:36,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.31GB
2025-10-26 11:57:36,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 11:57:36,568 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.31GB
2025-10-26 11:57:36,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 11:57:37,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.31GB
2025-10-26 11:57:37,402 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.31GB
2025-10-26 11:57:37,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.31GB
2025-10-26 11:57:37,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 11:57:37,960 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 11:57:38,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.31GB
2025-10-26 11:57:38,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.31GB
2025-10-26 11:57:39,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.27GB Delta_CPU=-0.04GB
2025-10-26 11:57:40,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.27GB
2025-10-26 11:57:47,740 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:57:47,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.27GB
2025-10-26 11:57:48,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.27GB
2025-10-26 11:57:48,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 11:57:48,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.27GB
2025-10-26 11:57:48,858 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 11:57:49,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 11:57:49,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.27GB
2025-10-26 11:57:49,686 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.27GB
2025-10-26 11:57:49,871 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 11:57:50,053 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 11:57:50,233 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 11:57:50,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.27GB
2025-10-26 11:57:52,073 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.29GB Delta_CPU=+0.02GB
2025-10-26 11:57:52,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.29GB
2025-10-26 11:57:59,603 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:57:59,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.29GB
2025-10-26 11:58:00,118 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.29GB
2025-10-26 11:58:00,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:58:00,519 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.29GB
2025-10-26 11:58:00,719 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:58:01,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.29GB
2025-10-26 11:58:01,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.29GB
2025-10-26 11:58:01,561 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.29GB
2025-10-26 11:58:01,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:58:01,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:58:02,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.29GB
2025-10-26 11:58:02,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.29GB
2025-10-26 11:58:03,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.07GB Delta_CPU=+0.79GB
2025-10-26 11:58:04,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.07GB
2025-10-26 11:58:11,685 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:58:11,877 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 11:58:12,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 11:58:12,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:12,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 11:58:12,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:13,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:13,441 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 11:58:13,620 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 11:58:13,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:13,987 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:14,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:14,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 11:58:15,996 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.45GB Delta_CPU=+0.80GB
2025-10-26 11:58:16,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.45GB
2025-10-26 11:58:23,713 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:58:23,911 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.65GB
2025-10-26 11:58:24,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.65GB
2025-10-26 11:58:24,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:24,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.65GB
2025-10-26 11:58:24,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:25,292 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.65GB
2025-10-26 11:58:25,477 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.65GB
2025-10-26 11:58:25,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.65GB
2025-10-26 11:58:25,840 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:26,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:26,200 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.65GB
2025-10-26 11:58:26,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.65GB
2025-10-26 11:58:28,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.82GB
2025-10-26 11:58:28,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:58:35,740 INFO __main__: Batch 460/520 | loss=0.566045 elapsed=5492.7s
2025-10-26 11:58:35,744 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:58:35,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.68GB
2025-10-26 11:58:36,257 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.68GB
2025-10-26 11:58:36,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:58:36,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.68GB
2025-10-26 11:58:36,843 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:58:37,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.68GB
2025-10-26 11:58:37,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.68GB
2025-10-26 11:58:37,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.68GB
2025-10-26 11:58:37,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:58:38,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:58:38,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.68GB
2025-10-26 11:58:38,227 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.68GB
2025-10-26 11:58:40,088 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.79GB
2025-10-26 11:58:40,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:58:47,823 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:58:48,016 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:58:48,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:58:48,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:58:48,751 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:58:48,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:58:49,400 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:58:49,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:58:49,777 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:58:49,975 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:58:50,156 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:58:50,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:58:50,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:58:52,164 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=+0.79GB
2025-10-26 11:58:52,366 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 11:58:59,742 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:58:59,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:59:00,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:59:00,440 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:00,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:59:00,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:01,276 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:01,462 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:59:01,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:59:01,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:02,005 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:02,185 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:02,188 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:59:04,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.46GB Delta_CPU=+0.79GB
2025-10-26 11:59:04,214 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.46GB
2025-10-26 11:59:11,656 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:59:11,845 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.67GB
2025-10-26 11:59:12,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.67GB
2025-10-26 11:59:12,382 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:12,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.67GB
2025-10-26 11:59:12,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:13,224 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.67GB
2025-10-26 11:59:13,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.67GB
2025-10-26 11:59:13,597 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.67GB
2025-10-26 11:59:13,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:13,966 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:14,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.67GB
2025-10-26 11:59:14,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.67GB
2025-10-26 11:59:15,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.67GB Delta_CPU=+1.00GB
2025-10-26 11:59:16,202 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.67GB
2025-10-26 11:59:24,017 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:59:24,212 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.87GB
2025-10-26 11:59:24,536 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.87GB
2025-10-26 11:59:24,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:59:24,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.87GB
2025-10-26 11:59:25,146 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:59:25,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.87GB
2025-10-26 11:59:25,799 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.87GB
2025-10-26 11:59:25,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.87GB
2025-10-26 11:59:26,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:59:26,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:59:26,562 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.87GB
2025-10-26 11:59:26,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.87GB
2025-10-26 11:59:28,378 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.76GB
2025-10-26 11:59:28,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 11:59:35,872 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:59:36,067 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 11:59:36,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 11:59:36,589 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:36,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 11:59:36,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:37,437 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:37,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 11:59:37,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 11:59:38,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:38,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:38,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:38,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 11:59:40,210 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.80GB
2025-10-26 11:59:40,406 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 11:59:48,134 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 11:59:48,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 11:59:48,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 11:59:48,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:49,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 11:59:49,256 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:49,732 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 11:59:49,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 11:59:50,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 11:59:50,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:50,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:50,659 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 11:59:50,663 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 11:59:52,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.08GB Delta_CPU=+0.36GB
2025-10-26 11:59:52,727 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.08GB
2025-10-26 12:00:00,170 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:00:00,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.08GB
2025-10-26 12:00:00,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.08GB
2025-10-26 12:00:00,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 12:00:01,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.08GB
2025-10-26 12:00:01,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 12:00:01,761 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.08GB
2025-10-26 12:00:01,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.08GB
2025-10-26 12:00:02,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.08GB
2025-10-26 12:00:02,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 12:00:02,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 12:00:02,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.08GB
2025-10-26 12:00:02,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.08GB
2025-10-26 12:00:04,635 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.04GB Delta_CPU=-0.04GB
2025-10-26 12:00:04,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.04GB
2025-10-26 12:00:12,444 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:00:12,633 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.04GB
2025-10-26 12:00:12,946 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.04GB
2025-10-26 12:00:13,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 12:00:13,337 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.04GB
2025-10-26 12:00:13,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 12:00:13,992 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.04GB
2025-10-26 12:00:14,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.04GB
2025-10-26 12:00:14,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.04GB
2025-10-26 12:00:14,565 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 12:00:14,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 12:00:14,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.04GB
2025-10-26 12:00:14,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.04GB
2025-10-26 12:00:16,747 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.82GB Delta_CPU=+0.78GB
2025-10-26 12:00:16,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.82GB
2025-10-26 12:00:24,312 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:00:24,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.02GB
2025-10-26 12:00:24,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.02GB
2025-10-26 12:00:25,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 12:00:25,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.02GB
2025-10-26 12:00:25,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 12:00:25,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.02GB
2025-10-26 12:00:26,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.02GB
2025-10-26 12:00:26,286 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.02GB
2025-10-26 12:00:26,469 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 12:00:26,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 12:00:26,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.02GB
2025-10-26 12:00:26,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.02GB
2025-10-26 12:00:28,637 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.84GB Delta_CPU=+0.82GB
2025-10-26 12:00:28,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.84GB
2025-10-26 12:00:36,294 INFO __main__: Batch 470/520 | loss=0.481990 elapsed=5613.3s
2025-10-26 12:00:36,296 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:00:36,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.91GB
2025-10-26 12:00:36,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.91GB
2025-10-26 12:00:37,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 12:00:37,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.91GB
2025-10-26 12:00:37,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 12:00:37,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.91GB
2025-10-26 12:00:38,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.91GB
2025-10-26 12:00:38,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.91GB
2025-10-26 12:00:38,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 12:00:38,603 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 12:00:38,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.91GB
2025-10-26 12:00:38,788 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.91GB
2025-10-26 12:00:40,660 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.30GB Delta_CPU=+0.39GB
2025-10-26 12:00:40,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.30GB
2025-10-26 12:00:47,987 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:00:48,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.30GB
2025-10-26 12:00:48,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.30GB
2025-10-26 12:00:48,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 12:00:48,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.30GB
2025-10-26 12:00:49,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 12:00:49,551 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.30GB
2025-10-26 12:00:49,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.30GB
2025-10-26 12:00:49,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.30GB
2025-10-26 12:00:50,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 12:00:50,279 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 12:00:50,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.30GB
2025-10-26 12:00:50,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.30GB
2025-10-26 12:00:52,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.25GB Delta_CPU=-0.05GB
2025-10-26 12:00:52,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.25GB
2025-10-26 12:01:00,221 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:01:00,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.25GB
2025-10-26 12:01:00,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.25GB
2025-10-26 12:01:00,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 12:01:01,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.25GB
2025-10-26 12:01:01,336 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 12:01:01,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.25GB
2025-10-26 12:01:01,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.25GB
2025-10-26 12:01:02,140 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.25GB
2025-10-26 12:01:02,328 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 12:01:02,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 12:01:02,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.25GB
2025-10-26 12:01:02,697 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.25GB
2025-10-26 12:01:04,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.27GB Delta_CPU=+0.03GB
2025-10-26 12:01:04,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.27GB
2025-10-26 12:01:12,494 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:01:12,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.27GB
2025-10-26 12:01:13,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.27GB
2025-10-26 12:01:13,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:13,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.27GB
2025-10-26 12:01:13,593 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:14,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:14,219 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.27GB
2025-10-26 12:01:14,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.27GB
2025-10-26 12:01:14,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:14,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:14,949 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:14,953 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.27GB
2025-10-26 12:01:16,832 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.27GB Delta_CPU=-0.00GB
2025-10-26 12:01:17,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.27GB
2025-10-26 12:01:24,331 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:01:24,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.27GB
2025-10-26 12:01:24,855 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.27GB
2025-10-26 12:01:25,055 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:25,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.27GB
2025-10-26 12:01:25,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:25,932 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.27GB
2025-10-26 12:01:26,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.27GB
2025-10-26 12:01:26,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.27GB
2025-10-26 12:01:26,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:26,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:26,854 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.27GB
2025-10-26 12:01:26,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.27GB
2025-10-26 12:01:28,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.05GB Delta_CPU=+0.78GB
2025-10-26 12:01:28,873 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.05GB
2025-10-26 12:01:36,250 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:01:36,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.26GB
2025-10-26 12:01:36,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.26GB
2025-10-26 12:01:36,965 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 12:01:37,165 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.26GB
2025-10-26 12:01:37,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 12:01:37,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.26GB
2025-10-26 12:01:37,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.26GB
2025-10-26 12:01:38,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.26GB
2025-10-26 12:01:38,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 12:01:38,526 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 12:01:38,711 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.26GB
2025-10-26 12:01:38,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.26GB
2025-10-26 12:01:40,497 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.03GB Delta_CPU=+0.77GB
2025-10-26 12:01:40,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.03GB
2025-10-26 12:01:47,879 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:01:48,068 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 12:01:48,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 12:01:48,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:01:48,815 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 12:01:49,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:01:49,458 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:01:49,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 12:01:49,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 12:01:50,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:01:50,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:01:50,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:01:50,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 12:01:52,243 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.23GB Delta_CPU=-0.00GB
2025-10-26 12:01:52,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.23GB
2025-10-26 12:01:59,955 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:02:00,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.23GB
2025-10-26 12:02:00,472 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.23GB
2025-10-26 12:02:00,664 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:02:00,865 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.23GB
2025-10-26 12:02:01,064 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:02:01,515 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.23GB
2025-10-26 12:02:01,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.23GB
2025-10-26 12:02:01,904 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.23GB
2025-10-26 12:02:02,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:02:02,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:02:02,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.23GB
2025-10-26 12:02:02,466 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.23GB
2025-10-26 12:02:04,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.22GB Delta_CPU=-0.01GB
2025-10-26 12:02:04,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.22GB
2025-10-26 12:02:12,193 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:02:12,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.22GB
2025-10-26 12:02:12,709 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.22GB
2025-10-26 12:02:12,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 12:02:13,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.22GB
2025-10-26 12:02:13,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 12:02:13,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.22GB
2025-10-26 12:02:13,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.22GB
2025-10-26 12:02:14,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.22GB
2025-10-26 12:02:14,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 12:02:14,625 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 12:02:14,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.22GB
2025-10-26 12:02:14,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.22GB
2025-10-26 12:02:16,668 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.61GB Delta_CPU=+0.39GB
2025-10-26 12:02:16,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.61GB
2025-10-26 12:02:24,462 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:02:24,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.61GB
2025-10-26 12:02:25,050 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.61GB
2025-10-26 12:02:25,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 12:02:25,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.61GB
2025-10-26 12:02:25,713 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 12:02:26,269 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.61GB
2025-10-26 12:02:26,484 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.61GB
2025-10-26 12:02:26,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.61GB
2025-10-26 12:02:26,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 12:02:27,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 12:02:27,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.61GB
2025-10-26 12:02:27,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.61GB
2025-10-26 12:02:29,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=-0.05GB
2025-10-26 12:02:29,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 12:02:37,303 INFO __main__: Batch 480/520 | loss=1.054198 elapsed=5734.3s
2025-10-26 12:02:37,308 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:02:37,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.56GB
2025-10-26 12:02:37,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.56GB
2025-10-26 12:02:38,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:38,334 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.56GB
2025-10-26 12:02:38,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:39,019 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:39,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.56GB
2025-10-26 12:02:39,387 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.56GB
2025-10-26 12:02:39,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:39,758 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:39,943 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:39,947 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.56GB
2025-10-26 12:02:41,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.56GB Delta_CPU=-0.00GB
2025-10-26 12:02:41,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.56GB
2025-10-26 12:02:49,423 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:02:49,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.56GB
2025-10-26 12:02:49,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.56GB
2025-10-26 12:02:50,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:50,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.56GB
2025-10-26 12:02:50,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:51,017 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.56GB
2025-10-26 12:02:51,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.56GB
2025-10-26 12:02:51,395 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.56GB
2025-10-26 12:02:51,578 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:51,756 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:51,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.56GB
2025-10-26 12:02:51,952 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.56GB
2025-10-26 12:02:53,769 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.58GB Delta_CPU=+0.02GB
2025-10-26 12:02:53,964 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.58GB
2025-10-26 12:03:01,562 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:03:01,754 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.58GB
2025-10-26 12:03:02,070 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.58GB
2025-10-26 12:03:02,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 12:03:02,487 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.58GB
2025-10-26 12:03:02,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 12:03:03,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.58GB
2025-10-26 12:03:03,351 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.58GB
2025-10-26 12:03:03,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.58GB
2025-10-26 12:03:03,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 12:03:03,896 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 12:03:04,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.58GB
2025-10-26 12:03:04,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.58GB
2025-10-26 12:03:05,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.53GB Delta_CPU=-0.05GB
2025-10-26 12:03:06,106 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.53GB
2025-10-26 12:03:13,579 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:03:13,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.53GB
2025-10-26 12:03:14,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.53GB
2025-10-26 12:03:14,290 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 12:03:14,500 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.53GB
2025-10-26 12:03:14,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 12:03:15,143 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.53GB
2025-10-26 12:03:15,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.53GB
2025-10-26 12:03:15,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.53GB
2025-10-26 12:03:15,721 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 12:03:15,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 12:03:16,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.53GB
2025-10-26 12:03:16,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.53GB
2025-10-26 12:03:17,906 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=-0.02GB
2025-10-26 12:03:18,109 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 12:03:25,509 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:03:25,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 12:03:26,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 12:03:26,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:26,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 12:03:26,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:27,089 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:27,277 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 12:03:27,448 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 12:03:27,631 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:27,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:27,998 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:28,001 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 12:03:29,827 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=+0.00GB
2025-10-26 12:03:30,021 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 12:03:37,767 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:03:37,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 12:03:38,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 12:03:38,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:38,694 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 12:03:38,890 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:39,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:03:39,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 12:03:39,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 12:03:39,922 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:40,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:40,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:03:40,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 12:03:42,092 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.54GB Delta_CPU=+0.03GB
2025-10-26 12:03:42,289 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.54GB
2025-10-26 12:03:49,660 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:03:49,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.54GB
2025-10-26 12:03:50,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.54GB
2025-10-26 12:03:50,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 12:03:50,588 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.54GB
2025-10-26 12:03:50,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 12:03:51,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.54GB
2025-10-26 12:03:51,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.54GB
2025-10-26 12:03:51,608 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.54GB
2025-10-26 12:03:51,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 12:03:51,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 12:03:52,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.54GB
2025-10-26 12:03:52,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.54GB
2025-10-26 12:03:53,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.51GB Delta_CPU=-0.03GB
2025-10-26 12:03:54,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.51GB
2025-10-26 12:04:01,591 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:04:01,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.51GB
2025-10-26 12:04:02,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.51GB
2025-10-26 12:04:02,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:04:02,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.51GB
2025-10-26 12:04:02,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:04:03,179 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.51GB
2025-10-26 12:04:03,371 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.51GB
2025-10-26 12:04:03,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.51GB
2025-10-26 12:04:03,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:04:03,925 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:04:04,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.51GB
2025-10-26 12:04:04,117 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.51GB
2025-10-26 12:04:05,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.69GB Delta_CPU=+0.18GB
2025-10-26 12:04:06,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.69GB
2025-10-26 12:04:13,593 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:04:13,787 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.69GB
2025-10-26 12:04:14,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.69GB
2025-10-26 12:04:14,308 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 12:04:14,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.69GB
2025-10-26 12:04:14,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 12:04:15,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.69GB
2025-10-26 12:04:15,372 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.69GB
2025-10-26 12:04:15,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.69GB
2025-10-26 12:04:15,729 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 12:04:15,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 12:04:16,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.69GB
2025-10-26 12:04:16,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.69GB
2025-10-26 12:04:17,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.64GB Delta_CPU=-0.05GB
2025-10-26 12:04:18,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.64GB
2025-10-26 12:04:25,576 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:04:25,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.64GB
2025-10-26 12:04:26,100 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.64GB
2025-10-26 12:04:26,307 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 12:04:26,512 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.64GB
2025-10-26 12:04:26,714 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 12:04:27,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.64GB
2025-10-26 12:04:27,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.64GB
2025-10-26 12:04:27,538 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.64GB
2025-10-26 12:04:27,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 12:04:27,919 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 12:04:28,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.64GB
2025-10-26 12:04:28,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.64GB
2025-10-26 12:04:29,914 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=-0.00GB
2025-10-26 12:04:30,111 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 12:04:37,534 INFO __main__: Batch 490/520 | loss=1.103771 elapsed=5854.5s
2025-10-26 12:04:37,538 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:04:37,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.63GB
2025-10-26 12:04:38,063 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.63GB
2025-10-26 12:04:38,271 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:38,486 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.63GB
2025-10-26 12:04:38,688 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:39,129 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:39,320 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.63GB
2025-10-26 12:04:39,498 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.63GB
2025-10-26 12:04:39,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:39,864 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:40,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:40,043 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.63GB
2025-10-26 12:04:41,869 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=-0.00GB
2025-10-26 12:04:42,065 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 12:04:49,621 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:04:49,812 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.63GB
2025-10-26 12:04:50,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.63GB
2025-10-26 12:04:50,331 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:50,531 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.63GB
2025-10-26 12:04:50,730 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:51,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.63GB
2025-10-26 12:04:51,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.63GB
2025-10-26 12:04:51,550 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.63GB
2025-10-26 12:04:51,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:51,958 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:52,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.63GB
2025-10-26 12:04:52,155 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.63GB
2025-10-26 12:04:53,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.65GB Delta_CPU=+0.02GB
2025-10-26 12:04:54,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.65GB
2025-10-26 12:05:01,680 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:05:01,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.65GB
2025-10-26 12:05:02,199 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.65GB
2025-10-26 12:05:02,396 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.65GB
2025-10-26 12:05:02,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.65GB
2025-10-26 12:05:02,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.65GB
2025-10-26 12:05:03,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.65GB
2025-10-26 12:05:03,431 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.65GB
2025-10-26 12:05:03,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.65GB
2025-10-26 12:05:03,803 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.65GB
2025-10-26 12:05:03,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.65GB
2025-10-26 12:05:04,171 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.65GB
2025-10-26 12:05:04,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.65GB
2025-10-26 12:05:05,905 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.46GB Delta_CPU=+0.81GB
2025-10-26 12:05:06,099 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.46GB
2025-10-26 12:05:13,530 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:05:13,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.66GB
2025-10-26 12:05:14,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.66GB
2025-10-26 12:05:14,250 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 12:05:14,452 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.66GB
2025-10-26 12:05:14,644 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 12:05:15,095 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.66GB
2025-10-26 12:05:15,283 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.66GB
2025-10-26 12:05:15,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.66GB
2025-10-26 12:05:15,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 12:05:15,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 12:05:16,015 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.66GB
2025-10-26 12:05:16,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.66GB
2025-10-26 12:05:17,760 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=26.46GB Delta_CPU=+0.79GB
2025-10-26 12:05:17,956 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=26.46GB
2025-10-26 12:05:25,247 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:05:25,442 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.60GB
2025-10-26 12:05:25,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.60GB
2025-10-26 12:05:25,959 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 12:05:26,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.60GB
2025-10-26 12:05:26,365 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 12:05:26,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.60GB
2025-10-26 12:05:27,002 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.60GB
2025-10-26 12:05:27,196 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.60GB
2025-10-26 12:05:27,381 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 12:05:27,564 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 12:05:27,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.60GB
2025-10-26 12:05:27,746 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.60GB
2025-10-26 12:05:29,528 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.63GB Delta_CPU=+0.03GB
2025-10-26 12:05:29,726 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.63GB
2025-10-26 12:05:37,022 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:05:37,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.50GB
2025-10-26 12:05:37,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.50GB
2025-10-26 12:05:37,728 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 12:05:37,931 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.50GB
2025-10-26 12:05:38,134 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 12:05:38,576 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.50GB
2025-10-26 12:05:38,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.50GB
2025-10-26 12:05:38,963 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.50GB
2025-10-26 12:05:39,159 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 12:05:39,341 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 12:05:39,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.50GB
2025-10-26 12:05:39,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.50GB
2025-10-26 12:05:41,358 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=-0.01GB
2025-10-26 12:05:41,556 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 12:05:48,732 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:05:48,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 12:05:49,255 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 12:05:49,459 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:05:49,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 12:05:49,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:05:50,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:05:50,494 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 12:05:50,674 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 12:05:50,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:05:51,045 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:05:51,238 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:05:51,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 12:05:53,093 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.49GB Delta_CPU=-0.00GB
2025-10-26 12:05:53,291 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.49GB
2025-10-26 12:06:00,663 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:06:00,856 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.49GB
2025-10-26 12:06:01,191 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.49GB
2025-10-26 12:06:01,393 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:06:01,602 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.49GB
2025-10-26 12:06:01,798 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:06:02,259 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.49GB
2025-10-26 12:06:02,455 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.49GB
2025-10-26 12:06:02,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.49GB
2025-10-26 12:06:02,825 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:06:02,999 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:06:03,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.49GB
2025-10-26 12:06:03,192 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.49GB
2025-10-26 12:06:05,062 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.47GB Delta_CPU=-0.02GB
2025-10-26 12:06:05,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.47GB
2025-10-26 12:06:12,586 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:06:12,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.47GB
2025-10-26 12:06:13,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.47GB
2025-10-26 12:06:13,298 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 12:06:13,501 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.47GB
2025-10-26 12:06:13,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 12:06:14,144 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.47GB
2025-10-26 12:06:14,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.47GB
2025-10-26 12:06:14,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.47GB
2025-10-26 12:06:14,699 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 12:06:14,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 12:06:15,056 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.47GB
2025-10-26 12:06:15,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.47GB
2025-10-26 12:06:16,898 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.50GB Delta_CPU=+0.02GB
2025-10-26 12:06:17,094 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.50GB
2025-10-26 12:06:24,635 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:06:24,830 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.43GB
2025-10-26 12:06:25,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.43GB
2025-10-26 12:06:25,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:25,547 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.43GB
2025-10-26 12:06:25,743 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:26,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:26,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.43GB
2025-10-26 12:06:26,558 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.43GB
2025-10-26 12:06:26,749 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:26,927 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:27,119 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:27,123 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.43GB
2025-10-26 12:06:28,950 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.43GB Delta_CPU=+0.00GB
2025-10-26 12:06:29,142 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.43GB
2025-10-26 12:06:36,624 INFO __main__: Batch 500/520 | loss=0.710706 elapsed=5973.6s
2025-10-26 12:06:36,626 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:06:36,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.43GB
2025-10-26 12:06:37,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.43GB
2025-10-26 12:06:37,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:37,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.43GB
2025-10-26 12:06:37,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:38,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.43GB
2025-10-26 12:06:38,438 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.43GB
2025-10-26 12:06:38,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.43GB
2025-10-26 12:06:38,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:38,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:39,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.43GB
2025-10-26 12:06:39,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.43GB
2025-10-26 12:06:41,010 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.42GB Delta_CPU=-0.01GB
2025-10-26 12:06:41,207 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.42GB
2025-10-26 12:06:48,546 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:06:48,736 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.42GB
2025-10-26 12:06:49,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.42GB
2025-10-26 12:06:49,258 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 12:06:49,463 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.42GB
2025-10-26 12:06:49,662 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 12:06:50,098 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.42GB
2025-10-26 12:06:50,296 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.42GB
2025-10-26 12:06:50,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.42GB
2025-10-26 12:06:50,653 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 12:06:50,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 12:06:51,006 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.42GB
2025-10-26 12:06:51,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.42GB
2025-10-26 12:06:52,863 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.44GB Delta_CPU=+0.03GB
2025-10-26 12:06:53,058 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.44GB
2025-10-26 12:07:00,259 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:07:00,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.44GB
2025-10-26 12:07:00,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.44GB
2025-10-26 12:07:00,988 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 12:07:01,184 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.44GB
2025-10-26 12:07:01,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 12:07:01,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.44GB
2025-10-26 12:07:02,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.44GB
2025-10-26 12:07:02,204 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.44GB
2025-10-26 12:07:02,390 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 12:07:02,581 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 12:07:02,764 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.44GB
2025-10-26 12:07:02,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.44GB
2025-10-26 12:07:04,598 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.40GB Delta_CPU=-0.04GB
2025-10-26 12:07:04,793 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.40GB
2025-10-26 12:07:12,045 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:07:12,235 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.40GB
2025-10-26 12:07:12,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.40GB
2025-10-26 12:07:12,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.40GB
2025-10-26 12:07:12,969 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.40GB
2025-10-26 12:07:13,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.40GB
2025-10-26 12:07:13,604 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.40GB
2025-10-26 12:07:13,791 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.40GB
2025-10-26 12:07:13,967 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.40GB
2025-10-26 12:07:14,152 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.40GB
2025-10-26 12:07:14,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.40GB
2025-10-26 12:07:14,517 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.40GB
2025-10-26 12:07:14,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.40GB
2025-10-26 12:07:16,346 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.57GB Delta_CPU=+0.17GB
2025-10-26 12:07:16,545 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.57GB
2025-10-26 12:07:23,945 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:07:24,136 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.19GB
2025-10-26 12:07:24,456 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.19GB
2025-10-26 12:07:24,654 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 12:07:24,860 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.19GB
2025-10-26 12:07:25,060 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 12:07:25,507 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.19GB
2025-10-26 12:07:25,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.19GB
2025-10-26 12:07:25,888 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.19GB
2025-10-26 12:07:26,071 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 12:07:26,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 12:07:26,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.19GB
2025-10-26 12:07:26,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.19GB
2025-10-26 12:07:28,274 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.22GB Delta_CPU=+0.03GB
2025-10-26 12:07:28,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.22GB
2025-10-26 12:07:35,923 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:07:36,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=25.09GB
2025-10-26 12:07:36,444 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=25.09GB
2025-10-26 12:07:36,646 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 12:07:36,857 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=25.09GB
2025-10-26 12:07:37,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 12:07:37,506 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=25.09GB
2025-10-26 12:07:37,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=25.09GB
2025-10-26 12:07:37,875 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=25.09GB
2025-10-26 12:07:38,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 12:07:38,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 12:07:38,428 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=25.09GB
2025-10-26 12:07:38,432 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=25.09GB
2025-10-26 12:07:40,249 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.88GB Delta_CPU=+0.79GB
2025-10-26 12:07:40,447 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.88GB
2025-10-26 12:07:48,054 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:07:48,245 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.69GB
2025-10-26 12:07:48,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.69GB
2025-10-26 12:07:48,768 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:07:48,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.69GB
2025-10-26 12:07:49,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:07:49,623 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:07:49,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.69GB
2025-10-26 12:07:49,985 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.69GB
2025-10-26 12:07:50,168 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:07:50,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:07:50,529 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:07:50,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.69GB
2025-10-26 12:07:52,421 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.72GB Delta_CPU=+0.03GB
2025-10-26 12:07:52,626 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.72GB
2025-10-26 12:08:00,072 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:08:00,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 12:08:00,587 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 12:08:00,780 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:00,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 12:08:01,176 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:01,615 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:01,802 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 12:08:01,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 12:08:02,158 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:02,327 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:02,510 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:02,514 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 12:08:04,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.81GB Delta_CPU=+0.09GB
2025-10-26 12:08:04,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.81GB
2025-10-26 12:08:12,255 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:08:12,445 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.69GB
2025-10-26 12:08:12,773 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.69GB
2025-10-26 12:08:12,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:08:13,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.69GB
2025-10-26 12:08:13,376 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:08:13,819 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.69GB
2025-10-26 12:08:14,004 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.69GB
2025-10-26 12:08:14,189 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.69GB
2025-10-26 12:08:14,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:08:14,552 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:08:14,733 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.69GB
2025-10-26 12:08:14,737 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.69GB
2025-10-26 12:08:16,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.52GB Delta_CPU=+0.83GB
2025-10-26 12:08:16,794 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.52GB
2025-10-26 12:08:24,182 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:08:24,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.72GB
2025-10-26 12:08:24,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.72GB
2025-10-26 12:08:24,894 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:25,096 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.72GB
2025-10-26 12:08:25,301 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:25,763 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.72GB
2025-10-26 12:08:25,948 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.72GB
2025-10-26 12:08:26,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.72GB
2025-10-26 12:08:26,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:26,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:26,672 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.72GB
2025-10-26 12:08:26,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.72GB
2025-10-26 12:08:28,580 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.69GB Delta_CPU=-0.03GB
2025-10-26 12:08:28,776 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.69GB
2025-10-26 12:08:36,165 INFO __main__: Batch 510/520 | loss=1.178487 elapsed=6093.1s
2025-10-26 12:08:36,169 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:08:36,359 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.38GB
2025-10-26 12:08:36,681 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.38GB
2025-10-26 12:08:36,879 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:37,084 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.38GB
2025-10-26 12:08:37,288 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:37,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:37,954 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.38GB
2025-10-26 12:08:38,130 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.38GB
2025-10-26 12:08:38,311 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:38,492 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:38,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:38,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.38GB
2025-10-26 12:08:40,611 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.38GB Delta_CPU=+0.00GB
2025-10-26 12:08:40,808 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.38GB
2025-10-26 12:08:48,451 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:08:48,647 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.38GB
2025-10-26 12:08:48,971 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.38GB
2025-10-26 12:08:49,162 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:49,362 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.38GB
2025-10-26 12:08:49,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:50,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.38GB
2025-10-26 12:08:50,193 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.38GB
2025-10-26 12:08:50,373 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.38GB
2025-10-26 12:08:50,566 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:50,739 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:50,923 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.38GB
2025-10-26 12:08:50,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.38GB
2025-10-26 12:08:52,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=25.21GB Delta_CPU=+0.83GB
2025-10-26 12:08:52,995 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=25.21GB
2025-10-26 12:09:00,432 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:09:00,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.41GB
2025-10-26 12:09:00,940 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.41GB
2025-10-26 12:09:01,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 12:09:01,345 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.41GB
2025-10-26 12:09:01,541 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 12:09:01,979 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.41GB
2025-10-26 12:09:02,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.41GB
2025-10-26 12:09:02,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.41GB
2025-10-26 12:09:02,525 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 12:09:02,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 12:09:02,881 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.41GB
2025-10-26 12:09:02,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.41GB
2025-10-26 12:09:04,851 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.63GB Delta_CPU=+0.21GB
2025-10-26 12:09:05,046 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.63GB
2025-10-26 12:09:12,460 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:09:12,651 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.63GB
2025-10-26 12:09:12,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.63GB
2025-10-26 12:09:13,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 12:09:13,386 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.63GB
2025-10-26 12:09:13,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 12:09:14,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.63GB
2025-10-26 12:09:14,217 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.63GB
2025-10-26 12:09:14,401 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.63GB
2025-10-26 12:09:14,572 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 12:09:14,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 12:09:14,930 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.63GB
2025-10-26 12:09:14,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.63GB
2025-10-26 12:09:16,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.83GB Delta_CPU=+0.21GB
2025-10-26 12:09:17,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.83GB
2025-10-26 12:09:24,615 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:09:24,804 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.83GB
2025-10-26 12:09:25,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.83GB
2025-10-26 12:09:25,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 12:09:25,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.83GB
2025-10-26 12:09:25,708 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 12:09:26,177 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.83GB
2025-10-26 12:09:26,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.83GB
2025-10-26 12:09:26,560 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.83GB
2025-10-26 12:09:26,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 12:09:26,926 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 12:09:27,105 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.83GB
2025-10-26 12:09:27,108 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.83GB
2025-10-26 12:09:29,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.79GB Delta_CPU=-0.04GB
2025-10-26 12:09:29,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.79GB
2025-10-26 12:09:36,894 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:09:37,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.59GB
2025-10-26 12:09:37,412 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.59GB
2025-10-26 12:09:37,606 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 12:09:37,810 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.59GB
2025-10-26 12:09:38,008 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 12:09:38,453 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.59GB
2025-10-26 12:09:38,648 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.59GB
2025-10-26 12:09:38,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.59GB
2025-10-26 12:09:39,013 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 12:09:39,201 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 12:09:39,388 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.59GB
2025-10-26 12:09:39,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.59GB
2025-10-26 12:09:41,279 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.62GB Delta_CPU=+0.03GB
2025-10-26 12:09:41,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.62GB
2025-10-26 12:09:48,694 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:09:48,893 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.48GB
2025-10-26 12:09:49,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.48GB
2025-10-26 12:09:49,416 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 12:09:49,623 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.48GB
2025-10-26 12:09:49,818 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 12:09:50,267 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.48GB
2025-10-26 12:09:50,470 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.48GB
2025-10-26 12:09:50,658 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.48GB
2025-10-26 12:09:50,848 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 12:09:51,022 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 12:09:51,203 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.48GB
2025-10-26 12:09:51,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.48GB
2025-10-26 12:09:53,127 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.51GB Delta_CPU=+0.03GB
2025-10-26 12:09:53,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.51GB
2025-10-26 12:10:00,866 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:01,059 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.51GB
2025-10-26 12:10:01,384 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.51GB
2025-10-26 12:10:01,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 12:10:01,783 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.51GB
2025-10-26 12:10:01,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 12:10:02,422 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.51GB
2025-10-26 12:10:02,616 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.51GB
2025-10-26 12:10:02,797 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.51GB
2025-10-26 12:10:02,989 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 12:10:03,175 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 12:10:03,367 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.51GB
2025-10-26 12:10:03,370 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.51GB
2025-10-26 12:10:05,306 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=-0.04GB
2025-10-26 12:10:05,504 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 12:10:13,187 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:13,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.46GB
2025-10-26 12:10:13,707 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.46GB
2025-10-26 12:10:13,897 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 12:10:14,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.46GB
2025-10-26 12:10:14,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 12:10:14,753 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.46GB
2025-10-26 12:10:14,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.46GB
2025-10-26 12:10:15,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.46GB
2025-10-26 12:10:15,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 12:10:15,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 12:10:15,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.46GB
2025-10-26 12:10:15,692 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.46GB
2025-10-26 12:10:17,620 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.46GB Delta_CPU=+0.00GB
2025-10-26 12:10:17,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.46GB
2025-10-26 12:10:26,474 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:26,683 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:27,029 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:27,246 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:27,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:27,675 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:28,231 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:28,425 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:28,609 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:28,795 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:28,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:29,167 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:29,169 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:31,179 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:31,374 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:32,277 DEBUG __main__: Production validation - first batch scaling check
2025-10-26 12:10:32,277 DEBUG __main__: Raw batch_y OHLC stats | mean=-0.000454 std=0.006307
2025-10-26 12:10:32,277 DEBUG __main__: Scaled targets stats | mean=-0.063526 std=0.432081
2025-10-26 12:10:32,277 DEBUG __main__: Model outputs stats | mean=-0.028922 std=0.041439
2025-10-26 12:10:32,277 DEBUG __main__: Scaling consistency verified for production validation
2025-10-26 12:10:32,278 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:32,490 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:32,759 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:32,955 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:33,148 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:33,350 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:33,822 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:34,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:34,190 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:34,379 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:34,557 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:34,738 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:34,742 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:36,278 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:36,474 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:37,295 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:37,495 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:37,767 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:37,970 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:38,174 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:38,368 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:38,833 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:39,028 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:39,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:39,404 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:39,590 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:39,770 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:39,774 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:41,340 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:41,535 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:42,349 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:42,549 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:42,814 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:43,009 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:43,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:43,419 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:43,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:44,077 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:44,254 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:44,451 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:44,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:44,872 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:44,876 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:46,410 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:46,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:47,369 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:47,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:47,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:48,034 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:48,236 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:48,434 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:48,901 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:49,090 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:49,272 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:49,461 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:49,643 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:49,824 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:49,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:51,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:51,577 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:52,397 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:52,600 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:52,867 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:53,062 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:53,265 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:53,460 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:53,920 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:54,112 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:54,292 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:54,476 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:54,657 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:54,842 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:54,846 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:10:56,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:10:56,627 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:10:57,431 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:10:57,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:10:57,912 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:10:58,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:58,315 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:10:58,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:58,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:10:59,173 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:10:59,349 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:10:59,533 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:59,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:59,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:10:59,899 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:01,433 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:01,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:02,462 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:02,656 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:02,934 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:03,131 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:03,330 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:03,532 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:04,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:04,194 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:04,380 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:04,563 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:04,750 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:04,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:04,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:06,483 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:06,680 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:07,491 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:07,693 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:07,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:08,172 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:08,375 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:08,569 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:09,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:09,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:09,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:09,591 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:09,782 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:09,974 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:09,978 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:11,579 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:11,778 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:12,597 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:12,791 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:13,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:13,280 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:13,480 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:13,678 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:14,141 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:14,335 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:14,520 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:14,703 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:14,887 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:15,072 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:15,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:16,618 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:16,817 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:17,645 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:17,839 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:18,116 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:18,317 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:18,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:18,722 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:19,198 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:19,392 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:19,574 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:19,765 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:19,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:20,124 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:20,128 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:21,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:21,895 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:22,724 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:22,915 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:23,186 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:23,385 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:23,584 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:23,786 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:24,273 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:24,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:24,639 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:24,835 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:25,011 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:25,205 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:25,209 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:26,781 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:26,977 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:27,785 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:27,983 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:28,262 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:28,465 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:28,671 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:28,870 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:29,352 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:29,553 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:29,741 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:29,933 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:30,114 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:30,299 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:30,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:31,829 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:32,025 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:32,843 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:33,040 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:33,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:33,530 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:33,731 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:33,929 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:34,415 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:34,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:34,785 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:34,973 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:35,153 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:35,338 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:35,342 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:36,909 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:37,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:37,912 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:38,113 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:38,383 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:38,596 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:38,796 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:38,986 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:39,446 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:39,649 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:39,834 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:40,031 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:40,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:40,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:40,413 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:41,945 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:42,137 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:42,956 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:43,153 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:43,429 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:43,628 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:43,837 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:44,035 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:44,513 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:44,745 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:44,937 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:45,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:45,304 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:45,493 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:45,496 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:47,018 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:47,216 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:48,030 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:48,228 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:48,509 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:48,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:48,913 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:49,110 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:49,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:49,779 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:49,957 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:50,145 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:50,326 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:50,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:50,527 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:52,086 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:52,284 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:53,104 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:53,300 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:53,575 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:53,775 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:53,980 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:54,183 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:54,645 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:54,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:11:55,023 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:11:55,211 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:55,391 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:55,582 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:11:55,586 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:11:57,104 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:11:57,302 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:11:58,094 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:11:58,294 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:11:58,570 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:11:58,771 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:58,972 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:11:59,170 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:59,638 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:11:59,838 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:00,024 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:00,221 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:00,407 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:00,592 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:00,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:02,122 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:02,314 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:03,116 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:03,313 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:03,594 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:03,792 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:04,003 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:04,208 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:04,673 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:04,866 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:05,049 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:05,237 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:05,417 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:05,607 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:05,610 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:07,126 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:07,323 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:08,148 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:08,347 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:08,622 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:08,828 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:09,027 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:09,222 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:09,689 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:09,880 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:10,057 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:10,241 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:10,427 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:10,617 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:10,621 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:12,150 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:12,353 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:13,141 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:13,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:13,613 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:13,809 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:14,012 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:14,206 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:14,670 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:14,862 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:15,041 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:15,225 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:15,409 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:15,595 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:15,599 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:17,147 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:17,343 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:18,171 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:18,369 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:18,641 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:18,836 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:19,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:19,232 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:19,695 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:19,885 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:20,061 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:20,242 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:20,436 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:20,632 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:20,636 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:22,218 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:22,418 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:23,235 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:23,430 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:23,702 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:23,900 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:24,102 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:24,303 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:24,772 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:24,968 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:25,149 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:25,339 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:25,524 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:25,720 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:25,724 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:27,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:27,464 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:28,291 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([3, 125, 118]), future_celestial_shape=torch.Size([3, 10, 118]), total_shape=torch.Size([3, 135, 118])
2025-10-26 12:12:28,489 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([3, 250, 118]), x_dec=torch.Size([3, 135, 118]) | CPU=24.23GB
2025-10-26 12:12:28,752 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=24.23GB
2025-10-26 12:12:28,938 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([3, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:29,139 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=24.23GB
2025-10-26 12:12:29,325 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([3, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:29,629 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([3, 250, 416]) | CPU=24.23GB
2025-10-26 12:12:29,813 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([3, 250, 3]) | CPU=24.23GB
2025-10-26 12:12:29,991 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=24.23GB
2025-10-26 12:12:30,180 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([3, 250, 13, 13]), astro_norm: torch.Size([3, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:30,363 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([3, 250, 1, 1]) with torch.Size([3, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:30,554 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([3, 250, 13, 13]) | CPU=24.23GB
2025-10-26 12:12:30,555 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=24.23GB
2025-10-26 12:12:31,039 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER celestial_combiner | CPU=24.23GB Delta_CPU=+0.00GB
2025-10-26 12:12:31,234 DEBUG scripts.train.train_celestial_production.memory: MEMORY AFTER GC | CPU=24.23GB
2025-10-26 12:12:31,469 INFO __main__: Epoch 1/3 complete [WARMUP 1/3] | train_loss=1.414947 val_loss=0.195179 lr=0.00100000 epoch_time=6328.44s elapsed=1.76h remaining=3.52h
2025-10-26 12:12:31,692 INFO __main__: New best model saved at checkpoints/celestial_enhanced_pgat_production_recovery_kalki/best_model.pth | val_loss=0.195179
2025-10-26 12:12:31,788 INFO __main__: Warmup phase | epoch=2/3 lr=0.00200000
2025-10-26 12:12:31,822 INFO __main__: Epoch 2/3 - production training
2025-10-26 12:12:31,831 DEBUG __main__: üîÆ Enhanced decoder input created: historical_shape=torch.Size([12, 125, 118]), future_celestial_shape=torch.Size([12, 10, 118]), total_shape=torch.Size([12, 135, 118])
2025-10-26 12:12:32,036 DEBUG scripts.train.train_celestial_production.memory: MEMORY [FORWARD_START] Input shapes: x_enc=torch.Size([12, 250, 118]), x_dec=torch.Size([12, 135, 118]) | CPU=22.80GB
2025-10-26 12:12:32,467 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ENC_EMBEDDING]  | CPU=22.80GB
2025-10-26 12:12:32,676 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ENC_EMBEDDING] enc_out shape: torch.Size([12, 250, 416]) | CPU=22.80GB
2025-10-26 12:12:32,889 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_MARKET_CONTEXT]  | CPU=22.80GB
2025-10-26 12:12:33,085 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_MARKET_CONTEXT] market_context shape: torch.Size([12, 250, 416]) | CPU=22.80GB
2025-10-26 12:12:34,321 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_WEIGHT_MLP] market_context: torch.Size([12, 250, 416]) | CPU=22.80GB
2025-10-26 12:12:34,521 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_WEIGHT_MLP] weights: torch.Size([12, 250, 3]) | CPU=22.80GB
2025-10-26 12:12:34,712 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_NORMALIZE]  | CPU=22.80GB
2025-10-26 12:12:34,902 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_NORMALIZE] phase_norm: torch.Size([12, 250, 13, 13]), astro_norm: torch.Size([12, 250, 13, 13]) | CPU=22.80GB
2025-10-26 12:12:35,076 DEBUG scripts.train.train_celestial_production.memory: MEMORY [BEFORE_ADJ_FUSION] Broadcasting torch.Size([12, 250, 1, 1]) with torch.Size([12, 250, 13, 13]) | CPU=22.80GB
2025-10-26 12:12:35,263 DEBUG scripts.train.train_celestial_production.memory: MEMORY [AFTER_ADJ_FUSION] combined_phase_adj: torch.Size([12, 250, 13, 13]) | CPU=22.80GB
2025-10-26 12:12:35,268 DEBUG scripts.train.train_celestial_production.memory: MEMORY BEFORE celestial_combiner | CPU=22.80GB
