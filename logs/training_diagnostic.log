CELESTIAL ENHANCED PGAT - TRAINING DIAGNOSTICS
================================================================================
Config: results/production_workflow_tests/05_Plus_GraphCombiner.yaml
Start time: 2025-10-27 13:15:54
================================================================================


--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.91740513
  weight_norm_after: 12.89941597
  weight_change: 0.01798916
  grad_norm: 0.04356183
celestial_projection.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018859
  weight_change: 0.01018859
  grad_norm: 0.00143833
celestial_projection.1.weight:
  weight_norm_before: 10.19803905
  weight_norm_after: 10.19510174
  weight_change: 0.00293732
  grad_norm: 0.00330999
celestial_projection.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019530
  weight_change: 0.01019530
  grad_norm: 0.00317967
celestial_query_projection.weight:
  weight_norm_before: 8.93205929
  weight_norm_after: 8.90787315
  weight_change: 0.02418613
  grad_norm: 0.00631939
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00799768
  weight_change: 0.00799768
  grad_norm: 0.00117446
celestial_key_projection.weight:
  weight_norm_before: 8.88466454
  weight_norm_after: 8.87512016
  weight_change: 0.00954437
  grad_norm: 0.00632915
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000668
  weight_change: 0.00000668
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.94329643
  weight_norm_after: 8.93793964
  weight_change: 0.00535679
  grad_norm: 0.01732984
celestial_value_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00799942
  weight_change: 0.00799942
  grad_norm: 0.00722143
celestial_output_projection.weight:
  weight_norm_before: 8.88304424
  weight_norm_after: 8.87615871
  weight_change: 0.00688553
  grad_norm: 0.02361269
celestial_output_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019773
  weight_change: 0.01019773
  grad_norm: 0.01395526
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 10.16949558
  weight_norm_after: 10.12979698
  weight_change: 0.03969860
  grad_norm: 0.00282895
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018340
  weight_change: 0.01018340
  grad_norm: 0.00037755
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 10.23390961
  weight_norm_after: 10.18357372
  weight_change: 0.05033588
  grad_norm: 0.00196846
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01017961
  weight_change: 0.01017961
  grad_norm: 0.00026543
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 10.19217873
  weight_norm_after: 10.15171623
  weight_change: 0.04046249
  grad_norm: 0.00271692
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018909
  weight_change: 0.01018909
  grad_norm: 0.00036810
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 10.21705723
  weight_norm_after: 10.18253613
  weight_change: 0.03452110
  grad_norm: 0.00362930
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018961
  weight_change: 0.01018961
  grad_norm: 0.00049482
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 10.09156322
  weight_norm_after: 10.07482052
  weight_change: 0.01674271
  grad_norm: 0.00513839
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000753
  weight_change: 0.00000753
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.24225712
  weight_norm_after: 10.23512840
  weight_change: 0.00712872
  grad_norm: 0.01526750
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019727
  weight_change: 0.01019727
  grad_norm: 0.00591070
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 10.19193363
  weight_norm_after: 10.16847515
  weight_change: 0.02345848
  grad_norm: 0.01886876
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018433
  weight_change: 0.01018433
  grad_norm: 0.00189752
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 10.24119186
  weight_norm_after: 10.22345543
  weight_change: 0.01773643
  grad_norm: 0.01968700
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019700
  weight_change: 0.01019700
  grad_norm: 0.00287694
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 10.19521332
  weight_norm_after: 10.16836643
  weight_change: 0.02684689
  grad_norm: 0.01892126
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01018507
  weight_change: 0.01018507
  grad_norm: 0.00169153
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 10.16844940
  weight_norm_after: 10.15019608
  weight_change: 0.01825333
  grad_norm: 0.01682323
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019700
  weight_change: 0.01019700
  grad_norm: 0.00287694
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 10.25697899
  weight_norm_after: 10.23962688
  weight_change: 0.01735210
  grad_norm: 0.01799105
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019386
  weight_change: 0.01019386
  grad_norm: 0.00183399
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 10.16810036
  weight_norm_after: 10.14950466
  weight_change: 0.01859570
  grad_norm: 0.02031051
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019700
  weight_change: 0.01019700
  grad_norm: 0.00287694
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 10.24071503
  weight_norm_after: 10.21211910
  weight_change: 0.02859592
  grad_norm: 0.02009989
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01017994
  weight_change: 0.01017994
  grad_norm: 0.00194198
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 10.06136990
  weight_norm_after: 10.04247761
  weight_change: 0.01889229
  grad_norm: 0.01569549
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019700
  weight_change: 0.01019700
  grad_norm: 0.00287694
projection.weight:
  weight_norm_before: 2.80302167
  weight_norm_after: 2.80041838
  weight_change: 0.00260329
  grad_norm: 0.06344811
projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00199999
  weight_change: 0.00199999
  grad_norm: 0.00812703
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 10.26805496
  weight_norm_after: 10.17806816
  weight_change: 0.08998680
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 10.15051079
  weight_norm_after: 10.14640903
  weight_change: 0.00410175
  grad_norm: 0.04880934
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019803
  weight_change: 0.01019803
  grad_norm: 0.50158811
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.19803905
  weight_norm_after: 10.19490623
  weight_change: 0.00313282
  grad_norm: 0.00428509
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.01019725
  weight_change: 0.01019725
  grad_norm: 0.00531384
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.61877990
  weight_norm_after: 3.61363316
  weight_change: 0.00514674
  grad_norm: 0.00451745
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00399990
  weight_change: 0.00399990
  grad_norm: 0.00445445
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 4.00000000
  weight_norm_after: 3.99750137
  weight_change: 0.00249863
  grad_norm: 0.00154791
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00399951
  weight_change: 0.00399951
  grad_norm: 0.00120369
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 0/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.13257992
loss (scaled for backward): 1.13257992
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1.13257992
avg train_loss so far: 1.13257992
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.740635 / 0.558382
y_true_for_loss mean/std: 0.028170 / 0.437782
reg_loss contribution: 0.07280815

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.89941597
  weight_norm_after: 12.88487434
  weight_change: 0.01454163
  grad_norm: 0.06198089
celestial_projection.0.bias:
  weight_norm_before: 0.01018859
  weight_norm_after: 0.01534913
  weight_change: 0.00516054
  grad_norm: 0.00209470
celestial_projection.1.weight:
  weight_norm_before: 10.19510174
  weight_norm_after: 10.19204235
  weight_change: 0.00305939
  grad_norm: 0.00472178
celestial_projection.1.bias:
  weight_norm_before: 0.01019530
  weight_norm_after: 0.01544497
  weight_change: 0.00524967
  grad_norm: 0.00460317
celestial_query_projection.weight:
  weight_norm_before: 8.90787315
  weight_norm_after: 8.88289165
  weight_change: 0.02498150
  grad_norm: 0.00425523
celestial_query_projection.bias:
  weight_norm_before: 0.00799768
  weight_norm_after: 0.01246687
  weight_change: 0.00446919
  grad_norm: 0.00062499
celestial_key_projection.weight:
  weight_norm_before: 8.87512016
  weight_norm_after: 8.86392784
  weight_change: 0.01119232
  grad_norm: 0.00530476
celestial_key_projection.bias:
  weight_norm_before: 0.00000668
  weight_norm_after: 0.00002509
  weight_change: 0.00001841
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.93793964
  weight_norm_after: 8.93364239
  weight_change: 0.00429726
  grad_norm: 0.02026131
celestial_value_projection.bias:
  weight_norm_before: 0.00799942
  weight_norm_after: 0.01236080
  weight_change: 0.00436138
  grad_norm: 0.00784917
celestial_output_projection.weight:
  weight_norm_before: 8.87615871
  weight_norm_after: 8.87164783
  weight_change: 0.00451088
  grad_norm: 0.02155663
celestial_output_projection.bias:
  weight_norm_before: 0.01019773
  weight_norm_after: 0.01539748
  weight_change: 0.00519975
  grad_norm: 0.01145085
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 10.12979698
  weight_norm_after: 10.09003162
  weight_change: 0.03976536
  grad_norm: 0.00332913
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01018340
  weight_norm_after: 0.01491116
  weight_change: 0.00472776
  grad_norm: 0.00042473
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 10.18357372
  weight_norm_after: 10.13580227
  weight_change: 0.04777145
  grad_norm: 0.00328294
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01017961
  weight_norm_after: 0.01357722
  weight_change: 0.00339761
  grad_norm: 0.00042289
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 10.15171623
  weight_norm_after: 10.11814594
  weight_change: 0.03357029
  grad_norm: 0.00465932
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01018909
  weight_norm_after: 0.01466236
  weight_change: 0.00447328
  grad_norm: 0.00059286
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 10.18253613
  weight_norm_after: 10.14821911
  weight_change: 0.03431702
  grad_norm: 0.00477231
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01018961
  weight_norm_after: 0.01470464
  weight_change: 0.00451503
  grad_norm: 0.00062981
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 10.07482052
  weight_norm_after: 10.06042194
  weight_change: 0.01439857
  grad_norm: 0.00748389
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000753
  weight_norm_after: 0.00002823
  weight_change: 0.00002070
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.23512840
  weight_norm_after: 10.22898865
  weight_change: 0.00613976
  grad_norm: 0.02672212
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.01019727
  weight_norm_after: 0.01365032
  weight_change: 0.00345305
  grad_norm: 0.01003440
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 10.16847515
  weight_norm_after: 10.14820004
  weight_change: 0.02027512
  grad_norm: 0.03339545
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.01018433
  weight_norm_after: 0.01225650
  weight_change: 0.00207218
  grad_norm: 0.00307800
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 10.22345543
  weight_norm_after: 10.20408535
  weight_change: 0.01937008
  grad_norm: 0.03260967
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01019700
  weight_norm_after: 0.00827896
  weight_change: 0.00191804
  grad_norm: 0.00499205
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 10.16836643
  weight_norm_after: 10.14704800
  weight_change: 0.02131844
  grad_norm: 0.02661016
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.01018507
  weight_norm_after: 0.01247317
  weight_change: 0.00228809
  grad_norm: 0.00256483
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 10.15019608
  weight_norm_after: 10.13256741
  weight_change: 0.01762867
  grad_norm: 0.02323050
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01019700
  weight_norm_after: 0.00827896
  weight_change: 0.00191804
  grad_norm: 0.00499205
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 10.23962688
  weight_norm_after: 10.22026920
  weight_change: 0.01935768
  grad_norm: 0.03387738
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.01019386
  weight_norm_after: 0.01083892
  weight_change: 0.00064506
  grad_norm: 0.00353194
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 10.14950466
  weight_norm_after: 10.13443184
  weight_change: 0.01507282
  grad_norm: 0.03498633
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01019700
  weight_norm_after: 0.00827896
  weight_change: 0.00191804
  grad_norm: 0.00499205
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 10.21211910
  weight_norm_after: 10.18941689
  weight_change: 0.02270222
  grad_norm: 0.03035069
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.01017994
  weight_norm_after: 0.01303741
  weight_change: 0.00285747
  grad_norm: 0.00291491
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 10.04247761
  weight_norm_after: 10.02294445
  weight_change: 0.01953316
  grad_norm: 0.02531723
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01019700
  weight_norm_after: 0.00827896
  weight_change: 0.00191804
  grad_norm: 0.00499205
projection.weight:
  weight_norm_before: 2.80041838
  weight_norm_after: 2.79751301
  weight_change: 0.00290537
  grad_norm: 0.11695237
projection.bias:
  weight_norm_before: 0.00199999
  weight_norm_after: 0.00144319
  weight_change: 0.00055680
  grad_norm: 0.01387810
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 10.17806816
  weight_norm_after: 10.08836937
  weight_change: 0.08969879
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 10.14640903
  weight_norm_after: 10.14195061
  weight_change: 0.00445843
  grad_norm: 0.06019027
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.01019803
  weight_norm_after: 0.01451657
  weight_change: 0.00431854
  grad_norm: 0.50858051
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.19490623
  weight_norm_after: 10.19176769
  weight_change: 0.00313854
  grad_norm: 0.00770289
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.01019725
  weight_norm_after: 0.01401930
  weight_change: 0.00382205
  grad_norm: 0.00716540
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.61363316
  weight_norm_after: 3.60900426
  weight_change: 0.00462890
  grad_norm: 0.00492581
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.00399990
  weight_norm_after: 0.00640027
  weight_change: 0.00240037
  grad_norm: 0.00598402
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.99750137
  weight_norm_after: 3.99529910
  weight_change: 0.00220227
  grad_norm: 0.00167759
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00399951
  weight_norm_after: 0.00641707
  weight_change: 0.00241755
  grad_norm: 0.00158500
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 5.93906307
loss (scaled for backward): 5.93906307
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 7.07164299
avg train_loss so far: 3.53582150
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -2.029721 / 1.382117
y_true_for_loss mean/std: -0.050417 / 0.341665
reg_loss contribution: 0.07657794

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.88487434
  weight_norm_after: 12.87274361
  weight_change: 0.01213074
  grad_norm: 0.06182316
celestial_projection.0.bias:
  weight_norm_before: 0.01534913
  weight_norm_after: 0.01959098
  weight_change: 0.00424185
  grad_norm: 0.00333897
celestial_projection.1.weight:
  weight_norm_before: 10.19204235
  weight_norm_after: 10.18910980
  weight_change: 0.00293255
  grad_norm: 0.00447745
celestial_projection.1.bias:
  weight_norm_before: 0.01544497
  weight_norm_after: 0.01984335
  weight_change: 0.00439838
  grad_norm: 0.00471716
celestial_query_projection.weight:
  weight_norm_before: 8.88289165
  weight_norm_after: 8.85727692
  weight_change: 0.02561474
  grad_norm: 0.00584703
celestial_query_projection.bias:
  weight_norm_before: 0.01246687
  weight_norm_after: 0.01403763
  weight_change: 0.00157076
  grad_norm: 0.00099405
celestial_key_projection.weight:
  weight_norm_before: 8.86392784
  weight_norm_after: 8.85290718
  weight_change: 0.01102066
  grad_norm: 0.00664463
celestial_key_projection.bias:
  weight_norm_before: 0.00002509
  weight_norm_after: 0.00004523
  weight_change: 0.00002014
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.93364239
  weight_norm_after: 8.92986393
  weight_change: 0.00377846
  grad_norm: 0.02173003
celestial_value_projection.bias:
  weight_norm_before: 0.01236080
  weight_norm_after: 0.01634153
  weight_change: 0.00398074
  grad_norm: 0.00869017
celestial_output_projection.weight:
  weight_norm_before: 8.87164783
  weight_norm_after: 8.86759186
  weight_change: 0.00405598
  grad_norm: 0.02819517
celestial_output_projection.bias:
  weight_norm_before: 0.01539748
  weight_norm_after: 0.01885985
  weight_change: 0.00346237
  grad_norm: 0.01357739
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 10.09003162
  weight_norm_after: 10.05730057
  weight_change: 0.03273106
  grad_norm: 0.00643936
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01491116
  weight_norm_after: 0.01821930
  weight_change: 0.00330815
  grad_norm: 0.00089991
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 10.13580227
  weight_norm_after: 10.09646606
  weight_change: 0.03933620
  grad_norm: 0.00543745
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01357722
  weight_norm_after: 0.01678724
  weight_change: 0.00321002
  grad_norm: 0.00077139
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 10.11814594
  weight_norm_after: 10.08425140
  weight_change: 0.03389454
  grad_norm: 0.00423847
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01466236
  weight_norm_after: 0.01798178
  weight_change: 0.00331941
  grad_norm: 0.00059861
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 10.14821911
  weight_norm_after: 10.11283112
  weight_change: 0.03538799
  grad_norm: 0.00320475
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01470464
  weight_norm_after: 0.01882928
  weight_change: 0.00412464
  grad_norm: 0.00045444
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 10.06042194
  weight_norm_after: 10.04849339
  weight_change: 0.01192856
  grad_norm: 0.00976127
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00002823
  weight_norm_after: 0.00005100
  weight_change: 0.00002277
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.22898865
  weight_norm_after: 10.22458649
  weight_change: 0.00440216
  grad_norm: 0.03571714
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.01365032
  weight_norm_after: 0.01643371
  weight_change: 0.00278339
  grad_norm: 0.01308488
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 10.14820004
  weight_norm_after: 10.13340855
  weight_change: 0.01479149
  grad_norm: 0.05423116
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.01225650
  weight_norm_after: 0.01425189
  weight_change: 0.00199538
  grad_norm: 0.00511655
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 10.20408535
  weight_norm_after: 10.19076347
  weight_change: 0.01332188
  grad_norm: 0.04140086
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.00827896
  weight_norm_after: 0.00694110
  weight_change: 0.00133786
  grad_norm: 0.00744538
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 10.14704800
  weight_norm_after: 10.13304710
  weight_change: 0.01400089
  grad_norm: 0.04285917
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.01247317
  weight_norm_after: 0.01429029
  weight_change: 0.00181712
  grad_norm: 0.00389203
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 10.13256741
  weight_norm_after: 10.12122726
  weight_change: 0.01134014
  grad_norm: 0.03822786
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.00827896
  weight_norm_after: 0.00694110
  weight_change: 0.00133786
  grad_norm: 0.00744538
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 10.22026920
  weight_norm_after: 10.20674992
  weight_change: 0.01351929
  grad_norm: 0.04707904
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.01083892
  weight_norm_after: 0.01167268
  weight_change: 0.00083376
  grad_norm: 0.00465488
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 10.13443184
  weight_norm_after: 10.12321281
  weight_change: 0.01121902
  grad_norm: 0.06363533
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.00827896
  weight_norm_after: 0.00694110
  weight_change: 0.00133786
  grad_norm: 0.00744538
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 10.18941689
  weight_norm_after: 10.17393208
  weight_change: 0.01548481
  grad_norm: 0.04021154
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.01303741
  weight_norm_after: 0.01505012
  weight_change: 0.00201271
  grad_norm: 0.00403076
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 10.02294445
  weight_norm_after: 10.00868034
  weight_change: 0.01426411
  grad_norm: 0.03447885
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.00827896
  weight_norm_after: 0.00694110
  weight_change: 0.00133786
  grad_norm: 0.00744538
projection.weight:
  weight_norm_before: 2.79751301
  weight_norm_after: 2.79493976
  weight_change: 0.00257325
  grad_norm: 0.15120192
projection.bias:
  weight_norm_before: 0.00144319
  weight_norm_after: 0.00117402
  weight_change: 0.00026917
  grad_norm: 0.02043708
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 10.08836937
  weight_norm_after: 9.99897861
  weight_change: 0.08939075
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 10.14195061
  weight_norm_after: 10.13803005
  weight_change: 0.00392056
  grad_norm: 0.06323748
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.01451657
  weight_norm_after: 0.01780184
  weight_change: 0.00328527
  grad_norm: 0.43446112
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.19176769
  weight_norm_after: 10.18870640
  weight_change: 0.00306129
  grad_norm: 0.00790669
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.01401930
  weight_norm_after: 0.01708612
  weight_change: 0.00306682
  grad_norm: 0.00788224
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.60900426
  weight_norm_after: 3.60460949
  weight_change: 0.00439477
  grad_norm: 0.00530030
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.00640027
  weight_norm_after: 0.00850240
  weight_change: 0.00210214
  grad_norm: 0.00598385
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.99529910
  weight_norm_after: 3.99305034
  weight_change: 0.00224876
  grad_norm: 0.00167400
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00641707
  weight_norm_after: 0.00855875
  weight_change: 0.00214168
  grad_norm: 0.00165303
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.41046417
loss (scaled for backward): 1.41046417
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 8.48210716
avg train_loss so far: 2.82736905
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.296140 / 0.986710
y_true_for_loss mean/std: 0.083508 / 0.616309
reg_loss contribution: 0.07331025

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.87274361
  weight_norm_after: 12.86298275
  weight_change: 0.00976086
  grad_norm: 0.06041554
celestial_projection.0.bias:
  weight_norm_before: 0.01959098
  weight_norm_after: 0.02253614
  weight_change: 0.00294516
  grad_norm: 0.00379149
celestial_projection.1.weight:
  weight_norm_before: 10.18910980
  weight_norm_after: 10.18645477
  weight_change: 0.00265503
  grad_norm: 0.00559847
celestial_projection.1.bias:
  weight_norm_before: 0.01984335
  weight_norm_after: 0.02332007
  weight_change: 0.00347671
  grad_norm: 0.00480626
celestial_query_projection.weight:
  weight_norm_before: 8.85727692
  weight_norm_after: 8.83251953
  weight_change: 0.02475739
  grad_norm: 0.00693560
celestial_query_projection.bias:
  weight_norm_before: 0.01403763
  weight_norm_after: 0.01608579
  weight_change: 0.00204816
  grad_norm: 0.00111819
celestial_key_projection.weight:
  weight_norm_before: 8.85290718
  weight_norm_after: 8.84176922
  weight_change: 0.01113796
  grad_norm: 0.00767932
celestial_key_projection.bias:
  weight_norm_before: 0.00004523
  weight_norm_after: 0.00003123
  weight_change: 0.00001399
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.92986393
  weight_norm_after: 8.92552567
  weight_change: 0.00433826
  grad_norm: 0.02601477
celestial_value_projection.bias:
  weight_norm_before: 0.01634153
  weight_norm_after: 0.01877738
  weight_change: 0.00243584
  grad_norm: 0.00958131
celestial_output_projection.weight:
  weight_norm_before: 8.86759186
  weight_norm_after: 8.86327171
  weight_change: 0.00432014
  grad_norm: 0.04343496
celestial_output_projection.bias:
  weight_norm_before: 0.01885985
  weight_norm_after: 0.02211090
  weight_change: 0.00325105
  grad_norm: 0.01867753
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 10.05730057
  weight_norm_after: 10.02829361
  weight_change: 0.02900696
  grad_norm: 0.00568995
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01821930
  weight_norm_after: 0.02175057
  weight_change: 0.00353127
  grad_norm: 0.00080023
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 10.09646606
  weight_norm_after: 10.06303120
  weight_change: 0.03343487
  grad_norm: 0.00623491
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01678724
  weight_norm_after: 0.01932859
  weight_change: 0.00254136
  grad_norm: 0.00087743
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 10.08425140
  weight_norm_after: 10.05559444
  weight_change: 0.02865696
  grad_norm: 0.00794641
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01798178
  weight_norm_after: 0.02006665
  weight_change: 0.00208488
  grad_norm: 0.00114448
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 10.11283112
  weight_norm_after: 10.08045292
  weight_change: 0.03237820
  grad_norm: 0.00603452
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01882928
  weight_norm_after: 0.02085540
  weight_change: 0.00202612
  grad_norm: 0.00085941
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 10.04849339
  weight_norm_after: 10.03765011
  weight_change: 0.01084328
  grad_norm: 0.01369579
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00005100
  weight_norm_after: 0.00003599
  weight_change: 0.00001501
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.22458649
  weight_norm_after: 10.22090912
  weight_change: 0.00367737
  grad_norm: 0.04527814
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.01643371
  weight_norm_after: 0.01943600
  weight_change: 0.00300228
  grad_norm: 0.01574841
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 10.13340855
  weight_norm_after: 10.12318993
  weight_change: 0.01021862
  grad_norm: 0.05914726
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.01425189
  weight_norm_after: 0.01634763
  weight_change: 0.00209575
  grad_norm: 0.00549139
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 10.19076347
  weight_norm_after: 10.18011379
  weight_change: 0.01064968
  grad_norm: 0.05470520
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.00694110
  weight_norm_after: 0.00591987
  weight_change: 0.00102124
  grad_norm: 0.00860918
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 10.13304710
  weight_norm_after: 10.12228775
  weight_change: 0.01075935
  grad_norm: 0.06065283
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.01429029
  weight_norm_after: 0.01573677
  weight_change: 0.00144648
  grad_norm: 0.00551861
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 10.12122726
  weight_norm_after: 10.11151695
  weight_change: 0.00971031
  grad_norm: 0.05915745
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.00694110
  weight_norm_after: 0.00591987
  weight_change: 0.00102124
  grad_norm: 0.00860918
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 10.20674992
  weight_norm_after: 10.19536400
  weight_change: 0.01138592
  grad_norm: 0.06220997
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.01167268
  weight_norm_after: 0.01307122
  weight_change: 0.00139854
  grad_norm: 0.00611759
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 10.12321281
  weight_norm_after: 10.11469841
  weight_change: 0.00851440
  grad_norm: 0.06667600
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.00694110
  weight_norm_after: 0.00591987
  weight_change: 0.00102124
  grad_norm: 0.00860918
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 10.17393208
  weight_norm_after: 10.16132259
  weight_change: 0.01260948
  grad_norm: 0.05957655
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.01505012
  weight_norm_after: 0.01674317
  weight_change: 0.00169304
  grad_norm: 0.00574543
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 10.00868034
  weight_norm_after: 9.99745178
  weight_change: 0.01122856
  grad_norm: 0.05015097
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.00694110
  weight_norm_after: 0.00591987
  weight_change: 0.00102124
  grad_norm: 0.00860918
projection.weight:
  weight_norm_before: 2.79493976
  weight_norm_after: 2.79255295
  weight_change: 0.00238681
  grad_norm: 0.16274028
projection.bias:
  weight_norm_before: 0.00117402
  weight_norm_after: 0.00102520
  weight_change: 0.00014882
  grad_norm: 0.02285940
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 9.99897861
  weight_norm_after: 9.90991306
  weight_change: 0.08906555
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 10.13803005
  weight_norm_after: 10.13477421
  weight_change: 0.00325584
  grad_norm: 0.07461270
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.01780184
  weight_norm_after: 0.02095946
  weight_change: 0.00315762
  grad_norm: 0.42453322
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.18870640
  weight_norm_after: 10.18574619
  weight_change: 0.00296021
  grad_norm: 0.00876445
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.01708612
  weight_norm_after: 0.01978046
  weight_change: 0.00269433
  grad_norm: 0.00972808
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.60460949
  weight_norm_after: 3.60021424
  weight_change: 0.00439525
  grad_norm: 0.00573209
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.00850240
  weight_norm_after: 0.01051651
  weight_change: 0.00201411
  grad_norm: 0.00700923
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.99305034
  weight_norm_after: 3.99085212
  weight_change: 0.00219822
  grad_norm: 0.00184370
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00855875
  weight_norm_after: 0.01060874
  weight_change: 0.00204999
  grad_norm: 0.00179691
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 3/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.23869932
loss (scaled for backward): 1.23869932
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 9.72080648
avg train_loss so far: 2.43020162
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.187932 / 0.796520
y_true_for_loss mean/std: 0.434436 / 0.679804
reg_loss contribution: 0.07198155

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.86298275
  weight_norm_after: 12.85577869
  weight_change: 0.00720406
  grad_norm: 0.08839433
celestial_projection.0.bias:
  weight_norm_before: 0.02253614
  weight_norm_after: 0.02482546
  weight_change: 0.00228932
  grad_norm: 0.00585653
celestial_projection.1.weight:
  weight_norm_before: 10.18645477
  weight_norm_after: 10.18406391
  weight_change: 0.00239086
  grad_norm: 0.00736908
celestial_projection.1.bias:
  weight_norm_before: 0.02332007
  weight_norm_after: 0.02618635
  weight_change: 0.00286628
  grad_norm: 0.00675254
celestial_query_projection.weight:
  weight_norm_before: 8.83251953
  weight_norm_after: 8.80779648
  weight_change: 0.02472305
  grad_norm: 0.00535484
celestial_query_projection.bias:
  weight_norm_before: 0.01608579
  weight_norm_after: 0.01845248
  weight_change: 0.00236669
  grad_norm: 0.00097085
celestial_key_projection.weight:
  weight_norm_before: 8.84176922
  weight_norm_after: 8.83025074
  weight_change: 0.01151848
  grad_norm: 0.00491555
celestial_key_projection.bias:
  weight_norm_before: 0.00003123
  weight_norm_after: 0.00001676
  weight_change: 0.00001448
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.92552567
  weight_norm_after: 8.92111015
  weight_change: 0.00441551
  grad_norm: 0.02236389
celestial_value_projection.bias:
  weight_norm_before: 0.01877738
  weight_norm_after: 0.02049830
  weight_change: 0.00172092
  grad_norm: 0.00851654
celestial_output_projection.weight:
  weight_norm_before: 8.86327171
  weight_norm_after: 8.85863686
  weight_change: 0.00463486
  grad_norm: 0.03007034
celestial_output_projection.bias:
  weight_norm_before: 0.02211090
  weight_norm_after: 0.02494252
  weight_change: 0.00283162
  grad_norm: 0.01082737
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 10.02829361
  weight_norm_after: 10.00286293
  weight_change: 0.02543068
  grad_norm: 0.00811931
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.02175057
  weight_norm_after: 0.02488028
  weight_change: 0.00312971
  grad_norm: 0.00113413
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 10.06303120
  weight_norm_after: 10.03452778
  weight_change: 0.02850342
  grad_norm: 0.00809491
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01932859
  weight_norm_after: 0.02031768
  weight_change: 0.00098908
  grad_norm: 0.00113820
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 10.05559444
  weight_norm_after: 10.03249741
  weight_change: 0.02309704
  grad_norm: 0.01448717
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.02006665
  weight_norm_after: 0.02193564
  weight_change: 0.00186898
  grad_norm: 0.00207252
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 10.08045292
  weight_norm_after: 10.05214024
  weight_change: 0.02831268
  grad_norm: 0.00736972
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.02085540
  weight_norm_after: 0.02397678
  weight_change: 0.00312138
  grad_norm: 0.00103986
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 10.03765011
  weight_norm_after: 10.02925396
  weight_change: 0.00839615
  grad_norm: 0.01952887
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00003599
  weight_norm_after: 0.00002070
  weight_change: 0.00001529
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.22090912
  weight_norm_after: 10.21799374
  weight_change: 0.00291538
  grad_norm: 0.06088620
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.01943600
  weight_norm_after: 0.02124901
  weight_change: 0.00181301
  grad_norm: 0.01885225
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 10.12318993
  weight_norm_after: 10.11528587
  weight_change: 0.00790405
  grad_norm: 0.08951819
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.01634763
  weight_norm_after: 0.01833096
  weight_change: 0.00198333
  grad_norm: 0.00790436
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 10.18011379
  weight_norm_after: 10.17108059
  weight_change: 0.00903320
  grad_norm: 0.08588472
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.00591987
  weight_norm_after: 0.00535248
  weight_change: 0.00056738
  grad_norm: 0.01247904
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 10.12228775
  weight_norm_after: 10.11325645
  weight_change: 0.00903130
  grad_norm: 0.08833916
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.01573677
  weight_norm_after: 0.01722942
  weight_change: 0.00149265
  grad_norm: 0.00751136
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 10.11151695
  weight_norm_after: 10.10264301
  weight_change: 0.00887394
  grad_norm: 0.08949047
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.00591987
  weight_norm_after: 0.00535248
  weight_change: 0.00056738
  grad_norm: 0.01247904
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 10.19536400
  weight_norm_after: 10.18564701
  weight_change: 0.00971699
  grad_norm: 0.09546766
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.01307122
  weight_norm_after: 0.01528918
  weight_change: 0.00221795
  grad_norm: 0.00882202
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 10.11469841
  weight_norm_after: 10.10654163
  weight_change: 0.00815678
  grad_norm: 0.10096985
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.00591987
  weight_norm_after: 0.00535248
  weight_change: 0.00056738
  grad_norm: 0.01247904
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 10.16132259
  weight_norm_after: 10.15066910
  weight_change: 0.01065350
  grad_norm: 0.07639994
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.01674317
  weight_norm_after: 0.01853392
  weight_change: 0.00179075
  grad_norm: 0.00705288
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.99745178
  weight_norm_after: 9.98784733
  weight_change: 0.00960445
  grad_norm: 0.08341667
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.00591987
  weight_norm_after: 0.00535248
  weight_change: 0.00056738
  grad_norm: 0.01247904
projection.weight:
  weight_norm_before: 2.79255295
  weight_norm_after: 2.78987598
  weight_change: 0.00267696
  grad_norm: 0.26196554
projection.bias:
  weight_norm_before: 0.00102520
  weight_norm_after: 0.00098693
  weight_change: 0.00003827
  grad_norm: 0.03512044
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 9.90991306
  weight_norm_after: 9.82119083
  weight_change: 0.08872223
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 10.13477421
  weight_norm_after: 10.13132954
  weight_change: 0.00344467
  grad_norm: 0.06822889
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.02095946
  weight_norm_after: 0.02344246
  weight_change: 0.00248300
  grad_norm: 0.34437880
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.18574619
  weight_norm_after: 10.18241215
  weight_change: 0.00333405
  grad_norm: 0.00911021
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.01978046
  weight_norm_after: 0.02158123
  weight_change: 0.00180077
  grad_norm: 0.00905506
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.60021424
  weight_norm_after: 3.59586930
  weight_change: 0.00434494
  grad_norm: 0.00668610
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01051651
  weight_norm_after: 0.01186425
  weight_change: 0.00134774
  grad_norm: 0.00588832
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.99085212
  weight_norm_after: 3.98909283
  weight_change: 0.00175929
  grad_norm: 0.00219633
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01060874
  weight_norm_after: 0.01176940
  weight_change: 0.00116065
  grad_norm: 0.00177497
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 4/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 4.80595589
loss (scaled for backward): 4.80595589
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 14.52676237
avg train_loss so far: 2.90535247
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 1.149570 / 0.650738
y_true_for_loss mean/std: 0.119463 / 1.998478
reg_loss contribution: 0.07138051

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.58708096
  weight_norm_after: 12.57926083
  weight_change: 0.00782013
  grad_norm: 0.02001821
celestial_projection.0.bias:
  weight_norm_before: 0.05979197
  weight_norm_after: 0.06007677
  weight_change: 0.00028481
  grad_norm: 0.00078860
celestial_projection.1.weight:
  weight_norm_before: 10.06634903
  weight_norm_after: 10.06354046
  weight_change: 0.00280857
  grad_norm: 0.00167786
celestial_projection.1.bias:
  weight_norm_before: 0.06078378
  weight_norm_after: 0.06120828
  weight_change: 0.00042450
  grad_norm: 0.00161580
celestial_query_projection.weight:
  weight_norm_before: 7.47617054
  weight_norm_after: 7.44487667
  weight_change: 0.03129387
  grad_norm: 0.00054280
celestial_query_projection.bias:
  weight_norm_before: 0.03948819
  weight_norm_after: 0.03937345
  weight_change: 0.00011474
  grad_norm: 0.00007510
celestial_key_projection.weight:
  weight_norm_before: 8.04352474
  weight_norm_after: 8.02232361
  weight_change: 0.02120113
  grad_norm: 0.00062600
celestial_key_projection.bias:
  weight_norm_before: 0.00000221
  weight_norm_after: 0.00000213
  weight_change: 0.00000008
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.64878368
  weight_norm_after: 8.64115047
  weight_change: 0.00763321
  grad_norm: 0.00279412
celestial_value_projection.bias:
  weight_norm_before: 0.04650823
  weight_norm_after: 0.04686287
  weight_change: 0.00035465
  grad_norm: 0.00057704
celestial_output_projection.weight:
  weight_norm_before: 8.64566326
  weight_norm_after: 8.64026737
  weight_change: 0.00539589
  grad_norm: 0.00987933
celestial_output_projection.bias:
  weight_norm_before: 0.05572947
  weight_norm_after: 0.05615358
  weight_change: 0.00042411
  grad_norm: 0.00128967
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 9.00927067
  weight_norm_after: 8.98507595
  weight_change: 0.02419472
  grad_norm: 0.00142035
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.05770229
  weight_norm_after: 0.05834721
  weight_change: 0.00064492
  grad_norm: 0.00024037
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 8.99387360
  weight_norm_after: 8.96913528
  weight_change: 0.02473831
  grad_norm: 0.00195983
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.05097791
  weight_norm_after: 0.05101236
  weight_change: 0.00003445
  grad_norm: 0.00033478
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 9.07618427
  weight_norm_after: 9.05218697
  weight_change: 0.02399731
  grad_norm: 0.00407006
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03814342
  weight_norm_after: 0.03820757
  weight_change: 0.00006415
  grad_norm: 0.00069752
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 9.02894211
  weight_norm_after: 9.00421333
  weight_change: 0.02472878
  grad_norm: 0.00268950
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.06546798
  weight_norm_after: 0.06560444
  weight_change: 0.00013646
  grad_norm: 0.00046704
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 9.70135498
  weight_norm_after: 9.69258499
  weight_change: 0.00876999
  grad_norm: 0.00656960
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000787
  weight_norm_after: 0.00000716
  weight_change: 0.00000071
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 10.12511349
  weight_norm_after: 10.12274265
  weight_change: 0.00237083
  grad_norm: 0.03571643
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.07274533
  weight_norm_after: 0.07327393
  weight_change: 0.00052860
  grad_norm: 0.00699888
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.92797375
  weight_norm_after: 9.92553806
  weight_change: 0.00243568
  grad_norm: 0.14560021
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.05830428
  weight_norm_after: 0.05950314
  weight_change: 0.00119886
  grad_norm: 0.01332516
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.96618462
  weight_norm_after: 9.96289062
  weight_change: 0.00329399
  grad_norm: 0.16256905
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01050775
  weight_norm_after: 0.01066918
  weight_change: 0.00016143
  grad_norm: 0.03049375
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.94018364
  weight_norm_after: 9.93723392
  weight_change: 0.00294971
  grad_norm: 0.13822316
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.06049887
  weight_norm_after: 0.06094662
  weight_change: 0.00044775
  grad_norm: 0.01294646
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.91146660
  weight_norm_after: 9.90811634
  weight_change: 0.00335026
  grad_norm: 0.09839246
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01050775
  weight_norm_after: 0.01066918
  weight_change: 0.00016143
  grad_norm: 0.03049375
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.98835182
  weight_norm_after: 9.98537254
  weight_change: 0.00297928
  grad_norm: 0.18579718
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.05335537
  weight_norm_after: 0.05405302
  weight_change: 0.00069765
  grad_norm: 0.01915221
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.92271137
  weight_norm_after: 9.91988754
  weight_change: 0.00282383
  grad_norm: 0.10132051
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01050775
  weight_norm_after: 0.01066918
  weight_change: 0.00016143
  grad_norm: 0.03049375
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.94522858
  weight_norm_after: 9.94207954
  weight_change: 0.00314903
  grad_norm: 0.13709456
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.05906001
  weight_norm_after: 0.05973950
  weight_change: 0.00067949
  grad_norm: 0.01392077
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.77871418
  weight_norm_after: 9.77525806
  weight_change: 0.00345612
  grad_norm: 0.13358852
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01050775
  weight_norm_after: 0.01066918
  weight_change: 0.00016143
  grad_norm: 0.03049375
projection.weight:
  weight_norm_before: 2.70324421
  weight_norm_after: 2.70185518
  weight_change: 0.00138903
  grad_norm: 0.52368265
projection.bias:
  weight_norm_before: 0.00211968
  weight_norm_after: 0.00221488
  weight_change: 0.00009520
  grad_norm: 0.09312439
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 6.33316135
  weight_norm_after: 6.26812601
  weight_change: 0.06503534
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 9.94506454
  weight_norm_after: 9.93994427
  weight_change: 0.00512028
  grad_norm: 0.01854401
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.05156115
  weight_norm_after: 0.05171207
  weight_change: 0.00015092
  grad_norm: 0.04213467
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 10.05199146
  weight_norm_after: 10.04877281
  weight_change: 0.00321865
  grad_norm: 0.00303837
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.05168245
  weight_norm_after: 0.05192523
  weight_change: 0.00024279
  grad_norm: 0.00295266
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.40096426
  weight_norm_after: 3.39678407
  weight_change: 0.00418019
  grad_norm: 0.00154848
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02467968
  weight_norm_after: 0.02485205
  weight_change: 0.00017237
  grad_norm: 0.00139280
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.91697550
  weight_norm_after: 3.91511488
  weight_change: 0.00186062
  grad_norm: 0.00063416
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02663776
  weight_norm_after: 0.02680195
  weight_change: 0.00016419
  grad_norm: 0.00052801
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 50/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.71033829
loss (scaled for backward): 0.71033829
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 76.28346309
avg train_loss so far: 1.49575418
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.150655 / 0.307565
y_true_for_loss mean/std: 0.253585 / 0.697868
reg_loss contribution: 0.01071482

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 12.10851192
  weight_norm_after: 12.09766865
  weight_change: 0.01084328
  grad_norm: 0.01430797
celestial_projection.0.bias:
  weight_norm_before: 0.06459814
  weight_norm_after: 0.06463543
  weight_change: 0.00003729
  grad_norm: 0.00022795
celestial_projection.1.weight:
  weight_norm_before: 9.91264915
  weight_norm_after: 9.90925121
  weight_change: 0.00339794
  grad_norm: 0.00133971
celestial_projection.1.bias:
  weight_norm_before: 0.07504900
  weight_norm_after: 0.07518117
  weight_change: 0.00013217
  grad_norm: 0.00102363
celestial_query_projection.weight:
  weight_norm_before: 5.99041653
  weight_norm_after: 5.96293116
  weight_change: 0.02748537
  grad_norm: 0.00044783
celestial_query_projection.bias:
  weight_norm_before: 0.03566156
  weight_norm_after: 0.03561896
  weight_change: 0.00004259
  grad_norm: 0.00005567
celestial_key_projection.weight:
  weight_norm_before: 6.90672588
  weight_norm_after: 6.88322544
  weight_change: 0.02350044
  grad_norm: 0.00055908
celestial_key_projection.bias:
  weight_norm_before: 0.00000039
  weight_norm_after: 0.00000037
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 8.20878887
  weight_norm_after: 8.19902897
  weight_change: 0.00975990
  grad_norm: 0.00241514
celestial_value_projection.bias:
  weight_norm_before: 0.05037044
  weight_norm_after: 0.05046181
  weight_change: 0.00009137
  grad_norm: 0.00045564
celestial_output_projection.weight:
  weight_norm_before: 8.34251881
  weight_norm_after: 8.33586502
  weight_change: 0.00665379
  grad_norm: 0.00907312
celestial_output_projection.bias:
  weight_norm_before: 0.06161656
  weight_norm_after: 0.06165535
  weight_change: 0.00003878
  grad_norm: 0.00118256
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 7.73685598
  weight_norm_after: 7.71112728
  weight_change: 0.02572870
  grad_norm: 0.00140154
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.05133511
  weight_norm_after: 0.05140069
  weight_change: 0.00006559
  grad_norm: 0.00028992
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 7.69595623
  weight_norm_after: 7.66963196
  weight_change: 0.02632427
  grad_norm: 0.00154338
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.05182146
  weight_norm_after: 0.05184532
  weight_change: 0.00002386
  grad_norm: 0.00034115
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 7.84478903
  weight_norm_after: 7.81977844
  weight_change: 0.02501059
  grad_norm: 0.00172077
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.04135920
  weight_norm_after: 0.04136787
  weight_change: 0.00000867
  grad_norm: 0.00038636
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 7.73911476
  weight_norm_after: 7.71347904
  weight_change: 0.02563572
  grad_norm: 0.00156984
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.05959743
  weight_norm_after: 0.05976384
  weight_change: 0.00016641
  grad_norm: 0.00028654
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 9.20512104
  weight_norm_after: 9.19433117
  weight_change: 0.01078987
  grad_norm: 0.00365564
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000229
  weight_norm_after: 0.00000315
  weight_change: 0.00000086
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 9.98287010
  weight_norm_after: 9.97973061
  weight_change: 0.00313950
  grad_norm: 0.03057047
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.08795981
  weight_norm_after: 0.08803136
  weight_change: 0.00007155
  grad_norm: 0.00535193
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.78946781
  weight_norm_after: 9.78734303
  weight_change: 0.00212479
  grad_norm: 0.14603443
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.08736388
  weight_norm_after: 0.08793401
  weight_change: 0.00057013
  grad_norm: 0.01110112
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.81053257
  weight_norm_after: 9.80789471
  weight_change: 0.00263786
  grad_norm: 0.14248452
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01087122
  weight_norm_after: 0.01006092
  weight_change: 0.00081030
  grad_norm: 0.02473637
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.79900742
  weight_norm_after: 9.79670525
  weight_change: 0.00230217
  grad_norm: 0.26351419
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.08531269
  weight_norm_after: 0.08569694
  weight_change: 0.00038424
  grad_norm: 0.02549489
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.76921558
  weight_norm_after: 9.76678658
  weight_change: 0.00242901
  grad_norm: 0.13341793
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01087122
  weight_norm_after: 0.01006092
  weight_change: 0.00081030
  grad_norm: 0.02473637
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.85422039
  weight_norm_after: 9.85170555
  weight_change: 0.00251484
  grad_norm: 0.21623163
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.08148358
  weight_norm_after: 0.08163264
  weight_change: 0.00014906
  grad_norm: 0.02014884
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.78968334
  weight_norm_after: 9.78755474
  weight_change: 0.00212860
  grad_norm: 0.17727940
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01087122
  weight_norm_after: 0.01006092
  weight_change: 0.00081030
  grad_norm: 0.02473637
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.80721569
  weight_norm_after: 9.80454350
  weight_change: 0.00267220
  grad_norm: 0.15646249
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.08697484
  weight_norm_after: 0.08747475
  weight_change: 0.00049990
  grad_norm: 0.01297115
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.62379074
  weight_norm_after: 9.62146473
  weight_change: 0.00232601
  grad_norm: 0.16307463
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01087122
  weight_norm_after: 0.01006092
  weight_change: 0.00081030
  grad_norm: 0.02473637
projection.weight:
  weight_norm_before: 2.64086890
  weight_norm_after: 2.63992834
  weight_change: 0.00094056
  grad_norm: 0.46475250
projection.bias:
  weight_norm_before: 0.00207322
  weight_norm_after: 0.00198498
  weight_change: 0.00008824
  grad_norm: 0.07047166
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 3.67977095
  weight_norm_after: 3.63787079
  weight_change: 0.04190016
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 9.66009426
  weight_norm_after: 9.65387535
  weight_change: 0.00621891
  grad_norm: 0.01689040
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.05610019
  weight_norm_after: 0.05614312
  weight_change: 0.00004293
  grad_norm: 0.03922248
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 9.88234520
  weight_norm_after: 9.87867641
  weight_change: 0.00366879
  grad_norm: 0.00299812
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06087161
  weight_norm_after: 0.06094135
  weight_change: 0.00006974
  grad_norm: 0.00282480
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.19810319
  weight_norm_after: 3.19415450
  weight_change: 0.00394869
  grad_norm: 0.00115291
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02563809
  weight_norm_after: 0.02569700
  weight_change: 0.00005892
  grad_norm: 0.00114167
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.82004786
  weight_norm_after: 3.81804395
  weight_change: 0.00200391
  grad_norm: 0.00035917
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02713843
  weight_norm_after: 0.02717547
  weight_change: 0.00003704
  grad_norm: 0.00031742
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 100/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.84293628
loss (scaled for backward): 0.84293628
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 118.76246946
avg train_loss so far: 1.17586603
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.091236 / 0.146020
y_true_for_loss mean/std: -0.116870 / 0.943930
reg_loss contribution: 0.00242745

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 11.52904415
  weight_norm_after: 11.51680374
  weight_change: 0.01224041
  grad_norm: 0.00807073
celestial_projection.0.bias:
  weight_norm_before: 0.06338995
  weight_norm_after: 0.06338952
  weight_change: 0.00000043
  grad_norm: 0.00015539
celestial_projection.1.weight:
  weight_norm_before: 9.73520660
  weight_norm_after: 9.73121834
  weight_change: 0.00398827
  grad_norm: 0.00115019
celestial_projection.1.bias:
  weight_norm_before: 0.07776348
  weight_norm_after: 0.07780249
  weight_change: 0.00003901
  grad_norm: 0.00075001
celestial_query_projection.weight:
  weight_norm_before: 4.74483490
  weight_norm_after: 4.72266912
  weight_change: 0.02216578
  grad_norm: 0.00012043
celestial_query_projection.bias:
  weight_norm_before: 0.03189018
  weight_norm_after: 0.03179600
  weight_change: 0.00009419
  grad_norm: 0.00001716
celestial_key_projection.weight:
  weight_norm_before: 5.73953104
  weight_norm_after: 5.71677637
  weight_change: 0.02275467
  grad_norm: 0.00012723
celestial_key_projection.bias:
  weight_norm_before: 0.00000017
  weight_norm_after: 0.00000015
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 7.68969774
  weight_norm_after: 7.67886114
  weight_change: 0.01083660
  grad_norm: 0.00188613
celestial_value_projection.bias:
  weight_norm_before: 0.05058025
  weight_norm_after: 0.05051620
  weight_change: 0.00006405
  grad_norm: 0.00039619
celestial_output_projection.weight:
  weight_norm_before: 7.99061632
  weight_norm_after: 7.98338795
  weight_change: 0.00722837
  grad_norm: 0.00638884
celestial_output_projection.bias:
  weight_norm_before: 0.06202648
  weight_norm_after: 0.06207713
  weight_change: 0.00005065
  grad_norm: 0.00101078
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 6.49414206
  weight_norm_after: 6.47039080
  weight_change: 0.02375126
  grad_norm: 0.00060081
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.05020462
  weight_norm_after: 0.05015002
  weight_change: 0.00005460
  grad_norm: 0.00014607
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 6.41870403
  weight_norm_after: 6.39425278
  weight_change: 0.02445126
  grad_norm: 0.00034727
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.04908740
  weight_norm_after: 0.04900021
  weight_change: 0.00008719
  grad_norm: 0.00008782
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 6.62499809
  weight_norm_after: 6.60151386
  weight_change: 0.02348423
  grad_norm: 0.00047710
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03999936
  weight_norm_after: 0.03992706
  weight_change: 0.00007230
  grad_norm: 0.00011908
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 6.49980831
  weight_norm_after: 6.47542524
  weight_change: 0.02438307
  grad_norm: 0.00120430
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.06883987
  weight_norm_after: 0.06764675
  weight_change: 0.00119312
  grad_norm: 0.00031539
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 8.63272572
  weight_norm_after: 8.62026119
  weight_change: 0.01246452
  grad_norm: 0.00172447
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000151
  weight_norm_after: 0.00000174
  weight_change: 0.00000023
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 9.81220436
  weight_norm_after: 9.80837536
  weight_change: 0.00382900
  grad_norm: 0.01963083
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.09272931
  weight_norm_after: 0.09299782
  weight_change: 0.00026851
  grad_norm: 0.00398759
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.66050816
  weight_norm_after: 9.65802097
  weight_change: 0.00248718
  grad_norm: 0.11074786
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.10301349
  weight_norm_after: 0.10314865
  weight_change: 0.00013516
  grad_norm: 0.01028268
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.67706203
  weight_norm_after: 9.67447567
  weight_change: 0.00258636
  grad_norm: 0.06906892
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01736544
  weight_norm_after: 0.01554658
  weight_change: 0.00181886
  grad_norm: 0.04494831
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.68116856
  weight_norm_after: 9.67931652
  weight_change: 0.00185204
  grad_norm: 0.10759583
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.10799450
  weight_norm_after: 0.10845850
  weight_change: 0.00046401
  grad_norm: 0.01087226
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.65523243
  weight_norm_after: 9.65259075
  weight_change: 0.00264168
  grad_norm: 0.08372100
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01736544
  weight_norm_after: 0.01554658
  weight_change: 0.00181886
  grad_norm: 0.04494831
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.73587036
  weight_norm_after: 9.73396587
  weight_change: 0.00190449
  grad_norm: 0.13683057
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.09797130
  weight_norm_after: 0.09842643
  weight_change: 0.00045513
  grad_norm: 0.01522726
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.68492794
  weight_norm_after: 9.68279648
  weight_change: 0.00213146
  grad_norm: 0.10034005
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01736544
  weight_norm_after: 0.01554658
  weight_change: 0.00181886
  grad_norm: 0.04494831
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.68798447
  weight_norm_after: 9.68549061
  weight_change: 0.00249386
  grad_norm: 0.15730563
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.10840081
  weight_norm_after: 0.10852780
  weight_change: 0.00012699
  grad_norm: 0.01629665
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.50583458
  weight_norm_after: 9.50263119
  weight_change: 0.00320339
  grad_norm: 0.16524456
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01736544
  weight_norm_after: 0.01554658
  weight_change: 0.00181886
  grad_norm: 0.04494831
projection.weight:
  weight_norm_before: 2.59940815
  weight_norm_after: 2.59797812
  weight_change: 0.00143003
  grad_norm: 0.63028795
projection.bias:
  weight_norm_before: 0.00358757
  weight_norm_after: 0.00303772
  weight_change: 0.00054985
  grad_norm: 0.15544027
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 2.01033592
  weight_norm_after: 1.98479807
  weight_change: 0.02553785
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 9.33285332
  weight_norm_after: 9.32612801
  weight_change: 0.00672531
  grad_norm: 0.01116119
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.05823576
  weight_norm_after: 0.05829383
  weight_change: 0.00005807
  grad_norm: 0.02605719
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 9.69304562
  weight_norm_after: 9.68920612
  weight_change: 0.00383949
  grad_norm: 0.00210836
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06487748
  weight_norm_after: 0.06509348
  weight_change: 0.00021600
  grad_norm: 0.00190318
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 3.01194143
  weight_norm_after: 3.00845599
  weight_change: 0.00348544
  grad_norm: 0.00066739
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02229627
  weight_norm_after: 0.02228405
  weight_change: 0.00001222
  grad_norm: 0.00065432
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.71365714
  weight_norm_after: 3.71138120
  weight_change: 0.00227594
  grad_norm: 0.00018228
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02301605
  weight_norm_after: 0.02291222
  weight_change: 0.00010383
  grad_norm: 0.00017012
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 150/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.78236139
loss (scaled for backward): 1.78236139
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 161.33983622
avg train_loss so far: 1.06847574
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.377299 / 0.205620
y_true_for_loss mean/std: -0.237928 / 1.162223
reg_loss contribution: 0.00135229

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 10.90223026
  weight_norm_after: 10.88946533
  weight_change: 0.01276493
  grad_norm: 0.00294085
celestial_projection.0.bias:
  weight_norm_before: 0.06308057
  weight_norm_after: 0.06307209
  weight_change: 0.00000848
  grad_norm: 0.00013057
celestial_projection.1.weight:
  weight_norm_before: 9.53495979
  weight_norm_after: 9.53083611
  weight_change: 0.00412369
  grad_norm: 0.00034249
celestial_projection.1.bias:
  weight_norm_before: 0.08135433
  weight_norm_after: 0.08136337
  weight_change: 0.00000904
  grad_norm: 0.00029064
celestial_query_projection.weight:
  weight_norm_before: 3.75713825
  weight_norm_after: 3.73975515
  weight_change: 0.01738310
  grad_norm: 0.00007474
celestial_query_projection.bias:
  weight_norm_before: 0.02706123
  weight_norm_after: 0.02697387
  weight_change: 0.00008737
  grad_norm: 0.00001073
celestial_key_projection.weight:
  weight_norm_before: 4.64952850
  weight_norm_after: 4.62890768
  weight_change: 0.02062082
  grad_norm: 0.00009485
celestial_key_projection.bias:
  weight_norm_before: 0.00000028
  weight_norm_after: 0.00000010
  weight_change: 0.00000017
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 7.13370705
  weight_norm_after: 7.12234974
  weight_change: 0.01135731
  grad_norm: 0.00097782
celestial_value_projection.bias:
  weight_norm_before: 0.04939720
  weight_norm_after: 0.04936346
  weight_change: 0.00003374
  grad_norm: 0.00019839
celestial_output_projection.weight:
  weight_norm_before: 7.61611938
  weight_norm_after: 7.60842180
  weight_change: 0.00769758
  grad_norm: 0.00409016
celestial_output_projection.bias:
  weight_norm_before: 0.06306466
  weight_norm_after: 0.06308393
  weight_change: 0.00001927
  grad_norm: 0.00063229
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 5.36762333
  weight_norm_after: 5.34650040
  weight_change: 0.02112293
  grad_norm: 0.00022445
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.04561037
  weight_norm_after: 0.04548479
  weight_change: 0.00012558
  grad_norm: 0.00005250
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 5.27528238
  weight_norm_after: 5.25424767
  weight_change: 0.02103472
  grad_norm: 0.00015220
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.04590356
  weight_norm_after: 0.04594933
  weight_change: 0.00004577
  grad_norm: 0.00002917
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 5.52024746
  weight_norm_after: 5.49960947
  weight_change: 0.02063799
  grad_norm: 0.00021479
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03866581
  weight_norm_after: 0.03862220
  weight_change: 0.00004360
  grad_norm: 0.00006102
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 5.38226509
  weight_norm_after: 5.36171055
  weight_change: 0.02055454
  grad_norm: 0.00029624
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.05300958
  weight_norm_after: 0.05303469
  weight_change: 0.00002511
  grad_norm: 0.00007446
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 7.99845028
  weight_norm_after: 7.98544312
  weight_change: 0.01300716
  grad_norm: 0.00056133
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000092
  weight_norm_after: 0.00000081
  weight_change: 0.00000011
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 9.61748219
  weight_norm_after: 9.61341953
  weight_change: 0.00406265
  grad_norm: 0.01286460
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.09958021
  weight_norm_after: 0.09961753
  weight_change: 0.00003733
  grad_norm: 0.00252278
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.54306126
  weight_norm_after: 9.54090309
  weight_change: 0.00215816
  grad_norm: 0.12184699
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.11672893
  weight_norm_after: 0.11704681
  weight_change: 0.00031788
  grad_norm: 0.01070065
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.56019878
  weight_norm_after: 9.55776978
  weight_change: 0.00242901
  grad_norm: 0.08291283
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01761790
  weight_norm_after: 0.01785025
  weight_change: 0.00023236
  grad_norm: 0.04924047
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.58414078
  weight_norm_after: 9.58221531
  weight_change: 0.00192547
  grad_norm: 0.10697532
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.13374394
  weight_norm_after: 0.13423999
  weight_change: 0.00049604
  grad_norm: 0.00948408
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.54603195
  weight_norm_after: 9.54401875
  weight_change: 0.00201321
  grad_norm: 0.10176290
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01761790
  weight_norm_after: 0.01785025
  weight_change: 0.00023236
  grad_norm: 0.04924047
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.64436436
  weight_norm_after: 9.64221954
  weight_change: 0.00214481
  grad_norm: 0.13032345
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.12512581
  weight_norm_after: 0.12569864
  weight_change: 0.00057283
  grad_norm: 0.01353135
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.59543133
  weight_norm_after: 9.59386921
  weight_change: 0.00156212
  grad_norm: 0.09658449
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01761790
  weight_norm_after: 0.01785025
  weight_change: 0.00023236
  grad_norm: 0.04924047
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.58356094
  weight_norm_after: 9.58144283
  weight_change: 0.00211811
  grad_norm: 0.13675855
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.13087931
  weight_norm_after: 0.13115855
  weight_change: 0.00027923
  grad_norm: 0.01359000
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.38955784
  weight_norm_after: 9.38767338
  weight_change: 0.00188446
  grad_norm: 0.12685110
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01761790
  weight_norm_after: 0.01785025
  weight_change: 0.00023236
  grad_norm: 0.04924047
projection.weight:
  weight_norm_before: 2.54809475
  weight_norm_after: 2.54756546
  weight_change: 0.00052929
  grad_norm: 0.65937406
projection.bias:
  weight_norm_before: 0.00296368
  weight_norm_after: 0.00289003
  weight_change: 0.00007364
  grad_norm: 0.18084155
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 1.02407181
  weight_norm_after: 1.00959361
  weight_change: 0.01447821
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 8.98430920
  weight_norm_after: 8.97715855
  weight_change: 0.00715065
  grad_norm: 0.00692948
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.06166514
  weight_norm_after: 0.06177149
  weight_change: 0.00010634
  grad_norm: 0.01676283
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 9.49056053
  weight_norm_after: 9.48635101
  weight_change: 0.00420952
  grad_norm: 0.00126564
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07129959
  weight_norm_after: 0.07133255
  weight_change: 0.00003296
  grad_norm: 0.00122412
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.84153891
  weight_norm_after: 2.83828425
  weight_change: 0.00325465
  grad_norm: 0.00042346
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02428531
  weight_norm_after: 0.02430717
  weight_change: 0.00002186
  grad_norm: 0.00035726
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.60435557
  weight_norm_after: 3.60207534
  weight_change: 0.00228024
  grad_norm: 0.00011880
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02339717
  weight_norm_after: 0.02334380
  weight_change: 0.00005337
  grad_norm: 0.00010472
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 200/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 2.57945347
loss (scaled for backward): 2.57945347
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 223.51440202
avg train_loss so far: 1.11201195
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.017755 / 0.139195
y_true_for_loss mean/std: 0.436120 / 1.551260
reg_loss contribution: 0.00061850

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 10.26033401
  weight_norm_after: 10.24750614
  weight_change: 0.01282787
  grad_norm: 0.00671985
celestial_projection.0.bias:
  weight_norm_before: 0.06304766
  weight_norm_after: 0.06303049
  weight_change: 0.00001717
  grad_norm: 0.00014267
celestial_projection.1.weight:
  weight_norm_before: 9.32218933
  weight_norm_after: 9.31782246
  weight_change: 0.00436687
  grad_norm: 0.00068456
celestial_projection.1.bias:
  weight_norm_before: 0.08101986
  weight_norm_after: 0.08095545
  weight_change: 0.00006441
  grad_norm: 0.00051291
celestial_query_projection.weight:
  weight_norm_before: 2.98842239
  weight_norm_after: 2.97497201
  weight_change: 0.01345038
  grad_norm: 0.00002710
celestial_query_projection.bias:
  weight_norm_before: 0.02228145
  weight_norm_after: 0.02219805
  weight_change: 0.00008340
  grad_norm: 0.00000274
celestial_key_projection.weight:
  weight_norm_before: 3.68854785
  weight_norm_after: 3.67085695
  weight_change: 0.01769090
  grad_norm: 0.00007403
celestial_key_projection.bias:
  weight_norm_before: 0.00000004
  weight_norm_after: 0.00000003
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 6.56584406
  weight_norm_after: 6.55453491
  weight_change: 0.01130915
  grad_norm: 0.00090978
celestial_value_projection.bias:
  weight_norm_before: 0.04867030
  weight_norm_after: 0.04865163
  weight_change: 0.00001866
  grad_norm: 0.00017907
celestial_output_projection.weight:
  weight_norm_before: 7.23028374
  weight_norm_after: 7.22263145
  weight_change: 0.00765228
  grad_norm: 0.00381834
celestial_output_projection.bias:
  weight_norm_before: 0.06374639
  weight_norm_after: 0.06373358
  weight_change: 0.00001281
  grad_norm: 0.00068748
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 4.40003061
  weight_norm_after: 4.38235378
  weight_change: 0.01767683
  grad_norm: 0.00015927
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.04001895
  weight_norm_after: 0.03994016
  weight_change: 0.00007879
  grad_norm: 0.00004656
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 4.30262136
  weight_norm_after: 4.28488302
  weight_change: 0.01773834
  grad_norm: 0.00023494
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.04114641
  weight_norm_after: 0.04095252
  weight_change: 0.00019389
  grad_norm: 0.00007065
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 4.56762314
  weight_norm_after: 4.55028629
  weight_change: 0.01733685
  grad_norm: 0.00071513
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03819564
  weight_norm_after: 0.03838455
  weight_change: 0.00018891
  grad_norm: 0.00021368
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 4.43057632
  weight_norm_after: 4.41328573
  weight_change: 0.01729059
  grad_norm: 0.00027262
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.05030545
  weight_norm_after: 0.05030348
  weight_change: 0.00000197
  grad_norm: 0.00007338
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 7.33775139
  weight_norm_after: 7.32444859
  weight_change: 0.01330280
  grad_norm: 0.00105923
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000073
  weight_norm_after: 0.00000093
  weight_change: 0.00000020
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 9.40514565
  weight_norm_after: 9.40081120
  weight_change: 0.00433445
  grad_norm: 0.01701883
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.10216713
  weight_norm_after: 0.10221767
  weight_change: 0.00005054
  grad_norm: 0.00322681
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.42867470
  weight_norm_after: 9.42652988
  weight_change: 0.00214481
  grad_norm: 0.16928051
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.12781365
  weight_norm_after: 0.12831147
  weight_change: 0.00049782
  grad_norm: 0.01514801
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.44824600
  weight_norm_after: 9.44592094
  weight_change: 0.00232506
  grad_norm: 0.16079792
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.01886171
  weight_norm_after: 0.01966201
  weight_change: 0.00080030
  grad_norm: 0.03325712
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.48230743
  weight_norm_after: 9.48012447
  weight_change: 0.00218296
  grad_norm: 0.17504352
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.14541225
  weight_norm_after: 0.14548646
  weight_change: 0.00007421
  grad_norm: 0.01555311
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.44539928
  weight_norm_after: 9.44376755
  weight_change: 0.00163174
  grad_norm: 0.13225664
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.01886171
  weight_norm_after: 0.01966201
  weight_change: 0.00080030
  grad_norm: 0.03325712
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.55864334
  weight_norm_after: 9.55659485
  weight_change: 0.00204849
  grad_norm: 0.17655377
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.14113267
  weight_norm_after: 0.14108978
  weight_change: 0.00004289
  grad_norm: 0.01630497
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.51344585
  weight_norm_after: 9.51190376
  weight_change: 0.00154209
  grad_norm: 0.12995909
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.01886171
  weight_norm_after: 0.01966201
  weight_change: 0.00080030
  grad_norm: 0.03325712
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.47279263
  weight_norm_after: 9.47082424
  weight_change: 0.00196838
  grad_norm: 0.18732454
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.14240144
  weight_norm_after: 0.14273018
  weight_change: 0.00032873
  grad_norm: 0.01842040
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.28182411
  weight_norm_after: 9.27976513
  weight_change: 0.00205898
  grad_norm: 0.14606450
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.01886171
  weight_norm_after: 0.01966201
  weight_change: 0.00080030
  grad_norm: 0.03325712
projection.weight:
  weight_norm_before: 2.51658988
  weight_norm_after: 2.51620007
  weight_change: 0.00038981
  grad_norm: 0.45076662
projection.bias:
  weight_norm_before: 0.00236626
  weight_norm_after: 0.00256659
  weight_change: 0.00020034
  grad_norm: 0.10245612
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.48428059
  weight_norm_after: 0.47671077
  weight_change: 0.00756982
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 8.62235260
  weight_norm_after: 8.61515236
  weight_change: 0.00720024
  grad_norm: 0.00980216
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.06340435
  weight_norm_after: 0.06345912
  weight_change: 0.00005477
  grad_norm: 0.02499164
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 9.27923489
  weight_norm_after: 9.27498341
  weight_change: 0.00425148
  grad_norm: 0.00166164
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07381266
  weight_norm_after: 0.07387654
  weight_change: 0.00006387
  grad_norm: 0.00176920
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.68496943
  weight_norm_after: 2.68199825
  weight_change: 0.00297117
  grad_norm: 0.00047253
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02390046
  weight_norm_after: 0.02389288
  weight_change: 0.00000758
  grad_norm: 0.00060268
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.49330306
  weight_norm_after: 3.49105024
  weight_change: 0.00225282
  grad_norm: 0.00015731
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02280626
  weight_norm_after: 0.02277611
  weight_change: 0.00003014
  grad_norm: 0.00016245
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 250/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.64299870
loss (scaled for backward): 1.64299870
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 272.73938785
avg train_loss so far: 1.08661111
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.171212 / 0.108781
y_true_for_loss mean/std: 0.112260 / 1.296320
reg_loss contribution: 0.00020459

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 9.62172794
  weight_norm_after: 9.60906696
  weight_change: 0.01266098
  grad_norm: 0.00198038
celestial_projection.0.bias:
  weight_norm_before: 0.06057281
  weight_norm_after: 0.06048253
  weight_change: 0.00009027
  grad_norm: 0.00012809
celestial_projection.1.weight:
  weight_norm_before: 9.09811687
  weight_norm_after: 9.09354210
  weight_change: 0.00457478
  grad_norm: 0.00023676
celestial_projection.1.bias:
  weight_norm_before: 0.07851536
  weight_norm_after: 0.07844524
  weight_change: 0.00007012
  grad_norm: 0.00018132
celestial_query_projection.weight:
  weight_norm_before: 2.39158511
  weight_norm_after: 2.38108397
  weight_change: 0.01050115
  grad_norm: 0.00000801
celestial_query_projection.bias:
  weight_norm_before: 0.01805757
  weight_norm_after: 0.01797661
  weight_change: 0.00008096
  grad_norm: 0.00000100
celestial_key_projection.weight:
  weight_norm_before: 2.87755990
  weight_norm_after: 2.86287093
  weight_change: 0.01468897
  grad_norm: 0.00001159
celestial_key_projection.bias:
  weight_norm_before: 0.00000002
  weight_norm_after: 0.00000001
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 6.00560760
  weight_norm_after: 5.99455118
  weight_change: 0.01105642
  grad_norm: 0.00058028
celestial_value_projection.bias:
  weight_norm_before: 0.04772651
  weight_norm_after: 0.04767840
  weight_change: 0.00004811
  grad_norm: 0.00012753
celestial_output_projection.weight:
  weight_norm_before: 6.84788084
  weight_norm_after: 6.84027195
  weight_change: 0.00760889
  grad_norm: 0.00257249
celestial_output_projection.bias:
  weight_norm_before: 0.06428723
  weight_norm_after: 0.06429713
  weight_change: 0.00000990
  grad_norm: 0.00058043
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 3.59454679
  weight_norm_after: 3.58001208
  weight_change: 0.01453471
  grad_norm: 0.00005625
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.03416340
  weight_norm_after: 0.03402852
  weight_change: 0.00013489
  grad_norm: 0.00001705
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 3.49834847
  weight_norm_after: 3.48386955
  weight_change: 0.01447892
  grad_norm: 0.00003021
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.03489033
  weight_norm_after: 0.03476413
  weight_change: 0.00012620
  grad_norm: 0.00000912
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 3.77237630
  weight_norm_after: 3.75788808
  weight_change: 0.01448822
  grad_norm: 0.00010577
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.04031166
  weight_norm_after: 0.04021706
  weight_change: 0.00009460
  grad_norm: 0.00003259
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 3.63796878
  weight_norm_after: 3.62364340
  weight_change: 0.01432538
  grad_norm: 0.00004838
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.04293603
  weight_norm_after: 0.04279402
  weight_change: 0.00014202
  grad_norm: 0.00001318
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 6.67122412
  weight_norm_after: 6.65793324
  weight_change: 0.01329088
  grad_norm: 0.00022154
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000084
  weight_norm_after: 0.00000039
  weight_change: 0.00000045
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 9.17809868
  weight_norm_after: 9.17345238
  weight_change: 0.00464630
  grad_norm: 0.01079741
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.10530047
  weight_norm_after: 0.10535328
  weight_change: 0.00005281
  grad_norm: 0.00230197
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.31111717
  weight_norm_after: 9.30863476
  weight_change: 0.00248241
  grad_norm: 0.09728082
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.13935792
  weight_norm_after: 0.13941507
  weight_change: 0.00005715
  grad_norm: 0.00925772
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.33744049
  weight_norm_after: 9.33544445
  weight_change: 0.00199604
  grad_norm: 0.07366237
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.02074685
  weight_norm_after: 0.02070669
  weight_change: 0.00004016
  grad_norm: 0.05838434
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.36913395
  weight_norm_after: 9.36702156
  weight_change: 0.00211239
  grad_norm: 0.11752994
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.15731612
  weight_norm_after: 0.15748255
  weight_change: 0.00016643
  grad_norm: 0.01154902
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.34571362
  weight_norm_after: 9.34378624
  weight_change: 0.00192738
  grad_norm: 0.09080160
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.02074685
  weight_norm_after: 0.02070669
  weight_change: 0.00004016
  grad_norm: 0.05838434
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.45633507
  weight_norm_after: 9.45469666
  weight_change: 0.00163841
  grad_norm: 0.17046139
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.14735968
  weight_norm_after: 0.14749356
  weight_change: 0.00013387
  grad_norm: 0.01937045
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.42963791
  weight_norm_after: 9.42803955
  weight_change: 0.00159836
  grad_norm: 0.13962729
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.02074685
  weight_norm_after: 0.02070669
  weight_change: 0.00004016
  grad_norm: 0.05838434
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.36049747
  weight_norm_after: 9.35856915
  weight_change: 0.00192833
  grad_norm: 0.07598352
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.15375319
  weight_norm_after: 0.15407625
  weight_change: 0.00032306
  grad_norm: 0.00778331
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.17693901
  weight_norm_after: 9.17498016
  weight_change: 0.00195885
  grad_norm: 0.08942439
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.02074685
  weight_norm_after: 0.02070669
  weight_change: 0.00004016
  grad_norm: 0.05838434
projection.weight:
  weight_norm_before: 2.48630810
  weight_norm_after: 2.48585033
  weight_change: 0.00045776
  grad_norm: 0.66276962
projection.bias:
  weight_norm_before: 0.00240193
  weight_norm_after: 0.00238932
  weight_change: 0.00001261
  grad_norm: 0.20083177
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.21207543
  weight_norm_after: 0.20843551
  weight_change: 0.00363992
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 8.25659275
  weight_norm_after: 8.24924278
  weight_change: 0.00734997
  grad_norm: 0.00494601
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.06465735
  weight_norm_after: 0.06469817
  weight_change: 0.00004081
  grad_norm: 0.01370468
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 9.05985165
  weight_norm_after: 9.05548763
  weight_change: 0.00436401
  grad_norm: 0.00095576
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07290057
  weight_norm_after: 0.07297883
  weight_change: 0.00007826
  grad_norm: 0.00091512
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.54204655
  weight_norm_after: 2.53933001
  weight_change: 0.00271654
  grad_norm: 0.00032637
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02423741
  weight_norm_after: 0.02422883
  weight_change: 0.00000857
  grad_norm: 0.00035725
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.37914777
  weight_norm_after: 3.37687349
  weight_change: 0.00227427
  grad_norm: 0.00011548
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02187225
  weight_norm_after: 0.02183319
  weight_change: 0.00003905
  grad_norm: 0.00009438
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 300/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.22236922
loss (scaled for backward): 0.22236922
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 331.87138087
avg train_loss so far: 1.10256273
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.133261 / 0.056305
y_true_for_loss mean/std: -0.069259 / 0.435491
reg_loss contribution: 0.00012369

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 9.00031281
  weight_norm_after: 8.98812675
  weight_change: 0.01218605
  grad_norm: 0.00251337
celestial_projection.0.bias:
  weight_norm_before: 0.05685216
  weight_norm_after: 0.05682451
  weight_change: 0.00002765
  grad_norm: 0.00004734
celestial_projection.1.weight:
  weight_norm_before: 8.86493778
  weight_norm_after: 8.86020851
  weight_change: 0.00472927
  grad_norm: 0.00022475
celestial_projection.1.bias:
  weight_norm_before: 0.07483722
  weight_norm_after: 0.07478426
  weight_change: 0.00005296
  grad_norm: 0.00020119
celestial_query_projection.weight:
  weight_norm_before: 1.92355204
  weight_norm_after: 1.91526544
  weight_change: 0.00828660
  grad_norm: 0.00000478
celestial_query_projection.bias:
  weight_norm_before: 0.01430643
  weight_norm_after: 0.01423802
  weight_change: 0.00006841
  grad_norm: 0.00000061
celestial_key_projection.weight:
  weight_norm_before: 2.21379924
  weight_norm_after: 2.20193863
  weight_change: 0.01186061
  grad_norm: 0.00001289
celestial_key_projection.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 5.46565390
  weight_norm_after: 5.45510626
  weight_change: 0.01054764
  grad_norm: 0.00088241
celestial_value_projection.bias:
  weight_norm_before: 0.04663941
  weight_norm_after: 0.04662815
  weight_change: 0.00001126
  grad_norm: 0.00020260
celestial_output_projection.weight:
  weight_norm_before: 6.47245836
  weight_norm_after: 6.46504974
  weight_change: 0.00740862
  grad_norm: 0.00311340
celestial_output_projection.bias:
  weight_norm_before: 0.06352860
  weight_norm_after: 0.06353409
  weight_change: 0.00000548
  grad_norm: 0.00084058
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 2.93523979
  weight_norm_after: 2.92340922
  weight_change: 0.01183057
  grad_norm: 0.00003930
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.02852932
  weight_norm_after: 0.02844402
  weight_change: 0.00008530
  grad_norm: 0.00001256
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 2.84403300
  weight_norm_after: 2.83228374
  weight_change: 0.01174927
  grad_norm: 0.00002654
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.02943712
  weight_norm_after: 0.02930763
  weight_change: 0.00012949
  grad_norm: 0.00000866
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 3.11375856
  weight_norm_after: 3.10188389
  weight_change: 0.01187468
  grad_norm: 0.00006415
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03607288
  weight_norm_after: 0.03599710
  weight_change: 0.00007577
  grad_norm: 0.00002192
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 2.99228811
  weight_norm_after: 2.98059583
  weight_change: 0.01169229
  grad_norm: 0.00006176
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.04362157
  weight_norm_after: 0.04353224
  weight_change: 0.00008933
  grad_norm: 0.00002081
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 6.01650143
  weight_norm_after: 6.00359869
  weight_change: 0.01290274
  grad_norm: 0.00017344
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000036
  weight_norm_after: 0.00000031
  weight_change: 0.00000005
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 8.94009876
  weight_norm_after: 8.93520641
  weight_change: 0.00489235
  grad_norm: 0.00728129
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.10910214
  weight_norm_after: 0.10909731
  weight_change: 0.00000483
  grad_norm: 0.00160232
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.20461464
  weight_norm_after: 9.20236015
  weight_change: 0.00225449
  grad_norm: 0.08748803
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.15050139
  weight_norm_after: 0.15067700
  weight_change: 0.00017561
  grad_norm: 0.00779255
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.23427677
  weight_norm_after: 9.23207092
  weight_change: 0.00220585
  grad_norm: 0.10210270
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.02603580
  weight_norm_after: 0.02591629
  weight_change: 0.00011952
  grad_norm: 0.06341895
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.26895905
  weight_norm_after: 9.26679802
  weight_change: 0.00216103
  grad_norm: 0.06429600
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.17095684
  weight_norm_after: 0.17121433
  weight_change: 0.00025749
  grad_norm: 0.00606785
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.24875164
  weight_norm_after: 9.24663258
  weight_change: 0.00211906
  grad_norm: 0.09177997
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.02603580
  weight_norm_after: 0.02591629
  weight_change: 0.00011952
  grad_norm: 0.06341895
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.36813068
  weight_norm_after: 9.36657429
  weight_change: 0.00155640
  grad_norm: 0.14884755
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.16347490
  weight_norm_after: 0.16387413
  weight_change: 0.00039923
  grad_norm: 0.01594499
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.34609413
  weight_norm_after: 9.34433174
  weight_change: 0.00176239
  grad_norm: 0.10795511
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.02603580
  weight_norm_after: 0.02591629
  weight_change: 0.00011952
  grad_norm: 0.06341895
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.25479984
  weight_norm_after: 9.25293541
  weight_change: 0.00186443
  grad_norm: 0.11248381
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.16361290
  weight_norm_after: 0.16396759
  weight_change: 0.00035469
  grad_norm: 0.01157192
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 9.08133984
  weight_norm_after: 9.07937241
  weight_change: 0.00196743
  grad_norm: 0.11486948
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.02603580
  weight_norm_after: 0.02591629
  weight_change: 0.00011952
  grad_norm: 0.06341895
projection.weight:
  weight_norm_before: 2.45222235
  weight_norm_after: 2.45157981
  weight_change: 0.00064254
  grad_norm: 0.65888655
projection.bias:
  weight_norm_before: 0.00359408
  weight_norm_after: 0.00353538
  weight_change: 0.00005870
  grad_norm: 0.22696157
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.08582181
  weight_norm_after: 0.08421378
  weight_change: 0.00160804
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 7.89082766
  weight_norm_after: 7.88353109
  weight_change: 0.00729656
  grad_norm: 0.00464823
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.06742388
  weight_norm_after: 0.06746953
  weight_change: 0.00004565
  grad_norm: 0.01350033
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 8.83564663
  weight_norm_after: 8.83113766
  weight_change: 0.00450897
  grad_norm: 0.00110970
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07573637
  weight_norm_after: 0.07576437
  weight_change: 0.00002800
  grad_norm: 0.00090222
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.41143394
  weight_norm_after: 2.40892005
  weight_change: 0.00251389
  grad_norm: 0.00019484
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02317607
  weight_norm_after: 0.02314747
  weight_change: 0.00002860
  grad_norm: 0.00018253
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.26611233
  weight_norm_after: 3.26387024
  weight_change: 0.00224209
  grad_norm: 0.00005786
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02071549
  weight_norm_after: 0.02069712
  weight_change: 0.00001837
  grad_norm: 0.00005348
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 350/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.79951096
loss (scaled for backward): 0.79951096
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 378.98529357
avg train_loss so far: 1.07973018
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.108045 / 0.110510
y_true_for_loss mean/std: -0.344062 / 0.857847
reg_loss contribution: 0.00006774

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 8.40377235
  weight_norm_after: 8.39216042
  weight_change: 0.01161194
  grad_norm: 0.00097318
celestial_projection.0.bias:
  weight_norm_before: 0.05521268
  weight_norm_after: 0.05514359
  weight_change: 0.00006909
  grad_norm: 0.00003622
celestial_projection.1.weight:
  weight_norm_before: 8.62731171
  weight_norm_after: 8.62249279
  weight_change: 0.00481892
  grad_norm: 0.00012210
celestial_projection.1.bias:
  weight_norm_before: 0.07253814
  weight_norm_after: 0.07246386
  weight_change: 0.00007427
  grad_norm: 0.00007305
celestial_query_projection.weight:
  weight_norm_before: 1.55229497
  weight_norm_after: 1.54568756
  weight_change: 0.00660741
  grad_norm: 0.00000097
celestial_query_projection.bias:
  weight_norm_before: 0.01119219
  weight_norm_after: 0.01113582
  weight_change: 0.00005637
  grad_norm: 0.00000012
celestial_key_projection.weight:
  weight_norm_before: 1.68343937
  weight_norm_after: 1.67406714
  weight_change: 0.00937223
  grad_norm: 0.00000194
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 4.95301533
  weight_norm_after: 4.94310093
  weight_change: 0.00991440
  grad_norm: 0.00025001
celestial_value_projection.bias:
  weight_norm_before: 0.04540291
  weight_norm_after: 0.04536905
  weight_change: 0.00003386
  grad_norm: 0.00006071
celestial_output_projection.weight:
  weight_norm_before: 6.10879660
  weight_norm_after: 6.10168076
  weight_change: 0.00711584
  grad_norm: 0.00110687
celestial_output_projection.bias:
  weight_norm_before: 0.06381955
  weight_norm_after: 0.06385888
  weight_change: 0.00003933
  grad_norm: 0.00036046
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 2.39827323
  weight_norm_after: 2.38860965
  weight_change: 0.00966358
  grad_norm: 0.00002622
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.02416798
  weight_norm_after: 0.02407598
  weight_change: 0.00009200
  grad_norm: 0.00000978
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 2.31420088
  weight_norm_after: 2.30470061
  weight_change: 0.00950027
  grad_norm: 0.00000475
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.02461883
  weight_norm_after: 0.02452827
  weight_change: 0.00009056
  grad_norm: 0.00000185
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 2.57402158
  weight_norm_after: 2.56428051
  weight_change: 0.00974107
  grad_norm: 0.00001139
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.03371060
  weight_norm_after: 0.03366827
  weight_change: 0.00004232
  grad_norm: 0.00000429
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 2.46198511
  weight_norm_after: 2.45243812
  weight_change: 0.00954700
  grad_norm: 0.00001179
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.03899397
  weight_norm_after: 0.03891113
  weight_change: 0.00008284
  grad_norm: 0.00000346
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 5.38465786
  weight_norm_after: 5.37232924
  weight_change: 0.01232862
  grad_norm: 0.00004980
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000014
  weight_norm_after: 0.00000013
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 8.69082832
  weight_norm_after: 8.68575668
  weight_change: 0.00507164
  grad_norm: 0.00324529
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.10878295
  weight_norm_after: 0.10881733
  weight_change: 0.00003438
  grad_norm: 0.00072106
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 9.09471607
  weight_norm_after: 9.09276104
  weight_change: 0.00195503
  grad_norm: 0.04993735
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.15966973
  weight_norm_after: 0.16002306
  weight_change: 0.00035334
  grad_norm: 0.00413227
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.13039494
  weight_norm_after: 9.12840080
  weight_change: 0.00199413
  grad_norm: 0.05902189
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.02723188
  weight_norm_after: 0.02717039
  weight_change: 0.00006149
  grad_norm: 0.02604680
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.16061878
  weight_norm_after: 9.15826893
  weight_change: 0.00234985
  grad_norm: 0.04239762
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.17968415
  weight_norm_after: 0.17972918
  weight_change: 0.00004503
  grad_norm: 0.00396452
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.14891815
  weight_norm_after: 9.14688396
  weight_change: 0.00203419
  grad_norm: 0.03597381
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.02723188
  weight_norm_after: 0.02717039
  weight_change: 0.00006149
  grad_norm: 0.02604680
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.28510952
  weight_norm_after: 9.28320122
  weight_change: 0.00190830
  grad_norm: 0.05735489
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.17563099
  weight_norm_after: 0.17583808
  weight_change: 0.00020710
  grad_norm: 0.00613692
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.26496601
  weight_norm_after: 9.26331139
  weight_change: 0.00165462
  grad_norm: 0.05186971
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.02723188
  weight_norm_after: 0.02717039
  weight_change: 0.00006149
  grad_norm: 0.02604680
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.16247082
  weight_norm_after: 9.16042042
  weight_change: 0.00205040
  grad_norm: 0.05334209
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.18152621
  weight_norm_after: 0.18183181
  weight_change: 0.00030559
  grad_norm: 0.00530200
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.98113632
  weight_norm_after: 8.97907257
  weight_change: 0.00206375
  grad_norm: 0.04379927
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.02723188
  weight_norm_after: 0.02717039
  weight_change: 0.00006149
  grad_norm: 0.02604680
projection.weight:
  weight_norm_before: 2.42376184
  weight_norm_after: 2.42327023
  weight_change: 0.00049162
  grad_norm: 0.27995276
projection.bias:
  weight_norm_before: 0.00293037
  weight_norm_after: 0.00296341
  weight_change: 0.00003303
  grad_norm: 0.10047539
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.03201356
  weight_norm_after: 0.03136165
  weight_change: 0.00065191
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 7.52957535
  weight_norm_after: 7.52240467
  weight_change: 0.00717068
  grad_norm: 0.00250199
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.06894350
  weight_norm_after: 0.06897825
  weight_change: 0.00003475
  grad_norm: 0.00775439
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 8.60873795
  weight_norm_after: 8.60412121
  weight_change: 0.00461674
  grad_norm: 0.00048954
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07668929
  weight_norm_after: 0.07664417
  weight_change: 0.00004512
  grad_norm: 0.00048163
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.29058647
  weight_norm_after: 2.28827667
  weight_change: 0.00230980
  grad_norm: 0.00012670
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02355240
  weight_norm_after: 0.02354790
  weight_change: 0.00000450
  grad_norm: 0.00013179
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.15374446
  weight_norm_after: 3.15151644
  weight_change: 0.00222802
  grad_norm: 0.00004072
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.02072544
  weight_norm_after: 0.02072792
  weight_change: 0.00000248
  grad_norm: 0.00003330
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 400/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.30956379
loss (scaled for backward): 0.30956379
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 419.41478892
avg train_loss so far: 1.04592217
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.061094 / 0.085239
y_true_for_loss mean/std: 0.024276 / 0.553859
reg_loss contribution: 0.00002722

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 7.83748245
  weight_norm_after: 7.82646179
  weight_change: 0.01102066
  grad_norm: 0.00276453
celestial_projection.0.bias:
  weight_norm_before: 0.05406968
  weight_norm_after: 0.05415940
  weight_change: 0.00008972
  grad_norm: 0.00022074
celestial_projection.1.weight:
  weight_norm_before: 8.38441563
  weight_norm_after: 8.37950897
  weight_change: 0.00490665
  grad_norm: 0.00027867
celestial_projection.1.bias:
  weight_norm_before: 0.06966743
  weight_norm_after: 0.06971671
  weight_change: 0.00004929
  grad_norm: 0.00020144
celestial_query_projection.weight:
  weight_norm_before: 1.25516701
  weight_norm_after: 1.24986053
  weight_change: 0.00530648
  grad_norm: 0.00000032
celestial_query_projection.bias:
  weight_norm_before: 0.00864602
  weight_norm_after: 0.00860047
  weight_change: 0.00004556
  grad_norm: 0.00000003
celestial_key_projection.weight:
  weight_norm_before: 1.26786578
  weight_norm_after: 1.26058745
  weight_change: 0.00727832
  grad_norm: 0.00000147
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 4.47528696
  weight_norm_after: 4.46612167
  weight_change: 0.00916529
  grad_norm: 0.00047783
celestial_value_projection.bias:
  weight_norm_before: 0.04507872
  weight_norm_after: 0.04513384
  weight_change: 0.00005513
  grad_norm: 0.00011847
celestial_output_projection.weight:
  weight_norm_before: 5.76159763
  weight_norm_after: 5.75485277
  weight_change: 0.00674486
  grad_norm: 0.00220337
celestial_output_projection.bias:
  weight_norm_before: 0.06584612
  weight_norm_after: 0.06567091
  weight_change: 0.00017520
  grad_norm: 0.00084386
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 1.95958066
  weight_norm_after: 1.95168138
  weight_change: 0.00789928
  grad_norm: 0.00002298
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01996308
  weight_norm_after: 0.01988725
  weight_change: 0.00007583
  grad_norm: 0.00000999
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 1.88501763
  weight_norm_after: 1.87731373
  weight_change: 0.00770390
  grad_norm: 0.00001061
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.02086401
  weight_norm_after: 0.02080158
  weight_change: 0.00006243
  grad_norm: 0.00000441
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 2.12948585
  weight_norm_after: 2.12145281
  weight_change: 0.00803304
  grad_norm: 0.00004406
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.02880563
  weight_norm_after: 0.02872949
  weight_change: 0.00007615
  grad_norm: 0.00001970
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 2.02813935
  weight_norm_after: 2.02028298
  weight_change: 0.00785637
  grad_norm: 0.00002251
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.03446058
  weight_norm_after: 0.03431072
  weight_change: 0.00014986
  grad_norm: 0.00001004
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 4.78483295
  weight_norm_after: 4.77321386
  weight_change: 0.01161909
  grad_norm: 0.00006649
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000012
  weight_norm_after: 0.00000009
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 8.43647194
  weight_norm_after: 8.43125153
  weight_change: 0.00522041
  grad_norm: 0.01141592
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11109348
  weight_norm_after: 0.11127910
  weight_change: 0.00018562
  grad_norm: 0.00273294
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.99780083
  weight_norm_after: 8.99613285
  weight_change: 0.00166798
  grad_norm: 0.18743233
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.17662014
  weight_norm_after: 0.17752209
  weight_change: 0.00090195
  grad_norm: 0.01717911
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 9.02739620
  weight_norm_after: 9.02504444
  weight_change: 0.00235176
  grad_norm: 0.11645867
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.03319808
  weight_norm_after: 0.03351557
  weight_change: 0.00031749
  grad_norm: 0.05664063
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 9.06856918
  weight_norm_after: 9.06725216
  weight_change: 0.00131702
  grad_norm: 0.09518678
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.19248374
  weight_norm_after: 0.19327012
  weight_change: 0.00078638
  grad_norm: 0.00810835
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 9.04685307
  weight_norm_after: 9.04466724
  weight_change: 0.00218582
  grad_norm: 0.10992382
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.03319808
  weight_norm_after: 0.03351557
  weight_change: 0.00031749
  grad_norm: 0.05664063
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.20230579
  weight_norm_after: 9.20065403
  weight_change: 0.00165176
  grad_norm: 0.16398329
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.18874298
  weight_norm_after: 0.18924539
  weight_change: 0.00050241
  grad_norm: 0.01700632
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.18633938
  weight_norm_after: 9.18453407
  weight_change: 0.00180531
  grad_norm: 0.13626446
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.03319808
  weight_norm_after: 0.03351557
  weight_change: 0.00031749
  grad_norm: 0.05664063
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 9.07116890
  weight_norm_after: 9.06983852
  weight_change: 0.00133038
  grad_norm: 0.13483793
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.19603299
  weight_norm_after: 0.19658254
  weight_change: 0.00054955
  grad_norm: 0.01277341
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.87952995
  weight_norm_after: 8.87728977
  weight_change: 0.00224018
  grad_norm: 0.10792232
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.03319808
  weight_norm_after: 0.03351557
  weight_change: 0.00031749
  grad_norm: 0.05664063
projection.weight:
  weight_norm_before: 2.38408184
  weight_norm_after: 2.38283873
  weight_change: 0.00124311
  grad_norm: 0.65330148
projection.bias:
  weight_norm_before: 0.00231191
  weight_norm_after: 0.00248168
  weight_change: 0.00016977
  grad_norm: 0.25104752
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.01097229
  weight_norm_after: 0.01073025
  weight_change: 0.00024204
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 7.17469978
  weight_norm_after: 7.16761923
  weight_change: 0.00708055
  grad_norm: 0.00514452
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07031841
  weight_norm_after: 0.07033577
  weight_change: 0.00001736
  grad_norm: 0.01670652
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 8.37731266
  weight_norm_after: 8.37282848
  weight_change: 0.00448418
  grad_norm: 0.00119727
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07597800
  weight_norm_after: 0.07613074
  weight_change: 0.00015274
  grad_norm: 0.00104574
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.17991161
  weight_norm_after: 2.17776132
  weight_change: 0.00215030
  grad_norm: 0.00043260
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02251598
  weight_norm_after: 0.02250666
  weight_change: 0.00000932
  grad_norm: 0.00056943
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 3.04051638
  weight_norm_after: 3.03826237
  weight_change: 0.00225401
  grad_norm: 0.00011822
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01930054
  weight_norm_after: 0.01926869
  weight_change: 0.00003185
  grad_norm: 0.00011759
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 450/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.76639962
loss (scaled for backward): 1.76639962
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 466.36395984
avg train_loss so far: 1.03406643
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.019814 / 0.164337
y_true_for_loss mean/std: 0.163699 / 1.327425
reg_loss contribution: 0.00001625

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 7.30200672
  weight_norm_after: 7.29163504
  weight_change: 0.01037169
  grad_norm: 0.00093967
celestial_projection.0.bias:
  weight_norm_before: 0.05446679
  weight_norm_after: 0.05449747
  weight_change: 0.00003068
  grad_norm: 0.00010991
celestial_projection.1.weight:
  weight_norm_before: 8.13640404
  weight_norm_after: 8.13141441
  weight_change: 0.00498962
  grad_norm: 0.00010986
celestial_projection.1.bias:
  weight_norm_before: 0.06806117
  weight_norm_after: 0.06802069
  weight_change: 0.00004048
  grad_norm: 0.00007470
celestial_query_projection.weight:
  weight_norm_before: 1.01589942
  weight_norm_after: 1.01161683
  weight_change: 0.00428259
  grad_norm: 0.00000015
celestial_query_projection.bias:
  weight_norm_before: 0.00659961
  weight_norm_after: 0.00656329
  weight_change: 0.00003633
  grad_norm: 0.00000002
celestial_key_projection.weight:
  weight_norm_before: 0.94713366
  weight_norm_after: 0.94155502
  weight_change: 0.00557864
  grad_norm: 0.00000054
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 4.03201580
  weight_norm_after: 4.02350473
  weight_change: 0.00851107
  grad_norm: 0.00026948
celestial_value_projection.bias:
  weight_norm_before: 0.04396745
  weight_norm_after: 0.04393938
  weight_change: 0.00002807
  grad_norm: 0.00006946
celestial_output_projection.weight:
  weight_norm_before: 5.42901182
  weight_norm_after: 5.42250443
  weight_change: 0.00650740
  grad_norm: 0.00110029
celestial_output_projection.bias:
  weight_norm_before: 0.06570442
  weight_norm_after: 0.06574316
  weight_change: 0.00003874
  grad_norm: 0.00051089
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 1.60046792
  weight_norm_after: 1.59398830
  weight_change: 0.00647962
  grad_norm: 0.00000231
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01615972
  weight_norm_after: 0.01609058
  weight_change: 0.00006914
  grad_norm: 0.00000089
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 1.53561926
  weight_norm_after: 1.52932644
  weight_change: 0.00629282
  grad_norm: 0.00000091
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01710746
  weight_norm_after: 0.01702973
  weight_change: 0.00007774
  grad_norm: 0.00000037
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 1.76271045
  weight_norm_after: 1.75605285
  weight_change: 0.00665760
  grad_norm: 0.00000465
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.02414879
  weight_norm_after: 0.02403679
  weight_change: 0.00011200
  grad_norm: 0.00000208
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 1.67149866
  weight_norm_after: 1.66504204
  weight_change: 0.00645661
  grad_norm: 0.00000589
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.02942454
  weight_norm_after: 0.02932112
  weight_change: 0.00010342
  grad_norm: 0.00000249
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 4.22372580
  weight_norm_after: 4.21292591
  weight_change: 0.01079988
  grad_norm: 0.00001004
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000002
  weight_norm_after: 0.00000005
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 8.17561245
  weight_norm_after: 8.17031860
  weight_change: 0.00529385
  grad_norm: 0.00256388
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11471500
  weight_norm_after: 0.11468239
  weight_change: 0.00003260
  grad_norm: 0.00063838
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.90072250
  weight_norm_after: 8.89873791
  weight_change: 0.00198460
  grad_norm: 0.03164659
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.19168845
  weight_norm_after: 0.19173861
  weight_change: 0.00005016
  grad_norm: 0.00273323
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.92619038
  weight_norm_after: 8.92401218
  weight_change: 0.00217819
  grad_norm: 0.04915339
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.03438389
  weight_norm_after: 0.03448382
  weight_change: 0.00009993
  grad_norm: 0.04073502
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.96267033
  weight_norm_after: 8.96038151
  weight_change: 0.00228882
  grad_norm: 0.03107271
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.20479392
  weight_norm_after: 0.20491533
  weight_change: 0.00012141
  grad_norm: 0.00293075
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.94514179
  weight_norm_after: 8.94324207
  weight_change: 0.00189972
  grad_norm: 0.04789212
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.03438389
  weight_norm_after: 0.03448382
  weight_change: 0.00009993
  grad_norm: 0.04073502
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.11736584
  weight_norm_after: 9.11565971
  weight_change: 0.00170612
  grad_norm: 0.07645757
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.20180331
  weight_norm_after: 0.20192413
  weight_change: 0.00012082
  grad_norm: 0.00864602
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.10595703
  weight_norm_after: 9.10452938
  weight_change: 0.00142765
  grad_norm: 0.05953138
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.03438389
  weight_norm_after: 0.03448382
  weight_change: 0.00009993
  grad_norm: 0.04073502
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.97521877
  weight_norm_after: 8.97322464
  weight_change: 0.00199413
  grad_norm: 0.04326597
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.20370235
  weight_norm_after: 0.20382947
  weight_change: 0.00012712
  grad_norm: 0.00446712
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.78322506
  weight_norm_after: 8.78146935
  weight_change: 0.00175571
  grad_norm: 0.04649969
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.03438389
  weight_norm_after: 0.03448382
  weight_change: 0.00009993
  grad_norm: 0.04073502
projection.weight:
  weight_norm_before: 2.35718441
  weight_norm_after: 2.35693955
  weight_change: 0.00024486
  grad_norm: 0.40045604
projection.bias:
  weight_norm_before: 0.00125723
  weight_norm_after: 0.00130575
  weight_change: 0.00004852
  grad_norm: 0.16980721
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00344122
  weight_norm_after: 0.00335918
  weight_change: 0.00008204
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 6.82798529
  weight_norm_after: 6.82114935
  weight_change: 0.00683594
  grad_norm: 0.00232543
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07154780
  weight_norm_after: 0.07156622
  weight_change: 0.00001843
  grad_norm: 0.00811362
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 8.14690876
  weight_norm_after: 8.14221573
  weight_change: 0.00469303
  grad_norm: 0.00057457
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07693676
  weight_norm_after: 0.07682018
  weight_change: 0.00011658
  grad_norm: 0.00046617
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 2.07659388
  weight_norm_after: 2.07459927
  weight_change: 0.00199461
  grad_norm: 0.00011972
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02228480
  weight_norm_after: 0.02229246
  weight_change: 0.00000765
  grad_norm: 0.00012320
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.92955065
  weight_norm_after: 2.92734146
  weight_change: 0.00220919
  grad_norm: 0.00002638
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01887362
  weight_norm_after: 0.01887370
  weight_change: 0.00000008
  grad_norm: 0.00002601
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 500/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.29019219
loss (scaled for backward): 0.29019219
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 514.60536968
avg train_loss so far: 1.02715643
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.047352 / 0.063371
y_true_for_loss mean/std: 0.116034 / 0.521931
reg_loss contribution: 0.00000834

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 6.79932880
  weight_norm_after: 6.78964281
  weight_change: 0.00968599
  grad_norm: 0.00178759
celestial_projection.0.bias:
  weight_norm_before: 0.05072822
  weight_norm_after: 0.05064716
  weight_change: 0.00008106
  grad_norm: 0.00008520
celestial_projection.1.weight:
  weight_norm_before: 7.88767576
  weight_norm_after: 7.88266277
  weight_change: 0.00501299
  grad_norm: 0.00016993
celestial_projection.1.bias:
  weight_norm_before: 0.06517670
  weight_norm_after: 0.06510609
  weight_change: 0.00007060
  grad_norm: 0.00012565
celestial_query_projection.weight:
  weight_norm_before: 0.82259089
  weight_norm_after: 0.81912750
  weight_change: 0.00346339
  grad_norm: 0.00000008
celestial_query_projection.bias:
  weight_norm_before: 0.00498224
  weight_norm_after: 0.00495380
  weight_change: 0.00002844
  grad_norm: 0.00000001
celestial_key_projection.weight:
  weight_norm_before: 0.70263004
  weight_norm_after: 0.69840133
  weight_change: 0.00422871
  grad_norm: 0.00000057
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 3.62450075
  weight_norm_after: 3.61672330
  weight_change: 0.00777745
  grad_norm: 0.00055833
celestial_value_projection.bias:
  weight_norm_before: 0.04235972
  weight_norm_after: 0.04232489
  weight_change: 0.00003483
  grad_norm: 0.00015322
celestial_output_projection.weight:
  weight_norm_before: 5.11272860
  weight_norm_after: 5.10660839
  weight_change: 0.00612020
  grad_norm: 0.00207028
celestial_output_projection.bias:
  weight_norm_before: 0.07027520
  weight_norm_after: 0.07042739
  weight_change: 0.00015219
  grad_norm: 0.00116073
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 1.30575824
  weight_norm_after: 1.30043268
  weight_change: 0.00532556
  grad_norm: 0.00000555
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01295101
  weight_norm_after: 0.01289233
  weight_change: 0.00005869
  grad_norm: 0.00000254
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 1.25010276
  weight_norm_after: 1.24495709
  weight_change: 0.00514567
  grad_norm: 0.00000185
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01370877
  weight_norm_after: 0.01364984
  weight_change: 0.00005892
  grad_norm: 0.00000084
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 1.45875001
  weight_norm_after: 1.45322752
  weight_change: 0.00552249
  grad_norm: 0.00000488
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01935945
  weight_norm_after: 0.01926072
  weight_change: 0.00009874
  grad_norm: 0.00000214
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 1.37733161
  weight_norm_after: 1.37199450
  weight_change: 0.00533712
  grad_norm: 0.00000517
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.02493951
  weight_norm_after: 0.02484234
  weight_change: 0.00009716
  grad_norm: 0.00000262
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 3.70546126
  weight_norm_after: 3.69554806
  weight_change: 0.00991321
  grad_norm: 0.00001856
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000002
  weight_norm_after: 0.00000002
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 7.90928698
  weight_norm_after: 7.90394020
  weight_change: 0.00534678
  grad_norm: 0.00635242
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11458723
  weight_norm_after: 0.11459558
  weight_change: 0.00000834
  grad_norm: 0.00165004
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.79374599
  weight_norm_after: 8.79132462
  weight_change: 0.00242138
  grad_norm: 0.11544155
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.19475682
  weight_norm_after: 0.19481285
  weight_change: 0.00005603
  grad_norm: 0.00990080
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.82666779
  weight_norm_after: 8.82472038
  weight_change: 0.00194740
  grad_norm: 0.08097813
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.03988022
  weight_norm_after: 0.03978906
  weight_change: 0.00009115
  grad_norm: 0.05604761
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.85077667
  weight_norm_after: 8.84841156
  weight_change: 0.00236511
  grad_norm: 0.06738967
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.20892356
  weight_norm_after: 0.20888947
  weight_change: 0.00003409
  grad_norm: 0.00609386
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.84791279
  weight_norm_after: 8.84592152
  weight_change: 0.00199127
  grad_norm: 0.07644936
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.03988022
  weight_norm_after: 0.03978906
  weight_change: 0.00009115
  grad_norm: 0.05604761
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 9.02680302
  weight_norm_after: 9.02511406
  weight_change: 0.00168896
  grad_norm: 0.12647764
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.20522115
  weight_norm_after: 0.20540845
  weight_change: 0.00018731
  grad_norm: 0.01441333
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 9.03066540
  weight_norm_after: 9.02917290
  weight_change: 0.00149250
  grad_norm: 0.10309464
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.03988022
  weight_norm_after: 0.03978906
  weight_change: 0.00009115
  grad_norm: 0.05604761
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.87466717
  weight_norm_after: 8.87249756
  weight_change: 0.00216961
  grad_norm: 0.08567570
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.21003459
  weight_norm_after: 0.21015619
  weight_change: 0.00012159
  grad_norm: 0.00814243
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.69136810
  weight_norm_after: 8.68937874
  weight_change: 0.00198936
  grad_norm: 0.07636692
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.03988022
  weight_norm_after: 0.03978906
  weight_change: 0.00009115
  grad_norm: 0.05604761
projection.weight:
  weight_norm_before: 2.33812070
  weight_norm_after: 2.33770823
  weight_change: 0.00041246
  grad_norm: 0.49113879
projection.bias:
  weight_norm_before: 0.00307232
  weight_norm_after: 0.00307006
  weight_change: 0.00000226
  grad_norm: 0.19527057
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00098260
  weight_norm_after: 0.00095732
  weight_change: 0.00002528
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 6.49134588
  weight_norm_after: 6.48474550
  weight_change: 0.00660038
  grad_norm: 0.00303373
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07182617
  weight_norm_after: 0.07184398
  weight_change: 0.00001781
  grad_norm: 0.01146365
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 7.91213751
  weight_norm_after: 7.90751743
  weight_change: 0.00462008
  grad_norm: 0.00067507
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07246965
  weight_norm_after: 0.07246199
  weight_change: 0.00000766
  grad_norm: 0.00062821
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.97981477
  weight_norm_after: 1.97794580
  weight_change: 0.00186896
  grad_norm: 0.00016556
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02200881
  weight_norm_after: 0.02200817
  weight_change: 0.00000065
  grad_norm: 0.00021676
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.81882215
  weight_norm_after: 2.81664133
  weight_change: 0.00218081
  grad_norm: 0.00007332
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01776204
  weight_norm_after: 0.01775844
  weight_change: 0.00000360
  grad_norm: 0.00004797
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 550/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.99735129
loss (scaled for backward): 1.99735129
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 561.56416557
avg train_loss so far: 1.01917271
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.014957 / 0.078951
y_true_for_loss mean/std: 0.080751 / 1.425264
reg_loss contribution: 0.00000479

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 6.33094931
  weight_norm_after: 6.32192516
  weight_change: 0.00902414
  grad_norm: 0.00121894
celestial_projection.0.bias:
  weight_norm_before: 0.04611419
  weight_norm_after: 0.04605292
  weight_change: 0.00006127
  grad_norm: 0.00007084
celestial_projection.1.weight:
  weight_norm_before: 7.63809013
  weight_norm_after: 7.63308525
  weight_change: 0.00500488
  grad_norm: 0.00014451
celestial_projection.1.bias:
  weight_norm_before: 0.06202281
  weight_norm_after: 0.06197839
  weight_change: 0.00004441
  grad_norm: 0.00009777
celestial_query_projection.weight:
  weight_norm_before: 0.66616595
  weight_norm_after: 0.66336203
  weight_change: 0.00280392
  grad_norm: 0.00000005
celestial_query_projection.bias:
  weight_norm_before: 0.00372301
  weight_norm_after: 0.00370100
  weight_change: 0.00002201
  grad_norm: 0.00000001
celestial_key_projection.weight:
  weight_norm_before: 0.51808834
  weight_norm_after: 0.51491129
  weight_change: 0.00317705
  grad_norm: 0.00000024
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 3.25330400
  weight_norm_after: 3.24623203
  weight_change: 0.00707197
  grad_norm: 0.00035431
celestial_value_projection.bias:
  weight_norm_before: 0.04081396
  weight_norm_after: 0.04078283
  weight_change: 0.00003113
  grad_norm: 0.00010031
celestial_output_projection.weight:
  weight_norm_before: 4.81355953
  weight_norm_after: 4.80773687
  weight_change: 0.00582266
  grad_norm: 0.00188322
celestial_output_projection.bias:
  weight_norm_before: 0.06821249
  weight_norm_after: 0.06828997
  weight_change: 0.00007747
  grad_norm: 0.00129927
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 1.06329596
  weight_norm_after: 1.05890834
  weight_change: 0.00438762
  grad_norm: 0.00000209
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.01035780
  weight_norm_after: 0.01030933
  weight_change: 0.00004846
  grad_norm: 0.00000111
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 1.01626015
  weight_norm_after: 1.01204014
  weight_change: 0.00422001
  grad_norm: 0.00000038
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.01090826
  weight_norm_after: 0.01085808
  weight_change: 0.00005018
  grad_norm: 0.00000017
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 1.20632887
  weight_norm_after: 1.20173466
  weight_change: 0.00459421
  grad_norm: 0.00000452
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01560190
  weight_norm_after: 0.01552321
  weight_change: 0.00007869
  grad_norm: 0.00000237
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 1.13374960
  weight_norm_after: 1.12932861
  weight_change: 0.00442100
  grad_norm: 0.00000462
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.02074677
  weight_norm_after: 0.02066785
  weight_change: 0.00007891
  grad_norm: 0.00000252
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 3.23213410
  weight_norm_after: 3.22312784
  weight_change: 0.00900626
  grad_norm: 0.00001045
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000002
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 7.64203835
  weight_norm_after: 7.63667297
  weight_change: 0.00536537
  grad_norm: 0.00821237
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11636330
  weight_norm_after: 0.11633628
  weight_change: 0.00002702
  grad_norm: 0.00226787
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.68445015
  weight_norm_after: 8.68214893
  weight_change: 0.00230122
  grad_norm: 0.11765974
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.19621965
  weight_norm_after: 0.19612876
  weight_change: 0.00009090
  grad_norm: 0.01078210
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.72698593
  weight_norm_after: 8.72518826
  weight_change: 0.00179768
  grad_norm: 0.09490274
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.04099702
  weight_norm_after: 0.04089542
  weight_change: 0.00010160
  grad_norm: 0.08519505
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.73639202
  weight_norm_after: 8.73442078
  weight_change: 0.00197124
  grad_norm: 0.07432602
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.21294966
  weight_norm_after: 0.21320453
  weight_change: 0.00025487
  grad_norm: 0.00712917
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.75008488
  weight_norm_after: 8.74804401
  weight_change: 0.00204086
  grad_norm: 0.09216072
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.04099702
  weight_norm_after: 0.04089542
  weight_change: 0.00010160
  grad_norm: 0.08519505
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.94854641
  weight_norm_after: 8.94700909
  weight_change: 0.00153732
  grad_norm: 0.13035139
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.21501110
  weight_norm_after: 0.21506639
  weight_change: 0.00005528
  grad_norm: 0.01509674
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.95692730
  weight_norm_after: 8.95558357
  weight_change: 0.00134373
  grad_norm: 0.10897966
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.04099702
  weight_norm_after: 0.04089542
  weight_change: 0.00010160
  grad_norm: 0.08519505
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.77060890
  weight_norm_after: 8.76843071
  weight_change: 0.00217819
  grad_norm: 0.19685556
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.21293300
  weight_norm_after: 0.21293676
  weight_change: 0.00000376
  grad_norm: 0.01992204
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.60008812
  weight_norm_after: 8.59827518
  weight_change: 0.00181293
  grad_norm: 0.13081808
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.04099702
  weight_norm_after: 0.04089542
  weight_change: 0.00010160
  grad_norm: 0.08519505
projection.weight:
  weight_norm_before: 2.31669569
  weight_norm_after: 2.31648207
  weight_change: 0.00021362
  grad_norm: 0.56329334
projection.bias:
  weight_norm_before: 0.00183967
  weight_norm_after: 0.00171119
  weight_change: 0.00012847
  grad_norm: 0.34051812
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00025384
  weight_norm_after: 0.00024680
  weight_change: 0.00000704
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 6.16663504
  weight_norm_after: 6.16027164
  weight_change: 0.00636339
  grad_norm: 0.00470534
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07341482
  weight_norm_after: 0.07346720
  weight_change: 0.00005237
  grad_norm: 0.01823164
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 7.68161249
  weight_norm_after: 7.67698908
  weight_change: 0.00462341
  grad_norm: 0.00115335
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07420490
  weight_norm_after: 0.07424018
  weight_change: 0.00003528
  grad_norm: 0.00094594
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.88885117
  weight_norm_after: 1.88708580
  weight_change: 0.00176537
  grad_norm: 0.00017675
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02188436
  weight_norm_after: 0.02186880
  weight_change: 0.00001556
  grad_norm: 0.00018933
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.71065354
  weight_norm_after: 2.70847368
  weight_change: 0.00217986
  grad_norm: 0.00005769
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01712074
  weight_norm_after: 0.01708287
  weight_change: 0.00003787
  grad_norm: 0.00004527
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 600/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.72056782
loss (scaled for backward): 0.72056782
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 638.99437997
avg train_loss so far: 1.06321860
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.030105 / 0.070434
y_true_for_loss mean/std: -0.347728 / 0.789043
reg_loss contribution: 0.00000276

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 5.89537716
  weight_norm_after: 5.88697910
  weight_change: 0.00839806
  grad_norm: 0.00140696
celestial_projection.0.bias:
  weight_norm_before: 0.04350372
  weight_norm_after: 0.04347982
  weight_change: 0.00002390
  grad_norm: 0.00008091
celestial_projection.1.weight:
  weight_norm_before: 7.38796520
  weight_norm_after: 7.38295364
  weight_change: 0.00501156
  grad_norm: 0.00013320
celestial_projection.1.bias:
  weight_norm_before: 0.05991254
  weight_norm_after: 0.05984295
  weight_change: 0.00006959
  grad_norm: 0.00011168
celestial_query_projection.weight:
  weight_norm_before: 0.53949100
  weight_norm_after: 0.53721976
  weight_change: 0.00227123
  grad_norm: 0.00000001
celestial_query_projection.bias:
  weight_norm_before: 0.00275437
  weight_norm_after: 0.00273754
  weight_change: 0.00001683
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.37992737
  weight_norm_after: 0.37755781
  weight_change: 0.00236955
  grad_norm: 0.00000017
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 2.91628575
  weight_norm_after: 2.90987468
  weight_change: 0.00641108
  grad_norm: 0.00050792
celestial_value_projection.bias:
  weight_norm_before: 0.03898248
  weight_norm_after: 0.03893970
  weight_change: 0.00004278
  grad_norm: 0.00015354
celestial_output_projection.weight:
  weight_norm_before: 4.53110218
  weight_norm_after: 4.52563000
  weight_change: 0.00547218
  grad_norm: 0.00210915
celestial_output_projection.bias:
  weight_norm_before: 0.07283339
  weight_norm_after: 0.07331985
  weight_change: 0.00048646
  grad_norm: 0.00181340
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.86355257
  weight_norm_after: 0.85993820
  weight_change: 0.00361437
  grad_norm: 0.00000093
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00816820
  weight_norm_after: 0.00812782
  weight_change: 0.00004038
  grad_norm: 0.00000051
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.82441252
  weight_norm_after: 0.82094949
  weight_change: 0.00346303
  grad_norm: 0.00000021
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00858622
  weight_norm_after: 0.00854467
  weight_change: 0.00004155
  grad_norm: 0.00000011
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.99620032
  weight_norm_after: 0.99237472
  weight_change: 0.00382560
  grad_norm: 0.00000040
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01268455
  weight_norm_after: 0.01262584
  weight_change: 0.00005871
  grad_norm: 0.00000021
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.93177205
  weight_norm_after: 0.92810380
  weight_change: 0.00366825
  grad_norm: 0.00000099
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01715831
  weight_norm_after: 0.01709060
  weight_change: 0.00006771
  grad_norm: 0.00000052
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 2.80403042
  weight_norm_after: 2.79592395
  weight_change: 0.00810647
  grad_norm: 0.00000204
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 7.37363958
  weight_norm_after: 7.36833096
  weight_change: 0.00530863
  grad_norm: 0.00335556
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11612964
  weight_norm_after: 0.11611792
  weight_change: 0.00001172
  grad_norm: 0.00099368
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.57947254
  weight_norm_after: 8.57765102
  weight_change: 0.00182152
  grad_norm: 0.08209701
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.20070492
  weight_norm_after: 0.20093274
  weight_change: 0.00022782
  grad_norm: 0.00745791
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.62486553
  weight_norm_after: 8.62302685
  weight_change: 0.00183868
  grad_norm: 0.07920297
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.04208243
  weight_norm_after: 0.04234969
  weight_change: 0.00026727
  grad_norm: 0.07616083
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.62881279
  weight_norm_after: 8.62705994
  weight_change: 0.00175285
  grad_norm: 0.04448039
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.21825649
  weight_norm_after: 0.21854514
  weight_change: 0.00028865
  grad_norm: 0.00418215
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.65222645
  weight_norm_after: 8.65030479
  weight_change: 0.00192165
  grad_norm: 0.07143500
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.04208243
  weight_norm_after: 0.04234969
  weight_change: 0.00026727
  grad_norm: 0.07616083
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.86199284
  weight_norm_after: 8.86037350
  weight_change: 0.00161934
  grad_norm: 0.05933066
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.22128923
  weight_norm_after: 0.22141345
  weight_change: 0.00012422
  grad_norm: 0.00681449
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.88272667
  weight_norm_after: 8.88133812
  weight_change: 0.00138855
  grad_norm: 0.09948872
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.04208243
  weight_norm_after: 0.04234969
  weight_change: 0.00026727
  grad_norm: 0.07616083
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.66461658
  weight_norm_after: 8.66305542
  weight_change: 0.00156116
  grad_norm: 0.05970905
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.21598396
  weight_norm_after: 0.21632853
  weight_change: 0.00034457
  grad_norm: 0.00599808
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.50827599
  weight_norm_after: 8.50625992
  weight_change: 0.00201607
  grad_norm: 0.08584132
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.04208243
  weight_norm_after: 0.04234969
  weight_change: 0.00026727
  grad_norm: 0.07616083
projection.weight:
  weight_norm_before: 2.30104685
  weight_norm_after: 2.30071807
  weight_change: 0.00032878
  grad_norm: 0.53731656
projection.bias:
  weight_norm_before: 0.00183798
  weight_norm_after: 0.00223444
  weight_change: 0.00039647
  grad_norm: 0.30380291
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00005887
  weight_norm_after: 0.00005710
  weight_change: 0.00000176
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 5.85445642
  weight_norm_after: 5.84836388
  weight_change: 0.00609255
  grad_norm: 0.00350654
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07543790
  weight_norm_after: 0.07550289
  weight_change: 0.00006500
  grad_norm: 0.01494500
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 7.44981194
  weight_norm_after: 7.44509697
  weight_change: 0.00471497
  grad_norm: 0.00077038
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.07367837
  weight_norm_after: 0.07357714
  weight_change: 0.00010123
  grad_norm: 0.00072079
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.80313396
  weight_norm_after: 1.80146980
  weight_change: 0.00166416
  grad_norm: 0.00012319
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02181631
  weight_norm_after: 0.02181597
  weight_change: 0.00000034
  grad_norm: 0.00015303
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.60418749
  weight_norm_after: 2.60206962
  weight_change: 0.00211787
  grad_norm: 0.00004479
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01658362
  weight_norm_after: 0.01658326
  weight_change: 0.00000036
  grad_norm: 0.00002965
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 650/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.24844828
loss (scaled for backward): 0.24844828
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 686.19804254
avg train_loss so far: 1.05406765
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.146020 / 0.098002
y_true_for_loss mean/std: 0.119044 / 0.413118
reg_loss contribution: 0.00000184

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 5.49197960
  weight_norm_after: 5.48421288
  weight_change: 0.00776672
  grad_norm: 0.00082243
celestial_projection.0.bias:
  weight_norm_before: 0.04148085
  weight_norm_after: 0.04139136
  weight_change: 0.00008949
  grad_norm: 0.00005167
celestial_projection.1.weight:
  weight_norm_before: 7.13871431
  weight_norm_after: 7.13374519
  weight_change: 0.00496912
  grad_norm: 0.00008869
celestial_projection.1.bias:
  weight_norm_before: 0.05741823
  weight_norm_after: 0.05734834
  weight_change: 0.00006990
  grad_norm: 0.00006788
celestial_query_projection.weight:
  weight_norm_before: 0.43686786
  weight_norm_after: 0.43502760
  weight_change: 0.00184026
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00201752
  weight_norm_after: 0.00200479
  weight_change: 0.00001273
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.27719435
  weight_norm_after: 0.27543828
  weight_change: 0.00175607
  grad_norm: 0.00000007
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 2.61177111
  weight_norm_after: 2.60597610
  weight_change: 0.00579500
  grad_norm: 0.00062997
celestial_value_projection.bias:
  weight_norm_before: 0.03849216
  weight_norm_after: 0.03845733
  weight_change: 0.00003484
  grad_norm: 0.00020274
celestial_output_projection.weight:
  weight_norm_before: 4.26423025
  weight_norm_after: 4.25906706
  weight_change: 0.00516319
  grad_norm: 0.00188749
celestial_output_projection.bias:
  weight_norm_before: 0.08543210
  weight_norm_after: 0.08569479
  weight_change: 0.00026269
  grad_norm: 0.00209538
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.69909352
  weight_norm_after: 0.69612056
  weight_change: 0.00297296
  grad_norm: 0.00000037
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00641668
  weight_norm_after: 0.00638478
  weight_change: 0.00003189
  grad_norm: 0.00000021
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.66700238
  weight_norm_after: 0.66416204
  weight_change: 0.00284034
  grad_norm: 0.00000035
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00666919
  weight_norm_after: 0.00663532
  weight_change: 0.00003387
  grad_norm: 0.00000019
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.82102025
  weight_norm_after: 0.81783289
  weight_change: 0.00318736
  grad_norm: 0.00000199
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.01002957
  weight_norm_after: 0.00998416
  weight_change: 0.00004541
  grad_norm: 0.00000112
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.76419091
  weight_norm_after: 0.76114756
  weight_change: 0.00304335
  grad_norm: 0.00000075
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01421290
  weight_norm_after: 0.01415820
  weight_change: 0.00005469
  grad_norm: 0.00000042
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 2.42020512
  weight_norm_after: 2.41296935
  weight_change: 0.00723577
  grad_norm: 0.00000325
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 7.10653830
  weight_norm_after: 7.10120010
  weight_change: 0.00533819
  grad_norm: 0.00573849
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11688254
  weight_norm_after: 0.11685587
  weight_change: 0.00002667
  grad_norm: 0.00182818
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.48508263
  weight_norm_after: 8.48314381
  weight_change: 0.00193882
  grad_norm: 0.09768473
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.20826980
  weight_norm_after: 0.20826052
  weight_change: 0.00000928
  grad_norm: 0.00897276
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.52364254
  weight_norm_after: 8.52177906
  weight_change: 0.00186348
  grad_norm: 0.08276182
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.04637359
  weight_norm_after: 0.04642052
  weight_change: 0.00004693
  grad_norm: 0.08282275
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.52886009
  weight_norm_after: 8.52661514
  weight_change: 0.00224495
  grad_norm: 0.06372630
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.22726627
  weight_norm_after: 0.22737813
  weight_change: 0.00011186
  grad_norm: 0.00589851
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.55200386
  weight_norm_after: 8.55004978
  weight_change: 0.00195408
  grad_norm: 0.07437646
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.04637359
  weight_norm_after: 0.04642052
  weight_change: 0.00004693
  grad_norm: 0.08282275
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.77798176
  weight_norm_after: 8.77642822
  weight_change: 0.00155354
  grad_norm: 0.11548044
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.22546917
  weight_norm_after: 0.22559661
  weight_change: 0.00012743
  grad_norm: 0.01331357
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.81031132
  weight_norm_after: 8.80885029
  weight_change: 0.00146103
  grad_norm: 0.12661545
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.04637359
  weight_norm_after: 0.04642052
  weight_change: 0.00004693
  grad_norm: 0.08282275
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.57743931
  weight_norm_after: 8.57555389
  weight_change: 0.00188541
  grad_norm: 0.17854913
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.22421992
  weight_norm_after: 0.22439122
  weight_change: 0.00017130
  grad_norm: 0.01833858
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.41331863
  weight_norm_after: 8.41130257
  weight_change: 0.00201607
  grad_norm: 0.14524102
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.04637359
  weight_norm_after: 0.04642052
  weight_change: 0.00004693
  grad_norm: 0.08282275
projection.weight:
  weight_norm_before: 2.27437663
  weight_norm_after: 2.27404547
  weight_change: 0.00033116
  grad_norm: 0.61753666
projection.bias:
  weight_norm_before: 0.00146588
  weight_norm_after: 0.00157320
  weight_change: 0.00010732
  grad_norm: 0.37186053
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00001213
  weight_norm_after: 0.00001174
  weight_change: 0.00000039
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 5.55331278
  weight_norm_after: 5.54742002
  weight_change: 0.00589275
  grad_norm: 0.00407265
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07645774
  weight_norm_after: 0.07646959
  weight_change: 0.00001185
  grad_norm: 0.01796793
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 7.21583939
  weight_norm_after: 7.21118498
  weight_change: 0.00465441
  grad_norm: 0.00133875
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06817719
  weight_norm_after: 0.06802475
  weight_change: 0.00015243
  grad_norm: 0.00086424
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.72182739
  weight_norm_after: 1.72023928
  weight_change: 0.00158811
  grad_norm: 0.00008187
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02104856
  weight_norm_after: 0.02104104
  weight_change: 0.00000751
  grad_norm: 0.00013915
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.49955893
  weight_norm_after: 2.49748373
  weight_change: 0.00207520
  grad_norm: 0.00002555
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01564498
  weight_norm_after: 0.01562957
  weight_change: 0.00001540
  grad_norm: 0.00002916
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 700/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.07321274
loss (scaled for backward): 1.07321274
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 751.79010862
avg train_loss so far: 1.07245379
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.058766 / 0.059654
y_true_for_loss mean/std: 0.641083 / 0.769026
reg_loss contribution: 0.00000152

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 5.11806631
  weight_norm_after: 5.11087847
  weight_change: 0.00718784
  grad_norm: 0.00124332
celestial_projection.0.bias:
  weight_norm_before: 0.03774854
  weight_norm_after: 0.03766665
  weight_change: 0.00008189
  grad_norm: 0.00010057
celestial_projection.1.weight:
  weight_norm_before: 6.89037418
  weight_norm_after: 6.88542604
  weight_change: 0.00494814
  grad_norm: 0.00010552
celestial_projection.1.bias:
  weight_norm_before: 0.05398421
  weight_norm_after: 0.05391870
  weight_change: 0.00006551
  grad_norm: 0.00009387
celestial_query_projection.weight:
  weight_norm_before: 0.35370591
  weight_norm_after: 0.35221437
  weight_change: 0.00149155
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00146304
  weight_norm_after: 0.00145352
  weight_change: 0.00000952
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.20125987
  weight_norm_after: 0.19996570
  weight_change: 0.00129417
  grad_norm: 0.00000003
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 2.33706927
  weight_norm_after: 2.33185363
  weight_change: 0.00521564
  grad_norm: 0.00030549
celestial_value_projection.bias:
  weight_norm_before: 0.03709397
  weight_norm_after: 0.03702425
  weight_change: 0.00006972
  grad_norm: 0.00010416
celestial_output_projection.weight:
  weight_norm_before: 4.01359367
  weight_norm_after: 4.00871325
  weight_change: 0.00488043
  grad_norm: 0.00173308
celestial_output_projection.bias:
  weight_norm_before: 0.09840493
  weight_norm_after: 0.09890881
  weight_change: 0.00050388
  grad_norm: 0.00233213
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.56388682
  weight_norm_after: 0.56144601
  weight_change: 0.00244081
  grad_norm: 0.00000039
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00497142
  weight_norm_after: 0.00494574
  weight_change: 0.00002568
  grad_norm: 0.00000022
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.53799886
  weight_norm_after: 0.53567380
  weight_change: 0.00232506
  grad_norm: 0.00000046
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00512326
  weight_norm_after: 0.00509667
  weight_change: 0.00002659
  grad_norm: 0.00000026
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.67514604
  weight_norm_after: 0.67249340
  weight_change: 0.00265265
  grad_norm: 0.00000025
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00802479
  weight_norm_after: 0.00798932
  weight_change: 0.00003547
  grad_norm: 0.00000013
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.62513185
  weight_norm_after: 0.62260759
  weight_change: 0.00252426
  grad_norm: 0.00000059
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.01165082
  weight_norm_after: 0.01160282
  weight_change: 0.00004800
  grad_norm: 0.00000033
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 2.07884574
  weight_norm_after: 2.07243562
  weight_change: 0.00641012
  grad_norm: 0.00000135
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 6.84040403
  weight_norm_after: 6.83514118
  weight_change: 0.00526285
  grad_norm: 0.00759559
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.11539637
  weight_norm_after: 0.11540592
  weight_change: 0.00000954
  grad_norm: 0.00253940
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.38760948
  weight_norm_after: 8.38585091
  weight_change: 0.00175858
  grad_norm: 0.20090033
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.21206595
  weight_norm_after: 0.21230459
  weight_change: 0.00023864
  grad_norm: 0.01876846
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.42952728
  weight_norm_after: 8.42745399
  weight_change: 0.00207329
  grad_norm: 0.20053485
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.05365358
  weight_norm_after: 0.05390009
  weight_change: 0.00024651
  grad_norm: 0.07216109
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.42273426
  weight_norm_after: 8.42078400
  weight_change: 0.00195026
  grad_norm: 0.13121618
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.23359156
  weight_norm_after: 0.23380411
  weight_change: 0.00021255
  grad_norm: 0.01237999
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.45795345
  weight_norm_after: 8.45595741
  weight_change: 0.00199604
  grad_norm: 0.08267144
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.05365358
  weight_norm_after: 0.05390009
  weight_change: 0.00024651
  grad_norm: 0.07216109
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.69019508
  weight_norm_after: 8.68880272
  weight_change: 0.00139236
  grad_norm: 0.08670762
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.22791757
  weight_norm_after: 0.22824538
  weight_change: 0.00032781
  grad_norm: 0.01006129
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.73645496
  weight_norm_after: 8.73510742
  weight_change: 0.00134754
  grad_norm: 0.10514727
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.05365358
  weight_norm_after: 0.05390009
  weight_change: 0.00024651
  grad_norm: 0.07216109
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.47813988
  weight_norm_after: 8.47667980
  weight_change: 0.00146008
  grad_norm: 0.09421388
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.22842911
  weight_norm_after: 0.22878791
  weight_change: 0.00035881
  grad_norm: 0.00981391
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.32177830
  weight_norm_after: 8.32002735
  weight_change: 0.00175095
  grad_norm: 0.07636185
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.05365358
  weight_norm_after: 0.05390009
  weight_change: 0.00024651
  grad_norm: 0.07216109
projection.weight:
  weight_norm_before: 2.25950861
  weight_norm_after: 2.25888014
  weight_change: 0.00062847
  grad_norm: 0.60473168
projection.bias:
  weight_norm_before: 0.00758958
  weight_norm_after: 0.00773501
  weight_change: 0.00014542
  grad_norm: 0.34708533
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000219
  weight_norm_after: 0.00000211
  weight_change: 0.00000008
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 5.26579142
  weight_norm_after: 5.26019478
  weight_change: 0.00559664
  grad_norm: 0.00274683
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07815337
  weight_norm_after: 0.07829160
  weight_change: 0.00013823
  grad_norm: 0.01281521
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 6.98826838
  weight_norm_after: 6.98375034
  weight_change: 0.00451803
  grad_norm: 0.00060317
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06809190
  weight_norm_after: 0.06815819
  weight_change: 0.00006629
  grad_norm: 0.00059831
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.64426994
  weight_norm_after: 1.64275646
  weight_change: 0.00151348
  grad_norm: 0.00016648
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02106154
  weight_norm_after: 0.02109909
  weight_change: 0.00003755
  grad_norm: 0.00021441
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.39768124
  weight_norm_after: 2.39565992
  weight_change: 0.00202131
  grad_norm: 0.00009487
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01563761
  weight_norm_after: 0.01563458
  weight_change: 0.00000303
  grad_norm: 0.00004846
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 750/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.47741193
loss (scaled for backward): 0.47741193
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 800.24239255
avg train_loss so far: 1.06556910
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.197695 / 0.052134
y_true_for_loss mean/std: -0.143850 / 0.604617
reg_loss contribution: 0.00000094

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 4.77339268
  weight_norm_after: 4.76677179
  weight_change: 0.00662088
  grad_norm: 0.00057006
celestial_projection.0.bias:
  weight_norm_before: 0.03520912
  weight_norm_after: 0.03516730
  weight_change: 0.00004182
  grad_norm: 0.00004967
celestial_projection.1.weight:
  weight_norm_before: 6.64474154
  weight_norm_after: 6.63984823
  weight_change: 0.00489330
  grad_norm: 0.00005747
celestial_projection.1.bias:
  weight_norm_before: 0.05176178
  weight_norm_after: 0.05171796
  weight_change: 0.00004382
  grad_norm: 0.00004253
celestial_query_projection.weight:
  weight_norm_before: 0.28629351
  weight_norm_after: 0.28508422
  weight_change: 0.00120929
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00105020
  weight_norm_after: 0.00104315
  weight_change: 0.00000705
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.14543566
  weight_norm_after: 0.14448687
  weight_change: 0.00094879
  grad_norm: 0.00000001
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 2.09307313
  weight_norm_after: 2.08844805
  weight_change: 0.00462508
  grad_norm: 0.00021654
celestial_value_projection.bias:
  weight_norm_before: 0.03809965
  weight_norm_after: 0.03809329
  weight_change: 0.00000637
  grad_norm: 0.00007534
celestial_output_projection.weight:
  weight_norm_before: 3.77627611
  weight_norm_after: 3.77162170
  weight_change: 0.00465441
  grad_norm: 0.00070344
celestial_output_projection.bias:
  weight_norm_before: 0.09848755
  weight_norm_after: 0.09844967
  weight_change: 0.00003788
  grad_norm: 0.00108802
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.45305768
  weight_norm_after: 0.45106059
  weight_change: 0.00199708
  grad_norm: 0.00000006
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00381974
  weight_norm_after: 0.00379910
  weight_change: 0.00002064
  grad_norm: 0.00000004
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.43251503
  weight_norm_after: 0.43061602
  weight_change: 0.00189900
  grad_norm: 0.00000009
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00391201
  weight_norm_after: 0.00389032
  weight_change: 0.00002168
  grad_norm: 0.00000005
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.55380476
  weight_norm_after: 0.55159998
  weight_change: 0.00220478
  grad_norm: 0.00000004
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00634054
  weight_norm_after: 0.00630891
  weight_change: 0.00003163
  grad_norm: 0.00000002
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.50991142
  weight_norm_after: 0.50782222
  weight_change: 0.00208920
  grad_norm: 0.00000017
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00948127
  weight_norm_after: 0.00944116
  weight_change: 0.00004011
  grad_norm: 0.00000010
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 1.77747881
  weight_norm_after: 1.77183998
  weight_change: 0.00563884
  grad_norm: 0.00000029
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 6.58127022
  weight_norm_after: 6.57609558
  weight_change: 0.00517464
  grad_norm: 0.00146643
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12033294
  weight_norm_after: 0.12041887
  weight_change: 0.00008593
  grad_norm: 0.00049963
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.30871391
  weight_norm_after: 8.30688000
  weight_change: 0.00183392
  grad_norm: 0.03268902
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.22690587
  weight_norm_after: 0.22702460
  weight_change: 0.00011873
  grad_norm: 0.00290566
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.33092117
  weight_norm_after: 8.32905674
  weight_change: 0.00186443
  grad_norm: 0.04271700
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.05364698
  weight_norm_after: 0.05394802
  weight_change: 0.00030104
  grad_norm: 0.04394479
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.33036995
  weight_norm_after: 8.32837200
  weight_change: 0.00199795
  grad_norm: 0.02566096
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.24691215
  weight_norm_after: 0.24710642
  weight_change: 0.00019427
  grad_norm: 0.00241306
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.35968494
  weight_norm_after: 8.35784626
  weight_change: 0.00183868
  grad_norm: 0.04025691
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.05364698
  weight_norm_after: 0.05394802
  weight_change: 0.00030104
  grad_norm: 0.04394479
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.61898708
  weight_norm_after: 8.61746216
  weight_change: 0.00152493
  grad_norm: 0.04084386
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.24305911
  weight_norm_after: 0.24315299
  weight_change: 0.00009388
  grad_norm: 0.00456619
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.65930843
  weight_norm_after: 8.65792370
  weight_change: 0.00138474
  grad_norm: 0.05717646
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.05364698
  weight_norm_after: 0.05394802
  weight_change: 0.00030104
  grad_norm: 0.04394479
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.38247395
  weight_norm_after: 8.38041592
  weight_change: 0.00205803
  grad_norm: 0.03596484
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.23426457
  weight_norm_after: 0.23433264
  weight_change: 0.00006807
  grad_norm: 0.00366626
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.23219967
  weight_norm_after: 8.23046017
  weight_change: 0.00173950
  grad_norm: 0.04513169
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.05364698
  weight_norm_after: 0.05394802
  weight_change: 0.00030104
  grad_norm: 0.04394479
projection.weight:
  weight_norm_before: 2.22786164
  weight_norm_after: 2.22737145
  weight_change: 0.00049019
  grad_norm: 0.30820948
projection.bias:
  weight_norm_before: 0.00188021
  weight_norm_after: 0.00190898
  weight_change: 0.00002877
  grad_norm: 0.19743603
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000034
  weight_norm_after: 0.00000033
  weight_change: 0.00000001
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 4.99062967
  weight_norm_after: 4.98524380
  weight_change: 0.00538588
  grad_norm: 0.00142468
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.07979357
  weight_norm_after: 0.07980106
  weight_change: 0.00000749
  grad_norm: 0.00704846
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 6.76383591
  weight_norm_after: 6.75932789
  weight_change: 0.00450802
  grad_norm: 0.00038181
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06871532
  weight_norm_after: 0.06865600
  weight_change: 0.00005932
  grad_norm: 0.00032000
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.57020378
  weight_norm_after: 1.56876731
  weight_change: 0.00143647
  grad_norm: 0.00006508
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02077713
  weight_norm_after: 0.02079621
  weight_change: 0.00001908
  grad_norm: 0.00009177
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.29752398
  weight_norm_after: 2.29557562
  weight_change: 0.00194836
  grad_norm: 0.00001598
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01447814
  weight_norm_after: 0.01450940
  weight_change: 0.00003126
  grad_norm: 0.00002170
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 800/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.34267130
loss (scaled for backward): 0.34267130
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 883.51218564
avg train_loss so far: 1.10301147
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.060044 / 0.044804
y_true_for_loss mean/std: 0.123185 / 0.561490
reg_loss contribution: 0.00000073

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 4.45476675
  weight_norm_after: 4.44865942
  weight_change: 0.00610733
  grad_norm: 0.00078361
celestial_projection.0.bias:
  weight_norm_before: 0.03267838
  weight_norm_after: 0.03260577
  weight_change: 0.00007261
  grad_norm: 0.00009404
celestial_projection.1.weight:
  weight_norm_before: 6.40150547
  weight_norm_after: 6.39667463
  weight_change: 0.00483084
  grad_norm: 0.00008915
celestial_projection.1.bias:
  weight_norm_before: 0.04936156
  weight_norm_after: 0.04930888
  weight_change: 0.00005268
  grad_norm: 0.00005838
celestial_query_projection.weight:
  weight_norm_before: 0.23162927
  weight_norm_after: 0.23064849
  weight_change: 0.00098078
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00074609
  weight_norm_after: 0.00074093
  weight_change: 0.00000516
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.10460408
  weight_norm_after: 0.10391194
  weight_change: 0.00069214
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.87230706
  weight_norm_after: 1.86802030
  weight_change: 0.00428677
  grad_norm: 0.00027216
celestial_value_projection.bias:
  weight_norm_before: 0.03818451
  weight_norm_after: 0.03809666
  weight_change: 0.00008785
  grad_norm: 0.00009968
celestial_output_projection.weight:
  weight_norm_before: 3.55289268
  weight_norm_after: 3.54854202
  weight_change: 0.00435066
  grad_norm: 0.00098650
celestial_output_projection.bias:
  weight_norm_before: 0.10167690
  weight_norm_after: 0.10231996
  weight_change: 0.00064306
  grad_norm: 0.00178583
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.36253428
  weight_norm_after: 0.36090648
  weight_change: 0.00162780
  grad_norm: 0.00000004
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00290311
  weight_norm_after: 0.00288701
  weight_change: 0.00001609
  grad_norm: 0.00000003
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.34649622
  weight_norm_after: 0.34495041
  weight_change: 0.00154582
  grad_norm: 0.00000009
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00294629
  weight_norm_after: 0.00292930
  weight_change: 0.00001698
  grad_norm: 0.00000006
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.45309019
  weight_norm_after: 0.45126331
  weight_change: 0.00182688
  grad_norm: 0.00000011
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00492966
  weight_norm_after: 0.00490574
  weight_change: 0.00002392
  grad_norm: 0.00000008
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.41464537
  weight_norm_after: 0.41292042
  weight_change: 0.00172496
  grad_norm: 0.00000004
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00766545
  weight_norm_after: 0.00763290
  weight_change: 0.00003255
  grad_norm: 0.00000003
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 1.51322484
  weight_norm_after: 1.50829744
  weight_change: 0.00492740
  grad_norm: 0.00000049
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 6.32132149
  weight_norm_after: 6.31617212
  weight_change: 0.00514936
  grad_norm: 0.00347860
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12082797
  weight_norm_after: 0.12084261
  weight_change: 0.00001465
  grad_norm: 0.00124922
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.21231270
  weight_norm_after: 8.21037769
  weight_change: 0.00193501
  grad_norm: 0.06354019
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.23013291
  weight_norm_after: 0.23007707
  weight_change: 0.00005583
  grad_norm: 0.00550042
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.23712921
  weight_norm_after: 8.23524284
  weight_change: 0.00188637
  grad_norm: 0.05083381
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.05954175
  weight_norm_after: 0.05989153
  weight_change: 0.00034977
  grad_norm: 0.04371627
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.22764111
  weight_norm_after: 8.22566414
  weight_change: 0.00197697
  grad_norm: 0.06281052
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.24972181
  weight_norm_after: 0.24972369
  weight_change: 0.00000188
  grad_norm: 0.00582310
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.26246071
  weight_norm_after: 8.26062107
  weight_change: 0.00183964
  grad_norm: 0.05810997
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.05954175
  weight_norm_after: 0.05989153
  weight_change: 0.00034977
  grad_norm: 0.04371627
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.53952980
  weight_norm_after: 8.53807354
  weight_change: 0.00145626
  grad_norm: 0.12202343
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.24686049
  weight_norm_after: 0.24708405
  weight_change: 0.00022356
  grad_norm: 0.01283925
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.58803463
  weight_norm_after: 8.58658028
  weight_change: 0.00145435
  grad_norm: 0.09131487
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.05954175
  weight_norm_after: 0.05989153
  weight_change: 0.00034977
  grad_norm: 0.04371627
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.28544903
  weight_norm_after: 8.28391933
  weight_change: 0.00152969
  grad_norm: 0.06868078
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.23782814
  weight_norm_after: 0.23825455
  weight_change: 0.00042641
  grad_norm: 0.00695714
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.14306641
  weight_norm_after: 8.14126301
  weight_change: 0.00180340
  grad_norm: 0.06748820
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.05954175
  weight_norm_after: 0.05989153
  weight_change: 0.00034977
  grad_norm: 0.04371627
projection.weight:
  weight_norm_before: 2.20611763
  weight_norm_after: 2.20563960
  weight_change: 0.00047803
  grad_norm: 0.25102785
projection.bias:
  weight_norm_before: 0.00235559
  weight_norm_after: 0.00251705
  weight_change: 0.00016146
  grad_norm: 0.16596964
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000004
  weight_norm_after: 0.00000004
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 4.72785378
  weight_norm_after: 4.72273397
  weight_change: 0.00511980
  grad_norm: 0.00198030
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08125068
  weight_norm_after: 0.08131986
  weight_change: 0.00006918
  grad_norm: 0.01022313
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 6.54022980
  weight_norm_after: 6.53577852
  weight_change: 0.00445127
  grad_norm: 0.00042133
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06685864
  weight_norm_after: 0.06677259
  weight_change: 0.00008605
  grad_norm: 0.00046570
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.49950051
  weight_norm_after: 1.49811590
  weight_change: 0.00138462
  grad_norm: 0.00010852
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02029744
  weight_norm_after: 0.02027957
  weight_change: 0.00001787
  grad_norm: 0.00017686
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.19927311
  weight_norm_after: 2.19734859
  weight_change: 0.00192451
  grad_norm: 0.00007113
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01358996
  weight_norm_after: 0.01357872
  weight_change: 0.00001123
  grad_norm: 0.00005193
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 850/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.69451278
loss (scaled for backward): 0.69451278
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 928.53007578
avg train_loss so far: 1.09110467
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.009977 / 0.065074
y_true_for_loss mean/std: -0.128376 / 0.833658
reg_loss contribution: 0.00000051

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 4.16086769
  weight_norm_after: 4.15522051
  weight_change: 0.00564718
  grad_norm: 0.00057871
celestial_projection.0.bias:
  weight_norm_before: 0.03052184
  weight_norm_after: 0.03048884
  weight_change: 0.00003300
  grad_norm: 0.00004672
celestial_projection.1.weight:
  weight_norm_before: 6.16073751
  weight_norm_after: 6.15595627
  weight_change: 0.00478125
  grad_norm: 0.00005663
celestial_projection.1.bias:
  weight_norm_before: 0.04687687
  weight_norm_after: 0.04682972
  weight_change: 0.00004715
  grad_norm: 0.00003386
celestial_query_projection.weight:
  weight_norm_before: 0.18728712
  weight_norm_after: 0.18649141
  weight_change: 0.00079571
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00052449
  weight_norm_after: 0.00052075
  weight_change: 0.00000374
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.07488453
  weight_norm_after: 0.07438206
  weight_change: 0.00050247
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.67279422
  weight_norm_after: 1.66906440
  weight_change: 0.00372982
  grad_norm: 0.00012758
celestial_value_projection.bias:
  weight_norm_before: 0.03698009
  weight_norm_after: 0.03700073
  weight_change: 0.00002065
  grad_norm: 0.00004928
celestial_output_projection.weight:
  weight_norm_before: 3.34208655
  weight_norm_after: 3.33800197
  weight_change: 0.00408459
  grad_norm: 0.00051012
celestial_output_projection.bias:
  weight_norm_before: 0.12454584
  weight_norm_after: 0.12445059
  weight_change: 0.00009525
  grad_norm: 0.00117712
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.28888971
  weight_norm_after: 0.28756833
  weight_change: 0.00132138
  grad_norm: 0.00000002
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00218902
  weight_norm_after: 0.00217652
  weight_change: 0.00001249
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.27659294
  weight_norm_after: 0.27533919
  weight_change: 0.00125375
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00219719
  weight_norm_after: 0.00218418
  weight_change: 0.00001301
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.36974946
  weight_norm_after: 0.36823997
  weight_change: 0.00150949
  grad_norm: 0.00000005
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00382249
  weight_norm_after: 0.00380275
  weight_change: 0.00001974
  grad_norm: 0.00000003
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.33607906
  weight_norm_after: 0.33465871
  weight_change: 0.00142035
  grad_norm: 0.00000015
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00615516
  weight_norm_after: 0.00612845
  weight_change: 0.00002670
  grad_norm: 0.00000008
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 1.28298187
  weight_norm_after: 1.27870202
  weight_change: 0.00427985
  grad_norm: 0.00000031
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 6.06738901
  weight_norm_after: 6.06231880
  weight_change: 0.00507021
  grad_norm: 0.00163909
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12234103
  weight_norm_after: 0.12228634
  weight_change: 0.00005469
  grad_norm: 0.00058893
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.11944962
  weight_norm_after: 8.11771488
  weight_change: 0.00173473
  grad_norm: 0.03467637
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.23557064
  weight_norm_after: 0.23572250
  weight_change: 0.00015186
  grad_norm: 0.00291882
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.14191341
  weight_norm_after: 8.13982677
  weight_change: 0.00208664
  grad_norm: 0.04920176
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.06566127
  weight_norm_after: 0.06566479
  weight_change: 0.00000352
  grad_norm: 0.03925274
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.12672329
  weight_norm_after: 8.12457561
  weight_change: 0.00214767
  grad_norm: 0.04150156
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.25774685
  weight_norm_after: 0.25781670
  weight_change: 0.00006986
  grad_norm: 0.00378156
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.16347122
  weight_norm_after: 8.16147423
  weight_change: 0.00199699
  grad_norm: 0.04171074
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.06566127
  weight_norm_after: 0.06566479
  weight_change: 0.00000352
  grad_norm: 0.03925274
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.46067715
  weight_norm_after: 8.45938301
  weight_change: 0.00129414
  grad_norm: 0.05874193
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.25612283
  weight_norm_after: 0.25621745
  weight_change: 0.00009462
  grad_norm: 0.00608708
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.51280689
  weight_norm_after: 8.51125336
  weight_change: 0.00155354
  grad_norm: 0.06015731
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.06566127
  weight_norm_after: 0.06566479
  weight_change: 0.00000352
  grad_norm: 0.03925274
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.19868088
  weight_norm_after: 8.19766331
  weight_change: 0.00101757
  grad_norm: 0.04034571
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.24744774
  weight_norm_after: 0.24799792
  weight_change: 0.00055018
  grad_norm: 0.00362649
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 8.05321503
  weight_norm_after: 8.05128956
  weight_change: 0.00192547
  grad_norm: 0.05522818
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.06566127
  weight_norm_after: 0.06566479
  weight_change: 0.00000352
  grad_norm: 0.03925274
projection.weight:
  weight_norm_before: 2.18556476
  weight_norm_after: 2.18527603
  weight_change: 0.00028872
  grad_norm: 0.31935492
projection.bias:
  weight_norm_before: 0.00536710
  weight_norm_after: 0.00595912
  weight_change: 0.00059202
  grad_norm: 0.18228455
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 4.47526884
  weight_norm_after: 4.47032738
  weight_change: 0.00494146
  grad_norm: 0.00129737
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08305036
  weight_norm_after: 0.08316185
  weight_change: 0.00011150
  grad_norm: 0.00705095
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 6.31999540
  weight_norm_after: 6.31561041
  weight_change: 0.00438499
  grad_norm: 0.00039583
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06544928
  weight_norm_after: 0.06543137
  weight_change: 0.00001791
  grad_norm: 0.00030855
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.43158448
  weight_norm_after: 1.43025410
  weight_change: 0.00133038
  grad_norm: 0.00003097
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.02075060
  weight_norm_after: 0.02073982
  weight_change: 0.00001078
  grad_norm: 0.00004525
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.10562015
  weight_norm_after: 2.10371351
  weight_change: 0.00190663
  grad_norm: 0.00001469
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01442310
  weight_norm_after: 0.01437468
  weight_change: 0.00004842
  grad_norm: 0.00001022
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 900/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.33685219
loss (scaled for backward): 1.33685219
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 973.80509215
avg train_loss so far: 1.08080476
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.053532 / 0.075534
y_true_for_loss mean/std: 0.143990 / 1.174191
reg_loss contribution: 0.00000051

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 3.88882732
  weight_norm_after: 3.88361192
  weight_change: 0.00521541
  grad_norm: 0.00055216
celestial_projection.0.bias:
  weight_norm_before: 0.02853297
  weight_norm_after: 0.02848158
  weight_change: 0.00005138
  grad_norm: 0.00007550
celestial_projection.1.weight:
  weight_norm_before: 5.92368984
  weight_norm_after: 5.91898251
  weight_change: 0.00470734
  grad_norm: 0.00004581
celestial_projection.1.bias:
  weight_norm_before: 0.04473571
  weight_norm_after: 0.04467952
  weight_change: 0.00005618
  grad_norm: 0.00003903
celestial_query_projection.weight:
  weight_norm_before: 0.15130782
  weight_norm_after: 0.15066211
  weight_change: 0.00064571
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00036479
  weight_norm_after: 0.00036211
  weight_change: 0.00000268
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.05335769
  weight_norm_after: 0.05299468
  weight_change: 0.00036301
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.49707603
  weight_norm_after: 1.49370146
  weight_change: 0.00337458
  grad_norm: 0.00008497
celestial_value_projection.bias:
  weight_norm_before: 0.03888708
  weight_norm_after: 0.03887336
  weight_change: 0.00001372
  grad_norm: 0.00003399
celestial_output_projection.weight:
  weight_norm_before: 3.14363551
  weight_norm_after: 3.13978791
  weight_change: 0.00384760
  grad_norm: 0.00076225
celestial_output_projection.bias:
  weight_norm_before: 0.11583263
  weight_norm_after: 0.11586614
  weight_change: 0.00003351
  grad_norm: 0.00186924
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.22923344
  weight_norm_after: 0.22816552
  weight_change: 0.00106792
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00163710
  weight_norm_after: 0.00162748
  weight_change: 0.00000962
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.21999797
  weight_norm_after: 0.21898496
  weight_change: 0.00101301
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00162067
  weight_norm_after: 0.00161060
  weight_change: 0.00001007
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.30100480
  weight_norm_after: 0.29976195
  weight_change: 0.00124285
  grad_norm: 0.00000002
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00295074
  weight_norm_after: 0.00293534
  weight_change: 0.00001540
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.27147907
  weight_norm_after: 0.27031294
  weight_change: 0.00116614
  grad_norm: 0.00000003
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00491689
  weight_norm_after: 0.00489445
  weight_change: 0.00002244
  grad_norm: 0.00000002
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 1.08354497
  weight_norm_after: 1.07984841
  weight_change: 0.00369656
  grad_norm: 0.00000015
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 5.81738138
  weight_norm_after: 5.81239557
  weight_change: 0.00498581
  grad_norm: 0.00253022
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12320641
  weight_norm_after: 0.12317825
  weight_change: 0.00002816
  grad_norm: 0.00098752
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 8.02901745
  weight_norm_after: 8.02675152
  weight_change: 0.00226593
  grad_norm: 0.06878129
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.24083194
  weight_norm_after: 0.24075036
  weight_change: 0.00008158
  grad_norm: 0.00588210
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 8.04938221
  weight_norm_after: 8.04771519
  weight_change: 0.00166702
  grad_norm: 0.06933306
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.06895220
  weight_norm_after: 0.06914932
  weight_change: 0.00019713
  grad_norm: 0.07976753
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 8.03182220
  weight_norm_after: 8.02971840
  weight_change: 0.00210381
  grad_norm: 0.06191641
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.26411825
  weight_norm_after: 0.26416087
  weight_change: 0.00004262
  grad_norm: 0.00551784
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 8.06652832
  weight_norm_after: 8.06471920
  weight_change: 0.00180912
  grad_norm: 0.07358929
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.06895220
  weight_norm_after: 0.06914932
  weight_change: 0.00019713
  grad_norm: 0.07976753
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.38513374
  weight_norm_after: 8.38334656
  weight_change: 0.00178719
  grad_norm: 0.09610161
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.25995538
  weight_norm_after: 0.25994429
  weight_change: 0.00001109
  grad_norm: 0.00992057
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.43900681
  weight_norm_after: 8.43748569
  weight_change: 0.00152111
  grad_norm: 0.12461127
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.06895220
  weight_norm_after: 0.06914932
  weight_change: 0.00019713
  grad_norm: 0.07976753
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.11430073
  weight_norm_after: 8.11198807
  weight_change: 0.00231266
  grad_norm: 0.06639411
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.25711605
  weight_norm_after: 0.25702330
  weight_change: 0.00009274
  grad_norm: 0.00615603
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.96298170
  weight_norm_after: 7.96124411
  weight_change: 0.00173759
  grad_norm: 0.08570085
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.06895220
  weight_norm_after: 0.06914932
  weight_change: 0.00019713
  grad_norm: 0.07976753
projection.weight:
  weight_norm_before: 2.16125655
  weight_norm_after: 2.16111684
  weight_change: 0.00013971
  grad_norm: 0.65016466
projection.bias:
  weight_norm_before: 0.00306333
  weight_norm_after: 0.00306219
  weight_change: 0.00000114
  grad_norm: 0.50379896
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 4.23551989
  weight_norm_after: 4.23082876
  weight_change: 0.00469112
  grad_norm: 0.00190904
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08421885
  weight_norm_after: 0.08420466
  weight_change: 0.00001419
  grad_norm: 0.01076294
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 6.10414839
  weight_norm_after: 6.09982300
  weight_change: 0.00432539
  grad_norm: 0.00054257
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06431545
  weight_norm_after: 0.06424583
  weight_change: 0.00006962
  grad_norm: 0.00043158
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.36631310
  weight_norm_after: 1.36503470
  weight_change: 0.00127840
  grad_norm: 0.00006127
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01988077
  weight_norm_after: 0.01987797
  weight_change: 0.00000280
  grad_norm: 0.00011384
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 2.01190257
  weight_norm_after: 2.01010370
  weight_change: 0.00179887
  grad_norm: 0.00004571
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01267016
  weight_norm_after: 0.01269263
  weight_change: 0.00002247
  grad_norm: 0.00002511
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 950/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 4.28070450
loss (scaled for backward): 4.28070450
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1017.29312223
avg train_loss so far: 1.06970886
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.025898 / 0.055494
y_true_for_loss mean/std: -0.577264 / 2.029949
reg_loss contribution: 0.00000024

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 3.63756990
  weight_norm_after: 3.63274121
  weight_change: 0.00482869
  grad_norm: 0.00031609
celestial_projection.0.bias:
  weight_norm_before: 0.02674520
  weight_norm_after: 0.02671269
  weight_change: 0.00003252
  grad_norm: 0.00003759
celestial_projection.1.weight:
  weight_norm_before: 5.68998432
  weight_norm_after: 5.68536615
  weight_change: 0.00461817
  grad_norm: 0.00002721
celestial_projection.1.bias:
  weight_norm_before: 0.04189446
  weight_norm_after: 0.04185084
  weight_change: 0.00004362
  grad_norm: 0.00002362
celestial_query_projection.weight:
  weight_norm_before: 0.12210938
  weight_norm_after: 0.12158536
  weight_change: 0.00052402
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00025100
  weight_norm_after: 0.00024910
  weight_change: 0.00000190
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.03784040
  weight_norm_after: 0.03757941
  weight_change: 0.00026099
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.33706760
  weight_norm_after: 1.33397818
  weight_change: 0.00308943
  grad_norm: 0.00009314
celestial_value_projection.bias:
  weight_norm_before: 0.03879369
  weight_norm_after: 0.03873515
  weight_change: 0.00005854
  grad_norm: 0.00003915
celestial_output_projection.weight:
  weight_norm_before: 2.95676184
  weight_norm_after: 2.95310187
  weight_change: 0.00365996
  grad_norm: 0.00047123
celestial_output_projection.bias:
  weight_norm_before: 0.12347907
  weight_norm_after: 0.12391353
  weight_change: 0.00043446
  grad_norm: 0.00139196
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.18112387
  weight_norm_after: 0.18026473
  weight_change: 0.00085914
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00121443
  weight_norm_after: 0.00120708
  weight_change: 0.00000735
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.17435819
  weight_norm_after: 0.17354304
  weight_change: 0.00081515
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00118156
  weight_norm_after: 0.00117400
  weight_change: 0.00000756
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.24449594
  weight_norm_after: 0.24347621
  weight_change: 0.00101973
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00227256
  weight_norm_after: 0.00226065
  weight_change: 0.00001191
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.21852891
  weight_norm_after: 0.21757476
  weight_change: 0.00095415
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00390486
  weight_norm_after: 0.00388671
  weight_change: 0.00001815
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.91173238
  weight_norm_after: 0.90855652
  weight_change: 0.00317585
  grad_norm: 0.00000005
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 5.57257605
  weight_norm_after: 5.56772947
  weight_change: 0.00484657
  grad_norm: 0.00218760
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12491070
  weight_norm_after: 0.12490956
  weight_change: 0.00000114
  grad_norm: 0.00089459
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.93397188
  weight_norm_after: 7.93190050
  weight_change: 0.00207138
  grad_norm: 0.05803186
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.24667603
  weight_norm_after: 0.24664575
  weight_change: 0.00003028
  grad_norm: 0.00494016
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.95310879
  weight_norm_after: 7.95128441
  weight_change: 0.00182438
  grad_norm: 0.04916370
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.07154209
  weight_norm_after: 0.07146757
  weight_change: 0.00007452
  grad_norm: 0.05480413
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.93860054
  weight_norm_after: 7.93654776
  weight_change: 0.00205278
  grad_norm: 0.04421535
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27057943
  weight_norm_after: 0.27051991
  weight_change: 0.00005952
  grad_norm: 0.00385130
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.96936083
  weight_norm_after: 7.96731138
  weight_change: 0.00204945
  grad_norm: 0.04516423
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.07154209
  weight_norm_after: 0.07146757
  weight_change: 0.00007452
  grad_norm: 0.05480413
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.31201363
  weight_norm_after: 8.31059742
  weight_change: 0.00141621
  grad_norm: 0.05741828
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.27168697
  weight_norm_after: 0.27175474
  weight_change: 0.00006777
  grad_norm: 0.00627310
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.36850262
  weight_norm_after: 8.36696434
  weight_change: 0.00153828
  grad_norm: 0.07763509
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.07154209
  weight_norm_after: 0.07146757
  weight_change: 0.00007452
  grad_norm: 0.05480413
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 8.02139378
  weight_norm_after: 8.01927567
  weight_change: 0.00211811
  grad_norm: 0.05709702
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.26145291
  weight_norm_after: 0.26144406
  weight_change: 0.00000885
  grad_norm: 0.00572020
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.87546492
  weight_norm_after: 7.87366390
  weight_change: 0.00180101
  grad_norm: 0.05474555
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.07154209
  weight_norm_after: 0.07146757
  weight_change: 0.00007452
  grad_norm: 0.05480413
projection.weight:
  weight_norm_before: 2.14210272
  weight_norm_after: 2.14171028
  weight_change: 0.00039244
  grad_norm: 0.30313170
projection.bias:
  weight_norm_before: 0.00244702
  weight_norm_after: 0.00230839
  weight_change: 0.00013863
  grad_norm: 0.23044986
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 4.00691175
  weight_norm_after: 4.00246763
  weight_change: 0.00444412
  grad_norm: 0.00119789
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08611631
  weight_norm_after: 0.08616836
  weight_change: 0.00005205
  grad_norm: 0.00712257
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 5.89086246
  weight_norm_after: 5.88659334
  weight_change: 0.00426912
  grad_norm: 0.00037216
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06226327
  weight_norm_after: 0.06214408
  weight_change: 0.00011919
  grad_norm: 0.00026849
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.30363202
  weight_norm_after: 1.30240571
  weight_change: 0.00122631
  grad_norm: 0.00004905
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01933667
  weight_norm_after: 0.01934262
  weight_change: 0.00000595
  grad_norm: 0.00005974
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.92139089
  weight_norm_after: 1.91962159
  weight_change: 0.00176930
  grad_norm: 0.00001113
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01166886
  weight_norm_after: 0.01167366
  weight_change: 0.00000480
  grad_norm: 0.00001042
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1000/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.05923986
loss (scaled for backward): 1.05923986
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1078.55842322
avg train_loss so far: 1.07748094
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.012956 / 0.093871
y_true_for_loss mean/std: 0.114237 / 1.034022
reg_loss contribution: 0.00000019

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 3.40508938
  weight_norm_after: 3.40062094
  weight_change: 0.00446844
  grad_norm: 0.00013374
celestial_projection.0.bias:
  weight_norm_before: 0.02473125
  weight_norm_after: 0.02465883
  weight_change: 0.00007243
  grad_norm: 0.00001900
celestial_projection.1.weight:
  weight_norm_before: 5.46088362
  weight_norm_after: 5.45633507
  weight_change: 0.00454855
  grad_norm: 0.00001537
celestial_projection.1.bias:
  weight_norm_before: 0.04006505
  weight_norm_after: 0.04001340
  weight_change: 0.00005165
  grad_norm: 0.00000938
celestial_query_projection.weight:
  weight_norm_before: 0.09841432
  weight_norm_after: 0.09798911
  weight_change: 0.00042521
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00017083
  weight_norm_after: 0.00016951
  weight_change: 0.00000133
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.02670923
  weight_norm_after: 0.02652250
  weight_change: 0.00018673
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.19141734
  weight_norm_after: 1.18878722
  weight_change: 0.00263011
  grad_norm: 0.00002044
celestial_value_projection.bias:
  weight_norm_before: 0.03646105
  weight_norm_after: 0.03653344
  weight_change: 0.00007239
  grad_norm: 0.00000909
celestial_output_projection.weight:
  weight_norm_before: 2.77877665
  weight_norm_after: 2.77536058
  weight_change: 0.00341606
  grad_norm: 0.00016593
celestial_output_projection.bias:
  weight_norm_before: 0.13322431
  weight_norm_after: 0.13298692
  weight_change: 0.00023739
  grad_norm: 0.00062172
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.14250179
  weight_norm_after: 0.14181374
  weight_change: 0.00068805
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00089371
  weight_norm_after: 0.00088818
  weight_change: 0.00000552
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.13770279
  weight_norm_after: 0.13704953
  weight_change: 0.00065327
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00085241
  weight_norm_after: 0.00084678
  weight_change: 0.00000563
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.19820935
  weight_norm_after: 0.19737564
  weight_change: 0.00083371
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00174557
  weight_norm_after: 0.00173634
  weight_change: 0.00000923
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.17527246
  weight_norm_after: 0.17449440
  weight_change: 0.00077806
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00308416
  weight_norm_after: 0.00306952
  weight_change: 0.00001464
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.76446962
  weight_norm_after: 0.76175445
  weight_change: 0.00271517
  grad_norm: 0.00000003
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 5.33271503
  weight_norm_after: 5.32801962
  weight_change: 0.00469542
  grad_norm: 0.00087434
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12364935
  weight_norm_after: 0.12365468
  weight_change: 0.00000533
  grad_norm: 0.00037602
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.83256149
  weight_norm_after: 7.83057308
  weight_change: 0.00198841
  grad_norm: 0.03195255
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.24455529
  weight_norm_after: 0.24453352
  weight_change: 0.00002177
  grad_norm: 0.00283892
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.86203527
  weight_norm_after: 7.86020327
  weight_change: 0.00183201
  grad_norm: 0.03196978
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.07490266
  weight_norm_after: 0.07506932
  weight_change: 0.00016666
  grad_norm: 0.02779850
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.83009481
  weight_norm_after: 7.82762718
  weight_change: 0.00246763
  grad_norm: 0.01629217
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27034283
  weight_norm_after: 0.27023020
  weight_change: 0.00011262
  grad_norm: 0.00143136
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.87282133
  weight_norm_after: 7.87104750
  weight_change: 0.00177383
  grad_norm: 0.01913770
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.07490266
  weight_norm_after: 0.07506932
  weight_change: 0.00016666
  grad_norm: 0.02779850
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.22467041
  weight_norm_after: 8.22256470
  weight_change: 0.00210571
  grad_norm: 0.02197234
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.27178955
  weight_norm_after: 0.27167076
  weight_change: 0.00011879
  grad_norm: 0.00236275
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.30075169
  weight_norm_after: 8.29955578
  weight_change: 0.00119591
  grad_norm: 0.03482832
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.07490266
  weight_norm_after: 0.07506932
  weight_change: 0.00016666
  grad_norm: 0.02779850
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.92646408
  weight_norm_after: 7.92448330
  weight_change: 0.00198078
  grad_norm: 0.02732031
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.26395977
  weight_norm_after: 0.26394647
  weight_change: 0.00001329
  grad_norm: 0.00254976
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.78707123
  weight_norm_after: 7.78526449
  weight_change: 0.00180674
  grad_norm: 0.02652143
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.07490266
  weight_norm_after: 0.07506932
  weight_change: 0.00016666
  grad_norm: 0.02779850
projection.weight:
  weight_norm_before: 2.12899280
  weight_norm_after: 2.12876368
  weight_change: 0.00022912
  grad_norm: 0.14555146
projection.bias:
  weight_norm_before: 0.00553148
  weight_norm_after: 0.00578662
  weight_change: 0.00025514
  grad_norm: 0.12894523
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 3.78863001
  weight_norm_after: 3.78437829
  weight_change: 0.00425172
  grad_norm: 0.00064484
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08770792
  weight_norm_after: 0.08769404
  weight_change: 0.00001388
  grad_norm: 0.00400031
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 5.68224621
  weight_norm_after: 5.67813110
  weight_change: 0.00411510
  grad_norm: 0.00021483
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06102433
  weight_norm_after: 0.06099284
  weight_change: 0.00003149
  grad_norm: 0.00015543
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.24333358
  weight_norm_after: 1.24214709
  weight_change: 0.00118649
  grad_norm: 0.00001435
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01924889
  weight_norm_after: 0.01923456
  weight_change: 0.00001433
  grad_norm: 0.00002312
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.83442974
  weight_norm_after: 1.83271670
  weight_change: 0.00171304
  grad_norm: 0.00000562
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01149468
  weight_norm_after: 0.01147498
  weight_change: 0.00001970
  grad_norm: 0.00000369
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1050/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.16901605
loss (scaled for backward): 0.16901605
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1133.50093743
avg train_loss so far: 1.07849756
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.034496 / 0.053488
y_true_for_loss mean/std: 0.149090 / 0.400168
reg_loss contribution: 0.00000014

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 3.18968344
  weight_norm_after: 3.18553281
  weight_change: 0.00415063
  grad_norm: 0.00015449
celestial_projection.0.bias:
  weight_norm_before: 0.02282005
  weight_norm_after: 0.02278435
  weight_change: 0.00003569
  grad_norm: 0.00002520
celestial_projection.1.weight:
  weight_norm_before: 5.23612642
  weight_norm_after: 5.23166466
  weight_change: 0.00446177
  grad_norm: 0.00001518
celestial_projection.1.bias:
  weight_norm_before: 0.03805698
  weight_norm_after: 0.03799910
  weight_change: 0.00005788
  grad_norm: 0.00001037
celestial_query_projection.weight:
  weight_norm_before: 0.07919022
  weight_norm_after: 0.07884531
  weight_change: 0.00034491
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00011501
  weight_norm_after: 0.00011409
  weight_change: 0.00000092
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.01876318
  weight_norm_after: 0.01863024
  weight_change: 0.00013295
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 1.06121433
  weight_norm_after: 1.05888486
  weight_change: 0.00232947
  grad_norm: 0.00003725
celestial_value_projection.bias:
  weight_norm_before: 0.03454860
  weight_norm_after: 0.03464428
  weight_change: 0.00009568
  grad_norm: 0.00001778
celestial_output_projection.weight:
  weight_norm_before: 2.61142206
  weight_norm_after: 2.60820103
  weight_change: 0.00322104
  grad_norm: 0.00020850
celestial_output_projection.bias:
  weight_norm_before: 0.14103857
  weight_norm_after: 0.14075541
  weight_change: 0.00028315
  grad_norm: 0.00096210
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.11163702
  weight_norm_after: 0.11108848
  weight_change: 0.00054854
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00065266
  weight_norm_after: 0.00064852
  weight_change: 0.00000415
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.10838312
  weight_norm_after: 0.10786170
  weight_change: 0.00052142
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00060867
  weight_norm_after: 0.00060452
  weight_change: 0.00000414
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.16042940
  weight_norm_after: 0.15975016
  weight_change: 0.00067924
  grad_norm: 0.00000001
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00133890
  weight_norm_after: 0.00133180
  weight_change: 0.00000710
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.14005685
  weight_norm_after: 0.13942459
  weight_change: 0.00063226
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00242182
  weight_norm_after: 0.00240998
  weight_change: 0.00001184
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.63884759
  weight_norm_after: 0.63653690
  weight_change: 0.00231069
  grad_norm: 0.00000003
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 5.10013056
  weight_norm_after: 5.09551096
  weight_change: 0.00461960
  grad_norm: 0.00180530
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12341006
  weight_norm_after: 0.12333516
  weight_change: 0.00007490
  grad_norm: 0.00084767
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.73151207
  weight_norm_after: 7.72997665
  weight_change: 0.00153542
  grad_norm: 0.03783355
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.24490656
  weight_norm_after: 0.24515688
  weight_change: 0.00025032
  grad_norm: 0.00337223
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.76986170
  weight_norm_after: 7.76793289
  weight_change: 0.00192881
  grad_norm: 0.02684404
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.07532032
  weight_norm_after: 0.07526442
  weight_change: 0.00005590
  grad_norm: 0.03370588
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.72454119
  weight_norm_after: 7.72277737
  weight_change: 0.00176382
  grad_norm: 0.06510609
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27101135
  weight_norm_after: 0.27112186
  weight_change: 0.00011051
  grad_norm: 0.00573794
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.77453566
  weight_norm_after: 7.77259350
  weight_change: 0.00194216
  grad_norm: 0.03784426
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.07532032
  weight_norm_after: 0.07526442
  weight_change: 0.00005590
  grad_norm: 0.03370588
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.14017963
  weight_norm_after: 8.13877296
  weight_change: 0.00140667
  grad_norm: 0.04959425
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.27135611
  weight_norm_after: 0.27158058
  weight_change: 0.00022447
  grad_norm: 0.00540912
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.22925282
  weight_norm_after: 8.22760677
  weight_change: 0.00164604
  grad_norm: 0.05097305
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.07532032
  weight_norm_after: 0.07526442
  weight_change: 0.00005590
  grad_norm: 0.03370588
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.82211781
  weight_norm_after: 7.82031012
  weight_change: 0.00180769
  grad_norm: 0.05979756
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.26119214
  weight_norm_after: 0.26125917
  weight_change: 0.00006703
  grad_norm: 0.00589145
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.69888163
  weight_norm_after: 7.69707727
  weight_change: 0.00180435
  grad_norm: 0.03330769
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.07532032
  weight_norm_after: 0.07526442
  weight_change: 0.00005590
  grad_norm: 0.03370588
projection.weight:
  weight_norm_before: 2.11900711
  weight_norm_after: 2.11869907
  weight_change: 0.00030804
  grad_norm: 0.16886996
projection.bias:
  weight_norm_before: 0.00305949
  weight_norm_after: 0.00288854
  weight_change: 0.00017096
  grad_norm: 0.12840001
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 3.58124423
  weight_norm_after: 3.57722354
  weight_change: 0.00402069
  grad_norm: 0.00093635
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.08929745
  weight_norm_after: 0.08936013
  weight_change: 0.00006267
  grad_norm: 0.00600423
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 5.47825718
  weight_norm_after: 5.47416067
  weight_change: 0.00409651
  grad_norm: 0.00029826
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.06040204
  weight_norm_after: 0.06032668
  weight_change: 0.00007536
  grad_norm: 0.00022762
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.18518198
  weight_norm_after: 1.18403983
  weight_change: 0.00114214
  grad_norm: 0.00002390
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01888113
  weight_norm_after: 0.01884610
  weight_change: 0.00003503
  grad_norm: 0.00004303
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.74982047
  weight_norm_after: 1.74813974
  weight_change: 0.00168073
  grad_norm: 0.00001242
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.01081178
  weight_norm_after: 0.01077924
  weight_change: 0.00003254
  grad_norm: 0.00000668
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1100/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.21862721
loss (scaled for backward): 0.21862721
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1185.67574247
avg train_loss so far: 1.07690803
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.069123 / 0.106909
y_true_for_loss mean/std: -0.104692 / 0.455404
reg_loss contribution: 0.00000009

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.98989797
  weight_norm_after: 2.98606563
  weight_change: 0.00383234
  grad_norm: 0.00038864
celestial_projection.0.bias:
  weight_norm_before: 0.02163766
  weight_norm_after: 0.02164713
  weight_change: 0.00000947
  grad_norm: 0.00006737
celestial_projection.1.weight:
  weight_norm_before: 5.01587486
  weight_norm_after: 5.01153374
  weight_change: 0.00434113
  grad_norm: 0.00005506
celestial_projection.1.bias:
  weight_norm_before: 0.03596268
  weight_norm_after: 0.03594646
  weight_change: 0.00001622
  grad_norm: 0.00003257
celestial_query_projection.weight:
  weight_norm_before: 0.06360168
  weight_norm_after: 0.06332210
  weight_change: 0.00027958
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00007659
  weight_norm_after: 0.00007596
  weight_change: 0.00000063
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.01311842
  weight_norm_after: 0.01302422
  weight_change: 0.00009420
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.95015413
  weight_norm_after: 0.94806910
  weight_change: 0.00208503
  grad_norm: 0.00010365
celestial_value_projection.bias:
  weight_norm_before: 0.03807474
  weight_norm_after: 0.03813472
  weight_change: 0.00005998
  grad_norm: 0.00005188
celestial_output_projection.weight:
  weight_norm_before: 2.45433640
  weight_norm_after: 2.45126367
  weight_change: 0.00307274
  grad_norm: 0.00049346
celestial_output_projection.bias:
  weight_norm_before: 0.14472182
  weight_norm_after: 0.14483677
  weight_change: 0.00011495
  grad_norm: 0.00222213
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.08708289
  weight_norm_after: 0.08664754
  weight_change: 0.00043535
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00047284
  weight_norm_after: 0.00046976
  weight_change: 0.00000308
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.08502546
  weight_norm_after: 0.08461094
  weight_change: 0.00041452
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00043008
  weight_norm_after: 0.00042707
  weight_change: 0.00000301
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.12969691
  weight_norm_after: 0.12914529
  weight_change: 0.00055161
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00102688
  weight_norm_after: 0.00102145
  weight_change: 0.00000543
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.11148912
  weight_norm_after: 0.11097719
  weight_change: 0.00051193
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00189000
  weight_norm_after: 0.00188052
  weight_change: 0.00000948
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.53216195
  weight_norm_after: 0.53020400
  weight_change: 0.00195795
  grad_norm: 0.00000001
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 4.87433863
  weight_norm_after: 4.86989164
  weight_change: 0.00444698
  grad_norm: 0.00149204
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12385258
  weight_norm_after: 0.12384876
  weight_change: 0.00000382
  grad_norm: 0.00073833
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.64868307
  weight_norm_after: 7.64725208
  weight_change: 0.00143099
  grad_norm: 0.04531401
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25089467
  weight_norm_after: 0.25108755
  weight_change: 0.00019288
  grad_norm: 0.00399055
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.67989731
  weight_norm_after: 7.67784023
  weight_change: 0.00205708
  grad_norm: 0.05545098
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.08389191
  weight_norm_after: 0.08349899
  weight_change: 0.00039291
  grad_norm: 0.07664783
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.61936712
  weight_norm_after: 7.61791992
  weight_change: 0.00144720
  grad_norm: 0.04218877
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27306756
  weight_norm_after: 0.27333003
  weight_change: 0.00026247
  grad_norm: 0.00375264
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.67801619
  weight_norm_after: 7.67583656
  weight_change: 0.00217962
  grad_norm: 0.04679507
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.08389191
  weight_norm_after: 0.08349899
  weight_change: 0.00039291
  grad_norm: 0.07664783
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 8.06690311
  weight_norm_after: 8.06509209
  weight_change: 0.00181103
  grad_norm: 0.06124868
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.27894938
  weight_norm_after: 0.27883780
  weight_change: 0.00011158
  grad_norm: 0.00685709
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.16089535
  weight_norm_after: 8.15946388
  weight_change: 0.00143147
  grad_norm: 0.08785170
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.08389191
  weight_norm_after: 0.08349899
  weight_change: 0.00039291
  grad_norm: 0.07664783
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.74566412
  weight_norm_after: 7.74433613
  weight_change: 0.00132799
  grad_norm: 0.05716952
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.26948348
  weight_norm_after: 0.26964650
  weight_change: 0.00016302
  grad_norm: 0.00569070
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.60869074
  weight_norm_after: 7.60681438
  weight_change: 0.00187635
  grad_norm: 0.05498182
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.08389191
  weight_norm_after: 0.08349899
  weight_change: 0.00039291
  grad_norm: 0.07664783
projection.weight:
  weight_norm_before: 2.10245562
  weight_norm_after: 2.10169363
  weight_change: 0.00076199
  grad_norm: 0.53958261
projection.bias:
  weight_norm_before: 0.00990526
  weight_norm_after: 0.00937422
  weight_change: 0.00053105
  grad_norm: 0.52651554
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 3.38497281
  weight_norm_after: 3.38114810
  weight_change: 0.00382471
  grad_norm: 0.00186350
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.09378334
  weight_norm_after: 0.09376388
  weight_change: 0.00001946
  grad_norm: 0.01241541
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 5.27509356
  weight_norm_after: 5.27106142
  weight_change: 0.00403214
  grad_norm: 0.00059079
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.05721887
  weight_norm_after: 0.05708202
  weight_change: 0.00013684
  grad_norm: 0.00046477
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.12915158
  weight_norm_after: 1.12805820
  weight_change: 0.00109339
  grad_norm: 0.00006441
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01865307
  weight_norm_after: 0.01867151
  weight_change: 0.00001844
  grad_norm: 0.00011745
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.66718245
  weight_norm_after: 1.66557324
  weight_change: 0.00160921
  grad_norm: 0.00002765
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00984484
  weight_norm_after: 0.00984780
  weight_change: 0.00000297
  grad_norm: 0.00001848
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1150/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.57098669
loss (scaled for backward): 0.57098669
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1234.16657078
avg train_loss so far: 1.07225593
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.066958 / 0.076771
y_true_for_loss mean/std: -0.454595 / 0.552151
reg_loss contribution: 0.00000009

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.80440092
  weight_norm_after: 2.80082679
  weight_change: 0.00357413
  grad_norm: 0.00023161
celestial_projection.0.bias:
  weight_norm_before: 0.01981493
  weight_norm_after: 0.01978941
  weight_change: 0.00002552
  grad_norm: 0.00005444
celestial_projection.1.weight:
  weight_norm_before: 4.80003595
  weight_norm_after: 4.79577255
  weight_change: 0.00426340
  grad_norm: 0.00002736
celestial_projection.1.bias:
  weight_norm_before: 0.03372164
  weight_norm_after: 0.03368100
  weight_change: 0.00004064
  grad_norm: 0.00001618
celestial_query_projection.weight:
  weight_norm_before: 0.05097167
  weight_norm_after: 0.05074529
  weight_change: 0.00022638
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00005045
  weight_norm_after: 0.00005002
  weight_change: 0.00000043
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00912783
  weight_norm_after: 0.00906141
  weight_change: 0.00006642
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.85030711
  weight_norm_after: 0.84829915
  weight_change: 0.00200796
  grad_norm: 0.00003176
celestial_value_projection.bias:
  weight_norm_before: 0.04049680
  weight_norm_after: 0.04044303
  weight_change: 0.00005377
  grad_norm: 0.00001682
celestial_output_projection.weight:
  weight_norm_before: 2.30623102
  weight_norm_after: 2.30333376
  weight_change: 0.00289726
  grad_norm: 0.00025533
celestial_output_projection.bias:
  weight_norm_before: 0.13580307
  weight_norm_after: 0.13592206
  weight_change: 0.00011899
  grad_norm: 0.00115767
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.06763657
  weight_norm_after: 0.06729259
  weight_change: 0.00034398
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00033982
  weight_norm_after: 0.00033755
  weight_change: 0.00000227
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.06649047
  weight_norm_after: 0.06616221
  weight_change: 0.00032827
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00030074
  weight_norm_after: 0.00029857
  weight_change: 0.00000218
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.10477474
  weight_norm_after: 0.10432810
  weight_change: 0.00044665
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00078802
  weight_norm_after: 0.00078386
  weight_change: 0.00000416
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.08839863
  weight_norm_after: 0.08798566
  weight_change: 0.00041297
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00146534
  weight_norm_after: 0.00145780
  weight_change: 0.00000754
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.44193521
  weight_norm_after: 0.44028276
  weight_change: 0.00165245
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 4.65427208
  weight_norm_after: 4.64994955
  weight_change: 0.00432253
  grad_norm: 0.00074732
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12246650
  weight_norm_after: 0.12248477
  weight_change: 0.00001827
  grad_norm: 0.00038587
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.55388165
  weight_norm_after: 7.55200577
  weight_change: 0.00187588
  grad_norm: 0.02892081
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25058493
  weight_norm_after: 0.25062227
  weight_change: 0.00003734
  grad_norm: 0.00243661
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.58603048
  weight_norm_after: 7.58408070
  weight_change: 0.00194979
  grad_norm: 0.02549617
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.08734248
  weight_norm_after: 0.08736062
  weight_change: 0.00001814
  grad_norm: 0.01910358
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.51892567
  weight_norm_after: 7.51705122
  weight_change: 0.00187445
  grad_norm: 0.01456887
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27517742
  weight_norm_after: 0.27529299
  weight_change: 0.00011557
  grad_norm: 0.00114045
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.57981730
  weight_norm_after: 7.57777739
  weight_change: 0.00203991
  grad_norm: 0.01618525
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.08734248
  weight_norm_after: 0.08736062
  weight_change: 0.00001814
  grad_norm: 0.01910358
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.98029900
  weight_norm_after: 7.97849417
  weight_change: 0.00180483
  grad_norm: 0.02706978
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.27948788
  weight_norm_after: 0.27949637
  weight_change: 0.00000849
  grad_norm: 0.00270983
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.08780098
  weight_norm_after: 8.08622265
  weight_change: 0.00157833
  grad_norm: 0.03692056
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.08734248
  weight_norm_after: 0.08736062
  weight_change: 0.00001814
  grad_norm: 0.01910358
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.65575409
  weight_norm_after: 7.65394592
  weight_change: 0.00180817
  grad_norm: 0.01909579
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27095261
  weight_norm_after: 0.27100077
  weight_change: 0.00004816
  grad_norm: 0.00172273
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.52124357
  weight_norm_after: 7.51944351
  weight_change: 0.00180006
  grad_norm: 0.02688917
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.08734248
  weight_norm_after: 0.08736062
  weight_change: 0.00001814
  grad_norm: 0.01910358
projection.weight:
  weight_norm_before: 2.08773565
  weight_norm_after: 2.08754873
  weight_change: 0.00018692
  grad_norm: 0.16922671
projection.bias:
  weight_norm_before: 0.01115802
  weight_norm_after: 0.01133909
  weight_change: 0.00018107
  grad_norm: 0.11747280
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 3.19783545
  weight_norm_after: 3.19418073
  weight_change: 0.00365472
  grad_norm: 0.00085445
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.09392890
  weight_norm_after: 0.09393766
  weight_change: 0.00000876
  grad_norm: 0.00582930
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 5.07950926
  weight_norm_after: 5.07561064
  weight_change: 0.00389862
  grad_norm: 0.00029012
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.05650863
  weight_norm_after: 0.05642724
  weight_change: 0.00008138
  grad_norm: 0.00022648
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.07521963
  weight_norm_after: 1.07415986
  weight_change: 0.00105977
  grad_norm: 0.00002008
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01813550
  weight_norm_after: 0.01811579
  weight_change: 0.00001970
  grad_norm: 0.00003274
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.58842945
  weight_norm_after: 1.58687615
  weight_change: 0.00155330
  grad_norm: 0.00000656
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00943754
  weight_norm_after: 0.00942515
  weight_change: 0.00001239
  grad_norm: 0.00000471
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1200/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.44497633
loss (scaled for backward): 0.44497633
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1270.34064174
avg train_loss so far: 1.05773575
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.080100 / 0.025267
y_true_for_loss mean/std: 0.184994 / 0.660453
reg_loss contribution: 0.00000007

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.63203359
  weight_norm_after: 2.62870383
  weight_change: 0.00332975
  grad_norm: 0.00030284
celestial_projection.0.bias:
  weight_norm_before: 0.02051017
  weight_norm_after: 0.02047230
  weight_change: 0.00003786
  grad_norm: 0.00007915
celestial_projection.1.weight:
  weight_norm_before: 4.59006023
  weight_norm_after: 4.58590603
  weight_change: 0.00415421
  grad_norm: 0.00003368
celestial_projection.1.bias:
  weight_norm_before: 0.03243549
  weight_norm_after: 0.03239879
  weight_change: 0.00003670
  grad_norm: 0.00002111
celestial_query_projection.weight:
  weight_norm_before: 0.04075053
  weight_norm_after: 0.04056745
  weight_change: 0.00018307
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00003287
  weight_norm_after: 0.00003259
  weight_change: 0.00000028
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00632022
  weight_norm_after: 0.00627361
  weight_change: 0.00004661
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.75441569
  weight_norm_after: 0.75259817
  weight_change: 0.00181752
  grad_norm: 0.00003704
celestial_value_projection.bias:
  weight_norm_before: 0.03709339
  weight_norm_after: 0.03701456
  weight_change: 0.00007883
  grad_norm: 0.00002011
celestial_output_projection.weight:
  weight_norm_before: 2.16516614
  weight_norm_after: 2.16243553
  weight_change: 0.00273061
  grad_norm: 0.00036555
celestial_output_projection.bias:
  weight_norm_before: 0.14991066
  weight_norm_after: 0.15007962
  weight_change: 0.00016896
  grad_norm: 0.00199509
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.05230386
  weight_norm_after: 0.05203328
  weight_change: 0.00027058
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00024219
  weight_norm_after: 0.00024054
  weight_change: 0.00000166
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.05183807
  weight_norm_after: 0.05157908
  weight_change: 0.00025900
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00020809
  weight_norm_after: 0.00020654
  weight_change: 0.00000155
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.08461919
  weight_norm_after: 0.08425843
  weight_change: 0.00036076
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00060546
  weight_norm_after: 0.00060229
  weight_change: 0.00000317
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.06980515
  weight_norm_after: 0.06947328
  weight_change: 0.00033186
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00112861
  weight_norm_after: 0.00112265
  weight_change: 0.00000596
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.36592630
  weight_norm_after: 0.36453700
  weight_change: 0.00138929
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 4.44259787
  weight_norm_after: 4.43838406
  weight_change: 0.00421381
  grad_norm: 0.00219490
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12413287
  weight_norm_after: 0.12405571
  weight_change: 0.00007717
  grad_norm: 0.00117454
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.46197414
  weight_norm_after: 7.46018028
  weight_change: 0.00179386
  grad_norm: 0.08024200
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25179452
  weight_norm_after: 0.25172493
  weight_change: 0.00006959
  grad_norm: 0.00705820
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.49099970
  weight_norm_after: 7.48911858
  weight_change: 0.00188112
  grad_norm: 0.06617486
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.08726153
  weight_norm_after: 0.08758698
  weight_change: 0.00032545
  grad_norm: 0.09899044
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.42059517
  weight_norm_after: 7.41859913
  weight_change: 0.00199604
  grad_norm: 0.04496601
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27782112
  weight_norm_after: 0.27783760
  weight_change: 0.00001648
  grad_norm: 0.00403578
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.48058414
  weight_norm_after: 7.47876740
  weight_change: 0.00181675
  grad_norm: 0.05575599
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.08726153
  weight_norm_after: 0.08758698
  weight_change: 0.00032545
  grad_norm: 0.09899044
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.90300894
  weight_norm_after: 7.90137959
  weight_change: 0.00162935
  grad_norm: 0.05913401
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.28420380
  weight_norm_after: 0.28427717
  weight_change: 0.00007337
  grad_norm: 0.00630992
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 8.01492500
  weight_norm_after: 8.01357555
  weight_change: 0.00134945
  grad_norm: 0.10330690
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.08726153
  weight_norm_after: 0.08758698
  weight_change: 0.00032545
  grad_norm: 0.09899044
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.56803942
  weight_norm_after: 7.56651258
  weight_change: 0.00152683
  grad_norm: 0.08337343
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27259129
  weight_norm_after: 0.27263042
  weight_change: 0.00003913
  grad_norm: 0.00827229
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.43083620
  weight_norm_after: 7.42890596
  weight_change: 0.00193024
  grad_norm: 0.08232101
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.08726153
  weight_norm_after: 0.08758698
  weight_change: 0.00032545
  grad_norm: 0.09899044
projection.weight:
  weight_norm_before: 2.06744385
  weight_norm_after: 2.06712055
  weight_change: 0.00032330
  grad_norm: 0.52148026
projection.bias:
  weight_norm_before: 0.00228783
  weight_norm_after: 0.00192226
  weight_change: 0.00036557
  grad_norm: 0.63008469
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 3.02113485
  weight_norm_after: 3.01761603
  weight_change: 0.00351882
  grad_norm: 0.00192080
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.09481482
  weight_norm_after: 0.09493045
  weight_change: 0.00011563
  grad_norm: 0.01318819
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 4.88497829
  weight_norm_after: 4.88119030
  weight_change: 0.00378799
  grad_norm: 0.00065775
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.05131010
  weight_norm_after: 0.05127924
  weight_change: 0.00003087
  grad_norm: 0.00047104
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 1.02320957
  weight_norm_after: 1.02218986
  weight_change: 0.00101972
  grad_norm: 0.00004853
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01778859
  weight_norm_after: 0.01779610
  weight_change: 0.00000752
  grad_norm: 0.00005858
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.51153696
  weight_norm_after: 1.51003313
  weight_change: 0.00150383
  grad_norm: 0.00002080
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00877129
  weight_norm_after: 0.00877082
  weight_change: 0.00000047
  grad_norm: 0.00001097
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1250/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.14357185
loss (scaled for backward): 1.14357185
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1327.36861350
avg train_loss so far: 1.06104605
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.035762 / 0.032849
y_true_for_loss mean/std: 0.644910 / 0.837405
reg_loss contribution: 0.00000004

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.47117972
  weight_norm_after: 2.46807146
  weight_change: 0.00310826
  grad_norm: 0.00013936
celestial_projection.0.bias:
  weight_norm_before: 0.01944967
  weight_norm_after: 0.01942436
  weight_change: 0.00002531
  grad_norm: 0.00004022
celestial_projection.1.weight:
  weight_norm_before: 4.38459635
  weight_norm_after: 4.38053894
  weight_change: 0.00405741
  grad_norm: 0.00001136
celestial_projection.1.bias:
  weight_norm_before: 0.03048107
  weight_norm_after: 0.03044007
  weight_change: 0.00004100
  grad_norm: 0.00000877
celestial_query_projection.weight:
  weight_norm_before: 0.03249110
  weight_norm_after: 0.03234330
  weight_change: 0.00014780
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00002118
  weight_norm_after: 0.00002100
  weight_change: 0.00000019
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00435433
  weight_norm_after: 0.00432177
  weight_change: 0.00003255
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.67084181
  weight_norm_after: 0.66932184
  weight_change: 0.00151998
  grad_norm: 0.00003285
celestial_value_projection.bias:
  weight_norm_before: 0.03557900
  weight_norm_after: 0.03560849
  weight_change: 0.00002949
  grad_norm: 0.00001874
celestial_output_projection.weight:
  weight_norm_before: 2.03265905
  weight_norm_after: 2.03009892
  weight_change: 0.00256014
  grad_norm: 0.00012900
celestial_output_projection.bias:
  weight_norm_before: 0.15199286
  weight_norm_after: 0.15182428
  weight_change: 0.00016858
  grad_norm: 0.00079794
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.04026788
  weight_norm_after: 0.04005598
  weight_change: 0.00021190
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00017116
  weight_norm_after: 0.00016996
  weight_change: 0.00000120
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.04029679
  weight_norm_after: 0.04009316
  weight_change: 0.00020363
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00014253
  weight_norm_after: 0.00014144
  weight_change: 0.00000109
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.06835433
  weight_norm_after: 0.06806348
  weight_change: 0.00029086
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00046607
  weight_norm_after: 0.00046365
  weight_change: 0.00000242
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.05489047
  weight_norm_after: 0.05462482
  weight_change: 0.00026565
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00086316
  weight_norm_after: 0.00085848
  weight_change: 0.00000468
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.30213010
  weight_norm_after: 0.30096614
  weight_change: 0.00116396
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 4.23878241
  weight_norm_after: 4.23495340
  weight_change: 0.00382900
  grad_norm: 0.00065343
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.12696549
  weight_norm_after: 0.12729880
  weight_change: 0.00033331
  grad_norm: 0.00036452
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.36500502
  weight_norm_after: 7.36322260
  weight_change: 0.00178242
  grad_norm: 0.02064338
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25062236
  weight_norm_after: 0.25070423
  weight_change: 0.00008187
  grad_norm: 0.00174254
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.40243244
  weight_norm_after: 7.40055656
  weight_change: 0.00187588
  grad_norm: 0.02283003
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.09013842
  weight_norm_after: 0.08992669
  weight_change: 0.00021173
  grad_norm: 0.01911915
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.32494068
  weight_norm_after: 7.32302761
  weight_change: 0.00191307
  grad_norm: 0.01469845
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28020376
  weight_norm_after: 0.28027841
  weight_change: 0.00007465
  grad_norm: 0.00130799
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.38499260
  weight_norm_after: 7.38298035
  weight_change: 0.00201225
  grad_norm: 0.01524370
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.09013842
  weight_norm_after: 0.08992669
  weight_change: 0.00021173
  grad_norm: 0.01911915
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.82430458
  weight_norm_after: 7.82274723
  weight_change: 0.00155735
  grad_norm: 0.02640474
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.28539002
  weight_norm_after: 0.28545976
  weight_change: 0.00006974
  grad_norm: 0.00263742
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.94789505
  weight_norm_after: 7.94635439
  weight_change: 0.00154066
  grad_norm: 0.02689239
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.09013842
  weight_norm_after: 0.08992669
  weight_change: 0.00021173
  grad_norm: 0.01911915
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.47619009
  weight_norm_after: 7.47392321
  weight_change: 0.00226688
  grad_norm: 0.03254440
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27329519
  weight_norm_after: 0.27319732
  weight_change: 0.00009787
  grad_norm: 0.00308148
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.34329844
  weight_norm_after: 7.34132099
  weight_change: 0.00197744
  grad_norm: 0.03566794
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.09013842
  weight_norm_after: 0.08992669
  weight_change: 0.00021173
  grad_norm: 0.01911915
projection.weight:
  weight_norm_before: 2.05420327
  weight_norm_after: 2.05380154
  weight_change: 0.00040174
  grad_norm: 0.10136815
projection.bias:
  weight_norm_before: 0.00224345
  weight_norm_after: 0.00207537
  weight_change: 0.00016808
  grad_norm: 0.10628654
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.85250378
  weight_norm_after: 2.84918785
  weight_change: 0.00331593
  grad_norm: 0.00058881
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.09676066
  weight_norm_after: 0.09676001
  weight_change: 0.00000065
  grad_norm: 0.00409327
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 4.70043755
  weight_norm_after: 4.69673395
  weight_change: 0.00370359
  grad_norm: 0.00018938
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.05240298
  weight_norm_after: 0.05230750
  weight_change: 0.00009548
  grad_norm: 0.00015832
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.97308576
  weight_norm_after: 0.97210091
  weight_change: 0.00098485
  grad_norm: 0.00003360
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01782172
  weight_norm_after: 0.01780123
  weight_change: 0.00002049
  grad_norm: 0.00007850
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.43799460
  weight_norm_after: 1.43654466
  weight_change: 0.00144994
  grad_norm: 0.00001959
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00840243
  weight_norm_after: 0.00839171
  weight_change: 0.00001072
  grad_norm: 0.00001062
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1300/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.30336484
loss (scaled for backward): 0.30336484
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1380.13884382
avg train_loss so far: 1.06082924
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.010754 / 0.057704
y_true_for_loss mean/std: 0.105047 / 0.545620
reg_loss contribution: 0.00000003

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.32095695
  weight_norm_after: 2.31806111
  weight_change: 0.00289583
  grad_norm: 0.00049711
celestial_projection.0.bias:
  weight_norm_before: 0.01775065
  weight_norm_after: 0.01784248
  weight_change: 0.00009182
  grad_norm: 0.00018427
celestial_projection.1.weight:
  weight_norm_before: 4.18472147
  weight_norm_after: 4.18078613
  weight_change: 0.00393534
  grad_norm: 0.00004384
celestial_projection.1.bias:
  weight_norm_before: 0.02885196
  weight_norm_after: 0.02882731
  weight_change: 0.00002465
  grad_norm: 0.00003103
celestial_query_projection.weight:
  weight_norm_before: 0.02582904
  weight_norm_after: 0.02570995
  weight_change: 0.00011909
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00001350
  weight_norm_after: 0.00001338
  weight_change: 0.00000012
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00298436
  weight_norm_after: 0.00296173
  weight_change: 0.00002263
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.59703869
  weight_norm_after: 0.59565473
  weight_change: 0.00138396
  grad_norm: 0.00007166
celestial_value_projection.bias:
  weight_norm_before: 0.03497512
  weight_norm_after: 0.03496692
  weight_change: 0.00000821
  grad_norm: 0.00004097
celestial_output_projection.weight:
  weight_norm_before: 1.90785539
  weight_norm_after: 1.90542555
  weight_change: 0.00242984
  grad_norm: 0.00046069
celestial_output_projection.bias:
  weight_norm_before: 0.14954054
  weight_norm_after: 0.14946914
  weight_change: 0.00007141
  grad_norm: 0.00293618
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.03086137
  weight_norm_after: 0.03069615
  weight_change: 0.00016522
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00011990
  weight_norm_after: 0.00011904
  weight_change: 0.00000086
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.03123707
  weight_norm_after: 0.03107750
  weight_change: 0.00015957
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00009664
  weight_norm_after: 0.00009588
  weight_change: 0.00000076
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.05524959
  weight_norm_after: 0.05501538
  weight_change: 0.00023421
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00035950
  weight_norm_after: 0.00035764
  weight_change: 0.00000186
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.04297423
  weight_norm_after: 0.04276244
  weight_change: 0.00021179
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00065531
  weight_norm_after: 0.00065166
  weight_change: 0.00000365
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.24876979
  weight_norm_after: 0.24779797
  weight_change: 0.00097182
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 4.04350996
  weight_norm_after: 4.03958797
  weight_change: 0.00392199
  grad_norm: 0.00369412
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.13215871
  weight_norm_after: 0.13203859
  weight_change: 0.00012012
  grad_norm: 0.00207399
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.27244997
  weight_norm_after: 7.27068281
  weight_change: 0.00176716
  grad_norm: 0.07141472
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25234485
  weight_norm_after: 0.25237760
  weight_change: 0.00003275
  grad_norm: 0.00649994
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.31145048
  weight_norm_after: 7.30962133
  weight_change: 0.00182915
  grad_norm: 0.05168594
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.09331764
  weight_norm_after: 0.09335135
  weight_change: 0.00003371
  grad_norm: 0.06181347
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.22576189
  weight_norm_after: 7.22372341
  weight_change: 0.00203848
  grad_norm: 0.03691974
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28041014
  weight_norm_after: 0.28036708
  weight_change: 0.00004306
  grad_norm: 0.00320794
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.28846836
  weight_norm_after: 7.28658152
  weight_change: 0.00188684
  grad_norm: 0.03756637
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.09331764
  weight_norm_after: 0.09335135
  weight_change: 0.00003371
  grad_norm: 0.06181347
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.74451065
  weight_norm_after: 7.74302912
  weight_change: 0.00148153
  grad_norm: 0.13687477
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.28434205
  weight_norm_after: 0.28426811
  weight_change: 0.00007394
  grad_norm: 0.01446776
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.87872553
  weight_norm_after: 7.87759638
  weight_change: 0.00112915
  grad_norm: 0.08969528
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.09331764
  weight_norm_after: 0.09335135
  weight_change: 0.00003371
  grad_norm: 0.06181347
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.38573694
  weight_norm_after: 7.38394403
  weight_change: 0.00179291
  grad_norm: 0.14079651
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27457821
  weight_norm_after: 0.27451417
  weight_change: 0.00006405
  grad_norm: 0.01368075
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.25525856
  weight_norm_after: 7.25372124
  weight_change: 0.00153732
  grad_norm: 0.06831306
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.09331764
  weight_norm_after: 0.09335135
  weight_change: 0.00003371
  grad_norm: 0.06181347
projection.weight:
  weight_norm_before: 2.04199982
  weight_norm_after: 2.04175401
  weight_change: 0.00024581
  grad_norm: 0.31298202
projection.bias:
  weight_norm_before: 0.00737585
  weight_norm_after: 0.00718899
  weight_change: 0.00018686
  grad_norm: 0.36819121
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.69114852
  weight_norm_after: 2.68800640
  weight_change: 0.00314212
  grad_norm: 0.00207236
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.09975587
  weight_norm_after: 0.09975057
  weight_change: 0.00000530
  grad_norm: 0.01490157
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 4.51610994
  weight_norm_after: 4.51244593
  weight_change: 0.00366402
  grad_norm: 0.00072931
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.04889811
  weight_norm_after: 0.04873658
  weight_change: 0.00016153
  grad_norm: 0.00059000
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.92466640
  weight_norm_after: 0.92371953
  weight_change: 0.00094688
  grad_norm: 0.00009175
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01762873
  weight_norm_after: 0.01764129
  weight_change: 0.00001256
  grad_norm: 0.00019273
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.36663103
  weight_norm_after: 1.36523795
  weight_change: 0.00139308
  grad_norm: 0.00002870
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00784346
  weight_norm_after: 0.00784208
  weight_change: 0.00000138
  grad_norm: 0.00002321
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1350/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.30086172
loss (scaled for backward): 1.30086172
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1424.94541487
avg train_loss so far: 1.05473384
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.026288 / 0.064256
y_true_for_loss mean/std: 0.354939 / 1.123668
reg_loss contribution: 0.00000003

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.18063521
  weight_norm_after: 2.17792344
  weight_change: 0.00271177
  grad_norm: 0.00019076
celestial_projection.0.bias:
  weight_norm_before: 0.02198836
  weight_norm_after: 0.02216564
  weight_change: 0.00017728
  grad_norm: 0.00007877
celestial_projection.1.weight:
  weight_norm_before: 3.99041438
  weight_norm_after: 3.98658609
  weight_change: 0.00382829
  grad_norm: 0.00001797
celestial_projection.1.bias:
  weight_norm_before: 0.02748344
  weight_norm_after: 0.02745958
  weight_change: 0.00002386
  grad_norm: 0.00001214
celestial_query_projection.weight:
  weight_norm_before: 0.02046695
  weight_norm_after: 0.02037122
  weight_change: 0.00009573
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000852
  weight_norm_after: 0.00000844
  weight_change: 0.00000008
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00203425
  weight_norm_after: 0.00201860
  weight_change: 0.00001565
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.52806032
  weight_norm_after: 0.52680963
  weight_change: 0.00125068
  grad_norm: 0.00006758
celestial_value_projection.bias:
  weight_norm_before: 0.03094061
  weight_norm_after: 0.03091773
  weight_change: 0.00002288
  grad_norm: 0.00004179
celestial_output_projection.weight:
  weight_norm_before: 1.78885329
  weight_norm_after: 1.78656280
  weight_change: 0.00229049
  grad_norm: 0.00025733
celestial_output_projection.bias:
  weight_norm_before: 0.16155306
  weight_norm_after: 0.16155428
  weight_change: 0.00000122
  grad_norm: 0.00200771
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.02354234
  weight_norm_after: 0.02341409
  weight_change: 0.00012825
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00008323
  weight_norm_after: 0.00008262
  weight_change: 0.00000061
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.02414812
  weight_norm_after: 0.02402347
  weight_change: 0.00012466
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00006487
  weight_norm_after: 0.00006435
  weight_change: 0.00000052
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.04469975
  weight_norm_after: 0.04451123
  weight_change: 0.00018852
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00027772
  weight_norm_after: 0.00027630
  weight_change: 0.00000143
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.03349270
  weight_norm_after: 0.03332455
  weight_change: 0.00016814
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00049365
  weight_norm_after: 0.00049082
  weight_change: 0.00000283
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.20428446
  weight_norm_after: 0.20347561
  weight_change: 0.00080885
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.85259318
  weight_norm_after: 3.84902525
  weight_change: 0.00356793
  grad_norm: 0.00195218
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.13300742
  weight_norm_after: 0.13331209
  weight_change: 0.00030467
  grad_norm: 0.00120280
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.17593431
  weight_norm_after: 7.17503500
  weight_change: 0.00089931
  grad_norm: 0.04599929
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.25117406
  weight_norm_after: 0.25162569
  weight_change: 0.00045162
  grad_norm: 0.00405557
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.22319412
  weight_norm_after: 7.22123718
  weight_change: 0.00195694
  grad_norm: 0.06852733
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.09389843
  weight_norm_after: 0.09407222
  weight_change: 0.00017378
  grad_norm: 0.06007326
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.11551666
  weight_norm_after: 7.11395836
  weight_change: 0.00155830
  grad_norm: 0.06047824
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.27603641
  weight_norm_after: 0.27627435
  weight_change: 0.00023794
  grad_norm: 0.00585603
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.19446945
  weight_norm_after: 7.19260979
  weight_change: 0.00185966
  grad_norm: 0.05095169
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.09389843
  weight_norm_after: 0.09407222
  weight_change: 0.00017378
  grad_norm: 0.06007326
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.67051649
  weight_norm_after: 7.66970110
  weight_change: 0.00081539
  grad_norm: 0.08198555
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.28346282
  weight_norm_after: 0.28384197
  weight_change: 0.00037915
  grad_norm: 0.00887969
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.81045866
  weight_norm_after: 7.80929899
  weight_change: 0.00115967
  grad_norm: 0.14586796
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.09389843
  weight_norm_after: 0.09407222
  weight_change: 0.00017378
  grad_norm: 0.06007326
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.28765774
  weight_norm_after: 7.28649664
  weight_change: 0.00116110
  grad_norm: 0.09763337
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27063975
  weight_norm_after: 0.27113184
  weight_change: 0.00049210
  grad_norm: 0.00968690
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.17235088
  weight_norm_after: 7.17032242
  weight_change: 0.00202847
  grad_norm: 0.16875798
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.09389843
  weight_norm_after: 0.09407222
  weight_change: 0.00017378
  grad_norm: 0.06007326
projection.weight:
  weight_norm_before: 2.03508210
  weight_norm_after: 2.03465080
  weight_change: 0.00043130
  grad_norm: 0.43886775
projection.bias:
  weight_norm_before: 0.00393339
  weight_norm_after: 0.00397309
  weight_change: 0.00003970
  grad_norm: 0.36579871
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.53959632
  weight_norm_after: 2.53664446
  weight_change: 0.00295186
  grad_norm: 0.00151905
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.10043723
  weight_norm_after: 0.10046915
  weight_change: 0.00003192
  grad_norm: 0.01105901
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 4.33676338
  weight_norm_after: 4.33333063
  weight_change: 0.00343275
  grad_norm: 0.00049088
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.04710536
  weight_norm_after: 0.04713143
  weight_change: 0.00002607
  grad_norm: 0.00045467
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.87801069
  weight_norm_after: 0.87709689
  weight_change: 0.00091380
  grad_norm: 0.00003360
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01780595
  weight_norm_after: 0.01780523
  weight_change: 0.00000072
  grad_norm: 0.00007074
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.29800260
  weight_norm_after: 1.29666126
  weight_change: 0.00134134
  grad_norm: 0.00001363
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00744568
  weight_norm_after: 0.00744614
  weight_change: 0.00000045
  grad_norm: 0.00000901
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1400/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.79297996
loss (scaled for backward): 0.79297996
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1469.06033507
avg train_loss so far: 1.04857983
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.121354 / 0.037056
y_true_for_loss mean/std: 0.224989 / 0.834500
reg_loss contribution: 0.00000001

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 2.04927564
  weight_norm_after: 2.04674053
  weight_change: 0.00253510
  grad_norm: 0.00021991
celestial_projection.0.bias:
  weight_norm_before: 0.02497936
  weight_norm_after: 0.02525469
  weight_change: 0.00027533
  grad_norm: 0.00010845
celestial_projection.1.weight:
  weight_norm_before: 3.80100751
  weight_norm_after: 3.79726768
  weight_change: 0.00373983
  grad_norm: 0.00002514
celestial_projection.1.bias:
  weight_norm_before: 0.02551698
  weight_norm_after: 0.02546666
  weight_change: 0.00005032
  grad_norm: 0.00001573
celestial_query_projection.weight:
  weight_norm_before: 0.01616182
  weight_norm_after: 0.01608507
  weight_change: 0.00007675
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000531
  weight_norm_after: 0.00000526
  weight_change: 0.00000005
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00137858
  weight_norm_after: 0.00136781
  weight_change: 0.00001077
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.46973416
  weight_norm_after: 0.46858057
  weight_change: 0.00115359
  grad_norm: 0.00001844
celestial_value_projection.bias:
  weight_norm_before: 0.03071425
  weight_norm_after: 0.03064439
  weight_change: 0.00006986
  grad_norm: 0.00001171
celestial_output_projection.weight:
  weight_norm_before: 1.67832172
  weight_norm_after: 1.67614639
  weight_change: 0.00217533
  grad_norm: 0.00016527
celestial_output_projection.bias:
  weight_norm_before: 0.16567482
  weight_norm_after: 0.16599068
  weight_change: 0.00031586
  grad_norm: 0.00127055
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.01787299
  weight_norm_after: 0.01777388
  weight_change: 0.00009911
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00005723
  weight_norm_after: 0.00005680
  weight_change: 0.00000043
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.01861785
  weight_norm_after: 0.01852075
  weight_change: 0.00009710
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00004313
  weight_norm_after: 0.00004277
  weight_change: 0.00000036
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.03620707
  weight_norm_after: 0.03605527
  weight_change: 0.00015180
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00021475
  weight_norm_after: 0.00021365
  weight_change: 0.00000110
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.02598055
  weight_norm_after: 0.02584764
  weight_change: 0.00013291
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00036887
  weight_norm_after: 0.00036669
  weight_change: 0.00000217
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.16731326
  weight_norm_after: 0.16664210
  weight_change: 0.00067116
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.67392755
  weight_norm_after: 3.67026544
  weight_change: 0.00366211
  grad_norm: 0.00073144
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.14213865
  weight_norm_after: 0.14202732
  weight_change: 0.00011133
  grad_norm: 0.00044647
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.10029697
  weight_norm_after: 7.09830666
  weight_change: 0.00199032
  grad_norm: 0.02903342
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26005393
  weight_norm_after: 0.25995827
  weight_change: 0.00009567
  grad_norm: 0.00242485
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.12942123
  weight_norm_after: 7.12778997
  weight_change: 0.00163126
  grad_norm: 0.03005213
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.09559795
  weight_norm_after: 0.09581943
  weight_change: 0.00022148
  grad_norm: 0.02990713
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 7.03917837
  weight_norm_after: 7.03717232
  weight_change: 0.00200605
  grad_norm: 0.01745425
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28583309
  weight_norm_after: 0.28583238
  weight_change: 0.00000072
  grad_norm: 0.00141099
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.10223246
  weight_norm_after: 7.10044384
  weight_change: 0.00178862
  grad_norm: 0.02425283
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.09559795
  weight_norm_after: 0.09581943
  weight_change: 0.00022148
  grad_norm: 0.02990713
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.60018492
  weight_norm_after: 7.59859037
  weight_change: 0.00159454
  grad_norm: 0.04813054
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.29043329
  weight_norm_after: 0.29035869
  weight_change: 0.00007460
  grad_norm: 0.00531002
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.73685789
  weight_norm_after: 7.73561668
  weight_change: 0.00124121
  grad_norm: 0.06637661
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.09559795
  weight_norm_after: 0.09581943
  weight_change: 0.00022148
  grad_norm: 0.02990713
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.21551132
  weight_norm_after: 7.21318007
  weight_change: 0.00233126
  grad_norm: 0.02293979
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28064656
  weight_norm_after: 0.28038433
  weight_change: 0.00026223
  grad_norm: 0.00211690
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 7.08401918
  weight_norm_after: 7.08250475
  weight_change: 0.00151443
  grad_norm: 0.03671447
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.09559795
  weight_norm_after: 0.09581943
  weight_change: 0.00022148
  grad_norm: 0.02990713
projection.weight:
  weight_norm_before: 2.01431036
  weight_norm_after: 2.01421976
  weight_change: 0.00009060
  grad_norm: 0.28778383
projection.bias:
  weight_norm_before: 0.00370794
  weight_norm_after: 0.00449002
  weight_change: 0.00078208
  grad_norm: 0.25992832
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.39707422
  weight_norm_after: 2.39432931
  weight_change: 0.00274491
  grad_norm: 0.00101325
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.10310057
  weight_norm_after: 0.10312373
  weight_change: 0.00002316
  grad_norm: 0.00745976
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 4.16801405
  weight_norm_after: 4.16479301
  weight_change: 0.00322104
  grad_norm: 0.00044599
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.04963987
  weight_norm_after: 0.04992134
  weight_change: 0.00028148
  grad_norm: 0.00030456
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.83320946
  weight_norm_after: 0.83233219
  weight_change: 0.00087726
  grad_norm: 0.00002552
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01714056
  weight_norm_after: 0.01711960
  weight_change: 0.00002096
  grad_norm: 0.00006733
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.23220408
  weight_norm_after: 1.23090422
  weight_change: 0.00129986
  grad_norm: 0.00000766
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00736270
  weight_norm_after: 0.00735150
  weight_change: 0.00001120
  grad_norm: 0.00000690
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1450/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.57374573
loss (scaled for backward): 1.57374573
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1522.53754895
avg train_loss so far: 1.04930224
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.057492 / 0.073919
y_true_for_loss mean/std: -0.296645 / 1.249743
reg_loss contribution: 0.00000002

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.92631280
  weight_norm_after: 1.92393029
  weight_change: 0.00238252
  grad_norm: 0.00021180
celestial_projection.0.bias:
  weight_norm_before: 0.02722671
  weight_norm_after: 0.02742675
  weight_change: 0.00020005
  grad_norm: 0.00013023
celestial_projection.1.weight:
  weight_norm_before: 3.61811113
  weight_norm_after: 3.61451888
  weight_change: 0.00359225
  grad_norm: 0.00002499
celestial_projection.1.bias:
  weight_norm_before: 0.02468494
  weight_norm_after: 0.02467251
  weight_change: 0.00001243
  grad_norm: 0.00001414
celestial_query_projection.weight:
  weight_norm_before: 0.01271490
  weight_norm_after: 0.01265355
  weight_change: 0.00006136
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000328
  weight_norm_after: 0.00000324
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00092841
  weight_norm_after: 0.00092104
  weight_change: 0.00000737
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.41865835
  weight_norm_after: 0.41765711
  weight_change: 0.00100124
  grad_norm: 0.00000822
celestial_value_projection.bias:
  weight_norm_before: 0.03168158
  weight_norm_after: 0.03165673
  weight_change: 0.00002486
  grad_norm: 0.00000552
celestial_output_projection.weight:
  weight_norm_before: 1.57487202
  weight_norm_after: 1.57284439
  weight_change: 0.00202763
  grad_norm: 0.00024682
celestial_output_projection.bias:
  weight_norm_before: 0.16141541
  weight_norm_after: 0.16158459
  weight_change: 0.00016917
  grad_norm: 0.00172940
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.01350147
  weight_norm_after: 0.01342524
  weight_change: 0.00007623
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00003897
  weight_norm_after: 0.00003867
  weight_change: 0.00000030
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.01431562
  weight_norm_after: 0.01424019
  weight_change: 0.00007543
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00002839
  weight_norm_after: 0.00002815
  weight_change: 0.00000024
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.02936532
  weight_norm_after: 0.02924294
  weight_change: 0.00012237
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00016603
  weight_norm_after: 0.00016518
  weight_change: 0.00000085
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.02005505
  weight_norm_after: 0.01995047
  weight_change: 0.00010459
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00027332
  weight_norm_after: 0.00027166
  weight_change: 0.00000166
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.13667807
  weight_norm_after: 0.13612276
  weight_change: 0.00055531
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.49869776
  weight_norm_after: 3.49545860
  weight_change: 0.00323915
  grad_norm: 0.00196351
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.14482337
  weight_norm_after: 0.14506632
  weight_change: 0.00024295
  grad_norm: 0.00129678
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 7.01439714
  weight_norm_after: 7.01249552
  weight_change: 0.00190163
  grad_norm: 0.10504004
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26048017
  weight_norm_after: 0.26045030
  weight_change: 0.00002986
  grad_norm: 0.00916587
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 7.04270363
  weight_norm_after: 7.04083300
  weight_change: 0.00187063
  grad_norm: 0.12237355
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.10471326
  weight_norm_after: 0.10471867
  weight_change: 0.00000541
  grad_norm: 0.06786277
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.93914986
  weight_norm_after: 6.93738842
  weight_change: 0.00176144
  grad_norm: 0.05189899
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28348434
  weight_norm_after: 0.28342494
  weight_change: 0.00005940
  grad_norm: 0.00455344
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 7.01105261
  weight_norm_after: 7.00916624
  weight_change: 0.00188637
  grad_norm: 0.04833204
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.10471326
  weight_norm_after: 0.10471867
  weight_change: 0.00000541
  grad_norm: 0.06786277
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.52278042
  weight_norm_after: 7.52200127
  weight_change: 0.00077915
  grad_norm: 0.07429881
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.29518875
  weight_norm_after: 0.29553369
  weight_change: 0.00034493
  grad_norm: 0.00848646
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.66962433
  weight_norm_after: 7.66815901
  weight_change: 0.00146532
  grad_norm: 0.08533882
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.10471326
  weight_norm_after: 0.10471867
  weight_change: 0.00000541
  grad_norm: 0.06786277
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.13510180
  weight_norm_after: 7.13291788
  weight_change: 0.00218391
  grad_norm: 0.02334524
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28450382
  weight_norm_after: 0.28437194
  weight_change: 0.00013188
  grad_norm: 0.00223245
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.99987602
  weight_norm_after: 6.99815607
  weight_change: 0.00171995
  grad_norm: 0.04643810
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.10471326
  weight_norm_after: 0.10471867
  weight_change: 0.00000541
  grad_norm: 0.06786277
projection.weight:
  weight_norm_before: 2.00175548
  weight_norm_after: 2.00113130
  weight_change: 0.00062418
  grad_norm: 0.43484965
projection.bias:
  weight_norm_before: 0.00764724
  weight_norm_after: 0.00723907
  weight_change: 0.00040817
  grad_norm: 0.43405244
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.26132298
  weight_norm_after: 2.25866175
  weight_change: 0.00266123
  grad_norm: 0.00120031
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.10725558
  weight_norm_after: 0.10734838
  weight_change: 0.00009280
  grad_norm: 0.00894162
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.99579740
  weight_norm_after: 3.99234724
  weight_change: 0.00345016
  grad_norm: 0.00047284
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.04407502
  weight_norm_after: 0.04387596
  weight_change: 0.00019906
  grad_norm: 0.00036908
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.78989917
  weight_norm_after: 0.78904647
  weight_change: 0.00085270
  grad_norm: 0.00004365
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01703342
  weight_norm_after: 0.01705183
  weight_change: 0.00001840
  grad_norm: 0.00011671
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.16799200
  weight_norm_after: 1.16672635
  weight_change: 0.00126565
  grad_norm: 0.00002372
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00626974
  weight_norm_after: 0.00625035
  weight_change: 0.00001940
  grad_norm: 0.00001531
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1500/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.34942424
loss (scaled for backward): 1.34942424
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1572.12433341
avg train_loss so far: 1.04738463
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.079603 / 0.029384
y_true_for_loss mean/std: -0.323382 / 1.105191
reg_loss contribution: 0.00000001

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.81074464
  weight_norm_after: 1.80850446
  weight_change: 0.00224018
  grad_norm: 0.00007188
celestial_projection.0.bias:
  weight_norm_before: 0.02661879
  weight_norm_after: 0.02651975
  weight_change: 0.00009904
  grad_norm: 0.00005500
celestial_projection.1.weight:
  weight_norm_before: 3.44031787
  weight_norm_after: 3.43681383
  weight_change: 0.00350404
  grad_norm: 0.00001334
celestial_projection.1.bias:
  weight_norm_before: 0.02324351
  weight_norm_after: 0.02320854
  weight_change: 0.00003497
  grad_norm: 0.00000614
celestial_query_projection.weight:
  weight_norm_before: 0.00996360
  weight_norm_after: 0.00991471
  weight_change: 0.00004889
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000200
  weight_norm_after: 0.00000198
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00062103
  weight_norm_after: 0.00061601
  weight_change: 0.00000502
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.37117329
  weight_norm_after: 0.37027529
  weight_change: 0.00089800
  grad_norm: 0.00000305
celestial_value_projection.bias:
  weight_norm_before: 0.03029339
  weight_norm_after: 0.03026289
  weight_change: 0.00003050
  grad_norm: 0.00000228
celestial_output_projection.weight:
  weight_norm_before: 1.47604895
  weight_norm_after: 1.47413206
  weight_change: 0.00191689
  grad_norm: 0.00009789
celestial_output_projection.bias:
  weight_norm_before: 0.16169104
  weight_norm_after: 0.16159166
  weight_change: 0.00009938
  grad_norm: 0.00071177
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.01014642
  weight_norm_after: 0.01008807
  weight_change: 0.00005836
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00002626
  weight_norm_after: 0.00002605
  weight_change: 0.00000021
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.01097755
  weight_norm_after: 0.01091911
  weight_change: 0.00005845
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00001851
  weight_norm_after: 0.00001835
  weight_change: 0.00000016
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.02384541
  weight_norm_after: 0.02374658
  weight_change: 0.00009883
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00012821
  weight_norm_after: 0.00012755
  weight_change: 0.00000066
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.01540258
  weight_norm_after: 0.01532067
  weight_change: 0.00008191
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00020074
  weight_norm_after: 0.00019949
  weight_change: 0.00000125
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.11136512
  weight_norm_after: 0.11090697
  weight_change: 0.00045815
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.33253574
  weight_norm_after: 3.32924199
  weight_change: 0.00329375
  grad_norm: 0.00058567
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.15353058
  weight_norm_after: 0.15365599
  weight_change: 0.00012541
  grad_norm: 0.00043409
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.92939043
  weight_norm_after: 6.92773676
  weight_change: 0.00165367
  grad_norm: 0.03658504
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26448169
  weight_norm_after: 0.26457015
  weight_change: 0.00008845
  grad_norm: 0.00324920
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.95206499
  weight_norm_after: 6.95017195
  weight_change: 0.00189304
  grad_norm: 0.03970471
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.10602767
  weight_norm_after: 0.10620275
  weight_change: 0.00017508
  grad_norm: 0.05194151
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.85009432
  weight_norm_after: 6.84812403
  weight_change: 0.00197029
  grad_norm: 0.02154847
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28573972
  weight_norm_after: 0.28573826
  weight_change: 0.00000146
  grad_norm: 0.00188340
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.91691065
  weight_norm_after: 6.91509771
  weight_change: 0.00181293
  grad_norm: 0.02775218
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.10602767
  weight_norm_after: 0.10620275
  weight_change: 0.00017508
  grad_norm: 0.05194151
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.45562792
  weight_norm_after: 7.45420790
  weight_change: 0.00142002
  grad_norm: 0.03342226
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.30087286
  weight_norm_after: 0.30093390
  weight_change: 0.00006104
  grad_norm: 0.00378676
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.59876776
  weight_norm_after: 7.59746122
  weight_change: 0.00130653
  grad_norm: 0.06518164
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.10602767
  weight_norm_after: 0.10620275
  weight_change: 0.00017508
  grad_norm: 0.05194151
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 7.04888105
  weight_norm_after: 7.04695511
  weight_change: 0.00192595
  grad_norm: 0.02542371
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28482807
  weight_norm_after: 0.28477108
  weight_change: 0.00005698
  grad_norm: 0.00247150
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.91437483
  weight_norm_after: 6.91275883
  weight_change: 0.00161600
  grad_norm: 0.03174820
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.10602767
  weight_norm_after: 0.10620275
  weight_change: 0.00017508
  grad_norm: 0.05194151
projection.weight:
  weight_norm_before: 1.98830914
  weight_norm_after: 1.98810303
  weight_change: 0.00020611
  grad_norm: 0.30160743
projection.bias:
  weight_norm_before: 0.00571712
  weight_norm_after: 0.00606519
  weight_change: 0.00034807
  grad_norm: 0.41300398
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.13080907
  weight_norm_after: 2.12826633
  weight_change: 0.00254273
  grad_norm: 0.00057215
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.10972698
  weight_norm_after: 0.10974813
  weight_change: 0.00002115
  grad_norm: 0.00436889
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.83192158
  weight_norm_after: 3.82880497
  weight_change: 0.00311661
  grad_norm: 0.00025109
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03934132
  weight_norm_after: 0.03936027
  weight_change: 0.00001895
  grad_norm: 0.00019420
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.74828410
  weight_norm_after: 0.74746895
  weight_change: 0.00081515
  grad_norm: 0.00000908
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01650776
  weight_norm_after: 0.01650124
  weight_change: 0.00000652
  grad_norm: 0.00002218
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.10718799
  weight_norm_after: 1.10599494
  weight_change: 0.00119305
  grad_norm: 0.00000145
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00597897
  weight_norm_after: 0.00597325
  weight_change: 0.00000572
  grad_norm: 0.00000211
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1550/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.85984004
loss (scaled for backward): 0.85984004
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1642.74770218
avg train_loss so far: 1.05915390
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.024159 / 0.069006
y_true_for_loss mean/std: 0.434272 / 0.843234
reg_loss contribution: 0.00000001

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.70209301
  weight_norm_after: 1.69998693
  weight_change: 0.00210607
  grad_norm: 0.00011405
celestial_projection.0.bias:
  weight_norm_before: 0.02489404
  weight_norm_after: 0.02458761
  weight_change: 0.00030643
  grad_norm: 0.00010681
celestial_projection.1.weight:
  weight_norm_before: 3.26825213
  weight_norm_after: 3.26485205
  weight_change: 0.00340009
  grad_norm: 0.00001658
celestial_projection.1.bias:
  weight_norm_before: 0.02175487
  weight_norm_after: 0.02170725
  weight_change: 0.00004763
  grad_norm: 0.00000862
celestial_query_projection.weight:
  weight_norm_before: 0.00777492
  weight_norm_after: 0.00773610
  weight_change: 0.00003882
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000121
  weight_norm_after: 0.00000119
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00041237
  weight_norm_after: 0.00040898
  weight_change: 0.00000340
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.32817647
  weight_norm_after: 0.32736993
  weight_change: 0.00080654
  grad_norm: 0.00001359
celestial_value_projection.bias:
  weight_norm_before: 0.02798379
  weight_norm_after: 0.02794092
  weight_change: 0.00004288
  grad_norm: 0.00001126
celestial_output_projection.weight:
  weight_norm_before: 1.38243127
  weight_norm_after: 1.38061905
  weight_change: 0.00181222
  grad_norm: 0.00014981
celestial_output_projection.bias:
  weight_norm_before: 0.15993266
  weight_norm_after: 0.15988566
  weight_change: 0.00004700
  grad_norm: 0.00117373
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00758393
  weight_norm_after: 0.00753948
  weight_change: 0.00004445
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00001751
  weight_norm_after: 0.00001737
  weight_change: 0.00000014
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00839406
  weight_norm_after: 0.00834888
  weight_change: 0.00004518
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00001195
  weight_norm_after: 0.00001185
  weight_change: 0.00000011
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.01938273
  weight_norm_after: 0.01930273
  weight_change: 0.00008000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00009876
  weight_norm_after: 0.00009825
  weight_change: 0.00000052
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.01176714
  weight_norm_after: 0.01170330
  weight_change: 0.00006384
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00014610
  weight_norm_after: 0.00014516
  weight_change: 0.00000094
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.09050713
  weight_norm_after: 0.09013015
  weight_change: 0.00037698
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.16880965
  weight_norm_after: 3.16566801
  weight_change: 0.00314164
  grad_norm: 0.00086072
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.15366511
  weight_norm_after: 0.15378909
  weight_change: 0.00012398
  grad_norm: 0.00070425
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.83700991
  weight_norm_after: 6.83546543
  weight_change: 0.00154448
  grad_norm: 0.03398965
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26317012
  weight_norm_after: 0.26329187
  weight_change: 0.00012174
  grad_norm: 0.00310179
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.86490202
  weight_norm_after: 6.86315584
  weight_change: 0.00174618
  grad_norm: 0.04005895
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.11040588
  weight_norm_after: 0.11044346
  weight_change: 0.00003758
  grad_norm: 0.06704431
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.74903679
  weight_norm_after: 6.74726248
  weight_change: 0.00177431
  grad_norm: 0.03071530
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28317922
  weight_norm_after: 0.28320903
  weight_change: 0.00002980
  grad_norm: 0.00275601
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.82305098
  weight_norm_after: 6.82113695
  weight_change: 0.00191402
  grad_norm: 0.03965884
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.11040588
  weight_norm_after: 0.11044346
  weight_change: 0.00003758
  grad_norm: 0.06704431
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.37750673
  weight_norm_after: 7.37625027
  weight_change: 0.00125647
  grad_norm: 0.04740582
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.30105671
  weight_norm_after: 0.30125675
  weight_change: 0.00020003
  grad_norm: 0.00562586
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.53194380
  weight_norm_after: 7.53044319
  weight_change: 0.00150061
  grad_norm: 0.07565051
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.11040588
  weight_norm_after: 0.11044346
  weight_change: 0.00003758
  grad_norm: 0.06704431
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.94859123
  weight_norm_after: 6.94733524
  weight_change: 0.00125599
  grad_norm: 0.02673753
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.27981317
  weight_norm_after: 0.27997714
  weight_change: 0.00016397
  grad_norm: 0.00264908
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.83120441
  weight_norm_after: 6.82948828
  weight_change: 0.00171614
  grad_norm: 0.04629483
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.11040588
  weight_norm_after: 0.11044346
  weight_change: 0.00003758
  grad_norm: 0.06704431
projection.weight:
  weight_norm_before: 1.97811389
  weight_norm_after: 1.97785401
  weight_change: 0.00025988
  grad_norm: 0.25809336
projection.bias:
  weight_norm_before: 0.00648010
  weight_norm_after: 0.00676792
  weight_change: 0.00028781
  grad_norm: 0.44192094
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 2.00702381
  weight_norm_after: 2.00462246
  weight_change: 0.00240135
  grad_norm: 0.00064210
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.10941840
  weight_norm_after: 0.10938631
  weight_change: 0.00003209
  grad_norm: 0.00495151
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.67504191
  weight_norm_after: 3.67203951
  weight_change: 0.00300241
  grad_norm: 0.00023649
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03783622
  weight_norm_after: 0.03785902
  weight_change: 0.00002280
  grad_norm: 0.00022000
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.70820141
  weight_norm_after: 0.70741671
  weight_change: 0.00078470
  grad_norm: 0.00003335
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01615339
  weight_norm_after: 0.01614682
  weight_change: 0.00000657
  grad_norm: 0.00010677
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 1.04831767
  weight_norm_after: 1.04717612
  weight_change: 0.00114155
  grad_norm: 0.00001930
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00533068
  weight_norm_after: 0.00532580
  weight_change: 0.00000488
  grad_norm: 0.00001037
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1600/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.56803232
loss (scaled for backward): 0.56803232
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1697.49057884
avg train_loss so far: 1.06026894
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.034968 / 0.107746
y_true_for_loss mean/std: -0.397581 / 0.622360
reg_loss contribution: 0.00000001

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.59984708
  weight_norm_after: 1.59786201
  weight_change: 0.00198507
  grad_norm: 0.00010094
celestial_projection.0.bias:
  weight_norm_before: 0.02812549
  weight_norm_after: 0.02810541
  weight_change: 0.00002008
  grad_norm: 0.00013039
celestial_projection.1.weight:
  weight_norm_before: 3.10208893
  weight_norm_after: 3.09881639
  weight_change: 0.00327253
  grad_norm: 0.00001336
celestial_projection.1.bias:
  weight_norm_before: 0.02057968
  weight_norm_after: 0.02054473
  weight_change: 0.00003495
  grad_norm: 0.00000629
celestial_query_projection.weight:
  weight_norm_before: 0.00604017
  weight_norm_after: 0.00600947
  weight_change: 0.00003070
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000072
  weight_norm_after: 0.00000071
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00027165
  weight_norm_after: 0.00026936
  weight_change: 0.00000228
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.28987294
  weight_norm_after: 0.28915307
  weight_change: 0.00071988
  grad_norm: 0.00000301
celestial_value_projection.bias:
  weight_norm_before: 0.02551609
  weight_norm_after: 0.02546761
  weight_change: 0.00004847
  grad_norm: 0.00000275
celestial_output_projection.weight:
  weight_norm_before: 1.29407430
  weight_norm_after: 1.29236197
  weight_change: 0.00171232
  grad_norm: 0.00010397
celestial_output_projection.bias:
  weight_norm_before: 0.15913349
  weight_norm_after: 0.15910897
  weight_change: 0.00002453
  grad_norm: 0.00088897
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00563658
  weight_norm_after: 0.00560290
  weight_change: 0.00003369
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00001155
  weight_norm_after: 0.00001145
  weight_change: 0.00000010
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00639945
  weight_norm_after: 0.00636462
  weight_change: 0.00003483
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000765
  weight_norm_after: 0.00000758
  weight_change: 0.00000007
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.01576586
  weight_norm_after: 0.01570093
  weight_change: 0.00006493
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00007581
  weight_norm_after: 0.00007541
  weight_change: 0.00000040
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00894056
  weight_norm_after: 0.00889106
  weight_change: 0.00004950
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00010533
  weight_norm_after: 0.00010463
  weight_change: 0.00000070
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.07336580
  weight_norm_after: 0.07305641
  weight_change: 0.00030939
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 3.01125836
  weight_norm_after: 3.00811911
  weight_change: 0.00313926
  grad_norm: 0.00076234
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.15459593
  weight_norm_after: 0.15459596
  weight_change: 0.00000003
  grad_norm: 0.00070030
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.76145744
  weight_norm_after: 6.75968647
  weight_change: 0.00177097
  grad_norm: 0.02354387
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26798698
  weight_norm_after: 0.26801470
  weight_change: 0.00002772
  grad_norm: 0.00206518
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.77678823
  weight_norm_after: 6.77499437
  weight_change: 0.00179386
  grad_norm: 0.03076590
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.10998862
  weight_norm_after: 0.10997424
  weight_change: 0.00001439
  grad_norm: 0.04021654
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.65877390
  weight_norm_after: 6.65662098
  weight_change: 0.00215292
  grad_norm: 0.01827374
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28324619
  weight_norm_after: 0.28315634
  weight_change: 0.00008985
  grad_norm: 0.00164891
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.72772264
  weight_norm_after: 6.72583389
  weight_change: 0.00188875
  grad_norm: 0.02284121
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.10998862
  weight_norm_after: 0.10997424
  weight_change: 0.00001439
  grad_norm: 0.04021654
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.31277895
  weight_norm_after: 7.31138086
  weight_change: 0.00139809
  grad_norm: 0.04292214
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.30700752
  weight_norm_after: 0.30710497
  weight_change: 0.00009745
  grad_norm: 0.00467696
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.46223736
  weight_norm_after: 7.46065855
  weight_change: 0.00157881
  grad_norm: 0.04879187
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.10998862
  weight_norm_after: 0.10997424
  weight_change: 0.00001439
  grad_norm: 0.04021654
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.87317276
  weight_norm_after: 6.87157917
  weight_change: 0.00159359
  grad_norm: 0.02397862
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28315148
  weight_norm_after: 0.28322455
  weight_change: 0.00007308
  grad_norm: 0.00224748
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.74375391
  weight_norm_after: 6.74193621
  weight_change: 0.00181770
  grad_norm: 0.03104527
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.10998862
  weight_norm_after: 0.10997424
  weight_change: 0.00001439
  grad_norm: 0.04021654
projection.weight:
  weight_norm_before: 1.96528447
  weight_norm_after: 1.96513188
  weight_change: 0.00015259
  grad_norm: 0.12841970
projection.bias:
  weight_norm_before: 0.00437048
  weight_norm_after: 0.00473525
  weight_change: 0.00036477
  grad_norm: 0.21910580
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.88968909
  weight_norm_after: 1.88739777
  weight_change: 0.00229132
  grad_norm: 0.00071837
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11104380
  weight_norm_after: 0.11111446
  weight_change: 0.00007065
  grad_norm: 0.00565953
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.52095532
  weight_norm_after: 3.51795650
  weight_change: 0.00299883
  grad_norm: 0.00029865
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03306566
  weight_norm_after: 0.03306330
  weight_change: 0.00000237
  grad_norm: 0.00024251
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.66970301
  weight_norm_after: 0.66894662
  weight_change: 0.00075638
  grad_norm: 0.00001917
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01645093
  weight_norm_after: 0.01645327
  weight_change: 0.00000234
  grad_norm: 0.00006218
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.99218261
  weight_norm_after: 0.99106848
  weight_change: 0.00111413
  grad_norm: 0.00000694
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00522416
  weight_norm_after: 0.00520881
  weight_change: 0.00001535
  grad_norm: 0.00000523
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1650/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.68242061
loss (scaled for backward): 0.68242061
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1739.73777103
avg train_loss so far: 1.05374789
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.019027 / 0.032003
y_true_for_loss mean/std: -0.172534 / 0.810401
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.50388396
  weight_norm_after: 1.50202000
  weight_change: 0.00186396
  grad_norm: 0.00007121
celestial_projection.0.bias:
  weight_norm_before: 0.03611134
  weight_norm_after: 0.03613748
  weight_change: 0.00002614
  grad_norm: 0.00009564
celestial_projection.1.weight:
  weight_norm_before: 2.94144917
  weight_norm_after: 2.93829393
  weight_change: 0.00315523
  grad_norm: 0.00001242
celestial_projection.1.bias:
  weight_norm_before: 0.01938136
  weight_norm_after: 0.01935469
  weight_change: 0.00002667
  grad_norm: 0.00000553
celestial_query_projection.weight:
  weight_norm_before: 0.00467061
  weight_norm_after: 0.00464642
  weight_change: 0.00002419
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000043
  weight_norm_after: 0.00000042
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00017740
  weight_norm_after: 0.00017588
  weight_change: 0.00000152
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.25614789
  weight_norm_after: 0.25551364
  weight_change: 0.00063425
  grad_norm: 0.00000073
celestial_value_projection.bias:
  weight_norm_before: 0.02368740
  weight_norm_after: 0.02365151
  weight_change: 0.00003588
  grad_norm: 0.00000075
celestial_output_projection.weight:
  weight_norm_before: 1.21127248
  weight_norm_after: 1.20966780
  weight_change: 0.00160468
  grad_norm: 0.00005572
celestial_output_projection.bias:
  weight_norm_before: 0.15575720
  weight_norm_after: 0.15567759
  weight_change: 0.00007962
  grad_norm: 0.00049275
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00416448
  weight_norm_after: 0.00413909
  weight_change: 0.00002539
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000752
  weight_norm_after: 0.00000746
  weight_change: 0.00000007
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00486325
  weight_norm_after: 0.00483646
  weight_change: 0.00002679
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000485
  weight_norm_after: 0.00000480
  weight_change: 0.00000004
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.01282677
  weight_norm_after: 0.01277394
  weight_change: 0.00005283
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00005793
  weight_norm_after: 0.00005761
  weight_change: 0.00000031
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00675431
  weight_norm_after: 0.00671614
  weight_change: 0.00003818
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00007520
  weight_norm_after: 0.00007469
  weight_change: 0.00000051
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.05931556
  weight_norm_after: 0.05906231
  weight_change: 0.00025325
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.85801816
  weight_norm_after: 2.85499501
  weight_change: 0.00302315
  grad_norm: 0.00023257
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.15287103
  weight_norm_after: 0.15279576
  weight_change: 0.00007527
  grad_norm: 0.00023787
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.66933632
  weight_norm_after: 6.66730452
  weight_change: 0.00203180
  grad_norm: 0.01593438
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26638043
  weight_norm_after: 0.26624987
  weight_change: 0.00013056
  grad_norm: 0.00144098
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.69152021
  weight_norm_after: 6.68990088
  weight_change: 0.00161934
  grad_norm: 0.01806034
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.11095955
  weight_norm_after: 0.11091457
  weight_change: 0.00004498
  grad_norm: 0.02362258
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.56008101
  weight_norm_after: 6.55787897
  weight_change: 0.00220203
  grad_norm: 0.00819452
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28110433
  weight_norm_after: 0.28096503
  weight_change: 0.00013930
  grad_norm: 0.00073943
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.63486290
  weight_norm_after: 6.63303900
  weight_change: 0.00182390
  grad_norm: 0.01107479
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.11095955
  weight_norm_after: 0.11091457
  weight_change: 0.00004498
  grad_norm: 0.02362258
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.23434401
  weight_norm_after: 7.23248434
  weight_change: 0.00185966
  grad_norm: 0.01160806
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.30703953
  weight_norm_after: 0.30688104
  weight_change: 0.00015849
  grad_norm: 0.00128925
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.39080095
  weight_norm_after: 7.38939333
  weight_change: 0.00140762
  grad_norm: 0.02444809
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.11095955
  weight_norm_after: 0.11091457
  weight_change: 0.00004498
  grad_norm: 0.02362258
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.78902197
  weight_norm_after: 6.78683805
  weight_change: 0.00218391
  grad_norm: 0.00908105
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28417212
  weight_norm_after: 0.28398752
  weight_change: 0.00018460
  grad_norm: 0.00087570
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.65839767
  weight_norm_after: 6.65673447
  weight_change: 0.00166321
  grad_norm: 0.01589019
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.11095955
  weight_norm_after: 0.11091457
  weight_change: 0.00004498
  grad_norm: 0.02362258
projection.weight:
  weight_norm_before: 1.95796347
  weight_norm_after: 1.95784795
  weight_change: 0.00011551
  grad_norm: 0.11803641
projection.bias:
  weight_norm_before: 0.00917745
  weight_norm_after: 0.00894972
  weight_change: 0.00022773
  grad_norm: 0.20270054
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.77860260
  weight_norm_after: 1.77643931
  weight_change: 0.00216329
  grad_norm: 0.00041109
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11256686
  weight_norm_after: 0.11258401
  weight_change: 0.00001715
  grad_norm: 0.00328245
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.37272048
  weight_norm_after: 3.36977673
  weight_change: 0.00294375
  grad_norm: 0.00019154
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03170247
  weight_norm_after: 0.03167414
  weight_change: 0.00002833
  grad_norm: 0.00013279
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.63273823
  weight_norm_after: 0.63201457
  weight_change: 0.00072366
  grad_norm: 0.00002084
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01588073
  weight_norm_after: 0.01586616
  weight_change: 0.00001457
  grad_norm: 0.00007249
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.93835336
  weight_norm_after: 0.93730509
  weight_change: 0.00104827
  grad_norm: 0.00001107
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00489093
  weight_norm_after: 0.00488793
  weight_change: 0.00000300
  grad_norm: 0.00000630
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1700/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.14143351
loss (scaled for backward): 0.14143351
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1780.35877843
avg train_loss so far: 1.04665419
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.024437 / 0.044225
y_true_for_loss mean/std: -0.176467 / 0.321923
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.41323388
  weight_norm_after: 1.41147411
  weight_change: 0.00175977
  grad_norm: 0.00005376
celestial_projection.0.bias:
  weight_norm_before: 0.03900314
  weight_norm_after: 0.03891078
  weight_change: 0.00009236
  grad_norm: 0.00008566
celestial_projection.1.weight:
  weight_norm_before: 2.78663921
  weight_norm_after: 2.78359389
  weight_change: 0.00304532
  grad_norm: 0.00001187
celestial_projection.1.bias:
  weight_norm_before: 0.01824026
  weight_norm_after: 0.01821160
  weight_change: 0.00002866
  grad_norm: 0.00000457
celestial_query_projection.weight:
  weight_norm_before: 0.00359389
  weight_norm_after: 0.00357492
  weight_change: 0.00001897
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000025
  weight_norm_after: 0.00000025
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00011477
  weight_norm_after: 0.00011377
  weight_change: 0.00000101
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.22625071
  weight_norm_after: 0.22568803
  weight_change: 0.00056268
  grad_norm: 0.00000056
celestial_value_projection.bias:
  weight_norm_before: 0.02205269
  weight_norm_after: 0.02201977
  weight_change: 0.00003292
  grad_norm: 0.00000063
celestial_output_projection.weight:
  weight_norm_before: 1.13338566
  weight_norm_after: 1.13187456
  weight_change: 0.00151110
  grad_norm: 0.00007247
celestial_output_projection.bias:
  weight_norm_before: 0.15072514
  weight_norm_after: 0.15061331
  weight_change: 0.00011183
  grad_norm: 0.00065220
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00305775
  weight_norm_after: 0.00303872
  weight_change: 0.00001903
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000484
  weight_norm_after: 0.00000480
  weight_change: 0.00000004
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00368309
  weight_norm_after: 0.00366254
  weight_change: 0.00002055
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000304
  weight_norm_after: 0.00000301
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.01043239
  weight_norm_after: 0.01038929
  weight_change: 0.00004310
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00004402
  weight_norm_after: 0.00004377
  weight_change: 0.00000024
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00507249
  weight_norm_after: 0.00504321
  weight_change: 0.00002928
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00005315
  weight_norm_after: 0.00005277
  weight_change: 0.00000037
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.04782862
  weight_norm_after: 0.04762185
  weight_change: 0.00020676
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.71373463
  weight_norm_after: 2.71097612
  weight_change: 0.00275850
  grad_norm: 0.00034011
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.15459047
  weight_norm_after: 0.15475927
  weight_change: 0.00016880
  grad_norm: 0.00037528
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.58242750
  weight_norm_after: 6.58123064
  weight_change: 0.00119686
  grad_norm: 0.01723487
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.26657447
  weight_norm_after: 0.26679465
  weight_change: 0.00022018
  grad_norm: 0.00151934
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.60390472
  weight_norm_after: 6.60202408
  weight_change: 0.00188065
  grad_norm: 0.02478647
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.11270516
  weight_norm_after: 0.11253358
  weight_change: 0.00017159
  grad_norm: 0.04045866
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.46783161
  weight_norm_after: 6.46636868
  weight_change: 0.00146294
  grad_norm: 0.01211617
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28029349
  weight_norm_after: 0.28041869
  weight_change: 0.00012520
  grad_norm: 0.00103838
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.54256868
  weight_norm_after: 6.54062128
  weight_change: 0.00194740
  grad_norm: 0.01788234
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.11270516
  weight_norm_after: 0.11253358
  weight_change: 0.00017159
  grad_norm: 0.04045866
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.15777969
  weight_norm_after: 7.15628719
  weight_change: 0.00149250
  grad_norm: 0.02950052
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.30677772
  weight_norm_after: 0.30685160
  weight_change: 0.00007388
  grad_norm: 0.00332613
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.32368517
  weight_norm_after: 7.32221746
  weight_change: 0.00146770
  grad_norm: 0.04184469
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.11270516
  weight_norm_after: 0.11253358
  weight_change: 0.00017159
  grad_norm: 0.04045866
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.70015430
  weight_norm_after: 6.69842339
  weight_change: 0.00173092
  grad_norm: 0.01297669
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28249469
  weight_norm_after: 0.28247729
  weight_change: 0.00001740
  grad_norm: 0.00121441
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.57208729
  weight_norm_after: 6.57028770
  weight_change: 0.00179958
  grad_norm: 0.02622872
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.11270516
  weight_norm_after: 0.11253358
  weight_change: 0.00017159
  grad_norm: 0.04045866
projection.weight:
  weight_norm_before: 1.94938111
  weight_norm_after: 1.94915330
  weight_change: 0.00022781
  grad_norm: 0.13492359
projection.bias:
  weight_norm_before: 0.00844472
  weight_norm_after: 0.00820761
  weight_change: 0.00023710
  grad_norm: 0.22707184
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.67360628
  weight_norm_after: 1.67154086
  weight_change: 0.00206542
  grad_norm: 0.00049523
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11291560
  weight_norm_after: 0.11290636
  weight_change: 0.00000924
  grad_norm: 0.00398608
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.22962618
  weight_norm_after: 3.22679925
  weight_change: 0.00282693
  grad_norm: 0.00023908
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.02986812
  weight_norm_after: 0.02973400
  weight_change: 0.00013412
  grad_norm: 0.00017459
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.59726137
  weight_norm_after: 0.59656793
  weight_change: 0.00069344
  grad_norm: 0.00001098
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01534474
  weight_norm_after: 0.01532509
  weight_change: 0.00001965
  grad_norm: 0.00003812
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.88657910
  weight_norm_after: 0.88559353
  weight_change: 0.00098556
  grad_norm: 0.00000323
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00450406
  weight_norm_after: 0.00451667
  weight_change: 0.00001262
  grad_norm: 0.00000242
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1750/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.37149185
loss (scaled for backward): 0.37149185
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1833.98789449
avg train_loss so far: 1.04739457
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.016900 / 0.047788
y_true_for_loss mean/std: 0.213976 / 0.580359
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.32776690
  weight_norm_after: 1.32610905
  weight_change: 0.00165784
  grad_norm: 0.00006156
celestial_projection.0.bias:
  weight_norm_before: 0.03107526
  weight_norm_after: 0.03096865
  weight_change: 0.00010661
  grad_norm: 0.00013321
celestial_projection.1.weight:
  weight_norm_before: 2.63721442
  weight_norm_after: 2.63427711
  weight_change: 0.00293732
  grad_norm: 0.00001082
celestial_projection.1.bias:
  weight_norm_before: 0.01685525
  weight_norm_after: 0.01682038
  weight_change: 0.00003486
  grad_norm: 0.00000418
celestial_query_projection.weight:
  weight_norm_before: 0.00275119
  weight_norm_after: 0.00273638
  weight_change: 0.00001481
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000014
  weight_norm_after: 0.00000014
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00007351
  weight_norm_after: 0.00007285
  weight_change: 0.00000066
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.19962768
  weight_norm_after: 0.19912882
  weight_change: 0.00049886
  grad_norm: 0.00000090
celestial_value_projection.bias:
  weight_norm_before: 0.02027739
  weight_norm_after: 0.02024746
  weight_change: 0.00002993
  grad_norm: 0.00000106
celestial_output_projection.weight:
  weight_norm_before: 1.05988479
  weight_norm_after: 1.05846858
  weight_change: 0.00141621
  grad_norm: 0.00009224
celestial_output_projection.bias:
  weight_norm_before: 0.15051983
  weight_norm_after: 0.15041031
  weight_change: 0.00010952
  grad_norm: 0.00087351
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00223053
  weight_norm_after: 0.00221635
  weight_change: 0.00001418
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000308
  weight_norm_after: 0.00000305
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00277888
  weight_norm_after: 0.00276315
  weight_change: 0.00001572
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000189
  weight_norm_after: 0.00000187
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00847746
  weight_norm_after: 0.00844224
  weight_change: 0.00003522
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00003324
  weight_norm_after: 0.00003305
  weight_change: 0.00000019
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00378602
  weight_norm_after: 0.00376370
  weight_change: 0.00002233
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00003717
  weight_norm_after: 0.00003690
  weight_change: 0.00000027
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.03846136
  weight_norm_after: 0.03829297
  weight_change: 0.00016839
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.58351398
  weight_norm_after: 2.58109832
  weight_change: 0.00241566
  grad_norm: 0.00048782
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.17255871
  weight_norm_after: 0.17307717
  weight_change: 0.00051846
  grad_norm: 0.00055662
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.50609589
  weight_norm_after: 6.50443745
  weight_change: 0.00165844
  grad_norm: 0.03564481
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.27002680
  weight_norm_after: 0.27003795
  weight_change: 0.00001115
  grad_norm: 0.00319424
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.51543474
  weight_norm_after: 6.51379442
  weight_change: 0.00164032
  grad_norm: 0.02807524
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.11586791
  weight_norm_after: 0.11610031
  weight_change: 0.00023240
  grad_norm: 0.04792641
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.38708544
  weight_norm_after: 6.38547468
  weight_change: 0.00161076
  grad_norm: 0.01628066
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28407499
  weight_norm_after: 0.28417283
  weight_change: 0.00009784
  grad_norm: 0.00151289
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.45015097
  weight_norm_after: 6.44826460
  weight_change: 0.00188637
  grad_norm: 0.02793892
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.11586791
  weight_norm_after: 0.11610031
  weight_change: 0.00023240
  grad_norm: 0.04792641
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.08602238
  weight_norm_after: 7.08465385
  weight_change: 0.00136852
  grad_norm: 0.03844422
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.31015605
  weight_norm_after: 0.31029278
  weight_change: 0.00013673
  grad_norm: 0.00426812
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.25436163
  weight_norm_after: 7.25293350
  weight_change: 0.00142813
  grad_norm: 0.05029362
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.11586791
  weight_norm_after: 0.11610031
  weight_change: 0.00023240
  grad_norm: 0.04792641
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.61133528
  weight_norm_after: 6.60964727
  weight_change: 0.00168800
  grad_norm: 0.01672146
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28141212
  weight_norm_after: 0.28144211
  weight_change: 0.00002998
  grad_norm: 0.00166661
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.48700523
  weight_norm_after: 6.48537779
  weight_change: 0.00162745
  grad_norm: 0.03432528
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.11586791
  weight_norm_after: 0.11610031
  weight_change: 0.00023240
  grad_norm: 0.04792641
projection.weight:
  weight_norm_before: 1.94060969
  weight_norm_after: 1.94053245
  weight_change: 0.00007725
  grad_norm: 0.23287520
projection.bias:
  weight_norm_before: 0.01447035
  weight_norm_after: 0.01481028
  weight_change: 0.00033993
  grad_norm: 0.39399573
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.57485807
  weight_norm_after: 1.57297432
  weight_change: 0.00188375
  grad_norm: 0.00054621
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11390273
  weight_norm_after: 0.11390036
  weight_change: 0.00000237
  grad_norm: 0.00443267
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 3.09135818
  weight_norm_after: 3.08873177
  weight_change: 0.00262642
  grad_norm: 0.00028339
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.02967995
  weight_norm_after: 0.02977899
  weight_change: 0.00009905
  grad_norm: 0.00020688
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.56316406
  weight_norm_after: 0.56249839
  weight_change: 0.00066566
  grad_norm: 0.00000551
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01485161
  weight_norm_after: 0.01484413
  weight_change: 0.00000748
  grad_norm: 0.00001930
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.83701897
  weight_norm_after: 0.83604884
  weight_change: 0.00097013
  grad_norm: 0.00000252
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00412370
  weight_norm_after: 0.00411488
  weight_change: 0.00000883
  grad_norm: 0.00000158
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1800/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.59251320
loss (scaled for backward): 0.59251320
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1876.51424787
avg train_loss so far: 1.04192907
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.056538 / 0.041600
y_true_for_loss mean/std: -0.334176 / 0.675934
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.24733841
  weight_norm_after: 1.24577248
  weight_change: 0.00156593
  grad_norm: 0.00001654
celestial_projection.0.bias:
  weight_norm_before: 0.06329447
  weight_norm_after: 0.06343956
  weight_change: 0.00014509
  grad_norm: 0.00003709
celestial_projection.1.weight:
  weight_norm_before: 2.49443221
  weight_norm_after: 2.49161768
  weight_change: 0.00281453
  grad_norm: 0.00000291
celestial_projection.1.bias:
  weight_norm_before: 0.01674554
  weight_norm_after: 0.01672298
  weight_change: 0.00002255
  grad_norm: 0.00000134
celestial_query_projection.weight:
  weight_norm_before: 0.00209477
  weight_norm_after: 0.00208326
  weight_change: 0.00001151
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000008
  weight_norm_after: 0.00000008
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00004658
  weight_norm_after: 0.00004615
  weight_change: 0.00000043
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.17604832
  weight_norm_after: 0.17560489
  weight_change: 0.00044343
  grad_norm: 0.00000081
celestial_value_projection.bias:
  weight_norm_before: 0.01870794
  weight_norm_after: 0.01867758
  weight_change: 0.00003036
  grad_norm: 0.00000097
celestial_output_projection.weight:
  weight_norm_before: 0.99114764
  weight_norm_after: 0.98981303
  weight_change: 0.00133461
  grad_norm: 0.00003087
celestial_output_projection.bias:
  weight_norm_before: 0.15241811
  weight_norm_after: 0.15237784
  weight_change: 0.00004026
  grad_norm: 0.00029236
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00161599
  weight_norm_after: 0.00160549
  weight_change: 0.00001050
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000193
  weight_norm_after: 0.00000192
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00208809
  weight_norm_after: 0.00207610
  weight_change: 0.00001199
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000116
  weight_norm_after: 0.00000115
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00687867
  weight_norm_after: 0.00684985
  weight_change: 0.00002882
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00002493
  weight_norm_after: 0.00002478
  weight_change: 0.00000014
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00280776
  weight_norm_after: 0.00279084
  weight_change: 0.00001692
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00002572
  weight_norm_after: 0.00002553
  weight_change: 0.00000019
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.03084224
  weight_norm_after: 0.03070546
  weight_change: 0.00013678
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.45788622
  weight_norm_after: 2.45533538
  weight_change: 0.00255084
  grad_norm: 0.00019691
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.18964486
  weight_norm_after: 0.18979475
  weight_change: 0.00014989
  grad_norm: 0.00023258
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.42576504
  weight_norm_after: 6.42471027
  weight_change: 0.00105476
  grad_norm: 0.00941883
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.27160162
  weight_norm_after: 0.27178839
  weight_change: 0.00018677
  grad_norm: 0.00083851
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.43547297
  weight_norm_after: 6.43382597
  weight_change: 0.00164700
  grad_norm: 0.01296495
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.11863636
  weight_norm_after: 0.11885191
  weight_change: 0.00021555
  grad_norm: 0.01448941
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.30772972
  weight_norm_after: 6.30688238
  weight_change: 0.00084734
  grad_norm: 0.01816961
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28665829
  weight_norm_after: 0.28694165
  weight_change: 0.00028336
  grad_norm: 0.00159865
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.36077595
  weight_norm_after: 6.35889196
  weight_change: 0.00188398
  grad_norm: 0.01265678
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.11863636
  weight_norm_after: 0.11885191
  weight_change: 0.00021555
  grad_norm: 0.01448941
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 7.02061844
  weight_norm_after: 7.01950312
  weight_change: 0.00111532
  grad_norm: 0.01077419
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.31505993
  weight_norm_after: 0.31519428
  weight_change: 0.00013435
  grad_norm: 0.00114861
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.18821430
  weight_norm_after: 7.18693304
  weight_change: 0.00128126
  grad_norm: 0.01989953
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.11863636
  weight_norm_after: 0.11885191
  weight_change: 0.00021555
  grad_norm: 0.01448941
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.54702950
  weight_norm_after: 6.54577541
  weight_change: 0.00125408
  grad_norm: 0.00708518
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28584674
  weight_norm_after: 0.28594765
  weight_change: 0.00010091
  grad_norm: 0.00064003
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.40791464
  weight_norm_after: 6.40625334
  weight_change: 0.00166130
  grad_norm: 0.01252167
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.11863636
  weight_norm_after: 0.11885191
  weight_change: 0.00021555
  grad_norm: 0.01448941
projection.weight:
  weight_norm_before: 1.92608047
  weight_norm_after: 1.92579603
  weight_change: 0.00028443
  grad_norm: 0.05295676
projection.bias:
  weight_norm_before: 0.00170360
  weight_norm_after: 0.00181906
  weight_change: 0.00011546
  grad_norm: 0.07507510
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.48248637
  weight_norm_after: 1.48069584
  weight_change: 0.00179052
  grad_norm: 0.00031312
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11760104
  weight_norm_after: 0.11762606
  weight_change: 0.00002502
  grad_norm: 0.00259713
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.95124793
  weight_norm_after: 2.94869399
  weight_change: 0.00255394
  grad_norm: 0.00016804
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03418696
  weight_norm_after: 0.03441054
  weight_change: 0.00022358
  grad_norm: 0.00011422
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.53054810
  weight_norm_after: 0.52990842
  weight_change: 0.00063968
  grad_norm: 0.00000614
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01526107
  weight_norm_after: 0.01525965
  weight_change: 0.00000142
  grad_norm: 0.00002315
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.78953105
  weight_norm_after: 0.78859276
  weight_change: 0.00093830
  grad_norm: 0.00000366
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00401798
  weight_norm_after: 0.00400233
  weight_change: 0.00001565
  grad_norm: 0.00000199
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1850/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.35626614
loss (scaled for backward): 0.35626614
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1924.85912213
avg train_loss so far: 1.03990228
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.021649 / 0.028274
y_true_for_loss mean/std: 0.014994 / 0.607450
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.17117846
  weight_norm_after: 1.16969931
  weight_change: 0.00147915
  grad_norm: 0.00007682
celestial_projection.0.bias:
  weight_norm_before: 0.05821469
  weight_norm_after: 0.05814233
  weight_change: 0.00007236
  grad_norm: 0.00020645
celestial_projection.1.weight:
  weight_norm_before: 2.35639048
  weight_norm_after: 2.35368514
  weight_change: 0.00270534
  grad_norm: 0.00001849
celestial_projection.1.bias:
  weight_norm_before: 0.01556277
  weight_norm_after: 0.01553868
  weight_change: 0.00002409
  grad_norm: 0.00000787
celestial_query_projection.weight:
  weight_norm_before: 0.00158601
  weight_norm_after: 0.00157712
  weight_change: 0.00000889
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000005
  weight_norm_after: 0.00000005
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00002917
  weight_norm_after: 0.00002890
  weight_change: 0.00000028
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.15511321
  weight_norm_after: 0.15471901
  weight_change: 0.00039420
  grad_norm: 0.00000117
celestial_value_projection.bias:
  weight_norm_before: 0.01717328
  weight_norm_after: 0.01714149
  weight_change: 0.00003179
  grad_norm: 0.00000158
celestial_output_projection.weight:
  weight_norm_before: 0.92602301
  weight_norm_after: 0.92475855
  weight_change: 0.00126445
  grad_norm: 0.00012623
celestial_output_projection.bias:
  weight_norm_before: 0.14954525
  weight_norm_after: 0.14949992
  weight_change: 0.00004533
  grad_norm: 0.00123458
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00116239
  weight_norm_after: 0.00115466
  weight_change: 0.00000772
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000120
  weight_norm_after: 0.00000119
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00156205
  weight_norm_after: 0.00155294
  weight_change: 0.00000912
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000071
  weight_norm_after: 0.00000070
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00556986
  weight_norm_after: 0.00554626
  weight_change: 0.00002360
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00001855
  weight_norm_after: 0.00001844
  weight_change: 0.00000011
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00206843
  weight_norm_after: 0.00205568
  weight_change: 0.00001275
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00001760
  weight_norm_after: 0.00001747
  weight_change: 0.00000014
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.02466111
  weight_norm_after: 0.02455030
  weight_change: 0.00011081
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.32919145
  weight_norm_after: 2.32671690
  weight_change: 0.00247455
  grad_norm: 0.00064394
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.18995203
  weight_norm_after: 0.19005588
  weight_change: 0.00010385
  grad_norm: 0.00085414
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.35213709
  weight_norm_after: 6.35045624
  weight_change: 0.00168085
  grad_norm: 0.05956795
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.27490705
  weight_norm_after: 0.27490211
  weight_change: 0.00000495
  grad_norm: 0.00540822
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.35090494
  weight_norm_after: 6.34928322
  weight_change: 0.00162172
  grad_norm: 0.05696252
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.12381079
  weight_norm_after: 0.12369630
  weight_change: 0.00011449
  grad_norm: 0.07801028
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.22465611
  weight_norm_after: 6.22272778
  weight_change: 0.00192833
  grad_norm: 0.02435607
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28877133
  weight_norm_after: 0.28872833
  weight_change: 0.00004300
  grad_norm: 0.00211663
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.26971006
  weight_norm_after: 6.26787424
  weight_change: 0.00183582
  grad_norm: 0.03343047
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.12381079
  weight_norm_after: 0.12369630
  weight_change: 0.00011449
  grad_norm: 0.07801028
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.95274782
  weight_norm_after: 6.95110512
  weight_change: 0.00164270
  grad_norm: 0.03827978
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.31795308
  weight_norm_after: 0.31788200
  weight_change: 0.00007108
  grad_norm: 0.00423872
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.11799479
  weight_norm_after: 7.11643982
  weight_change: 0.00155497
  grad_norm: 0.07621355
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.12381079
  weight_norm_after: 0.12369630
  weight_change: 0.00011449
  grad_norm: 0.07801028
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.47336388
  weight_norm_after: 6.47169304
  weight_change: 0.00167084
  grad_norm: 0.02678580
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28806245
  weight_norm_after: 0.28803691
  weight_change: 0.00002554
  grad_norm: 0.00248534
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.32202768
  weight_norm_after: 6.32030630
  weight_change: 0.00172138
  grad_norm: 0.04449803
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.12381079
  weight_norm_after: 0.12369630
  weight_change: 0.00011449
  grad_norm: 0.07801028
projection.weight:
  weight_norm_before: 1.91741705
  weight_norm_after: 1.91727436
  weight_change: 0.00014269
  grad_norm: 0.28188840
projection.bias:
  weight_norm_before: 0.01191075
  weight_norm_after: 0.01202161
  weight_change: 0.00011086
  grad_norm: 0.61887199
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.39316177
  weight_norm_after: 1.39140058
  weight_change: 0.00176120
  grad_norm: 0.00043859
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11844023
  weight_norm_after: 0.11843198
  weight_change: 0.00000825
  grad_norm: 0.00365122
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.82540655
  weight_norm_after: 2.82288051
  weight_change: 0.00252604
  grad_norm: 0.00021483
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03212025
  weight_norm_after: 0.03201146
  weight_change: 0.00010879
  grad_norm: 0.00018725
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.49931708
  weight_norm_after: 0.49870834
  weight_change: 0.00060874
  grad_norm: 0.00001266
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01458095
  weight_norm_after: 0.01457610
  weight_change: 0.00000485
  grad_norm: 0.00004909
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.74436015
  weight_norm_after: 0.74348831
  weight_change: 0.00087184
  grad_norm: 0.00000217
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00375893
  weight_norm_after: 0.00376329
  weight_change: 0.00000435
  grad_norm: 0.00000479
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1900/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.03931189
loss (scaled for backward): 1.03931189
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 1963.29127575
avg train_loss so far: 1.03276764
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.037887 / 0.045076
y_true_for_loss mean/std: -0.572550 / 0.826704
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.09931970
  weight_norm_after: 1.09792507
  weight_change: 0.00139463
  grad_norm: 0.00002075
celestial_projection.0.bias:
  weight_norm_before: 0.05195946
  weight_norm_after: 0.05182340
  weight_change: 0.00013606
  grad_norm: 0.00006877
celestial_projection.1.weight:
  weight_norm_before: 2.22387695
  weight_norm_after: 2.22128367
  weight_change: 0.00259328
  grad_norm: 0.00000400
celestial_projection.1.bias:
  weight_norm_before: 0.01442516
  weight_norm_after: 0.01440377
  weight_change: 0.00002139
  grad_norm: 0.00000188
celestial_query_projection.weight:
  weight_norm_before: 0.00119378
  weight_norm_after: 0.00118694
  weight_change: 0.00000684
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000003
  weight_norm_after: 0.00000003
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00001805
  weight_norm_after: 0.00001788
  weight_change: 0.00000017
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.13653930
  weight_norm_after: 0.13618977
  weight_change: 0.00034952
  grad_norm: 0.00000021
celestial_value_projection.bias:
  weight_norm_before: 0.01569906
  weight_norm_after: 0.01566912
  weight_change: 0.00002994
  grad_norm: 0.00000032
celestial_output_projection.weight:
  weight_norm_before: 0.86488616
  weight_norm_after: 0.86369902
  weight_change: 0.00118715
  grad_norm: 0.00004812
celestial_output_projection.bias:
  weight_norm_before: 0.14667366
  weight_norm_after: 0.14660798
  weight_change: 0.00006568
  grad_norm: 0.00049048
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00082984
  weight_norm_after: 0.00082420
  weight_change: 0.00000564
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000073
  weight_norm_after: 0.00000072
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00116290
  weight_norm_after: 0.00115599
  weight_change: 0.00000690
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000043
  weight_norm_after: 0.00000042
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00449821
  weight_norm_after: 0.00447889
  weight_change: 0.00001932
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00001369
  weight_norm_after: 0.00001361
  weight_change: 0.00000008
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00151325
  weight_norm_after: 0.00150371
  weight_change: 0.00000954
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00001191
  weight_norm_after: 0.00001181
  weight_change: 0.00000009
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.01965983
  weight_norm_after: 0.01957030
  weight_change: 0.00008953
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.20457554
  weight_norm_after: 2.20252681
  weight_change: 0.00204873
  grad_norm: 0.00051185
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.18630603
  weight_norm_after: 0.18723112
  weight_change: 0.00092509
  grad_norm: 0.00076625
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.26684523
  weight_norm_after: 6.26485729
  weight_change: 0.00198793
  grad_norm: 0.03649222
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.27345118
  weight_norm_after: 0.27332887
  weight_change: 0.00012231
  grad_norm: 0.00344963
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.27140188
  weight_norm_after: 6.26989365
  weight_change: 0.00150824
  grad_norm: 0.05536779
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.12685806
  weight_norm_after: 0.12683210
  weight_change: 0.00002596
  grad_norm: 0.02729993
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.12374353
  weight_norm_after: 6.12163925
  weight_change: 0.00210428
  grad_norm: 0.01055019
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.28373981
  weight_norm_after: 0.28357539
  weight_change: 0.00016442
  grad_norm: 0.00093459
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.18142414
  weight_norm_after: 6.17971754
  weight_change: 0.00170660
  grad_norm: 0.01432260
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.12685806
  weight_norm_after: 0.12683210
  weight_change: 0.00002596
  grad_norm: 0.02729993
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.87695599
  weight_norm_after: 6.87562323
  weight_change: 0.00133276
  grad_norm: 0.02652377
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.31644765
  weight_norm_after: 0.31643316
  weight_change: 0.00001448
  grad_norm: 0.00289997
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 7.04618645
  weight_norm_after: 7.04500151
  weight_change: 0.00118494
  grad_norm: 0.03029033
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.12685806
  weight_norm_after: 0.12683210
  weight_change: 0.00002596
  grad_norm: 0.02729993
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.37967348
  weight_norm_after: 6.37737989
  weight_change: 0.00229359
  grad_norm: 0.01103885
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28365502
  weight_norm_after: 0.28340247
  weight_change: 0.00025254
  grad_norm: 0.00100438
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.23872089
  weight_norm_after: 6.23714924
  weight_change: 0.00157166
  grad_norm: 0.02012499
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.12685806
  weight_norm_after: 0.12683210
  weight_change: 0.00002596
  grad_norm: 0.02729993
projection.weight:
  weight_norm_before: 1.91299164
  weight_norm_after: 1.91284680
  weight_change: 0.00014484
  grad_norm: 0.16135997
projection.bias:
  weight_norm_before: 0.02323095
  weight_norm_after: 0.02308909
  weight_change: 0.00014186
  grad_norm: 0.22987834
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.30765438
  weight_norm_after: 1.30600917
  weight_change: 0.00164521
  grad_norm: 0.00055232
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.11970127
  weight_norm_after: 0.11972167
  weight_change: 0.00002039
  grad_norm: 0.00467834
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.70157337
  weight_norm_after: 2.69909024
  weight_change: 0.00248313
  grad_norm: 0.00032584
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03304805
  weight_norm_after: 0.03315494
  weight_change: 0.00010689
  grad_norm: 0.00020787
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.46940958
  weight_norm_after: 0.46882200
  weight_change: 0.00058758
  grad_norm: 0.00001751
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01460415
  weight_norm_after: 0.01461778
  weight_change: 0.00001364
  grad_norm: 0.00008202
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.70092338
  weight_norm_after: 0.70005274
  weight_change: 0.00087065
  grad_norm: 0.00000904
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00339784
  weight_norm_after: 0.00337601
  weight_change: 0.00002183
  grad_norm: 0.00000517
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 1950/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.35008448
loss (scaled for backward): 0.35008448
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2010.87565149
avg train_loss so far: 1.03068972
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.082666 / 0.017353
y_true_for_loss mean/std: -0.145854 / 0.557042
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 1.03155732
  weight_norm_after: 1.03023899
  weight_change: 0.00131834
  grad_norm: 0.00002857
celestial_projection.0.bias:
  weight_norm_before: 0.04697110
  weight_norm_after: 0.04677979
  weight_change: 0.00019131
  grad_norm: 0.00010308
celestial_projection.1.weight:
  weight_norm_before: 2.09697056
  weight_norm_after: 2.09446716
  weight_change: 0.00250340
  grad_norm: 0.00000644
celestial_projection.1.bias:
  weight_norm_before: 0.01352247
  weight_norm_after: 0.01348351
  weight_change: 0.00003896
  grad_norm: 0.00000260
celestial_query_projection.weight:
  weight_norm_before: 0.00089306
  weight_norm_after: 0.00088784
  weight_change: 0.00000523
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00001103
  weight_norm_after: 0.00001092
  weight_change: 0.00000011
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.12011912
  weight_norm_after: 0.11980949
  weight_change: 0.00030963
  grad_norm: 0.00000054
celestial_value_projection.bias:
  weight_norm_before: 0.01449641
  weight_norm_after: 0.01446927
  weight_change: 0.00002715
  grad_norm: 0.00000073
celestial_output_projection.weight:
  weight_norm_before: 0.80820715
  weight_norm_after: 0.80710232
  weight_change: 0.00110483
  grad_norm: 0.00005529
celestial_output_projection.bias:
  weight_norm_before: 0.14811631
  weight_norm_after: 0.14797638
  weight_change: 0.00013992
  grad_norm: 0.00055637
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00058779
  weight_norm_after: 0.00058370
  weight_change: 0.00000409
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000044
  weight_norm_after: 0.00000044
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00086121
  weight_norm_after: 0.00085601
  weight_change: 0.00000521
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000026
  weight_norm_after: 0.00000025
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00362126
  weight_norm_after: 0.00360546
  weight_change: 0.00001580
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00001002
  weight_norm_after: 0.00000996
  weight_change: 0.00000006
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00109914
  weight_norm_after: 0.00109205
  weight_change: 0.00000709
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000796
  weight_norm_after: 0.00000790
  weight_change: 0.00000006
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.01562417
  weight_norm_after: 0.01555203
  weight_change: 0.00007214
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.11808085
  weight_norm_after: 2.11560345
  weight_change: 0.00247741
  grad_norm: 0.00048943
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.25952697
  weight_norm_after: 0.25923002
  weight_change: 0.00029695
  grad_norm: 0.00063901
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.20375490
  weight_norm_after: 6.20145893
  weight_change: 0.00229597
  grad_norm: 0.01551195
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28209823
  weight_norm_after: 0.28184712
  weight_change: 0.00025111
  grad_norm: 0.00134420
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.19121933
  weight_norm_after: 6.18980122
  weight_change: 0.00141811
  grad_norm: 0.01318673
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.12645562
  weight_norm_after: 0.12666425
  weight_change: 0.00020863
  grad_norm: 0.01957479
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.07079697
  weight_norm_after: 6.06855726
  weight_change: 0.00223970
  grad_norm: 0.00892141
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29639539
  weight_norm_after: 0.29622725
  weight_change: 0.00016814
  grad_norm: 0.00081557
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.09738302
  weight_norm_after: 6.09589481
  weight_change: 0.00148821
  grad_norm: 0.01538186
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.12645562
  weight_norm_after: 0.12666425
  weight_change: 0.00020863
  grad_norm: 0.01957479
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.81583595
  weight_norm_after: 6.81378317
  weight_change: 0.00205278
  grad_norm: 0.04904797
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.32160160
  weight_norm_after: 0.32120726
  weight_change: 0.00039434
  grad_norm: 0.00506957
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.99156427
  weight_norm_after: 6.99076557
  weight_change: 0.00079870
  grad_norm: 0.05432076
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.12645562
  weight_norm_after: 0.12666425
  weight_change: 0.00020863
  grad_norm: 0.01957479
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.30744219
  weight_norm_after: 6.30522060
  weight_change: 0.00222158
  grad_norm: 0.01899786
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28663757
  weight_norm_after: 0.28639251
  weight_change: 0.00024506
  grad_norm: 0.00180701
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.16031313
  weight_norm_after: 6.15899897
  weight_change: 0.00131416
  grad_norm: 0.01820898
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.12645562
  weight_norm_after: 0.12666425
  weight_change: 0.00020863
  grad_norm: 0.01957479
projection.weight:
  weight_norm_before: 1.89603651
  weight_norm_after: 1.89618528
  weight_change: 0.00014877
  grad_norm: 0.18915528
projection.bias:
  weight_norm_before: 0.00447398
  weight_norm_after: 0.00489327
  weight_change: 0.00041930
  grad_norm: 0.16452101
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.23059332
  weight_norm_after: 1.22912943
  weight_change: 0.00146389
  grad_norm: 0.00070134
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.12564431
  weight_norm_after: 0.12561686
  weight_change: 0.00002745
  grad_norm: 0.00605107
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.57433414
  weight_norm_after: 2.57232952
  weight_change: 0.00200462
  grad_norm: 0.00043234
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03310082
  weight_norm_after: 0.03359722
  weight_change: 0.00049639
  grad_norm: 0.00028174
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.44101256
  weight_norm_after: 0.44045112
  weight_change: 0.00056145
  grad_norm: 0.00002139
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01430525
  weight_norm_after: 0.01425775
  weight_change: 0.00004750
  grad_norm: 0.00010368
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.65946805
  weight_norm_after: 0.65862912
  weight_change: 0.00083894
  grad_norm: 0.00001157
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00339401
  weight_norm_after: 0.00336302
  weight_change: 0.00003099
  grad_norm: 0.00000615
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2000/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.61988890
loss (scaled for backward): 0.61988890
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2068.72288755
avg train_loss so far: 1.03384452
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.098604 / 0.072231
y_true_for_loss mean/std: -0.237612 / 0.784272
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.96765095
  weight_norm_after: 0.96640724
  weight_change: 0.00124371
  grad_norm: 0.00000633
celestial_projection.0.bias:
  weight_norm_before: 0.05670269
  weight_norm_after: 0.05658053
  weight_change: 0.00012216
  grad_norm: 0.00002814
celestial_projection.1.weight:
  weight_norm_before: 1.97556651
  weight_norm_after: 1.97318685
  weight_change: 0.00237966
  grad_norm: 0.00000281
celestial_projection.1.bias:
  weight_norm_before: 0.01297605
  weight_norm_after: 0.01295698
  weight_change: 0.00001907
  grad_norm: 0.00000108
celestial_query_projection.weight:
  weight_norm_before: 0.00066385
  weight_norm_after: 0.00065988
  weight_change: 0.00000397
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000664
  weight_norm_after: 0.00000658
  weight_change: 0.00000007
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.10554807
  weight_norm_after: 0.10527399
  weight_change: 0.00027408
  grad_norm: 0.00000006
celestial_value_projection.bias:
  weight_norm_before: 0.01328025
  weight_norm_after: 0.01325559
  weight_change: 0.00002466
  grad_norm: 0.00000009
celestial_output_projection.weight:
  weight_norm_before: 0.75453281
  weight_norm_after: 0.75348741
  weight_change: 0.00104541
  grad_norm: 0.00002179
celestial_output_projection.bias:
  weight_norm_before: 0.15631400
  weight_norm_after: 0.15632807
  weight_change: 0.00001407
  grad_norm: 0.00021795
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00041293
  weight_norm_after: 0.00040999
  weight_change: 0.00000294
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000026
  weight_norm_after: 0.00000026
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00063420
  weight_norm_after: 0.00063030
  weight_change: 0.00000391
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000015
  weight_norm_after: 0.00000015
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00290465
  weight_norm_after: 0.00289175
  weight_change: 0.00001290
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000727
  weight_norm_after: 0.00000722
  weight_change: 0.00000005
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00079239
  weight_norm_after: 0.00078716
  weight_change: 0.00000523
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000526
  weight_norm_after: 0.00000522
  weight_change: 0.00000004
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.01237680
  weight_norm_after: 0.01231884
  weight_change: 0.00005796
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 2.02090359
  weight_norm_after: 2.01901150
  weight_change: 0.00189209
  grad_norm: 0.00009517
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.29143712
  weight_norm_after: 0.29200655
  weight_change: 0.00056943
  grad_norm: 0.00012699
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.13680267
  weight_norm_after: 6.13535929
  weight_change: 0.00144339
  grad_norm: 0.00919666
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28994957
  weight_norm_after: 0.29004967
  weight_change: 0.00010011
  grad_norm: 0.00078675
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.10425568
  weight_norm_after: 6.10243416
  weight_change: 0.00182152
  grad_norm: 0.01178205
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.12649107
  weight_norm_after: 0.12648223
  weight_change: 0.00000884
  grad_norm: 0.01743045
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 6.02883911
  weight_norm_after: 6.02721977
  weight_change: 0.00161934
  grad_norm: 0.00479025
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.31226659
  weight_norm_after: 0.31227809
  weight_change: 0.00001150
  grad_norm: 0.00040526
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 6.01266098
  weight_norm_after: 6.01097441
  weight_change: 0.00168657
  grad_norm: 0.01071855
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.12649107
  weight_norm_after: 0.12648223
  weight_change: 0.00000884
  grad_norm: 0.01743045
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.76596546
  weight_norm_after: 6.76447010
  weight_change: 0.00149536
  grad_norm: 0.01789980
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33935937
  weight_norm_after: 0.33943799
  weight_change: 0.00007862
  grad_norm: 0.00203824
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.91659927
  weight_norm_after: 6.91508818
  weight_change: 0.00151110
  grad_norm: 0.02069809
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.12649107
  weight_norm_after: 0.12648223
  weight_change: 0.00000884
  grad_norm: 0.01743045
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.26309586
  weight_norm_after: 6.26136780
  weight_change: 0.00172806
  grad_norm: 0.00753168
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.30261266
  weight_norm_after: 0.30260494
  weight_change: 0.00000772
  grad_norm: 0.00068038
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 6.07917500
  weight_norm_after: 6.07752228
  weight_change: 0.00165272
  grad_norm: 0.01225713
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.12649107
  weight_norm_after: 0.12648223
  weight_change: 0.00000884
  grad_norm: 0.01743045
projection.weight:
  weight_norm_before: 1.87181282
  weight_norm_after: 1.87138402
  weight_change: 0.00042880
  grad_norm: 0.08571733
projection.bias:
  weight_norm_before: 0.00408650
  weight_norm_after: 0.00391983
  weight_change: 0.00016666
  grad_norm: 0.13381803
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.15816927
  weight_norm_after: 1.15668488
  weight_change: 0.00148439
  grad_norm: 0.00013450
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13091511
  weight_norm_after: 0.13096902
  weight_change: 0.00005391
  grad_norm: 0.00117723
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.44844246
  weight_norm_after: 2.44610691
  weight_change: 0.00233555
  grad_norm: 0.00008689
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03547844
  weight_norm_after: 0.03547695
  weight_change: 0.00000149
  grad_norm: 0.00007376
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.41423070
  weight_norm_after: 0.41369811
  weight_change: 0.00053260
  grad_norm: 0.00000526
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01667154
  weight_norm_after: 0.01664004
  weight_change: 0.00003150
  grad_norm: 0.00002452
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.62057942
  weight_norm_after: 0.61979592
  weight_change: 0.00078350
  grad_norm: 0.00000431
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00411108
  weight_norm_after: 0.00409045
  weight_change: 0.00002064
  grad_norm: 0.00000214
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2050/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.39944249
loss (scaled for backward): 0.39944249
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2117.89550025
avg train_loss so far: 1.03261604
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.002218 / 0.061767
y_true_for_loss mean/std: -0.113730 / 0.629482
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.90714169
  weight_norm_after: 0.90596700
  weight_change: 0.00117469
  grad_norm: 0.00001876
celestial_projection.0.bias:
  weight_norm_before: 0.04997566
  weight_norm_after: 0.04992253
  weight_change: 0.00005313
  grad_norm: 0.00010368
celestial_projection.1.weight:
  weight_norm_before: 1.85913241
  weight_norm_after: 1.85686159
  weight_change: 0.00227082
  grad_norm: 0.00000795
celestial_projection.1.bias:
  weight_norm_before: 0.01196916
  weight_norm_after: 0.01195511
  weight_change: 0.00001406
  grad_norm: 0.00000343
celestial_query_projection.weight:
  weight_norm_before: 0.00049020
  weight_norm_after: 0.00048720
  weight_change: 0.00000300
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000395
  weight_norm_after: 0.00000390
  weight_change: 0.00000004
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.09261619
  weight_norm_after: 0.09237284
  weight_change: 0.00024334
  grad_norm: 0.00000029
celestial_value_projection.bias:
  weight_norm_before: 0.01203919
  weight_norm_after: 0.01201325
  weight_change: 0.00002594
  grad_norm: 0.00000044
celestial_output_projection.weight:
  weight_norm_before: 0.70372504
  weight_norm_after: 0.70272630
  weight_change: 0.00099874
  grad_norm: 0.00006991
celestial_output_projection.bias:
  weight_norm_before: 0.15302610
  weight_norm_after: 0.15298033
  weight_change: 0.00004578
  grad_norm: 0.00073472
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00028761
  weight_norm_after: 0.00028551
  weight_change: 0.00000210
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000015
  weight_norm_after: 0.00000015
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00046421
  weight_norm_after: 0.00046130
  weight_change: 0.00000292
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000009
  weight_norm_after: 0.00000009
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00232030
  weight_norm_after: 0.00230980
  weight_change: 0.00001050
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000522
  weight_norm_after: 0.00000519
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00056682
  weight_norm_after: 0.00056299
  weight_change: 0.00000383
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000343
  weight_norm_after: 0.00000340
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00977134
  weight_norm_after: 0.00972491
  weight_change: 0.00004643
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.91265464
  weight_norm_after: 1.91047406
  weight_change: 0.00218058
  grad_norm: 0.00031244
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.29120007
  weight_norm_after: 0.29104754
  weight_change: 0.00015253
  grad_norm: 0.00046581
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 6.04105854
  weight_norm_after: 6.03945398
  weight_change: 0.00160456
  grad_norm: 0.02655071
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28476766
  weight_norm_after: 0.28475899
  weight_change: 0.00000867
  grad_norm: 0.00234191
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 6.02045155
  weight_norm_after: 6.01877499
  weight_change: 0.00167656
  grad_norm: 0.03751676
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.12981135
  weight_norm_after: 0.12964375
  weight_change: 0.00016759
  grad_norm: 0.06074879
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.92862463
  weight_norm_after: 5.92693472
  weight_change: 0.00168991
  grad_norm: 0.01692302
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.30647111
  weight_norm_after: 0.30644879
  weight_change: 0.00002232
  grad_norm: 0.00151212
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.92724037
  weight_norm_after: 5.92534351
  weight_change: 0.00189686
  grad_norm: 0.03399159
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.12981135
  weight_norm_after: 0.12964375
  weight_change: 0.00016759
  grad_norm: 0.06074879
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.68342304
  weight_norm_after: 6.68186855
  weight_change: 0.00155449
  grad_norm: 0.05328613
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33684295
  weight_norm_after: 0.33696967
  weight_change: 0.00012672
  grad_norm: 0.00595302
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.85014582
  weight_norm_after: 6.84863806
  weight_change: 0.00150776
  grad_norm: 0.06440303
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.12981135
  weight_norm_after: 0.12964375
  weight_change: 0.00016759
  grad_norm: 0.06074879
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.16654825
  weight_norm_after: 6.16507721
  weight_change: 0.00147104
  grad_norm: 0.02327785
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.29703224
  weight_norm_after: 0.29701898
  weight_change: 0.00001326
  grad_norm: 0.00215507
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.99807358
  weight_norm_after: 5.99631071
  weight_change: 0.00176287
  grad_norm: 0.03944462
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.12981135
  weight_norm_after: 0.12964375
  weight_change: 0.00016759
  grad_norm: 0.06074879
projection.weight:
  weight_norm_before: 1.86217582
  weight_norm_after: 1.86189270
  weight_change: 0.00028312
  grad_norm: 0.22351781
projection.bias:
  weight_norm_before: 0.00294441
  weight_norm_after: 0.00286402
  weight_change: 0.00008040
  grad_norm: 0.49163142
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.08484495
  weight_norm_after: 1.08341205
  weight_change: 0.00143290
  grad_norm: 0.00044505
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13192493
  weight_norm_after: 0.13191096
  weight_change: 0.00001396
  grad_norm: 0.00396016
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.33907986
  weight_norm_after: 2.33696604
  weight_change: 0.00211382
  grad_norm: 0.00030131
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03581448
  weight_norm_after: 0.03571212
  weight_change: 0.00010236
  grad_norm: 0.00020690
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.38816744
  weight_norm_after: 0.38765833
  weight_change: 0.00050911
  grad_norm: 0.00002545
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01545329
  weight_norm_after: 0.01551062
  weight_change: 0.00005733
  grad_norm: 0.00013862
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.58250588
  weight_norm_after: 0.58178747
  weight_change: 0.00071841
  grad_norm: 0.00001706
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00343183
  weight_norm_after: 0.00344554
  weight_change: 0.00001371
  grad_norm: 0.00000865
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2100/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.14507198
loss (scaled for backward): 1.14507198
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2153.79302644
avg train_loss so far: 1.02512757
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.001767 / 0.054648
y_true_for_loss mean/std: -0.481361 / 0.966044
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.85001659
  weight_norm_after: 0.84890753
  weight_change: 0.00110906
  grad_norm: 0.00001070
celestial_projection.0.bias:
  weight_norm_before: 0.04639821
  weight_norm_after: 0.04633554
  weight_change: 0.00006268
  grad_norm: 0.00007371
celestial_projection.1.weight:
  weight_norm_before: 1.74801850
  weight_norm_after: 1.74584889
  weight_change: 0.00216961
  grad_norm: 0.00000394
celestial_projection.1.bias:
  weight_norm_before: 0.01116787
  weight_norm_after: 0.01115296
  weight_change: 0.00001491
  grad_norm: 0.00000171
celestial_query_projection.weight:
  weight_norm_before: 0.00035948
  weight_norm_after: 0.00035723
  weight_change: 0.00000225
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000231
  weight_norm_after: 0.00000228
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.08116239
  weight_norm_after: 0.08094744
  weight_change: 0.00021495
  grad_norm: 0.00000013
celestial_value_projection.bias:
  weight_norm_before: 0.01084920
  weight_norm_after: 0.01082700
  weight_change: 0.00002220
  grad_norm: 0.00000021
celestial_output_projection.weight:
  weight_norm_before: 0.65567118
  weight_norm_after: 0.65474516
  weight_change: 0.00092602
  grad_norm: 0.00006717
celestial_output_projection.bias:
  weight_norm_before: 0.15052035
  weight_norm_after: 0.15044753
  weight_change: 0.00007282
  grad_norm: 0.00075233
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00019854
  weight_norm_after: 0.00019706
  weight_change: 0.00000148
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000009
  weight_norm_after: 0.00000009
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00033760
  weight_norm_after: 0.00033544
  weight_change: 0.00000217
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000005
  weight_norm_after: 0.00000005
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00184517
  weight_norm_after: 0.00183664
  weight_change: 0.00000853
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000372
  weight_norm_after: 0.00000369
  weight_change: 0.00000003
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00040220
  weight_norm_after: 0.00039942
  weight_change: 0.00000278
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000221
  weight_norm_after: 0.00000219
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00768722
  weight_norm_after: 0.00765014
  weight_change: 0.00003708
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.80759764
  weight_norm_after: 1.80554426
  weight_change: 0.00205338
  grad_norm: 0.00018857
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.28773811
  weight_norm_after: 0.28766778
  weight_change: 0.00007033
  grad_norm: 0.00031168
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.95004654
  weight_norm_after: 5.94807863
  weight_change: 0.00196791
  grad_norm: 0.02240165
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28008962
  weight_norm_after: 0.27993259
  weight_change: 0.00015703
  grad_norm: 0.00193838
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.93987274
  weight_norm_after: 5.93838501
  weight_change: 0.00148773
  grad_norm: 0.02322507
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.13065468
  weight_norm_after: 0.13080540
  weight_change: 0.00015073
  grad_norm: 0.03215344
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.82906771
  weight_norm_after: 5.82708693
  weight_change: 0.00198078
  grad_norm: 0.02316081
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.30027556
  weight_norm_after: 0.30011940
  weight_change: 0.00015616
  grad_norm: 0.00205253
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.83992386
  weight_norm_after: 5.83827114
  weight_change: 0.00165272
  grad_norm: 0.02305549
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.13065468
  weight_norm_after: 0.13080540
  weight_change: 0.00015073
  grad_norm: 0.03215344
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.59799051
  weight_norm_after: 6.59605932
  weight_change: 0.00193119
  grad_norm: 0.02127690
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33317280
  weight_norm_after: 0.33299583
  weight_change: 0.00017697
  grad_norm: 0.00223223
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.78115654
  weight_norm_after: 6.78011513
  weight_change: 0.00104141
  grad_norm: 0.04895230
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.13065468
  weight_norm_after: 0.13080540
  weight_change: 0.00015073
  grad_norm: 0.03215344
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 6.07746744
  weight_norm_after: 6.07572126
  weight_change: 0.00174618
  grad_norm: 0.01472143
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.29283458
  weight_norm_after: 0.29274437
  weight_change: 0.00009021
  grad_norm: 0.00132309
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.91517067
  weight_norm_after: 5.91354656
  weight_change: 0.00162411
  grad_norm: 0.02367623
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.13065468
  weight_norm_after: 0.13080540
  weight_change: 0.00015073
  grad_norm: 0.03215344
projection.weight:
  weight_norm_before: 1.85477078
  weight_norm_after: 1.85467708
  weight_change: 0.00009370
  grad_norm: 0.12371763
projection.bias:
  weight_norm_before: 0.00406179
  weight_norm_after: 0.00381900
  weight_change: 0.00024279
  grad_norm: 0.25746396
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 1.01557386
  weight_norm_after: 1.01423740
  weight_change: 0.00133646
  grad_norm: 0.00034017
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13237317
  weight_norm_after: 0.13239650
  weight_change: 0.00002334
  grad_norm: 0.00306430
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.23482180
  weight_norm_after: 2.23268366
  weight_change: 0.00213814
  grad_norm: 0.00026762
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03476943
  weight_norm_after: 0.03476473
  weight_change: 0.00000471
  grad_norm: 0.00021102
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.36330554
  weight_norm_after: 0.36281976
  weight_change: 0.00048578
  grad_norm: 0.00001133
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01595632
  weight_norm_after: 0.01595418
  weight_change: 0.00000213
  grad_norm: 0.00004864
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.54660386
  weight_norm_after: 0.54589063
  weight_change: 0.00071323
  grad_norm: 0.00000243
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00331985
  weight_norm_after: 0.00330689
  weight_change: 0.00001296
  grad_norm: 0.00000217
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2150/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 1.40201461
loss (scaled for backward): 1.40201461
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2191.54415535
avg train_loss so far: 1.01884898
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.015168 / 0.056772
y_true_for_loss mean/std: -0.233912 / 1.181030
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.79605889
  weight_norm_after: 0.79501057
  weight_change: 0.00104833
  grad_norm: 0.00000247
celestial_projection.0.bias:
  weight_norm_before: 0.04058838
  weight_norm_after: 0.04045498
  weight_change: 0.00013340
  grad_norm: 0.00001822
celestial_projection.1.weight:
  weight_norm_before: 1.64173543
  weight_norm_after: 1.63965845
  weight_change: 0.00207698
  grad_norm: 0.00000098
celestial_projection.1.bias:
  weight_norm_before: 0.01020085
  weight_norm_after: 0.01018010
  weight_change: 0.00002074
  grad_norm: 0.00000043
celestial_query_projection.weight:
  weight_norm_before: 0.00026173
  weight_norm_after: 0.00026005
  weight_change: 0.00000168
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000133
  weight_norm_after: 0.00000131
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.07103955
  weight_norm_after: 0.07084944
  weight_change: 0.00019011
  grad_norm: 0.00000006
celestial_value_projection.bias:
  weight_norm_before: 0.00980869
  weight_norm_after: 0.00978827
  weight_change: 0.00002042
  grad_norm: 0.00000012
celestial_output_projection.weight:
  weight_norm_before: 0.61107719
  weight_norm_after: 0.61021304
  weight_change: 0.00086415
  grad_norm: 0.00001675
celestial_output_projection.bias:
  weight_norm_before: 0.14554019
  weight_norm_after: 0.14544238
  weight_change: 0.00009781
  grad_norm: 0.00019518
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00013578
  weight_norm_after: 0.00013474
  weight_change: 0.00000104
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000005
  weight_norm_after: 0.00000005
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00024385
  weight_norm_after: 0.00024225
  weight_change: 0.00000160
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000003
  weight_norm_after: 0.00000003
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00146018
  weight_norm_after: 0.00145329
  weight_change: 0.00000689
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000262
  weight_norm_after: 0.00000260
  weight_change: 0.00000002
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00028301
  weight_norm_after: 0.00028100
  weight_change: 0.00000201
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000141
  weight_norm_after: 0.00000139
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00602539
  weight_norm_after: 0.00599588
  weight_change: 0.00002951
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.70854366
  weight_norm_after: 1.70656919
  weight_change: 0.00197446
  grad_norm: 0.00005367
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.28835315
  weight_norm_after: 0.28829327
  weight_change: 0.00005987
  grad_norm: 0.00009166
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.87515640
  weight_norm_after: 5.87365627
  weight_change: 0.00150013
  grad_norm: 0.00634150
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28081608
  weight_norm_after: 0.28083330
  weight_change: 0.00001723
  grad_norm: 0.00056109
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.85964727
  weight_norm_after: 5.85808897
  weight_change: 0.00155830
  grad_norm: 0.01177488
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.13227670
  weight_norm_after: 0.13233107
  weight_change: 0.00005437
  grad_norm: 0.00853015
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.74199581
  weight_norm_after: 5.74038744
  weight_change: 0.00160837
  grad_norm: 0.00578840
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29736248
  weight_norm_after: 0.29736832
  weight_change: 0.00000584
  grad_norm: 0.00050950
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.75535774
  weight_norm_after: 5.75353813
  weight_change: 0.00181961
  grad_norm: 0.00591794
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.13227670
  weight_norm_after: 0.13233107
  weight_change: 0.00005437
  grad_norm: 0.00853015
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.52288818
  weight_norm_after: 6.52134800
  weight_change: 0.00154018
  grad_norm: 0.01015018
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33131644
  weight_norm_after: 0.33127779
  weight_change: 0.00003865
  grad_norm: 0.00099795
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.71815729
  weight_norm_after: 6.71688509
  weight_change: 0.00127220
  grad_norm: 0.02106674
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.13227670
  weight_norm_after: 0.13233107
  weight_change: 0.00005437
  grad_norm: 0.00853015
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 5.99536133
  weight_norm_after: 5.99392462
  weight_change: 0.00143671
  grad_norm: 0.00629541
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.29076919
  weight_norm_after: 0.29079264
  weight_change: 0.00002345
  grad_norm: 0.00056972
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.83491135
  weight_norm_after: 5.83326292
  weight_change: 0.00164843
  grad_norm: 0.01017657
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.13227670
  weight_norm_after: 0.13233107
  weight_change: 0.00005437
  grad_norm: 0.00853015
projection.weight:
  weight_norm_before: 1.84567571
  weight_norm_after: 1.84563088
  weight_change: 0.00004482
  grad_norm: 0.05071466
projection.bias:
  weight_norm_before: 0.00409123
  weight_norm_after: 0.00448129
  weight_change: 0.00039006
  grad_norm: 0.08834763
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 0.95067048
  weight_norm_after: 0.94944131
  weight_change: 0.00122917
  grad_norm: 0.00021205
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13272794
  weight_norm_after: 0.13273555
  weight_change: 0.00000761
  grad_norm: 0.00193326
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.13284349
  weight_norm_after: 2.13093543
  weight_change: 0.00190806
  grad_norm: 0.00012851
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03804662
  weight_norm_after: 0.03807470
  weight_change: 0.00002808
  grad_norm: 0.00009965
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.33965075
  weight_norm_after: 0.33918908
  weight_change: 0.00046167
  grad_norm: 0.00000554
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01657076
  weight_norm_after: 0.01660503
  weight_change: 0.00003428
  grad_norm: 0.00003431
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.51255912
  weight_norm_after: 0.51189995
  weight_change: 0.00065917
  grad_norm: 0.00000408
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00325807
  weight_norm_after: 0.00326307
  weight_change: 0.00000500
  grad_norm: 0.00000187
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2200/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.72929424
loss (scaled for backward): 0.72929424
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2257.71957738
avg train_loss so far: 1.02576991
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.000343 / 0.026534
y_true_for_loss mean/std: -0.081016 / 0.864778
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.74512583
  weight_norm_after: 0.74413627
  weight_change: 0.00098956
  grad_norm: 0.00000952
celestial_projection.0.bias:
  weight_norm_before: 0.03879311
  weight_norm_after: 0.03870930
  weight_change: 0.00008381
  grad_norm: 0.00008352
celestial_projection.1.weight:
  weight_norm_before: 1.54051149
  weight_norm_after: 1.53853428
  weight_change: 0.00197721
  grad_norm: 0.00000407
celestial_projection.1.bias:
  weight_norm_before: 0.00940476
  weight_norm_after: 0.00938707
  weight_change: 0.00001770
  grad_norm: 0.00000218
celestial_query_projection.weight:
  weight_norm_before: 0.00018914
  weight_norm_after: 0.00018790
  weight_change: 0.00000124
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000075
  weight_norm_after: 0.00000074
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.06208220
  weight_norm_after: 0.06191419
  weight_change: 0.00016801
  grad_norm: 0.00000004
celestial_value_projection.bias:
  weight_norm_before: 0.00879089
  weight_norm_after: 0.00877199
  weight_change: 0.00001890
  grad_norm: 0.00000008
celestial_output_projection.weight:
  weight_norm_before: 0.56859422
  weight_norm_after: 0.56777757
  weight_change: 0.00081664
  grad_norm: 0.00006541
celestial_output_projection.bias:
  weight_norm_before: 0.14637928
  weight_norm_after: 0.14632927
  weight_change: 0.00005001
  grad_norm: 0.00083105
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00009197
  weight_norm_after: 0.00009125
  weight_change: 0.00000072
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000003
  weight_norm_after: 0.00000003
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00017485
  weight_norm_after: 0.00017368
  weight_change: 0.00000117
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000002
  weight_norm_after: 0.00000002
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00114951
  weight_norm_after: 0.00114396
  weight_change: 0.00000555
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000183
  weight_norm_after: 0.00000181
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00019741
  weight_norm_after: 0.00019597
  weight_change: 0.00000143
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000088
  weight_norm_after: 0.00000087
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00470468
  weight_norm_after: 0.00468127
  weight_change: 0.00002341
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.61208522
  weight_norm_after: 1.61009812
  weight_change: 0.00198710
  grad_norm: 0.00068884
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.28589505
  weight_norm_after: 0.28562099
  weight_change: 0.00027406
  grad_norm: 0.00138553
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.80833197
  weight_norm_after: 5.80708981
  weight_change: 0.00124216
  grad_norm: 0.05836955
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28390762
  weight_norm_after: 0.28403562
  weight_change: 0.00012800
  grad_norm: 0.00519491
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.77934313
  weight_norm_after: 5.77788401
  weight_change: 0.00145912
  grad_norm: 0.08075818
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.13308924
  weight_norm_after: 0.13312989
  weight_change: 0.00004065
  grad_norm: 0.12335570
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.66284418
  weight_norm_after: 5.66160488
  weight_change: 0.00123930
  grad_norm: 0.05305408
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29683131
  weight_norm_after: 0.29693195
  weight_change: 0.00010064
  grad_norm: 0.00480352
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.66906548
  weight_norm_after: 5.66733456
  weight_change: 0.00173092
  grad_norm: 0.06996164
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.13308924
  weight_norm_after: 0.13312989
  weight_change: 0.00004065
  grad_norm: 0.12335570
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.45555925
  weight_norm_after: 6.45380688
  weight_change: 0.00175238
  grad_norm: 0.11765485
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33518380
  weight_norm_after: 0.33507380
  weight_change: 0.00011000
  grad_norm: 0.01306816
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.65539503
  weight_norm_after: 6.65408134
  weight_change: 0.00131369
  grad_norm: 0.16130058
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.13308924
  weight_norm_after: 0.13312989
  weight_change: 0.00004065
  grad_norm: 0.12335570
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 5.92145491
  weight_norm_after: 5.91973352
  weight_change: 0.00172138
  grad_norm: 0.06105771
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.29117617
  weight_norm_after: 0.29111633
  weight_change: 0.00005984
  grad_norm: 0.00561367
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.75587034
  weight_norm_after: 5.75439167
  weight_change: 0.00147867
  grad_norm: 0.07355217
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.13308924
  weight_norm_after: 0.13312989
  weight_change: 0.00004065
  grad_norm: 0.12335570
projection.weight:
  weight_norm_before: 1.83663881
  weight_norm_after: 1.83649480
  weight_change: 0.00014400
  grad_norm: 0.34394240
projection.bias:
  weight_norm_before: 0.01137518
  weight_norm_after: 0.01175516
  weight_change: 0.00037999
  grad_norm: 0.54786289
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 0.89006037
  weight_norm_after: 0.88890010
  weight_change: 0.00116026
  grad_norm: 0.00084429
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13307361
  weight_norm_after: 0.13302609
  weight_change: 0.00004752
  grad_norm: 0.00772066
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 2.03810740
  weight_norm_after: 2.03651309
  weight_change: 0.00159431
  grad_norm: 0.00069145
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03636308
  weight_norm_after: 0.03606646
  weight_change: 0.00029663
  grad_norm: 0.00052838
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.31714910
  weight_norm_after: 0.31670773
  weight_change: 0.00044137
  grad_norm: 0.00002298
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01724474
  weight_norm_after: 0.01731070
  weight_change: 0.00006596
  grad_norm: 0.00013244
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.48030499
  weight_norm_after: 0.47967890
  weight_change: 0.00062609
  grad_norm: 0.00001237
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00336717
  weight_norm_after: 0.00337441
  weight_change: 0.00000724
  grad_norm: 0.00000663
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2250/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 9.58827782
loss (scaled for backward): 9.58827782
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2336.92762614
avg train_loss so far: 1.03817309
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.035148 / 0.047063
y_true_for_loss mean/std: -0.268818 / 3.139063
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.69708443
  weight_norm_after: 0.69615209
  weight_change: 0.00093234
  grad_norm: 0.00001152
celestial_projection.0.bias:
  weight_norm_before: 0.03762748
  weight_norm_after: 0.03763148
  weight_change: 0.00000400
  grad_norm: 0.00011402
celestial_projection.1.weight:
  weight_norm_before: 1.44408286
  weight_norm_after: 1.44220614
  weight_change: 0.00187671
  grad_norm: 0.00000402
celestial_projection.1.bias:
  weight_norm_before: 0.00868366
  weight_norm_after: 0.00867285
  weight_change: 0.00001082
  grad_norm: 0.00000263
celestial_query_projection.weight:
  weight_norm_before: 0.00013563
  weight_norm_after: 0.00013472
  weight_change: 0.00000091
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000042
  weight_norm_after: 0.00000041
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.05417568
  weight_norm_after: 0.05402724
  weight_change: 0.00014844
  grad_norm: 0.00000006
celestial_value_projection.bias:
  weight_norm_before: 0.00792001
  weight_norm_after: 0.00790203
  weight_change: 0.00001798
  grad_norm: 0.00000014
celestial_output_projection.weight:
  weight_norm_before: 0.52962112
  weight_norm_after: 0.52884859
  weight_change: 0.00077254
  grad_norm: 0.00009346
celestial_output_projection.bias:
  weight_norm_before: 0.14321856
  weight_norm_after: 0.14323755
  weight_change: 0.00001898
  grad_norm: 0.00122040
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00006167
  weight_norm_after: 0.00006117
  weight_change: 0.00000050
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000002
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00012443
  weight_norm_after: 0.00012357
  weight_change: 0.00000085
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00089994
  weight_norm_after: 0.00089549
  weight_change: 0.00000445
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000126
  weight_norm_after: 0.00000125
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00013646
  weight_norm_after: 0.00013545
  weight_change: 0.00000102
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000055
  weight_norm_after: 0.00000054
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00365872
  weight_norm_after: 0.00364021
  weight_change: 0.00001851
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.52150536
  weight_norm_after: 1.51973009
  weight_change: 0.00177526
  grad_norm: 0.00048840
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.28819075
  weight_norm_after: 0.28815788
  weight_change: 0.00003287
  grad_norm: 0.00107447
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.73261595
  weight_norm_after: 5.73079967
  weight_change: 0.00181627
  grad_norm: 0.03878428
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28355244
  weight_norm_after: 0.28341392
  weight_change: 0.00013852
  grad_norm: 0.00341166
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.69954824
  weight_norm_after: 5.69796515
  weight_change: 0.00158310
  grad_norm: 0.05414934
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.13916647
  weight_norm_after: 0.13924731
  weight_change: 0.00008084
  grad_norm: 0.10007897
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.59306574
  weight_norm_after: 5.59093857
  weight_change: 0.00212717
  grad_norm: 0.03911275
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29898685
  weight_norm_after: 0.29880229
  weight_change: 0.00018457
  grad_norm: 0.00353145
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.58236313
  weight_norm_after: 5.58078575
  weight_change: 0.00157738
  grad_norm: 0.05058502
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.13916647
  weight_norm_after: 0.13924731
  weight_change: 0.00008084
  grad_norm: 0.10007897
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.39013147
  weight_norm_after: 6.38873911
  weight_change: 0.00139236
  grad_norm: 0.05333327
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33669922
  weight_norm_after: 0.33670506
  weight_change: 0.00000584
  grad_norm: 0.00568870
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.59016085
  weight_norm_after: 6.58910179
  weight_change: 0.00105906
  grad_norm: 0.09824114
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.13916647
  weight_norm_after: 0.13924731
  weight_change: 0.00008084
  grad_norm: 0.10007897
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 5.84514284
  weight_norm_after: 5.84289598
  weight_change: 0.00224686
  grad_norm: 0.10932107
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.29011217
  weight_norm_after: 0.28986806
  weight_change: 0.00024411
  grad_norm: 0.01012548
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.67887545
  weight_norm_after: 5.67746878
  weight_change: 0.00140667
  grad_norm: 0.05800271
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.13916647
  weight_norm_after: 0.13924731
  weight_change: 0.00008084
  grad_norm: 0.10007897
projection.weight:
  weight_norm_before: 1.82559621
  weight_norm_after: 1.82551646
  weight_change: 0.00007975
  grad_norm: 0.21731371
projection.bias:
  weight_norm_before: 0.00271746
  weight_norm_after: 0.00275093
  weight_change: 0.00003346
  grad_norm: 0.59916097
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 0.83208460
  weight_norm_after: 0.83099794
  weight_change: 0.00108665
  grad_norm: 0.00139713
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13581397
  weight_norm_after: 0.13582638
  weight_change: 0.00001241
  grad_norm: 0.01309373
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 1.94367075
  weight_norm_after: 1.94174182
  weight_change: 0.00192893
  grad_norm: 0.00077400
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03997289
  weight_norm_after: 0.03999177
  weight_change: 0.00001888
  grad_norm: 0.00062739
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.29617250
  weight_norm_after: 0.29575136
  weight_change: 0.00042114
  grad_norm: 0.00009889
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01272564
  weight_norm_after: 0.01267412
  weight_change: 0.00005153
  grad_norm: 0.00066546
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.44777894
  weight_norm_after: 0.44712913
  weight_change: 0.00064981
  grad_norm: 0.00007432
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00193852
  weight_norm_after: 0.00191929
  weight_change: 0.00001922
  grad_norm: 0.00003350
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2300/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 4.22516489
loss (scaled for backward): 4.22516489
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2377.93676570
avg train_loss so far: 1.03343623
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.006075 / 0.026733
y_true_for_loss mean/std: -0.501642 / 2.030276
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.65175319
  weight_norm_after: 0.65087295
  weight_change: 0.00088024
  grad_norm: 0.00000207
celestial_projection.0.bias:
  weight_norm_before: 0.03702825
  weight_norm_after: 0.03696179
  weight_change: 0.00006646
  grad_norm: 0.00002291
celestial_projection.1.weight:
  weight_norm_before: 1.35242343
  weight_norm_after: 1.35063457
  weight_change: 0.00178885
  grad_norm: 0.00000108
celestial_projection.1.bias:
  weight_norm_before: 0.00807622
  weight_norm_after: 0.00806179
  weight_change: 0.00001443
  grad_norm: 0.00000055
celestial_query_projection.weight:
  weight_norm_before: 0.00009647
  weight_norm_after: 0.00009581
  weight_change: 0.00000066
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000023
  weight_norm_after: 0.00000023
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.04719507
  weight_norm_after: 0.04706414
  weight_change: 0.00013093
  grad_norm: 0.00000003
celestial_value_projection.bias:
  weight_norm_before: 0.00711191
  weight_norm_after: 0.00709591
  weight_change: 0.00001601
  grad_norm: 0.00000008
celestial_output_projection.weight:
  weight_norm_before: 0.49281317
  weight_norm_after: 0.49209413
  weight_change: 0.00071904
  grad_norm: 0.00002170
celestial_output_projection.bias:
  weight_norm_before: 0.14069414
  weight_norm_after: 0.14061651
  weight_change: 0.00007764
  grad_norm: 0.00029390
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00004092
  weight_norm_after: 0.00004058
  weight_change: 0.00000034
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000001
  weight_norm_after: 0.00000001
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00008784
  weight_norm_after: 0.00008722
  weight_change: 0.00000062
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00070046
  weight_norm_after: 0.00069692
  weight_change: 0.00000354
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000086
  weight_norm_after: 0.00000085
  weight_change: 0.00000001
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00009345
  weight_norm_after: 0.00009274
  weight_change: 0.00000071
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000033
  weight_norm_after: 0.00000033
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00283338
  weight_norm_after: 0.00281881
  weight_change: 0.00001457
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.43345141
  weight_norm_after: 1.43169546
  weight_change: 0.00175595
  grad_norm: 0.00007739
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.28448522
  weight_norm_after: 0.28428310
  weight_change: 0.00020212
  grad_norm: 0.00018890
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.65675735
  weight_norm_after: 5.65512514
  weight_change: 0.00163221
  grad_norm: 0.01108684
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.28307489
  weight_norm_after: 0.28303036
  weight_change: 0.00004452
  grad_norm: 0.00098119
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.62138510
  weight_norm_after: 5.61980295
  weight_change: 0.00158215
  grad_norm: 0.01268455
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.14106339
  weight_norm_after: 0.14101796
  weight_change: 0.00004543
  grad_norm: 0.02470362
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.51419926
  weight_norm_after: 5.51259327
  weight_change: 0.00160599
  grad_norm: 0.00858880
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29846540
  weight_norm_after: 0.29843852
  weight_change: 0.00002688
  grad_norm: 0.00076608
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.49678278
  weight_norm_after: 5.49504137
  weight_change: 0.00174141
  grad_norm: 0.01182149
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.14106339
  weight_norm_after: 0.14101796
  weight_change: 0.00004543
  grad_norm: 0.02470362
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.31638527
  weight_norm_after: 6.31500196
  weight_change: 0.00138330
  grad_norm: 0.01136544
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33558449
  weight_norm_after: 0.33559653
  weight_change: 0.00001204
  grad_norm: 0.00123630
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.52163792
  weight_norm_after: 6.52027321
  weight_change: 0.00136471
  grad_norm: 0.02539644
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.14106339
  weight_norm_after: 0.14101796
  weight_change: 0.00004543
  grad_norm: 0.02470362
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 5.76862621
  weight_norm_after: 5.76680136
  weight_change: 0.00182486
  grad_norm: 0.01466833
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28862655
  weight_norm_after: 0.28850994
  weight_change: 0.00011662
  grad_norm: 0.00133988
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.60008812
  weight_norm_after: 5.59851980
  weight_change: 0.00156832
  grad_norm: 0.01171931
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.14106339
  weight_norm_after: 0.14101796
  weight_change: 0.00004543
  grad_norm: 0.02470362
projection.weight:
  weight_norm_before: 1.81472170
  weight_norm_after: 1.81457031
  weight_change: 0.00015140
  grad_norm: 0.09044389
projection.bias:
  weight_norm_before: 0.01212601
  weight_norm_after: 0.01229020
  weight_change: 0.00016419
  grad_norm: 0.24322096
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 0.77787584
  weight_norm_after: 0.77680469
  weight_change: 0.00107116
  grad_norm: 0.00030237
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13711183
  weight_norm_after: 0.13711910
  weight_change: 0.00000727
  grad_norm: 0.00288667
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 1.85411572
  weight_norm_after: 1.85232294
  weight_change: 0.00179279
  grad_norm: 0.00024582
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.03893597
  weight_norm_after: 0.03886374
  weight_change: 0.00007223
  grad_norm: 0.00015389
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.27600527
  weight_norm_after: 0.27561274
  weight_change: 0.00039253
  grad_norm: 0.00000426
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01575156
  weight_norm_after: 0.01572387
  weight_change: 0.00002769
  grad_norm: 0.00003000
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.41890582
  weight_norm_after: 0.41832399
  weight_change: 0.00058183
  grad_norm: 0.00000504
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00235670
  weight_norm_after: 0.00234844
  weight_change: 0.00000825
  grad_norm: 0.00000197
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2350/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.55566132
loss (scaled for backward): 0.55566132
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2426.30808224
avg train_loss so far: 1.03203236
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: 0.016389 / 0.027655
y_true_for_loss mean/std: 0.248780 / 0.718493
reg_loss contribution: 0.00000000

--- OPTIMIZER STEP DIAGNOSTICS ---
celestial_projection.0.weight:
  weight_norm_before: 0.60898155
  weight_norm_after: 0.60815138
  weight_change: 0.00083017
  grad_norm: 0.00000198
celestial_projection.0.bias:
  weight_norm_before: 0.03379898
  weight_norm_after: 0.03371233
  weight_change: 0.00008665
  grad_norm: 0.00002643
celestial_projection.1.weight:
  weight_norm_before: 1.26521635
  weight_norm_after: 1.26351690
  weight_change: 0.00169945
  grad_norm: 0.00000107
celestial_projection.1.bias:
  weight_norm_before: 0.00739918
  weight_norm_after: 0.00738521
  weight_change: 0.00001397
  grad_norm: 0.00000062
celestial_query_projection.weight:
  weight_norm_before: 0.00006805
  weight_norm_after: 0.00006757
  weight_change: 0.00000048
  grad_norm: 0.00000000
celestial_query_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.weight:
  weight_norm_before: 0.00000012
  weight_norm_after: 0.00000012
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_value_projection.weight:
  weight_norm_before: 0.04103791
  weight_norm_after: 0.04092254
  weight_change: 0.00011538
  grad_norm: 0.00000001
celestial_value_projection.bias:
  weight_norm_before: 0.00636022
  weight_norm_after: 0.00634585
  weight_change: 0.00001437
  grad_norm: 0.00000004
celestial_output_projection.weight:
  weight_norm_before: 0.45819429
  weight_norm_after: 0.45752475
  weight_change: 0.00066954
  grad_norm: 0.00002420
celestial_output_projection.bias:
  weight_norm_before: 0.13883677
  weight_norm_after: 0.13879998
  weight_change: 0.00003679
  grad_norm: 0.00034820
dynamic_spatiotemporal_encoder.node_feature_projection.weight:
  weight_norm_before: 13.88551712
  weight_norm_after: 13.88551712
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.weight:
  weight_norm_before: 13.90959835
  weight_norm_after: 13.90959835
  weight_change: 0.00000000
  grad_norm: 0.00000000
dynamic_spatiotemporal_encoder.node_feature_back_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.weight:
  weight_norm_before: 0.00002686
  weight_norm_after: 0.00002664
  weight_change: 0.00000023
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.0.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.weight:
  weight_norm_before: 0.00006149
  weight_norm_after: 0.00006104
  weight_change: 0.00000044
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.1.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.weight:
  weight_norm_before: 0.00054189
  weight_norm_after: 0.00053908
  weight_change: 0.00000281
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.2.bias:
  weight_norm_before: 0.00000058
  weight_norm_after: 0.00000057
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.weight:
  weight_norm_before: 0.00006338
  weight_norm_after: 0.00006288
  weight_change: 0.00000050
  grad_norm: 0.00000000
celestial_to_target_attention.target_query_projections.3.bias:
  weight_norm_before: 0.00000020
  weight_norm_after: 0.00000020
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.weight:
  weight_norm_before: 0.00218464
  weight_norm_after: 0.00217320
  weight_change: 0.00001143
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_key_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
celestial_to_target_attention.celestial_value_projection.weight:
  weight_norm_before: 1.34783065
  weight_norm_after: 1.34630907
  weight_change: 0.00152159
  grad_norm: 0.00011665
celestial_to_target_attention.celestial_value_projection.bias:
  weight_norm_before: 0.27557158
  weight_norm_after: 0.27605936
  weight_change: 0.00048777
  grad_norm: 0.00031217
celestial_to_target_attention.output_projections.0.0.weight:
  weight_norm_before: 5.57193851
  weight_norm_after: 5.57052565
  weight_change: 0.00141287
  grad_norm: 0.00834710
celestial_to_target_attention.output_projections.0.0.bias:
  weight_norm_before: 0.27901542
  weight_norm_after: 0.27902424
  weight_change: 0.00000882
  grad_norm: 0.00069742
celestial_to_target_attention.output_projections.0.3.weight:
  weight_norm_before: 5.54468060
  weight_norm_after: 5.54299641
  weight_change: 0.00168419
  grad_norm: 0.01254299
celestial_to_target_attention.output_projections.0.3.bias:
  weight_norm_before: 0.13918069
  weight_norm_after: 0.13913570
  weight_change: 0.00004499
  grad_norm: 0.01935033
celestial_to_target_attention.output_projections.1.0.weight:
  weight_norm_before: 5.43012381
  weight_norm_after: 5.42850113
  weight_change: 0.00162268
  grad_norm: 0.00847484
celestial_to_target_attention.output_projections.1.0.bias:
  weight_norm_before: 0.29534537
  weight_norm_after: 0.29531085
  weight_change: 0.00003451
  grad_norm: 0.00077264
celestial_to_target_attention.output_projections.1.3.weight:
  weight_norm_before: 5.41217613
  weight_norm_after: 5.41049814
  weight_change: 0.00167799
  grad_norm: 0.01049087
celestial_to_target_attention.output_projections.1.3.bias:
  weight_norm_before: 0.13918069
  weight_norm_after: 0.13913570
  weight_change: 0.00004499
  grad_norm: 0.01935033
celestial_to_target_attention.output_projections.2.0.weight:
  weight_norm_before: 6.24776125
  weight_norm_after: 6.24613333
  weight_change: 0.00162792
  grad_norm: 0.01699883
celestial_to_target_attention.output_projections.2.0.bias:
  weight_norm_before: 0.33526826
  weight_norm_after: 0.33514592
  weight_change: 0.00012234
  grad_norm: 0.00175855
celestial_to_target_attention.output_projections.2.3.weight:
  weight_norm_before: 6.45583344
  weight_norm_after: 6.45438719
  weight_change: 0.00144625
  grad_norm: 0.01880151
celestial_to_target_attention.output_projections.2.3.bias:
  weight_norm_before: 0.13918069
  weight_norm_after: 0.13913570
  weight_change: 0.00004499
  grad_norm: 0.01935033
celestial_to_target_attention.output_projections.3.0.weight:
  weight_norm_before: 5.68311977
  weight_norm_after: 5.68197727
  weight_change: 0.00114250
  grad_norm: 0.00884367
celestial_to_target_attention.output_projections.3.0.bias:
  weight_norm_before: 0.28387913
  weight_norm_after: 0.28395835
  weight_change: 0.00007921
  grad_norm: 0.00081328
celestial_to_target_attention.output_projections.3.3.weight:
  weight_norm_before: 5.52384996
  weight_norm_after: 5.52225924
  weight_change: 0.00159073
  grad_norm: 0.01271433
celestial_to_target_attention.output_projections.3.3.bias:
  weight_norm_before: 0.13918069
  weight_norm_after: 0.13913570
  weight_change: 0.00004499
  grad_norm: 0.01935033
projection.weight:
  weight_norm_before: 1.80689359
  weight_norm_after: 1.80665004
  weight_change: 0.00024354
  grad_norm: 0.04764713
projection.bias:
  weight_norm_before: 0.00361553
  weight_norm_after: 0.00346649
  weight_change: 0.00014904
  grad_norm: 0.11279669
dual_stream_decoder.target_autocorr.target_projection.weight:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.target_projection.bias:
  weight_norm_before: 0.00000000
  weight_norm_after: 0.00000000
  weight_change: 0.00000000
  grad_norm: 0.00000000
dual_stream_decoder.target_autocorr.output_projection.0.weight:
  weight_norm_before: 0.72691560
  weight_norm_after: 0.72586656
  weight_change: 0.00104904
  grad_norm: 0.00020386
dual_stream_decoder.target_autocorr.output_projection.0.bias:
  weight_norm_before: 0.13844575
  weight_norm_after: 0.13847232
  weight_change: 0.00002657
  grad_norm: 0.00196812
dual_stream_decoder.target_autocorr.output_projection.1.weight:
  weight_norm_before: 1.76616144
  weight_norm_after: 1.76450884
  weight_change: 0.00165260
  grad_norm: 0.00021276
dual_stream_decoder.target_autocorr.output_projection.1.bias:
  weight_norm_before: 0.04290383
  weight_norm_after: 0.04280860
  weight_change: 0.00009523
  grad_norm: 0.00014246
calendar_effects_encoder.calendar_projection.0.weight:
  weight_norm_before: 0.25686744
  weight_norm_after: 0.25649619
  weight_change: 0.00037125
  grad_norm: 0.00000976
calendar_effects_encoder.calendar_projection.0.bias:
  weight_norm_before: 0.01423833
  weight_norm_after: 0.01421664
  weight_change: 0.00002169
  grad_norm: 0.00007501
calendar_effects_encoder.calendar_projection.1.weight:
  weight_norm_before: 0.39064023
  weight_norm_after: 0.39009753
  weight_change: 0.00054270
  grad_norm: 0.00000614
calendar_effects_encoder.calendar_projection.1.bias:
  weight_norm_before: 0.00193576
  weight_norm_after: 0.00193251
  weight_change: 0.00000325
  grad_norm: 0.00000329
optimizer_step_executed: True
current_lr: 0.00100000

================================================================================
EPOCH 1 | BATCH 2400/3529 | TRAINING MODE
================================================================================
raw_loss (full batch loss): 0.41786134
loss (scaled for backward): 0.41786134
effective_cycle (gradient_accumulation_steps): 1
loss/raw_loss ratio: 1.0000 (should be ~1/1)
accumulated train_loss so far: 2461.79874284
avg train_loss so far: 1.02532226
NOTE: NOW ACCUMULATING 'loss' (scaled), NOT 'raw_loss' (3x inflated)
y_pred_for_loss.requires_grad: True
y_pred_for_loss mean/std: -0.003773 / 0.026585
y_true_for_loss mean/std: 0.077993 / 0.648908
reg_loss contribution: 0.00000000
